/* UX v3 - Stats Component */
/* KPI / stats cards with values, trends, progress */

@layer components {

  /* =============================================
     Stats card
     ============================================= */

  .stat {
    @apply flex flex-col;
    gap: 0.5rem;
    padding: 1.5rem;
    background-color: var(--color-base-100);
    border: var(--border) solid var(--color-base-200);
    border-radius: var(--radius-box);
    transition: transform 0.15s, box-shadow 0.15s;

    &:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
    }
  }

  /* Clickable */
  a.stat,
  button.stat {
    @apply cursor-pointer no-underline text-left;

    &:active {
      transform: scale(0.98);
    }
  }

  /* =============================================
     Header (label + icon)
     ============================================= */

  .stat-header {
    @apply flex items-start justify-between;
    gap: 1rem;
  }

  .stat-label {
    @apply text-sm font-medium m-0;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
    line-height: 1.4;
  }

  .stat-icon {
    @apply flex items-center justify-center shrink-0;
    width: 48px;
    height: 48px;
    background-color: var(--color-base-200);
    border-radius: var(--radius-field);
    color: var(--color-primary);

    & > svg {
      @apply size-6;
    }
  }

  .stat-icon-sm {
    width: 36px;
    height: 36px;

    & > svg {
      @apply size-4.5;
    }
  }

  .stat-icon-lg {
    width: 56px;
    height: 56px;

    & > svg {
      @apply size-7;
    }
  }

  /* Icon colors */
  .stat-icon.color-primary  { background-color: color-mix(in oklch, var(--color-primary) 10%, transparent); color: var(--color-primary); }
  .stat-icon.color-success  { background-color: color-mix(in oklch, var(--color-success) 10%, transparent); color: var(--color-success); }
  .stat-icon.color-warning  { background-color: color-mix(in oklch, var(--color-warning) 10%, transparent); color: var(--color-warning); }
  .stat-icon.color-error    { background-color: color-mix(in oklch, var(--color-error) 10%, transparent);   color: var(--color-error);   }

  /* =============================================
     Value
     ============================================= */

  .stat-value {
    @apply m-0 font-bold;
    font-size: 2rem;
    color: var(--color-base-content);
    line-height: 1.2;
    font-variant-numeric: tabular-nums;
  }

  .stat-value-sm { font-size: 1.5rem; }
  .stat-value-lg { font-size: 2.5rem; }
  .stat-value-xl { font-size: 3rem; }

  /* Value with prefix/suffix */
  .stat-value-wrapper {
    @apply flex items-baseline;
    gap: 0.25rem;
  }

  .stat-value-prefix,
  .stat-value-suffix {
    @apply font-medium;
    font-size: 1.2rem;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }

  /* =============================================
     Footer (trend + description)
     ============================================= */

  .stat-footer {
    @apply flex items-center;
    gap: 0.5rem;
    margin-top: 0.25rem;
  }

  .stat-trend {
    @apply inline-flex items-center text-sm font-semibold;
    gap: 4px;
    padding: 2px 8px;
    border-radius: 9999px;

    & > svg {
      @apply size-3.5;
    }
  }

  .stat-trend-up {
    color: var(--color-success);
    background-color: color-mix(in oklch, var(--color-success) 10%, transparent);
  }

  .stat-trend-down {
    color: var(--color-error);
    background-color: color-mix(in oklch, var(--color-error) 10%, transparent);
  }

  .stat-trend-neutral {
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
    background-color: var(--color-base-200);
  }

  .stat-desc {
    @apply text-xs;
    color: color-mix(in oklch, var(--color-base-content) 50%, transparent);
  }

  /* =============================================
     Progress inside stat
     ============================================= */

  .stat-progress {
    margin-top: 0.5rem;
  }

  .stat-progress-bar {
    height: 6px;
    background-color: var(--color-base-200);
    border-radius: 9999px;
    overflow: hidden;
  }

  .stat-progress-fill {
    height: 100%;
    background-color: var(--color-primary);
    border-radius: 9999px;
    transition: width 0.3s;
  }

  .stat-progress-fill-success { background-color: var(--color-success); }
  .stat-progress-fill-warning { background-color: var(--color-warning); }
  .stat-progress-fill-error   { background-color: var(--color-error);   }

  .stat-progress-label {
    @apply flex justify-between text-xs;
    color: color-mix(in oklch, var(--color-base-content) 50%, transparent);
    margin-top: 0.25rem;
  }

  /* =============================================
     Size variants
     ============================================= */

  .stat-sm {
    padding: 1rem;

    & .stat-value { font-size: 1.5rem; }
    & .stat-icon { width: 36px; height: 36px; }
  }

  .stat-lg {
    padding: 2rem;

    & .stat-value { font-size: 2.5rem; }
    & .stat-icon { width: 56px; height: 56px; }
  }

  /* =============================================
     Layout variants
     ============================================= */

  .stat-horizontal {
    @apply flex-row items-center;

    & .stat-icon {
      order: -1;
    }
  }

  .stat-centered {
    @apply text-center items-center;

    & .stat-header {
      @apply flex-col items-center;
    }

    & .stat-footer {
      @apply justify-center;
    }
  }

  /* =============================================
     Stats grid
     ============================================= */

  .stats-grid {
    @apply grid;
    gap: 1rem;
  }

  .stats-grid-auto {
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  }

  .stats-grid-2 { grid-template-columns: repeat(2, 1fr); }
  .stats-grid-3 { grid-template-columns: repeat(3, 1fr); }
  .stats-grid-4 { grid-template-columns: repeat(4, 1fr); }

  @media (max-width: 991px) {
    .stats-grid-4,
    .stats-grid-3 {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  @media (max-width: 767px) {
    .stats-grid-4,
    .stats-grid-3,
    .stats-grid-2 {
      grid-template-columns: 1fr;
    }
  }

  /* =============================================
     Glass
     ============================================= */

  .stat.glass {
    @apply glass;
  }
}

/* =============================================
   Reduced motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .stat {
    transition: none;

    &:hover {
      transform: none;
    }
  }

  .stat-progress-fill {
    transition: none;
  }
}
