/* UX v3 - Chat Component */
/* Chat bubbles for AI assistant / messaging interfaces */

@layer components {

  /* =============================================
     Chat Message Container
     ============================================= */

  .chat-message {
    @apply flex;
    gap: 0.75rem;
    max-width: 85%;
  }

  .chat-user {
    @apply ml-auto flex-row-reverse;
  }

  .chat-assistant {
    @apply mr-auto;
  }

  .chat-system {
    @apply w-full;
    max-width: 100%;
  }

  /* =============================================
     Chat Bubble
     ============================================= */

  .chat-bubble {
    padding: 0.75rem 1rem;
    border-radius: var(--radius-box);
    font-size: 0.9375rem;
    line-height: 1.6;
    word-break: break-word;
  }

  .chat-user .chat-bubble {
    background-color: var(--color-primary);
    color: var(--color-primary-content, #fff);
    border-bottom-right-radius: 4px;
  }

  .chat-assistant .chat-bubble {
    background-color: var(--color-base-200);
    color: var(--color-base-content);
    border: var(--border) solid var(--color-base-300);
    border-bottom-left-radius: 4px;
  }

  .chat-bubble p {
    margin: 0;
  }

  .chat-bubble p + p {
    margin-top: 0.5rem;
  }

  .chat-bubble ul,
  .chat-bubble ol {
    margin: 0.25rem 0;
    padding-left: 1.25rem;
  }

  .chat-bubble li {
    margin: 0.125rem 0;
  }

  .chat-bubble code {
    padding: 2px 6px;
    background-color: color-mix(in oklch, var(--color-base-content) 8%, transparent);
    border-radius: var(--radius-field);
    font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, Consolas, monospace;
    font-size: 0.875em;
  }

  .chat-user .chat-bubble code {
    background-color: color-mix(in oklch, #fff 15%, transparent);
  }

  /* =============================================
     Typing Indicator
     ============================================= */

  .chat-typing {
    @apply flex items-center;
    gap: 4px;
    padding: 0.75rem 1rem;
    background-color: var(--color-base-200);
    border: var(--border) solid var(--color-base-300);
    border-radius: var(--radius-box);
    border-bottom-left-radius: 4px;
  }

  .chat-typing-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background-color: color-mix(in oklch, var(--color-base-content) 30%, transparent);
    animation: chat-typing-bounce 1.4s ease-in-out infinite;
  }

  .chat-typing-dot:nth-child(2) {
    animation-delay: 0.2s;
  }

  .chat-typing-dot:nth-child(3) {
    animation-delay: 0.4s;
  }

  @keyframes chat-typing-bounce {
    0%, 60%, 100% {
      transform: translateY(0);
      opacity: 0.4;
    }
    30% {
      transform: translateY(-4px);
      opacity: 1;
    }
  }

  /* =============================================
     Chat Avatar (optional)
     ============================================= */

  .chat-avatar {
    @apply shrink-0 flex items-center justify-center;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background-color: var(--color-base-300);
    color: var(--color-base-content);
    font-size: 0.875rem;
    font-weight: 600;
  }

  .chat-user .chat-avatar {
    background-color: color-mix(in oklch, var(--color-primary) 20%, transparent);
    color: var(--color-primary);
  }

  .chat-assistant .chat-avatar {
    background-color: color-mix(in oklch, var(--color-base-content) 10%, transparent);
  }

  /* =============================================
     Chat Input Area
     ============================================= */

  .chat-input-area {
    @apply flex items-end;
    gap: 0.5rem;
    padding: 1rem;
    border-top: var(--border) solid var(--color-base-300);
  }
}

/* =============================================
   Reduced Motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .chat-typing-dot {
    animation: none;
    opacity: 0.5;
  }
}
