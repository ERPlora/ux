/* UX v3 - Select Modal Component */
/* Ionic-style select that opens a modal with radio/checkbox options */
/* Trigger + option items only â€” reuses modal, radio, checkbox, btn */

@layer components {

  /* =============================================
     Trigger (button that looks like a select)
     ============================================= */

  .select-modal {
    @apply relative w-full flex items-center gap-2 cursor-pointer outline-none text-left;
    height: 2.75rem;
    padding: 0.5rem 2.5rem 0.5rem 0.75rem;
    font-size: 1rem;
    line-height: 1.5;
    color: var(--color-base-content);
    background-color: var(--color-base-100);
    border: var(--border) solid var(--color-base-300);
    border-radius: var(--radius-field);
    transition: border-color 0.15s, box-shadow 0.15s;

    /* Chevron arrow (matches select.css) */
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 0.75rem center;
    background-size: 1rem;

    &:hover {
      border-color: color-mix(in oklch, var(--color-base-content) 30%, transparent);
    }

    &:focus {
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px color-mix(in oklch, var(--color-primary) 15%, transparent);
    }

    &:disabled,
    &[disabled] {
      @apply opacity-50 cursor-not-allowed;
      background-color: var(--color-base-200);
    }
  }

  /* =============================================
     Trigger children
     ============================================= */

  .select-modal-value {
    @apply truncate flex-1;
    color: var(--color-base-content);
  }

  .select-modal-placeholder {
    @apply truncate flex-1;
    color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
  }

  /* =============================================
     Tags (multi-select chips in trigger)
     ============================================= */

  .select-modal-tags {
    @apply flex flex-wrap gap-1 flex-1 overflow-hidden;
  }

  .select-modal-tag {
    @apply inline-flex items-center gap-1 text-xs font-medium rounded-full;
    padding: 0.125rem 0.5rem;
    background-color: color-mix(in oklch, var(--color-primary) 12%, transparent);
    color: var(--color-primary);
    max-width: 120px;

    & span {
      @apply truncate;
    }
  }

  .select-modal-tag-remove {
    @apply inline-flex items-center justify-center rounded-full shrink-0 cursor-pointer;
    width: 0.875rem;
    height: 0.875rem;
    opacity: 0.6;
    transition: opacity 0.1s;

    &:hover {
      opacity: 1;
    }

    & svg {
      @apply size-2.5;
    }
  }

  /* =============================================
     Sizes
     ============================================= */

  .select-modal-sm {
    height: 2.25rem;
    padding: 0.375rem 2rem 0.375rem 0.625rem;
    font-size: 0.875rem;
  }

  .select-modal-lg {
    height: 3.25rem;
    padding: 0.625rem 2.75rem 0.625rem 1rem;
    font-size: 1.125rem;
  }

  /* =============================================
     Variants
     ============================================= */

  .select-modal-filled {
    background-color: var(--color-base-200);
    border-color: transparent;
    border-radius: var(--radius-field) var(--radius-field) 0 0;
    border-bottom: 2px solid var(--color-base-300);

    &:focus {
      border-bottom-color: var(--color-primary);
      @apply shadow-none;
    }
  }

  .select-modal-ghost {
    @apply bg-transparent border-transparent;

    &:focus {
      border-color: var(--color-primary);
    }
  }

  /* =============================================
     States
     ============================================= */

  .select-modal-error {
    border-color: var(--color-error);

    &:focus {
      box-shadow: 0 0 0 3px color-mix(in oklch, var(--color-error) 15%, transparent);
    }
  }

  .select-modal-success {
    border-color: var(--color-success);

    &:focus {
      box-shadow: 0 0 0 3px color-mix(in oklch, var(--color-success) 15%, transparent);
    }
  }

  /* =============================================
     Option items (inside modal-body)
     ============================================= */

  .select-modal-option {
    @apply flex items-center gap-3 cursor-pointer select-none;
    padding: 0.75rem 1.25rem;
    transition: background-color 0.1s;

    &:hover {
      background-color: var(--color-base-200);
    }

    &:active {
      background-color: color-mix(in oklch, var(--color-base-content) 8%, transparent);
    }
  }

  .select-modal-option + .select-modal-option {
    border-top: var(--border) solid var(--color-base-200);
  }

  .select-modal-option-selected {
    background-color: color-mix(in oklch, var(--color-primary) 6%, transparent);
  }

  .select-modal-option-disabled {
    @apply opacity-40 cursor-not-allowed pointer-events-none;
  }

  /* =============================================
     Option children
     ============================================= */

  .select-modal-option-text {
    @apply flex-1 min-w-0;
  }

  .select-modal-option-label {
    @apply text-base leading-snug;
    color: var(--color-base-content);
  }

  .select-modal-option-description {
    @apply text-sm;
    color: color-mix(in oklch, var(--color-base-content) 55%, transparent);
    margin-top: 0.125rem;
  }

  /* =============================================
     Checkmark style (no radio/checkbox widget)
     ============================================= */

  .select-modal-option-check {
    @apply shrink-0 opacity-0;
    width: 1.25rem;
    height: 1.25rem;
    color: var(--color-primary);
    transition: opacity 0.15s;
  }

  .select-modal-option-selected .select-modal-option-check {
    @apply opacity-100;
  }

  /* =============================================
     Search input (sticky at top of modal-body)
     ============================================= */

  .select-modal-search {
    @apply sticky top-0 z-10;
    padding: 0.75rem 1.25rem;
    background-color: var(--color-base-100);
    border-bottom: var(--border) solid var(--color-base-200);
  }

  /* =============================================
     Color composition
     ============================================= */

  .select-modal.color-primary,
  .select-modal.color-secondary,
  .select-modal.color-accent,
  .select-modal.color-info,
  .select-modal.color-success,
  .select-modal.color-warning,
  .select-modal.color-error {
    border-color: var(--c);

    &:focus {
      box-shadow: 0 0 0 3px color-mix(in oklch, var(--c) 15%, transparent);
    }
  }

  /* =============================================
     Glass variant
     ============================================= */

  .select-modal.glass {
    @apply glass;
    border: 0.5px solid var(--glass-border);

    &:focus {
      box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.5);
    }
  }

  .select-modal.glass .select-modal-tag {
    background-color: rgba(255, 255, 255, 0.15);
    color: var(--color-base-content);
  }

  /* Glass option items */
  .modal.glass .select-modal-option:hover {
    background-color: rgba(255, 255, 255, 0.08);
  }

  .modal.glass .select-modal-option-selected {
    background-color: rgba(255, 255, 255, 0.12);
  }

  .modal.glass .select-modal-option + .select-modal-option {
    border-top-color: var(--glass-border);
  }

  .modal.glass .select-modal-search {
    background-color: transparent;
    border-bottom-color: var(--glass-border);
  }
}

/* =============================================
   Reduced motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .select-modal {
    transition: none;
  }

  .select-modal-option {
    transition: none;
  }

  .select-modal-option-check {
    transition: none;
  }
}
