/* UX v3 - Variant Selector Component */
/* Size, color, image, chip selectors for e-commerce product options */

@layer components {

  /* =============================================
     Base
     ============================================= */

  .variant-selector {
    @apply flex flex-col;
    gap: 0.5rem;
  }

  .variant-selector-label {
    @apply flex items-center justify-between text-sm font-medium;
    color: var(--color-base-content);
  }

  .variant-selector-selected {
    @apply font-normal;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }

  .variant-selector-options {
    @apply flex flex-wrap;
    gap: 0.5rem;
  }

  /* =============================================
     Option (base)
     ============================================= */

  .variant-selector-option {
    @apply flex items-center justify-center relative overflow-hidden cursor-pointer text-sm font-medium;
    min-width: 44px;
    height: 44px;
    padding: 0 1rem;
    border: 2px solid var(--color-base-300);
    border-radius: var(--radius-box, 0.75rem);
    background: var(--color-base-100);
    color: var(--color-base-content);
    transition: all 0.15s ease;

    &:hover {
      border-color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
    }
  }

  .variant-selector-option-selected {
    border-color: var(--color-primary);
    background: color-mix(in oklch, var(--color-primary) 10%, transparent);
    color: var(--color-primary);
  }

  .variant-selector-option-disabled {
    @apply opacity-40 cursor-not-allowed pointer-events-none;
  }

  .variant-selector-option-unavailable {
    @apply cursor-not-allowed;
    opacity: 0.5;

    &::after {
      content: '';
      @apply absolute;
      top: 50%;
      left: -10%;
      width: 120%;
      height: 2px;
      background: color-mix(in oklch, var(--color-base-content) 40%, transparent);
      transform: rotate(-45deg);
    }
  }

  /* =============================================
     Size Variants
     ============================================= */

  .variant-selector-sm .variant-selector-option {
    min-width: 36px;
    height: 36px;
    padding: 0 0.5rem;
    font-size: 0.75rem;
  }

  .variant-selector-lg .variant-selector-option {
    min-width: 52px;
    height: 52px;
    padding: 0 1.5rem;
    font-size: 1rem;
  }

  /* =============================================
     Color Swatch Variant
     ============================================= */

  .variant-selector-color {
    .variant-selector-options { gap: 0.25rem; }

    .variant-selector-option {
      min-width: 36px;
      width: 36px;
      height: 36px;
      @apply p-0 rounded-full;
      border-width: 3px;
      border-color: transparent;
      box-shadow: inset 0 0 0 2px var(--color-base-100);

      &:hover {
        border-color: var(--color-base-300);
      }
    }

    .variant-selector-option-selected {
      border-color: var(--color-primary);
      box-shadow: inset 0 0 0 2px var(--color-base-100);

      &::before {
        content: '';
        width: 12px;
        height: 6px;
        border-left: 2px solid white;
        border-bottom: 2px solid white;
        transform: rotate(-45deg);
        margin-bottom: 2px;
      }
    }

    .variant-selector-option-dark.variant-selector-option-selected::before {
      border-color: white;
    }

    .variant-selector-option-light {
      box-shadow: inset 0 0 0 1px var(--color-base-300), inset 0 0 0 2px var(--color-base-100);

      &.variant-selector-option-selected::before {
        border-color: var(--color-base-content);
      }
    }

    .variant-selector-option-unavailable::after {
      @apply w-full;
      left: 0;
      background: rgba(255, 255, 255, 0.8);
    }

    &.variant-selector-sm .variant-selector-option {
      min-width: 28px;
      width: 28px;
      height: 28px;
    }

    &.variant-selector-lg .variant-selector-option {
      min-width: 44px;
      width: 44px;
      height: 44px;
    }
  }

  /* =============================================
     Image Variant
     ============================================= */

  .variant-selector-image {
    .variant-selector-option {
      width: 56px;
      height: 56px;
      padding: 2px;
      border-radius: var(--radius-box, 0.75rem);

      img {
        @apply w-full h-full object-cover;
        border-radius: calc(var(--radius-box, 0.75rem) - 4px);
      }
    }

    &.variant-selector-sm .variant-selector-option {
      width: 44px;
      height: 44px;
    }

    &.variant-selector-lg .variant-selector-option {
      width: 72px;
      height: 72px;
    }
  }

  /* =============================================
     Chip Variant
     ============================================= */

  .variant-selector-chip {
    .variant-selector-option {
      @apply h-auto rounded-full text-sm;
      padding: 0.25rem 1rem;
    }

    .variant-selector-option-selected {
      background: var(--color-primary);
      border-color: var(--color-primary);
      color: var(--color-primary-content, white);
    }
  }

  /* =============================================
     Button Group Variant
     ============================================= */

  .variant-selector-button-group {
    .variant-selector-options { gap: 0; }

    .variant-selector-option {
      @apply rounded-none;
      margin-left: -2px;

      &:first-child {
        border-radius: var(--radius-box, 0.75rem) 0 0 var(--radius-box, 0.75rem);
        margin-left: 0;
      }

      &:last-child {
        border-radius: 0 var(--radius-box, 0.75rem) var(--radius-box, 0.75rem) 0;
      }
    }

    .variant-selector-option-selected { z-index: 1; }
  }

  /* =============================================
     Dropdown Variant
     ============================================= */

  .variant-selector-dropdown {
    @apply relative;

    .variant-selector-trigger {
      @apply flex items-center justify-between w-full cursor-pointer;
      height: 44px;
      padding: 0 1rem;
      border: 1px solid var(--color-base-300);
      border-radius: var(--radius-box, 0.75rem);
      background: var(--color-base-100);
      color: var(--color-base-content);
      font-size: 1rem;
      transition: border-color 0.15s ease;

      &:hover {
        border-color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
      }

      &:focus {
        @apply outline-none;
        border-color: var(--color-primary);
        box-shadow: 0 0 0 3px color-mix(in oklch, var(--color-primary) 20%, transparent);
      }
    }

    .variant-selector-trigger-icon {
      width: 16px;
      height: 16px;
      color: color-mix(in oklch, var(--color-base-content) 50%, transparent);
      transition: transform 0.15s ease;
    }

    &.variant-selector-open .variant-selector-trigger-icon {
      transform: rotate(180deg);
    }

    .variant-selector-menu {
      @apply absolute;
      top: 100%;
      left: 0;
      right: 0;
      margin-top: 0.25rem;
      padding: 0.25rem;
      background: var(--color-base-100);
      border: 1px solid var(--color-base-300);
      border-radius: var(--radius-box, 0.75rem);
      box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
      z-index: 100;
      opacity: 0;
      visibility: hidden;
      transform: translateY(-8px);
      transition: all 0.15s ease;
    }

    &.variant-selector-open .variant-selector-menu {
      opacity: 1;
      visibility: visible;
      transform: translateY(0);
    }

    .variant-selector-option {
      @apply w-full justify-start border-none;
      border-radius: var(--radius-field, 0.25rem);
      padding: 0.5rem 1rem;

      &:hover {
        background: var(--color-base-200);
      }
    }

    .variant-selector-option-selected {
      background: color-mix(in oklch, var(--color-primary) 10%, transparent);
    }
  }

  /* =============================================
     Option Content (with price)
     ============================================= */

  .variant-selector-option-content {
    @apply flex flex-col items-center;
    gap: 2px;
  }

  .variant-selector-option-name { @apply font-medium; }

  .variant-selector-option-price {
    @apply text-xs;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }

  .variant-selector-option-selected .variant-selector-option-price {
    color: color-mix(in oklch, var(--color-primary) 80%, transparent);
  }

  .variant-selector-option-diff { @apply text-xs; }
  .variant-selector-option-diff-up { color: var(--color-error); }
  .variant-selector-option-diff-down { color: var(--color-success); }

  /* =============================================
     Stock Indicator
     ============================================= */

  .variant-selector-stock {
    @apply flex items-center text-xs;
    gap: 0.25rem;
    margin-top: 0.25rem;
  }

  .variant-selector-stock-dot {
    @apply rounded-full;
    width: 6px;
    height: 6px;
  }

  .variant-selector-stock-in-stock .variant-selector-stock-dot { background: var(--color-success); }
  .variant-selector-stock-low-stock .variant-selector-stock-dot { background: var(--color-warning); }
  .variant-selector-stock-out-of-stock .variant-selector-stock-dot { background: var(--color-error); }

  .variant-selector-stock-text {
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }
}

/* =============================================
   Reduced Motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .variant-selector-option,
  .variant-selector-dropdown .variant-selector-trigger,
  .variant-selector-dropdown .variant-selector-menu,
  .variant-selector-dropdown .variant-selector-trigger-icon {
    transition: none;
  }
}
