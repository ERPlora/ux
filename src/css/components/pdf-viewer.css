/* UX v3 - PDF Viewer Component */
/* PDF viewer with toolbar, page navigation, zoom, thumbnails, search, annotations */

@layer components {

  /* =============================================
     Base
     ============================================= */

  .pdf-viewer {
    @apply relative flex flex-col overflow-hidden;
    background-color: var(--color-base-200);
    border-radius: var(--radius-box, 0.75rem);
    height: 600px;
  }

  .pdf-viewer-fullscreen {
    @apply fixed inset-0;
    z-index: 50;
    height: 100dvh;
    border-radius: 0;
  }

  /* =============================================
     Toolbar
     ============================================= */

  .pdf-viewer-toolbar {
    @apply flex items-center gap-2 shrink-0;
    padding: 0 1rem;
    height: 48px;
    background-color: var(--color-base-100);
    border-bottom: 1px solid var(--color-base-300);
  }

  .pdf-viewer-toolbar-group {
    @apply flex items-center gap-1;
  }

  .pdf-viewer-toolbar-separator {
    width: 1px;
    height: 24px;
    background-color: var(--color-base-300);
    margin: 0 0.25rem;
  }

  .pdf-viewer-toolbar-spacer {
    @apply flex-1;
  }

  /* =============================================
     Toolbar Button
     ============================================= */

  .pdf-viewer-btn {
    @apply inline-flex items-center justify-center border-none bg-transparent cursor-pointer;
    width: 36px;
    height: 36px;
    border-radius: var(--radius-field, 0.25rem);
    color: var(--color-base-content);
    transition: background-color 0.15s ease;

    &:hover {
      background-color: var(--color-base-200);
    }

    &:active {
      background-color: var(--color-base-300);
    }

    &:disabled {
      @apply opacity-40 cursor-not-allowed;
    }

    svg {
      @apply w-5 h-5;
    }
  }

  /* =============================================
     Page Input / Zoom
     ============================================= */

  .pdf-viewer-page-input {
    @apply text-center text-sm;
    width: 48px;
    height: 32px;
    border: 1px solid var(--color-base-300);
    border-radius: var(--radius-field, 0.25rem);
    background-color: var(--color-base-100);
    color: var(--color-base-content);
  }

  .pdf-viewer-page-total {
    @apply text-sm;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }

  .pdf-viewer-zoom-select {
    @apply text-sm cursor-pointer;
    height: 32px;
    padding: 0 0.5rem;
    border: 1px solid var(--color-base-300);
    border-radius: var(--radius-field, 0.25rem);
    background-color: var(--color-base-100);
    color: var(--color-base-content);
  }

  /* =============================================
     Container / Page
     ============================================= */

  .pdf-viewer-container {
    @apply flex-1 overflow-auto flex flex-col items-center gap-4;
    padding: 1.5rem;
  }

  .pdf-viewer-page {
    @apply relative;
    background-color: var(--color-base-100);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);

    canvas {
      @apply block;
    }
  }

  /* =============================================
     Loading
     ============================================= */

  .pdf-viewer-loading {
    @apply absolute inset-0 flex flex-col items-center justify-center gap-4;
    background-color: var(--color-base-200);
  }

  .pdf-viewer-loading-spinner {
    @apply rounded-full;
    width: 40px;
    height: 40px;
    border: 3px solid var(--color-base-300);
    border-top-color: var(--color-primary);
    animation: pdf-spin 0.8s linear infinite;
  }

  .pdf-viewer-loading-text {
    @apply text-sm;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }

  /* =============================================
     Error
     ============================================= */

  .pdf-viewer-error {
    @apply absolute inset-0 flex flex-col items-center justify-center gap-4 text-center;
    background-color: var(--color-base-200);
    padding: 2rem;
  }

  .pdf-viewer-error-icon {
    @apply w-12 h-12;
    color: var(--color-error);
  }

  .pdf-viewer-error-text {
    color: var(--color-base-content);
  }

  /* =============================================
     Thumbnails Sidebar
     ============================================= */

  .pdf-viewer-with-thumbnails {
    @apply flex-row;

    .pdf-viewer-main {
      @apply flex flex-col flex-1 min-w-0;
    }
  }

  .pdf-viewer-thumbnails {
    @apply flex flex-col gap-2 shrink-0 overflow-y-auto;
    width: 160px;
    padding: 0.5rem;
    background-color: var(--color-base-100);
    border-right: 1px solid var(--color-base-300);
  }

  .pdf-viewer-thumbnail {
    @apply cursor-pointer;
    border: 2px solid transparent;
    border-radius: var(--radius-field, 0.25rem);
    padding: 0.25rem;
    transition: border-color 0.15s ease;

    &:hover {
      border-color: var(--color-base-300);
    }

    canvas {
      @apply block w-full h-auto;
    }
  }

  .pdf-viewer-thumbnail-active {
    border-color: var(--color-primary);
  }

  .pdf-viewer-thumbnail-label {
    @apply text-xs text-center;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
    margin-top: 0.25rem;
  }

  /* =============================================
     Search
     ============================================= */

  .pdf-viewer-search {
    @apply flex items-center gap-1;
  }

  .pdf-viewer-search-input {
    @apply text-sm;
    width: 160px;
    height: 32px;
    padding: 0 0.5rem;
    border: 1px solid var(--color-base-300);
    border-radius: var(--radius-field, 0.25rem);
    background-color: var(--color-base-100);
    color: var(--color-base-content);
  }

  .pdf-viewer-search-count {
    @apply text-xs;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
    min-width: 60px;
  }

  /* =============================================
     Annotations
     ============================================= */

  .pdf-viewer-annotation {
    @apply absolute cursor-pointer;
    background: rgba(255, 235, 59, 0.3);
    border: 1px solid rgba(255, 235, 59, 0.6);
  }

  /* =============================================
     Glass
     ============================================= */

  .pdf-viewer.glass {
    @apply glass;

    .pdf-viewer-toolbar {
      background-color: color-mix(in oklch, var(--color-base-100) 50%, transparent);
      border-color: color-mix(in oklch, var(--color-base-content) 10%, transparent);
    }
  }
}

@keyframes pdf-spin {
  to { transform: rotate(360deg); }
}

/* =============================================
   Responsive
   ============================================= */

@media (max-width: 767px) {
  .pdf-viewer-thumbnails {
    @apply hidden;
  }

  .pdf-viewer-toolbar {
    @apply flex-wrap h-auto gap-1;
    padding: 0.5rem;
  }

  .pdf-viewer-search {
    @apply w-full order-last;
    margin-top: 0.25rem;
  }

  .pdf-viewer-search-input {
    @apply flex-1;
  }
}

/* =============================================
   Print
   ============================================= */

@media print {
  .pdf-viewer-toolbar,
  .pdf-viewer-thumbnails {
    display: none !important;
  }

  .pdf-viewer {
    height: auto !important;
    background: none !important;
  }

  .pdf-viewer-page {
    box-shadow: none !important;
    page-break-after: always;
  }
}

/* =============================================
   Reduced Motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .pdf-viewer-loading-spinner {
    animation: none;
  }
}
