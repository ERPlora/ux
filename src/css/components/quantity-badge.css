/* UX v3 - Quantity Badge Component */
/* Badges for counters, notifications, cart items with position & color variants */

@layer components {

  /* =============================================
     Base
     ============================================= */

  .quantity-badge {
    @apply relative inline-flex;
  }

  /* =============================================
     Count Element
     ============================================= */

  .quantity-badge-count {
    @apply absolute flex items-center justify-center font-semibold;
    top: -6px;
    right: -6px;
    min-width: 18px;
    height: 18px;
    padding: 0 5px;
    background: var(--color-error);
    color: white;
    font-size: 11px;
    line-height: 1;
    border-radius: 9999px;
    border: 2px solid var(--color-base-100);
    transform: scale(1);
    transition: transform 0.15s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }

  .quantity-badge-count-animate {
    animation: badge-pop 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }

  .quantity-badge-count-hidden {
    transform: scale(0);
  }

  .quantity-badge-count-dot {
    @apply p-0;
    min-width: 10px;
    width: 10px;
    height: 10px;
    top: -2px;
    right: -2px;
  }

  .quantity-badge-count-pulse {
    animation: badge-pulse 1.5s ease-in-out infinite;
  }

  /* =============================================
     Size Variants
     ============================================= */

  .quantity-badge-sm .quantity-badge-count {
    min-width: 14px;
    height: 14px;
    padding: 0 3px;
    font-size: 9px;
    top: -4px;
    right: -4px;
  }

  .quantity-badge-lg .quantity-badge-count {
    min-width: 22px;
    height: 22px;
    padding: 0 6px;
    font-size: 13px;
    top: -8px;
    right: -8px;
  }

  /* =============================================
     Position Variants
     ============================================= */

  .quantity-badge-top-left .quantity-badge-count {
    top: -6px;
    right: auto;
    left: -6px;
  }

  .quantity-badge-bottom-right .quantity-badge-count {
    top: auto;
    bottom: -6px;
    right: -6px;
  }

  .quantity-badge-bottom-left .quantity-badge-count {
    top: auto;
    bottom: -6px;
    right: auto;
    left: -6px;
  }

  /* =============================================
     Inline Variant
     ============================================= */

  .quantity-badge-inline {
    @apply inline-flex items-center;
    gap: 0.25rem;

    .quantity-badge-count {
      @apply static border-none;
    }
  }

  /* =============================================
     Color Variants
     ============================================= */

  .quantity-badge-primary .quantity-badge-count { background: var(--color-primary); }
  .quantity-badge-secondary .quantity-badge-count { background: var(--color-secondary); }
  .quantity-badge-success .quantity-badge-count { background: var(--color-success); }

  .quantity-badge-warning .quantity-badge-count {
    background: var(--color-warning);
    color: #111;
  }

  .quantity-badge-danger .quantity-badge-count { background: var(--color-error); }

  .quantity-badge-dark .quantity-badge-count {
    background: color-mix(in oklch, var(--color-base-content) 90%, transparent);
  }

  .quantity-badge-light .quantity-badge-count {
    background: var(--color-base-200);
    color: var(--color-base-content);
  }

  /* Soft color variants */
  .quantity-badge-primary-soft .quantity-badge-count {
    background: color-mix(in oklch, var(--color-primary) 15%, transparent);
    color: var(--color-primary);
    border-color: color-mix(in oklch, var(--color-primary) 15%, transparent);
  }

  .quantity-badge-success-soft .quantity-badge-count {
    background: color-mix(in oklch, var(--color-success) 15%, transparent);
    color: var(--color-success);
    border-color: color-mix(in oklch, var(--color-success) 15%, transparent);
  }

  .quantity-badge-danger-soft .quantity-badge-count {
    background: color-mix(in oklch, var(--color-error) 15%, transparent);
    color: var(--color-error);
    border-color: color-mix(in oklch, var(--color-error) 15%, transparent);
  }

  /* Outline variants */
  .quantity-badge-outline .quantity-badge-count {
    background: var(--color-base-100);
    color: var(--color-error);
    border-color: var(--color-error);
  }

  .quantity-badge-outline.quantity-badge-primary .quantity-badge-count {
    color: var(--color-primary);
    border-color: var(--color-primary);
  }

  .quantity-badge-outline.quantity-badge-success .quantity-badge-count {
    color: var(--color-success);
    border-color: var(--color-success);
  }

  /* =============================================
     Cart Variant
     ============================================= */

  .quantity-badge-cart {
    @apply inline-flex items-center;
    gap: 0.5rem;
    padding: 0.25rem 0.5rem;
    background: var(--color-base-100);
    border: 1px solid var(--color-base-300);
    border-radius: 9999px;

    .quantity-badge-btn {
      @apply flex items-center justify-center border-none cursor-pointer select-none;
      width: 24px;
      height: 24px;
      background: var(--color-base-200);
      border-radius: 50%;
      color: var(--color-base-content);
      font-size: 16px;
      font-weight: 500;
      transition: background 0.15s ease;

      &:hover { background: var(--color-base-300); }
      &:active { transform: scale(0.95); }
      &:disabled { @apply opacity-40 cursor-not-allowed; }
    }

    .quantity-badge-value {
      @apply text-center font-semibold;
      min-width: 24px;
      color: var(--color-base-content);
    }
  }

  /* =============================================
     Stepper Variant
     ============================================= */

  .quantity-badge-stepper {
    @apply inline-flex items-center overflow-hidden;
    background: var(--color-base-200);
    border-radius: var(--radius-box, 0.75rem);

    .quantity-badge-btn {
      @apply flex items-center justify-center border-none cursor-pointer;
      width: 36px;
      height: 36px;
      background: transparent;
      color: var(--color-base-content);
      font-size: 18px;
      transition: background 0.15s ease;

      &:hover { background: var(--color-base-300); }
      &:active { background: color-mix(in oklch, var(--color-base-content) 20%, transparent); }
      &:disabled { @apply opacity-40 cursor-not-allowed; }
    }

    .quantity-badge-value {
      @apply flex items-center justify-center font-semibold;
      min-width: 40px;
      height: 36px;
      color: var(--color-base-content);
      border-left: 1px solid var(--color-base-300);
      border-right: 1px solid var(--color-base-300);
    }
  }
}

/* =============================================
   Keyframes (outside @layer)
   ============================================= */

@keyframes badge-pop {
  0% { transform: scale(0); }
  50% { transform: scale(1.2); }
  100% { transform: scale(1); }
}

@keyframes badge-pulse {
  0%, 100% { box-shadow: 0 0 0 0 color-mix(in oklch, var(--color-error) 50%, transparent); }
  50% { box-shadow: 0 0 0 6px transparent; }
}

/* =============================================
   Reduced Motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .quantity-badge-count {
    transition: none;
  }

  .quantity-badge-count-animate,
  .quantity-badge-count-pulse {
    animation: none;
  }

  .quantity-badge-cart .quantity-badge-btn,
  .quantity-badge-stepper .quantity-badge-btn {
    transition: none;
  }
}
