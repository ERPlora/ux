/* UX v3 - Resizable Component */
/* Resizable panels with drag handles, grips, and collapse buttons */

@layer components {

  /* =============================================
     Container
     ============================================= */

  .resizable {
    @apply flex w-full h-full;
  }

  .resizable-vertical {
    @apply flex-col;
  }

  /* =============================================
     Panel
     ============================================= */

  .resizable-panel {
    @apply flex-1 overflow-hidden;
    min-width: var(--panel-min-w, 0);
    max-width: var(--panel-max-w, none);
    min-height: var(--panel-min-h, 0);
    max-height: var(--panel-max-h, none);
  }

  .resizable-panel[data-collapsed="true"] {
    flex-basis: 0 !important;
    @apply overflow-hidden;
  }

  /* =============================================
     Handle (horizontal default)
     ============================================= */

  .resizable-handle {
    @apply relative flex items-center justify-center select-none;
    flex: 0 0 4px;
    background-color: var(--color-base-300);
    cursor: col-resize;
    touch-action: none;
    transition: background-color 0.15s ease;

    /* Hit area */
    &::before {
      content: '';
      @apply absolute inset-0;
      width: 12px;
      left: 50%;
      transform: translateX(-50%);
    }

    &:hover,
    &:focus-visible,
    &[data-dragging="true"] {
      background-color: var(--color-primary);
    }

    &:focus-visible {
      @apply outline-2 outline-primary outline-offset-2;
    }
  }

  /* Vertical handle */
  .resizable-vertical > .resizable-handle {
    cursor: row-resize;

    &::before {
      width: auto;
      height: 12px;
      inset: auto 0;
      top: 50%;
      left: auto;
      transform: translateY(-50%);
    }
  }

  /* =============================================
     Handle variants
     ============================================= */

  .resizable-handle-hidden {
    @apply bg-transparent;

    &:hover {
      background-color: var(--color-primary);
    }
  }

  .resizable-handle-bordered {
    @apply bg-transparent;
    border-left: 1px solid var(--color-base-300);

    &:hover {
      border-color: var(--color-primary);
      background-color: color-mix(in oklch, var(--color-primary) 5%, transparent);
    }
  }

  .resizable-vertical > .resizable-handle-bordered {
    border-left: none;
    border-top: 1px solid var(--color-base-300);
  }

  /* =============================================
     Grip (visual handle indicator)
     ============================================= */

  .resizable-grip {
    @apply flex items-center justify-center z-10;
    width: 12px;
    height: 1rem;
    background-color: var(--color-base-100);
    border: 1px solid var(--color-base-300);
    border-radius: var(--radius-field, 0.25rem);

    & svg {
      @apply w-2.5 h-2.5;
      color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
    }
  }

  .resizable-handle:hover .resizable-grip svg,
  .resizable-handle[data-dragging="true"] .resizable-grip svg {
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }

  .resizable-vertical .resizable-grip {
    width: 1rem;
    height: 12px;

    & svg {
      transform: rotate(90deg);
    }
  }

  /* =============================================
     Collapse button
     ============================================= */

  .resizable-collapse-btn {
    @apply absolute flex items-center justify-center cursor-pointer;
    width: 20px;
    height: 20px;
    background-color: var(--color-base-100);
    border: 1px solid var(--color-base-300);
    border-radius: 50%;
    z-index: 2;
    transition: background-color 0.15s ease, transform 0.15s ease;
    top: 50%;
    transform: translateY(-50%);

    & svg {
      @apply w-3 h-3;
      color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
    }

    &:hover {
      background-color: var(--color-base-200);

      & svg {
        color: var(--color-base-content);
      }
    }
  }

  .resizable-collapse-start { left: -10px; }
  .resizable-collapse-end { right: -10px; }

  .resizable-vertical .resizable-collapse-btn {
    top: auto;
    left: 50%;
    transform: translateX(-50%);
  }

  .resizable-vertical .resizable-collapse-start { top: -10px; }
  .resizable-vertical .resizable-collapse-end { bottom: -10px; }

  /* =============================================
     Sizes
     ============================================= */

  .resizable-sm > .resizable-handle { flex-basis: 2px; }
  .resizable-lg > .resizable-handle { flex-basis: 8px; }

  /* =============================================
     Nested
     ============================================= */

  .resizable-panel > .resizable {
    @apply w-full h-full;
  }

  /* =============================================
     Disabled
     ============================================= */

  .resizable-disabled .resizable-handle {
    @apply cursor-default pointer-events-none opacity-50;
  }

  /* =============================================
     Glass
     ============================================= */

  .resizable.glass .resizable-handle {
    background-color: rgba(255, 255, 255, 0.18);
  }

  .resizable.glass .resizable-grip {
    @apply glass;
    border-color: rgba(255, 255, 255, 0.18);
  }
}

/* =============================================
   Dragging state (on body)
   ============================================= */

body[data-resizing="horizontal"] {
  cursor: col-resize;
  user-select: none;
}

body[data-resizing="vertical"] {
  cursor: row-resize;
  user-select: none;
}

/* =============================================
   Reduced motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .resizable-handle,
  .resizable-grip,
  .resizable-collapse-btn {
    transition: none;
  }
}
