/* UX v3 - Sparkline Component */
/* Inline SVG sparkline charts with line, area, bar types, and animated draw */

@layer components {

  /* =============================================
     Base
     ============================================= */

  .sparkline {
    @apply inline-flex items-center gap-2;
  }

  .sparkline-svg {
    @apply block overflow-visible;
  }

  /* =============================================
     Line Chart
     ============================================= */

  .sparkline-line {
    fill: none;
    stroke: var(--color-primary);
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
  }

  .sparkline-area {
    fill: url(#sparklineGradient);
    opacity: 0.2;
  }

  .sparkline-dot {
    fill: var(--color-primary);
  }

  .sparkline-dot-last {
    fill: var(--color-primary);
    stroke: var(--color-base-100);
    stroke-width: 2;
  }

  /* =============================================
     Bar Chart
     ============================================= */

  .sparkline-bar {
    fill: var(--color-primary);
    rx: 2;
  }

  .sparkline-bar-negative {
    fill: var(--color-error);
  }

  /* =============================================
     Reference Line
     ============================================= */

  .sparkline-reference {
    stroke: color-mix(in oklch, var(--color-base-content) 40%, transparent);
    stroke-width: 1;
    stroke-dasharray: 4 2;
  }

  /* =============================================
     Color Variants
     ============================================= */

  .sparkline.color-success .sparkline-line,
  .sparkline.color-success .sparkline-dot,
  .sparkline.color-success .sparkline-bar {
    stroke: var(--color-success);
    fill: var(--color-success);
  }
  .sparkline.color-success .sparkline-line { fill: none; }

  .sparkline.color-error .sparkline-line,
  .sparkline.color-error .sparkline-dot,
  .sparkline.color-error .sparkline-bar {
    stroke: var(--color-error);
    fill: var(--color-error);
  }
  .sparkline.color-error .sparkline-line { fill: none; }

  .sparkline.color-warning .sparkline-line,
  .sparkline.color-warning .sparkline-dot,
  .sparkline.color-warning .sparkline-bar {
    stroke: var(--color-warning);
    fill: var(--color-warning);
  }
  .sparkline.color-warning .sparkline-line { fill: none; }

  .sparkline.color-info .sparkline-line,
  .sparkline.color-info .sparkline-dot,
  .sparkline.color-info .sparkline-bar {
    stroke: var(--color-info);
    fill: var(--color-info);
  }
  .sparkline.color-info .sparkline-line { fill: none; }

  /* =============================================
     Value Display
     ============================================= */

  .sparkline-value {
    @apply text-sm font-semibold;
    color: var(--color-base-content);
    font-variant-numeric: tabular-nums;
  }

  .sparkline-change {
    @apply inline-flex items-center gap-0.5 text-xs font-medium;
  }

  .sparkline-change svg {
    @apply w-3 h-3;
  }

  .sparkline-change-positive {
    color: var(--color-success);
  }

  .sparkline-change-negative {
    color: var(--color-error);
  }

  .sparkline-change-neutral {
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }

  /* =============================================
     Size Variants
     ============================================= */

  .sparkline-sm .sparkline-line { stroke-width: 1.5; }
  .sparkline-lg .sparkline-line { stroke-width: 2.5; }

  /* =============================================
     Interactive
     ============================================= */

  .sparkline-interactive {
    @apply cursor-pointer;
  }

  .sparkline-interactive:hover .sparkline-line {
    stroke-width: 2.5;
  }

  .sparkline-tooltip {
    @apply absolute text-xs whitespace-nowrap pointer-events-none;
    padding: 0.375rem 0.625rem;
    background: var(--color-neutral, #1f2937);
    border-radius: var(--radius-field, 0.25rem);
    color: white;
    transform: translate(-50%, -100%);
    margin-top: -8px;
    z-index: 50;

    &::after {
      content: '';
      @apply absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 4px solid transparent;
      border-top-color: var(--color-neutral, #1f2937);
    }
  }

  /* =============================================
     Animated
     ============================================= */

  .sparkline-animated .sparkline-line {
    stroke-dasharray: 1000;
    stroke-dashoffset: 1000;
    animation: sparkline-draw 1s ease-out forwards;
  }
}

@keyframes sparkline-draw {
  to {
    stroke-dashoffset: 0;
  }
}

/* =============================================
   Reduced Motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .sparkline-animated .sparkline-line {
    animation: none;
    stroke-dasharray: none;
    stroke-dashoffset: 0;
  }
}
