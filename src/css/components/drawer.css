/* UX v3 - Drawer (responsive sidebar/panel) */
/* Desktop: inline (content resizes) */
/* Mobile: overlay with backdrop via checkbox toggle (no JS needed) */
/* Uses generic .header, .content, .footer from structure.css */
/*
   Usage (checkbox, no JS):
   <input type="checkbox" id="drawer" class="drawer-toggle">
   <div class="page">
     <header class="header">
       <label for="drawer" class="btn btn-ghost">☰</label>
     </header>
     <aside class="drawer drawer-start">...</aside>
     <label for="drawer" class="drawer-backdrop"></label>
     <main class="content">...</main>
   </div>

   Usage (class-based, for JS frameworks):
   <aside class="drawer drawer-start drawer-open">...</aside>
   <div class="drawer-backdrop drawer-backdrop-open"></div>
*/

@layer components {

  /* =============================================
     Drawer toggle (hidden checkbox)
     ============================================= */

  .drawer-toggle {
    @apply fixed w-0 h-0 opacity-0 pointer-events-none;
  }

  /* =============================================
     Drawer base
     ============================================= */

  .drawer {
    --drawer-width: 280px;

    @apply flex flex-col shrink-0 h-full bg-base-100 overflow-hidden;
    width: var(--drawer-width);
    transition: width 350ms var(--ease-ios),
                transform 350ms var(--ease-ios);
    will-change: width, transform;

    /* Glass variant */
    &.glass {
      @apply glass;
    }
  }

  /* =============================================
     Drawer positions
     ============================================= */

  .drawer-start {
    @apply border-r border-base-300;
    order: -1;

    &.glass {
      @apply border-r-glass-border;
    }
  }

  .drawer-end {
    @apply border-l border-base-300;
    order: 99;

    &.glass {
      @apply border-l-glass-border;
    }
  }

  .drawer-top {
    --drawer-width: auto;
    --drawer-height: 240px;

    @apply w-full shrink-0 border-b border-base-300;
    height: var(--drawer-height);
    transition: height 350ms var(--ease-ios),
                transform 350ms var(--ease-ios);
    will-change: height, transform;
  }

  .drawer-bottom {
    --drawer-width: auto;
    --drawer-height: 240px;

    @apply w-full shrink-0 border-t border-base-300;
    height: var(--drawer-height);
    transition: height 350ms var(--ease-ios),
                transform 350ms var(--ease-ios);
    will-change: height, transform;
  }

  /* =============================================
     Drawer title (utility class)
     ============================================= */

  .drawer-title {
    @apply text-[0.9375rem] font-semibold text-base-content m-0 whitespace-nowrap overflow-hidden;
    text-overflow: ellipsis;
  }

  /* =============================================
     Drawer collapsed state (desktop)
     ============================================= */

  .drawer-collapsed {
    @apply w-0 border-0 overflow-hidden;
  }

  .drawer-collapsed.drawer-top,
  .drawer-collapsed.drawer-bottom {
    @apply h-0 w-full;
  }

  /* =============================================
     Drawer size variants
     ============================================= */

  .drawer-sm { --drawer-width: 220px; }
  .drawer-lg { --drawer-width: 360px; }
  .drawer-xl { --drawer-width: 480px; }

  /* =============================================
     Drawer backdrop
     ============================================= */

  .drawer-backdrop {
    @apply hidden absolute inset-0 z-400 opacity-0 invisible cursor-pointer;
    background-color: rgba(0, 0, 0, 0.4);
    transition: opacity 300ms var(--ease-ios),
                visibility 300ms var(--ease-ios);
    -webkit-tap-highlight-color: transparent;
  }

  /* Class-based open (for JS frameworks) */
  .drawer-backdrop-open {
    @apply opacity-100 visible;
  }
}

/* =============================================
   Desktop: checkbox toggle collapses drawer
   ============================================= */

@media (min-width: 992px) {
  .drawer-toggle:not(:checked) ~ .page .drawer,
  .drawer-toggle:not(:checked) ~ .app .page .drawer {
    @apply w-0 border-0 overflow-hidden;
  }

  .drawer-toggle:not(:checked) ~ .page .drawer.drawer-top,
  .drawer-toggle:not(:checked) ~ .page .drawer.drawer-bottom,
  .drawer-toggle:not(:checked) ~ .app .page .drawer.drawer-top,
  .drawer-toggle:not(:checked) ~ .app .page .drawer.drawer-bottom {
    @apply h-0 w-full;
  }
}

/* =============================================
   Mobile: drawer becomes overlay
   ============================================= */

@media (max-width: 991px) {
  .drawer.drawer-start,
  .drawer.drawer-end {
    @apply absolute top-0 bottom-0 z-500;
    width: var(--drawer-width);
    max-width: calc(100% - 3rem);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    grid-column: auto;
    grid-row: auto;
  }

  .drawer.drawer-start {
    @apply left-0;
    transform: translateX(-100%);
  }

  .drawer.drawer-end {
    @apply right-0 left-auto;
    transform: translateX(100%);
  }

  .drawer.drawer-top {
    @apply absolute top-0 left-0 right-0 z-500;
    height: var(--drawer-height);
    max-height: 70%;
    transform: translateY(-100%);
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    grid-column: auto;
    grid-row: auto;
  }

  .drawer.drawer-bottom {
    @apply absolute bottom-0 left-0 right-0 z-500;
    height: var(--drawer-height);
    max-height: 70%;
    transform: translateY(100%);
    box-shadow: 0 -10px 50px -12px rgba(0, 0, 0, 0.25);
    grid-column: auto;
    grid-row: auto;
  }

  /* Open state — class-based (JS frameworks) */
  .drawer-open.drawer-start { transform: translateX(0); }
  .drawer-open.drawer-end { transform: translateX(0); }
  .drawer-open.drawer-top { transform: translateY(0); }
  .drawer-open.drawer-bottom { transform: translateY(0); }

  /* Open state — checkbox toggle (no JS) */
  .drawer-toggle:checked ~ .page .drawer.drawer-start,
  .drawer-toggle:checked ~ .page .drawer-start,
  .drawer-toggle:checked ~ .app .page .drawer.drawer-start,
  .drawer-toggle:checked ~ .app .page .drawer-start {
    transform: translateX(0);
  }

  .drawer-toggle:checked ~ .page .drawer.drawer-end,
  .drawer-toggle:checked ~ .page .drawer-end,
  .drawer-toggle:checked ~ .app .page .drawer.drawer-end,
  .drawer-toggle:checked ~ .app .page .drawer-end {
    transform: translateX(0);
  }

  .drawer-toggle:checked ~ .page .drawer.drawer-top,
  .drawer-toggle:checked ~ .page .drawer-top,
  .drawer-toggle:checked ~ .app .page .drawer.drawer-top,
  .drawer-toggle:checked ~ .app .page .drawer-top {
    transform: translateY(0);
  }

  .drawer-toggle:checked ~ .page .drawer.drawer-bottom,
  .drawer-toggle:checked ~ .page .drawer-bottom,
  .drawer-toggle:checked ~ .app .page .drawer.drawer-bottom,
  .drawer-toggle:checked ~ .app .page .drawer-bottom {
    transform: translateY(0);
  }

  /* Backdrop open via checkbox */
  .drawer-toggle:checked ~ .page .drawer-backdrop,
  .drawer-toggle:checked ~ .app .page .drawer-backdrop {
    @apply opacity-100 visible;
  }

  /* Collapsed is same as closed on mobile */
  .drawer-collapsed.drawer-start { transform: translateX(-100%); }
  .drawer-collapsed.drawer-end   { transform: translateX(100%); }
  .drawer-collapsed.drawer-top   { transform: translateY(-100%); }
  .drawer-collapsed.drawer-bottom { transform: translateY(100%); }

  /* Backdrop visible on mobile */
  .drawer-backdrop {
    @apply block;
  }
}

/* =============================================
   Reduced motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .drawer,
  .drawer-backdrop {
    transition: none;
  }
}
