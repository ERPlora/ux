/* Batch Tracker Component */
/* Manufacturing batch tracking card with timeline, quantity bars, status, QR code */

@layer components {

  /* =============================================
     Batch Card
     ============================================= */

  .batch-card {
    @apply flex flex-col;
    background-color: var(--color-base-100);
    border: 1px solid var(--color-base-300);
    border-radius: var(--radius-box, 0.75rem);
    padding: 1.5rem;
  }

  .batch-card-header {
    @apply flex items-start justify-between gap-4;
    margin-bottom: 1.5rem;
  }

  .batch-card-title-group {
    @apply flex-1 min-w-0;
  }

  .batch-card-batch-number {
    @apply text-xl font-bold m-0 font-mono;
    color: var(--color-base-content);
    margin-bottom: 0.25rem;
    letter-spacing: 0.5px;
  }

  .batch-card-product-name {
    @apply text-sm m-0;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }

  .batch-card-qr {
    @apply flex items-center justify-center shrink-0;
    width: 64px;
    height: 64px;
    background-color: var(--color-base-200);
    border-radius: var(--radius-field, 0.25rem);
    padding: 0.25rem;

    svg, img { @apply w-full h-full; }
  }

  .batch-card-body {
    @apply flex flex-col;
    gap: 1rem;
  }

  .batch-card-footer {
    @apply flex items-center justify-between gap-4;
    margin-top: 1.5rem;
    padding-top: 1rem;
    border-top: 1px solid var(--color-base-300);
  }

  .batch-card.glass {
    border-color: color-mix(in oklch, var(--color-base-content) 10%, transparent);
  }

  /* =============================================
     Batch Status Badge
     ============================================= */

  .batch-status {
    @apply inline-flex items-center gap-1 text-xs font-semibold uppercase rounded-full;
    padding: 0.25rem 0.5rem;
    letter-spacing: 0.5px;
  }

  .batch-status-dot {
    @apply rounded-full;
    width: 8px;
    height: 8px;
    animation: batch-pulse 2s infinite;
  }

  .batch-status-created {
    background-color: color-mix(in oklch, var(--color-base-content) 10%, transparent);
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);

    .batch-status-dot {
      background-color: color-mix(in oklch, var(--color-base-content) 50%, transparent);
      animation: none;
    }
  }

  .batch-status-in-progress {
    background-color: color-mix(in oklch, var(--color-primary) 15%, transparent);
    color: var(--color-primary);

    .batch-status-dot { background-color: var(--color-primary); }
  }

  .batch-status-qc {
    background-color: color-mix(in oklch, var(--color-warning) 15%, transparent);
    color: var(--color-warning);

    .batch-status-dot { background-color: var(--color-warning); }
  }

  .batch-status-completed {
    background-color: color-mix(in oklch, var(--color-success) 15%, transparent);
    color: var(--color-success);

    .batch-status-dot {
      background-color: var(--color-success);
      animation: none;
    }
  }

  .batch-status-shipped {
    background-color: color-mix(in oklch, var(--color-info, #06b6d4) 15%, transparent);
    color: var(--color-info, #0891b2);

    .batch-status-dot {
      background-color: var(--color-info, #06b6d4);
      animation: none;
    }
  }

  .batch-status-rejected {
    background-color: color-mix(in oklch, var(--color-error) 15%, transparent);
    color: var(--color-error);

    .batch-status-dot {
      background-color: var(--color-error);
      animation: none;
    }
  }

  .batch-status-quarantine {
    background-color: color-mix(in oklch, var(--color-accent, #8b5cf6) 15%, transparent);
    color: var(--color-accent, #7c3aed);

    .batch-status-dot { background-color: var(--color-accent, #8b5cf6); }
  }

  /* =============================================
     Batch Info Grid
     ============================================= */

  .batch-info {
    @apply grid gap-4;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  }

  .batch-info-item {
    @apply flex flex-col;
    gap: 2px;
  }

  .batch-info-label {
    @apply text-xs uppercase;
    color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
    letter-spacing: 0.5px;
  }

  .batch-info-value {
    @apply text-base font-medium;
    color: var(--color-base-content);
  }

  .batch-info-value-mono { @apply font-mono; }
  .batch-info-value-danger { color: var(--color-error); }
  .batch-info-value-warning { color: var(--color-warning); }
  .batch-info-value-success { color: var(--color-success); }

  /* =============================================
     Batch Quantity
     ============================================= */

  .batch-quantity {
    @apply flex flex-col gap-2;
  }

  .batch-quantity-header {
    @apply flex items-center justify-between;
  }

  .batch-quantity-title {
    @apply text-sm font-semibold;
    color: var(--color-base-content);
  }

  .batch-quantity-values {
    @apply flex text-sm;
    gap: 1.5rem;
  }

  .batch-quantity-stat {
    @apply flex flex-col items-center;
    gap: 2px;
  }

  .batch-quantity-stat-value {
    @apply text-lg font-bold font-mono;
  }

  .batch-quantity-stat-value-initial { color: var(--color-base-content); }
  .batch-quantity-stat-value-current { color: var(--color-primary); }
  .batch-quantity-stat-value-rejected { color: var(--color-error); }
  .batch-quantity-stat-value-yield { color: var(--color-success); }

  .batch-quantity-stat-label {
    @apply text-xs;
    color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
  }

  .batch-quantity-bar {
    @apply flex overflow-hidden;
    height: 8px;
    background-color: var(--color-base-200);
    border-radius: 9999px;
  }

  .batch-quantity-bar-segment {
    @apply h-full;
    transition: width 0.2s ease;
  }

  .batch-quantity-bar-segment-good { background-color: var(--color-success); }
  .batch-quantity-bar-segment-rejected { background-color: var(--color-error); }
  .batch-quantity-bar-segment-remaining { background-color: var(--color-base-300); }

  /* =============================================
     Batch Timeline
     ============================================= */

  .batch-timeline {
    @apply relative;
    padding-left: calc(24px / 2 + 1.5rem);

    &::before {
      content: '';
      @apply absolute;
      left: calc(24px / 2 - 1px);
      top: 24px;
      bottom: 24px;
      width: 2px;
      background-color: var(--color-base-300);
    }
  }

  .batch-timeline-item {
    @apply relative;
    padding-bottom: 1.5rem;

    &:last-child { padding-bottom: 0; }
  }

  .batch-timeline-item-completed .batch-timeline-marker {
    background-color: var(--color-success);
    border-color: var(--color-success);

    svg { color: white; }
  }

  .batch-timeline-item-active .batch-timeline-marker {
    background-color: var(--color-primary);
    border-color: var(--color-primary);
    box-shadow: 0 0 0 4px color-mix(in oklch, var(--color-primary) 20%, transparent);

    svg { color: white; }
  }

  .batch-timeline-item-error .batch-timeline-marker {
    background-color: var(--color-error);
    border-color: var(--color-error);

    svg { color: white; }
  }

  .batch-timeline-item-pending .batch-timeline-title {
    color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
  }

  .batch-timeline-marker {
    @apply absolute flex items-center justify-center;
    left: calc(-1 * 24px / 2 - 1.5rem);
    top: 0;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background-color: var(--color-base-100);
    border: 2px solid var(--color-base-300);
    z-index: 1;

    svg {
      @apply w-3.5 h-3.5;
      color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
    }
  }

  .batch-timeline-content {
    @apply flex flex-col;
    gap: 2px;
  }

  .batch-timeline-title {
    @apply text-sm font-semibold m-0;
    color: var(--color-base-content);
  }

  .batch-timeline-time {
    @apply text-xs;
    color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
  }

  .batch-timeline-description {
    @apply text-xs;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
    margin-top: 0.25rem;
  }

  /* =============================================
     Batch List
     ============================================= */

  .batch-list {
    @apply flex flex-col gap-2;
  }

  .batch-list-item {
    @apply flex items-center gap-4 cursor-pointer;
    padding: 1rem;
    background-color: var(--color-base-100);
    border: 1px solid var(--color-base-300);
    border-radius: var(--radius-field, 0.25rem);
    transition: all 0.15s ease;

    &:hover {
      border-color: var(--color-primary);
      box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
  }

  .batch-list-item-main {
    @apply flex-1 min-w-0;
  }

  .batch-list-item-batch {
    @apply text-base font-semibold font-mono;
    color: var(--color-base-content);
  }

  .batch-list-item-product {
    @apply text-sm;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }

  .batch-list-item-meta {
    @apply flex flex-col items-end;
    gap: 2px;
  }

  .batch-list-item-qty {
    @apply text-sm font-medium;
    color: var(--color-base-content);
  }

  .batch-list-item-date {
    @apply text-xs;
    color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
  }
}

/* =============================================
   Animations
   ============================================= */

@keyframes batch-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* =============================================
   Responsive
   ============================================= */

@media (max-width: 767px) {
  .batch-card-header {
    @apply flex-col items-stretch;
  }

  .batch-card-qr {
    @apply self-center order-first;
    margin-bottom: 0.5rem;
  }

  .batch-info { grid-template-columns: repeat(2, 1fr); }

  .batch-quantity-values {
    @apply flex-wrap justify-center;
  }
}

/* =============================================
   Reduced Motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .batch-status-dot { animation: none; }
  .batch-quantity-bar-segment { transition: none; }
  .batch-list-item { transition: none; }
}
