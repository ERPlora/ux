/* UX v3 - Stepper Component */
/* Multi-step form indicator with horizontal/vertical/compact/dots variants */

@layer components {

  /* =============================================
     Stepper container
     ============================================= */

  .stepper {
    @apply flex flex-col w-full;
  }

  /* =============================================
     Stepper Header (Steps Indicator)
     ============================================= */

  .stepper-header {
    @apply flex items-start justify-between relative;
    margin-bottom: 2rem;

    /* Progress line behind steps */
    &::before {
      content: '';
      @apply absolute top-0 bottom-auto;
      top: 20px;
      left: 40px;
      right: 40px;
      height: 2px;
      background-color: var(--color-base-300);
      z-index: 0;
    }
  }

  /* =============================================
     Step Item
     ============================================= */

  .stepper-step {
    @apply flex flex-col items-center relative cursor-pointer;
    z-index: 1;
    flex: 1;

    &:hover .stepper-circle {
      border-color: var(--color-primary);
      transform: scale(1.05);
    }
  }

  .stepper-step-disabled {
    @apply cursor-not-allowed pointer-events-none;

    & .stepper-circle,
    & .stepper-label {
      @apply opacity-50;
    }
  }

  /* Active Step */
  .stepper-step-active {
    & .stepper-circle {
      background-color: var(--color-primary);
      border-color: var(--color-primary);
      color: var(--color-primary-content);
    }

    & .stepper-label {
      color: var(--color-primary);
    }
  }

  /* Completed Step */
  .stepper-step-completed {
    & .stepper-circle {
      background-color: var(--color-success);
      border-color: var(--color-success);
      color: var(--color-success-content);
    }

    & .stepper-label {
      color: var(--color-success);
    }
  }

  /* Error Step */
  .stepper-step-error {
    & .stepper-circle {
      background-color: var(--color-error);
      border-color: var(--color-error);
      color: var(--color-error-content);
    }

    & .stepper-label {
      color: var(--color-error);
    }
  }

  /* =============================================
     Step Circle
     ============================================= */

  .stepper-circle {
    @apply flex items-center justify-center rounded-full font-semibold;
    width: 40px;
    height: 40px;
    font-size: 1rem;
    background-color: var(--color-base-100);
    border: 2px solid var(--color-base-300);
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
    transition: background-color 0.15s, border-color 0.15s, color 0.15s, transform 0.15s;

    & > svg {
      @apply size-5;
    }
  }

  /* =============================================
     Step Labels
     ============================================= */

  .stepper-label {
    @apply text-sm font-medium text-center;
    margin-top: 0.5rem;
    max-width: 100px;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
    transition: color 0.15s;
  }

  .stepper-description {
    @apply text-xs text-center;
    color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
    max-width: 120px;
    margin-top: 0.25rem;
  }

  /* =============================================
     Progress Line (Completed Portion)
     ============================================= */

  .stepper-progress {
    @apply absolute;
    top: 20px;
    left: 40px;
    height: 2px;
    max-width: calc(100% - 80px);
    background-color: var(--color-success);
    z-index: 0;
    transition: width 0.3s;
  }

  /* =============================================
     Stepper Content
     ============================================= */

  .stepper-content {
    @apply flex-1;
    min-height: 200px;
  }

  .stepper-panel {
    @apply hidden;

    &.stepper-panel-active {
      @apply block;
    }
  }

  /* =============================================
     Stepper Actions
     ============================================= */

  .stepper-actions {
    @apply flex justify-between items-center;
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: var(--border) solid var(--color-base-200);
    gap: 1rem;
  }

  .stepper-actions-start,
  .stepper-actions-end {
    @apply flex;
    gap: 0.5rem;
  }

  /* =============================================
     Vertical Stepper
     ============================================= */

  .stepper-vertical {
    @apply flex-row;

    & .stepper-header {
      @apply flex-col items-start;
      margin-bottom: 0;
      margin-right: 2rem;
      min-width: 200px;

      &::before {
        top: 40px;
        bottom: 40px;
        left: 19px;
        right: auto;
        width: 2px;
        height: auto;
      }
    }

    & .stepper-progress {
      top: 40px;
      left: 19px;
      width: 2px;
      height: 0;
    }

    & .stepper-step {
      @apply flex-row items-center;
      margin-bottom: 2rem;

      &:last-child {
        margin-bottom: 0;
      }
    }

    & .stepper-label {
      @apply text-left;
      margin-top: 0;
      margin-left: 1rem;
      max-width: none;
    }

    & .stepper-description {
      @apply text-left;
      margin-left: 1rem;
      max-width: none;
    }

    & .stepper-content {
      @apply flex-1;
      border-left: var(--border) solid var(--color-base-200);
      padding-left: 2rem;
    }
  }

  /* =============================================
     Compact Stepper
     ============================================= */

  .stepper-compact {
    & .stepper-circle {
      width: 32px;
      height: 32px;
      @apply text-sm;
    }

    & .stepper-header::before {
      top: 16px;
    }

    & .stepper-progress {
      top: 16px;
    }

    & .stepper-label {
      @apply text-xs;
    }
  }

  /* =============================================
     Dot Stepper (Minimal)
     ============================================= */

  .stepper-dots {
    & .stepper-circle {
      width: 12px;
      height: 12px;
      @apply p-0;

      & > span {
        @apply hidden;
      }

      & > svg {
        @apply hidden;
      }
    }

    & .stepper-header::before {
      top: 6px;
    }

    & .stepper-progress {
      top: 6px;
    }
  }

  /* =============================================
     Progress Bar Variant
     ============================================= */

  .stepper-progress-bar {
    & .stepper-header {
      @apply flex-col;
      gap: 0.5rem;

      &::before {
        @apply hidden;
      }
    }

    & .stepper-progress-track {
      @apply w-full overflow-hidden;
      height: 4px;
      background-color: var(--color-base-300);
      border-radius: 2px;
    }

    & .stepper-progress-fill {
      @apply h-full;
      background-color: var(--color-primary);
      border-radius: 2px;
      transition: width 0.3s;
    }

    & .stepper-steps-row {
      @apply flex justify-between;
    }

    & .stepper-step {
      flex: none;
    }

    & .stepper-circle {
      @apply hidden;
    }
  }

  /* =============================================
     Glass
     ============================================= */

  .stepper.glass .stepper-content {
    @apply glass;
  }
}

/* =============================================
   Animation
   ============================================= */

@keyframes stepper-fade-in {
  from {
    opacity: 0;
    transform: translateX(10px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

.stepper-panel-active {
  animation: stepper-fade-in 0.3s ease;
}

/* =============================================
   Responsive
   ============================================= */

@media (max-width: 767px) {
  .stepper-header {
    @apply overflow-x-auto;
    -webkit-overflow-scrolling: touch;
    padding-bottom: 0.5rem;
  }

  .stepper-label {
    @apply hidden;
  }

  .stepper-step-active .stepper-label {
    @apply block;
  }

  .stepper-vertical {
    @apply flex-col;

    & .stepper-header {
      @apply flex-row;
      margin-right: 0;
      margin-bottom: 2rem;
      min-width: auto;
    }

    & .stepper-content {
      @apply border-l-0 pl-0;
    }
  }
}

/* =============================================
   Reduced Motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .stepper-circle,
  .stepper-progress {
    transition: none;
  }

  .stepper-panel-active {
    animation: none;
  }
}
