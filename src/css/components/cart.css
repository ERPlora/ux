/* UX v3 - Cart Component */
/* Shopping cart with header, item list, quantity controls, summary, actions */

@layer components {

  /* =============================================
     Container
     ============================================= */

  .cart {
    @apply flex flex-col h-full overflow-hidden;
    background-color: var(--color-base-100);
    border-radius: var(--radius-box, 0.75rem);
  }

  .cart-bordered {
    border: 1px solid var(--color-base-300);
  }

  .cart-mini {
    max-height: 400px;
    width: 320px;

    .cart-items { max-height: 240px; }
  }

  /* =============================================
     Header
     ============================================= */

  .cart-header {
    @apply flex items-center justify-between shrink-0;
    padding: 1rem 1.5rem;
    background-color: var(--color-base-100);
    border-bottom: 1px solid var(--color-base-300);
  }

  .cart-title {
    @apply flex items-center gap-2 text-lg font-semibold m-0;
    color: var(--color-base-content);
  }

  .cart-count {
    @apply inline-flex items-center justify-center text-sm font-semibold;
    min-width: 24px;
    height: 24px;
    padding: 0 0.25rem;
    background-color: var(--color-primary);
    color: var(--color-primary-content, white);
    border-radius: 12px;
  }

  .cart-clear {
    @apply flex items-center gap-1 text-sm bg-transparent border-none cursor-pointer;
    padding: 0.25rem 0.5rem;
    border-radius: var(--radius-field, 0.25rem);
    color: var(--color-error);
    transition: background-color 0.15s ease;

    &:hover {
      background-color: color-mix(in oklch, var(--color-error) 10%, transparent);
    }

    svg { @apply w-4 h-4; }
  }

  /* =============================================
     Items List
     ============================================= */

  .cart-items {
    @apply flex-1 overflow-y-auto overflow-x-hidden;
    -webkit-overflow-scrolling: touch;
  }

  .cart-items-list {
    @apply list-none m-0 p-0;
  }

  /* =============================================
     Cart Item
     ============================================= */

  .cart-item {
    @apply flex items-start gap-4;
    padding: 1rem;
    border-bottom: 1px solid var(--color-base-300);
    background-color: var(--color-base-100);
    transition: background-color 0.15s ease;

    &:last-child { border-bottom: none; }
    &:hover { background-color: var(--color-base-200); }
  }

  .cart-item-compact {
    padding: 0.5rem 1rem;
    @apply gap-2;

    .cart-item-image,
    .cart-item-image-placeholder { width: 40px; height: 40px; }
    .cart-item-name { @apply text-xs; -webkit-line-clamp: 1; }
  }

  /* Item image */
  .cart-item-image {
    @apply shrink-0 object-cover;
    width: 56px;
    height: 56px;
    border-radius: var(--radius-field, 0.25rem);
    background-color: var(--color-base-200);
  }

  .cart-item-image-placeholder {
    @apply flex items-center justify-center shrink-0;
    width: 56px;
    height: 56px;
    border-radius: var(--radius-field, 0.25rem);
    background-color: var(--color-base-200);
    color: color-mix(in oklch, var(--color-base-content) 40%, transparent);

    svg { @apply w-6 h-6; }
  }

  /* Item content */
  .cart-item-content {
    @apply flex-1 min-w-0;
  }

  .cart-item-name {
    @apply text-sm font-medium m-0 overflow-hidden;
    color: var(--color-base-content);
    line-height: 1.3;
    margin-bottom: 0.25rem;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  .cart-item-meta {
    @apply text-xs;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
    margin-bottom: 0.25rem;
  }

  .cart-item-unit-price {
    @apply text-xs;
    color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
  }

  /* Item price */
  .cart-item-price {
    @apply font-semibold text-right whitespace-nowrap;
    color: var(--color-base-content);
    font-variant-numeric: tabular-nums;
  }

  /* Quantity controls */
  .cart-item-qty {
    @apply flex items-center gap-1;
    margin-top: 0.25rem;
  }

  .cart-item-qty-btn {
    @apply flex items-center justify-center cursor-pointer p-0;
    width: 28px;
    height: 28px;
    background-color: var(--color-base-200);
    border: 1px solid var(--color-base-300);
    border-radius: var(--radius-field, 0.25rem);
    color: var(--color-base-content);
    transition: background-color 0.15s ease, border-color 0.15s ease;

    &:hover { background-color: var(--color-base-300); border-color: var(--color-primary); }
    &:active { transform: scale(0.95); }
    &:disabled { @apply opacity-40 cursor-not-allowed; }

    svg { @apply w-3.5 h-3.5; }
  }

  .cart-item-qty-value {
    @apply text-sm font-medium text-center;
    min-width: 32px;
    color: var(--color-base-content);
  }

  /* Remove button */
  .cart-item-remove {
    @apply flex items-center justify-center bg-transparent border-none cursor-pointer ml-auto p-0;
    width: 28px;
    height: 28px;
    border-radius: var(--radius-field, 0.25rem);
    color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
    transition: background-color 0.15s ease, color 0.15s ease;

    &:hover {
      background-color: color-mix(in oklch, var(--color-error) 10%, transparent);
      color: var(--color-error);
    }

    svg { @apply w-4 h-4; }
  }

  /* =============================================
     Empty State
     ============================================= */

  .cart-empty {
    @apply flex flex-col items-center justify-center text-center flex-1;
    padding: 2.5rem;
  }

  .cart-empty-icon {
    @apply w-16 h-16 mb-4;
    color: color-mix(in oklch, var(--color-base-content) 40%, transparent);
  }

  .cart-empty-title {
    @apply text-lg font-semibold m-0 mb-1;
    color: var(--color-base-content);
  }

  .cart-empty-text {
    @apply text-sm m-0;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }

  /* =============================================
     Summary
     ============================================= */

  .cart-summary {
    @apply shrink-0;
    padding: 1rem 1.5rem;
    background-color: var(--color-base-200);
    border-top: 1px solid var(--color-base-300);
  }

  .cart-summary-row {
    @apply flex justify-between items-center mb-2;

    &:last-child { @apply mb-0; }
  }

  .cart-summary-row-subtotal {
    padding-top: 0.5rem;
    border-top: 1px dashed var(--color-base-300);
  }

  .cart-summary-row-total {
    padding-top: 1rem;
    margin-top: 0.5rem;
    border-top: 2px solid var(--color-base-300);

    .cart-summary-label { @apply font-semibold; color: var(--color-base-content); }
    .cart-summary-value { @apply text-xl font-bold; color: var(--color-primary); }
  }

  .cart-summary-row-discount .cart-summary-value { color: var(--color-success); }

  .cart-summary-label {
    @apply text-sm;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }

  .cart-summary-value {
    @apply text-sm;
    color: var(--color-base-content);
    font-variant-numeric: tabular-nums;
  }

  /* =============================================
     Actions
     ============================================= */

  .cart-actions {
    @apply flex flex-col gap-2 shrink-0;
    padding: 1rem 1.5rem;
    background-color: var(--color-base-100);
    border-top: 1px solid var(--color-base-300);
  }

  .cart-actions-row {
    @apply flex-row;

    > * { @apply flex-1; }
  }

  /* =============================================
     Glass
     ============================================= */

  .cart.glass {
    @apply glass;

    .cart-header,
    .cart-item,
    .cart-summary,
    .cart-actions {
      @apply bg-transparent;
      border-color: color-mix(in oklch, var(--color-base-content) 10%, transparent);
    }

    .cart-summary {
      background-color: color-mix(in oklch, var(--color-base-100) 50%, transparent);
    }
  }
}

/* =============================================
   Responsive
   ============================================= */

@media (max-width: 767px) {
  .cart-header { padding: 0.5rem 1rem; }
  .cart-item { padding: 0.5rem 1rem; }
  .cart-summary,
  .cart-actions { padding: 0.5rem 1rem; }
}

/* =============================================
   Reduced Motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .cart-item,
  .cart-clear,
  .cart-item-qty-btn,
  .cart-item-remove {
    transition: none;
  }
}
