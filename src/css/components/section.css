/* UX v3 - Section Component */
/* Content sections for organizing page content with header, description, and actions. */

@layer components {

  /* =============================================
     Base section
     ============================================= */

  .section {
    --section-padding: 1.5rem;
    --section-gap: 0.5rem;
    --section-margin-y: 1.5rem;

    @apply flex flex-col w-full;
    margin: var(--section-margin-y) 0;

    &:first-child {
      @apply mt-0;
    }

    &:last-child {
      @apply mb-0;
    }
  }

  /* =============================================
     Header
     ============================================= */

  .section-header {
    @apply flex items-start justify-between;
    gap: 1rem;
    padding: var(--section-padding);
    padding-bottom: 0.5rem;
  }

  .section-header-content {
    @apply flex flex-col flex-1 min-w-0;
    gap: var(--section-gap);
  }

  .section-title {
    @apply m-0 text-lg font-semibold leading-tight;
  }

  .section-description {
    @apply m-0 text-sm leading-relaxed;
    color: var(--color-base-content);
    opacity: 0.6;
  }

  .section-actions {
    @apply flex items-center gap-2 shrink-0;
  }

  /* =============================================
     Content
     ============================================= */

  .section-content {
    padding: var(--section-padding);
    padding-top: 0;

    /* When no header, add top padding */
    &:first-child {
      padding-top: var(--section-padding);
    }
  }

  /* =============================================
     Bordered variant
     ============================================= */

  .section-bordered {
    border: 1px solid var(--color-base-300);
    border-radius: var(--radius-box);
    background-color: var(--color-base-100);

    & .section-header {
      border-bottom: 1px solid var(--color-base-300);
      padding-bottom: var(--section-padding);
    }

    & .section-content {
      padding-top: var(--section-padding);
    }
  }

  /* =============================================
     Card variant (shadow)
     ============================================= */

  .section-card {
    background-color: var(--color-base-100);
    border-radius: var(--radius-box);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06), 0 1px 2px rgba(0, 0, 0, 0.04);

    & .section-header {
      border-bottom: 1px solid var(--color-base-300);
      padding-bottom: var(--section-padding);
    }

    & .section-content {
      padding-top: var(--section-padding);
    }
  }

  /* =============================================
     Inset variant (iOS grouped style)
     ============================================= */

  .section-inset {
    margin-left: 1.5rem;
    margin-right: 1.5rem;
  }

  /* =============================================
     Compact variant
     ============================================= */

  .section-compact {
    --section-padding: 1rem;
    --section-gap: 0.25rem;
    --section-margin-y: 1rem;

    & .section-title {
      @apply text-base;
    }

    & .section-description {
      @apply text-xs;
    }
  }

  /* =============================================
     Collapsible variant
     ============================================= */

  .section-collapsible .section-header {
    @apply cursor-pointer select-none;
    -webkit-tap-highlight-color: transparent;
    transition: background-color 0.15s ease;

    &:hover {
      background-color: var(--color-base-200);
    }

    &:active {
      background-color: var(--color-base-300);
    }
  }

  .section-collapsible .section-body {
    @apply grid;
    grid-template-rows: 0fr;
    transition: grid-template-rows 0.2s ease;
  }

  .section-collapsible.section-expanded .section-body {
    grid-template-rows: 1fr;
  }

  .section-body-inner {
    @apply overflow-hidden;
  }

  .section-chevron {
    @apply size-5 shrink-0 ml-auto;
    color: var(--color-base-content);
    opacity: 0.3;
    transition: transform 0.2s ease;

    & svg {
      @apply w-full h-full;
    }
  }

  .section-expanded .section-chevron {
    transform: rotate(180deg);
  }

  /* =============================================
     Sizes
     ============================================= */

  .section-sm .section-header,
  .section-sm .section-content {
    padding: 1rem;
  }

  .section-sm .section-header {
    padding-bottom: 0.25rem;
  }

  .section-sm .section-title {
    @apply text-base;
  }

  .section-sm .section-description {
    @apply text-xs;
  }

  .section-lg .section-header,
  .section-lg .section-content {
    padding: 2rem;
  }

  .section-lg .section-header {
    padding-bottom: 1rem;
  }

  .section-lg .section-title {
    @apply text-xl;
  }

  /* =============================================
     Divider variant (border between sections)
     ============================================= */

  .section-divider {
    border-bottom: 1px solid var(--color-base-300);
    padding-bottom: var(--section-margin-y);

    &:last-child {
      @apply border-b-0 pb-0;
    }
  }

  /* =============================================
     Header-only variant (iOS list group header)
     ============================================= */

  .section-header-only .section-header {
    padding-bottom: 0.5rem;
  }

  .section-header-only .section-title {
    @apply text-sm font-medium uppercase tracking-wider;
    color: var(--color-base-content);
    opacity: 0.6;
  }

  /* =============================================
     States
     ============================================= */

  .section-disabled {
    @apply opacity-50 pointer-events-none;
  }

  /* =============================================
     Glass variant
     ============================================= */

  .section.glass {
    @apply glass overflow-hidden;
    border-radius: var(--radius-box);

    & .section-header {
      border-bottom: 0.5px solid var(--color-glass-border);
      padding-bottom: var(--section-padding);
    }

    & .section-content {
      padding-top: var(--section-padding);
    }

    &.section-collapsible .section-header:hover {
      background-color: rgba(255, 255, 255, 0.15);
    }
  }
}

/* =============================================
   Responsive
   ============================================= */

@media (max-width: 767px) {
  .section-inset {
    margin-left: 1rem;
    margin-right: 1rem;
  }

  .section-header {
    @apply flex-wrap;
  }

  .section-actions {
    @apply w-full justify-end mt-2;
  }

  /* Keep inline when single action */
  .section-header:has(.section-actions > :only-child) {
    @apply flex-nowrap;
  }

  .section-header:has(.section-actions > :only-child) .section-actions {
    @apply w-auto mt-0;
  }
}

/* =============================================
   Reduced motion
   ============================================= */

@media (prefers-reduced-motion: reduce) {
  .section-chevron,
  .section-collapsible .section-body,
  .section-collapsible .section-header {
    transition: none;
  }
}
