/* Form â€” form group with label, validation, helper text, addons, sections */

@layer components {

  /* ---- Form Group ---- */
  .form-group {
    @apply flex flex-col gap-1 mb-4;
  }
  .form-group:last-child {
    @apply mb-0;
  }

  /* ---- Label ---- */
  .form-group-label {
    @apply text-sm font-medium leading-snug flex items-center gap-1;
    color: color-mix(in oklch, var(--color-base-content) 60%, transparent);
  }
  .form-group-label-required::after {
    content: '*';
    @apply font-semibold;
    color: var(--color-error);
  }
  .form-group-optional {
    @apply text-xs font-normal text-base-content/40 ml-auto;
  }

  /* ---- Control ---- */
  .form-group-control {
    @apply relative flex flex-col gap-1;
  }
  .form-group-input-wrapper {
    @apply relative flex items-center;
  }
  .form-group-input-wrapper .input,
  .form-group-input-wrapper .textarea,
  .form-group-input-wrapper .select,
  .form-group-input-wrapper input,
  .form-group-input-wrapper textarea,
  .form-group-input-wrapper select {
    @apply w-full;
  }

  /* ---- Icon (validation) ---- */
  .form-group-icon {
    @apply absolute right-3 top-1/2 -translate-y-1/2 size-4 pointer-events-none opacity-0;
    transition: opacity 0.15s ease;
  }
  .form-group-icon svg {
    @apply size-full;
  }

  /* ---- Helper Text ---- */
  .form-group-helper {
    @apply text-xs text-base-content/40 leading-snug flex items-start gap-1;
  }
  .form-group-helper svg {
    @apply size-3.5 shrink-0 mt-px;
  }

  /* ---- Error Message ---- */
  .form-group-error {
    @apply text-xs leading-snug flex items-start gap-1 opacity-0 overflow-hidden;
    color: var(--color-error);
    max-height: 0;
    transition: opacity 0.15s ease, max-height 0.15s ease;
  }
  .form-group-error svg {
    @apply size-3.5 shrink-0 mt-px fill-current;
  }

  /* ---- Success Message ---- */
  .form-group-success {
    @apply text-xs leading-snug flex items-start gap-1 opacity-0 overflow-hidden;
    color: var(--color-success);
    max-height: 0;
    transition: opacity 0.15s ease, max-height 0.15s ease;
  }
  .form-group-success svg {
    @apply size-3.5 shrink-0 mt-px fill-current;
  }

  /* ---- Counter ---- */
  .form-group-counter {
    @apply text-xs text-base-content/40 text-right ml-auto;
  }
  .form-group-counter-warning {
    color: var(--color-warning);
  }
  .form-group-counter-error {
    color: var(--color-error);
  }

  .form-group-footer {
    @apply flex justify-between items-center gap-2;
  }

  /* ---- Addon (prefix/suffix) ---- */
  .form-group-addon {
    @apply flex items-center px-2 bg-base-200 border border-base-300 text-base-content/60 text-sm whitespace-nowrap;
  }
  .form-group-addon-start {
    @apply border-r-0;
    border-radius: var(--radius-field, 0.375rem) 0 0 var(--radius-field, 0.375rem);
  }
  .form-group-addon-end {
    @apply border-l-0;
    border-radius: 0 var(--radius-field, 0.375rem) var(--radius-field, 0.375rem) 0;
  }

  /* ---- Horizontal Layout ---- */
  .form-group-horizontal {
    @apply flex-row items-center gap-3;
  }
  .form-group-horizontal .form-group-label {
    @apply shrink-0 mb-0;
    min-width: 120px;
  }
  .form-group-horizontal .form-group-control {
    @apply flex-1;
  }

  /* ---- Validation: Error ---- */
  .form-group-has-error .form-group-label {
    color: var(--color-error);
  }
  .form-group-has-error .input,
  .form-group-has-error .textarea,
  .form-group-has-error .select,
  .form-group-has-error input,
  .form-group-has-error textarea,
  .form-group-has-error select {
    border-color: var(--color-error) !important;
    background: color-mix(in oklch, var(--color-error) 3%, var(--color-base-100));
  }
  .form-group-has-error .input:focus,
  .form-group-has-error input:focus {
    box-shadow: 0 0 0 3px color-mix(in oklch, var(--color-error) 15%, transparent);
  }
  .form-group-has-error .form-group-icon-error {
    @apply opacity-100;
    color: var(--color-error);
  }
  .form-group-has-error .form-group-error {
    @apply opacity-100;
    max-height: 100px;
  }
  .form-group-has-error .form-group-helper {
    @apply hidden;
  }

  /* ---- Validation: Success ---- */
  .form-group-has-success .form-group-label {
    color: var(--color-success);
  }
  .form-group-has-success .input,
  .form-group-has-success input {
    border-color: var(--color-success) !important;
    background: color-mix(in oklch, var(--color-success) 3%, var(--color-base-100));
  }
  .form-group-has-success .input:focus,
  .form-group-has-success input:focus {
    box-shadow: 0 0 0 3px color-mix(in oklch, var(--color-success) 15%, transparent);
  }
  .form-group-has-success .form-group-icon-success {
    @apply opacity-100;
    color: var(--color-success);
  }
  .form-group-has-success .form-group-success {
    @apply opacity-100;
    max-height: 100px;
  }
  .form-group-has-success .form-group-helper {
    @apply hidden;
  }

  /* ---- Validation: Warning ---- */
  .form-group-has-warning .form-group-label {
    color: var(--color-warning);
  }
  .form-group-has-warning .input,
  .form-group-has-warning input {
    border-color: var(--color-warning) !important;
    background: color-mix(in oklch, var(--color-warning) 3%, var(--color-base-100));
  }

  /* ---- Disabled ---- */
  .form-group-disabled {
    @apply opacity-50 pointer-events-none;
  }

  /* ---- Glass ---- */
  .form-group.glass .input,
  .form-group.glass .textarea,
  .form-group.glass .select,
  .form-group.glass input,
  .form-group.glass textarea,
  .form-group.glass select {
    @apply glass;
  }
  .form-group.glass .form-group-addon {
    @apply glass;
  }

  /* ---- Form Section ---- */
  .form-section {
    @apply mb-8 p-0 border-none;
  }
  .form-section-header {
    @apply mb-4 pb-2 border-b border-base-300;
  }
  .form-section-title {
    @apply text-lg font-semibold text-base-content m-0 mb-1;
  }
  .form-section-description {
    @apply text-sm text-base-content/60 m-0;
  }
  .form-section-content {
    @apply flex flex-col gap-4;
  }
  .form-section-compact .form-section-header {
    @apply mb-3;
  }
  .form-section-compact .form-section-title {
    @apply text-base;
  }

  /* ---- Form Row ---- */
  .form-row {
    @apply flex gap-4 mb-4;
  }
  .form-row:last-child {
    @apply mb-0;
  }
  .form-row > .form-group {
    @apply flex-1 mb-0;
  }
  .form-row > .form-group-auto {
    @apply flex-none;
  }
  .form-row > .form-group-fixed {
    flex: 0 0 200px;
  }

  /* ---- Form Actions ---- */
  .form-actions {
    @apply flex gap-2 justify-end pt-4 mt-4 border-t border-base-300;
  }
  .form-actions-start {
    @apply justify-start;
  }
  .form-actions-center {
    @apply justify-center;
  }
  .form-actions-between {
    @apply justify-between;
  }
  .form-actions-sticky {
    @apply sticky bottom-0 bg-base-100 p-3 border-t border-base-300;
    margin: 1.5rem -1.5rem 0;
    box-shadow: 0 -4px 12px rgba(0, 0, 0, 0.05);
  }
}

/* ---- Mobile ---- */
@media (max-width: 767px) {
  .form-row {
    flex-direction: column;
    gap: 1rem;
  }
  .form-row > .form-group-fixed {
    flex: 1;
  }
  .form-group-horizontal {
    flex-direction: column;
    align-items: stretch;
  }
  .form-group-horizontal .form-group-label {
    min-width: 0;
    margin-bottom: 0.25rem;
  }
}

/* Reduced motion */
@media (prefers-reduced-motion: reduce) {
  .form-group-error,
  .form-group-success,
  .form-group-icon {
    transition: none;
  }
}
