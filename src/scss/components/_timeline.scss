/**
 * UX Timeline Component
 * Part of the UX CSS Library
 * https://github.com/user/ux
 */

/* ========================================
   UX Timeline - Base
   ======================================== */

.ux-timeline {
  position: relative;
  font-family: var(--ux-font-family);

  /* ========================================
     Vertical Timeline (Default)
     ======================================== */

  &--vertical {
    padding-left: var(--ux-space-xl);

    &::before {
      content: '';
      position: absolute;
      left: 11px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: var(--ux-border-color);
    }
  }

  /* ========================================
     Simple Timeline (No Cards)
     ======================================== */

  &--simple {
    .ux-timeline__content {
      background: transparent;
      border: none;
      padding: 0;
      padding-left: var(--ux-space-sm);
    }

    .ux-timeline__footer {
      border-top: none;
      padding-top: 0;
    }
  }

  /* ========================================
     Compact Timeline
     ======================================== */

  &--compact {
    .ux-timeline__item {
      padding-bottom: var(--ux-space-md);
    }

    .ux-timeline__content {
      padding: var(--ux-space-sm);
    }

    .ux-timeline__title {
      font-size: var(--ux-font-size-sm);
    }

    .ux-timeline__body {
      font-size: var(--ux-font-size-xs);
    }
  }

  /* ========================================
     Alternating Timeline
     ======================================== */

  &--alternating {
    padding-left: 0;

    &::before {
      left: 50%;
      transform: translateX(-50%);
    }

    .ux-timeline__item {
      width: 50%;
      padding-right: var(--ux-space-xl);
      padding-left: 0;

      &:nth-child(even) {
        margin-left: 50%;
        padding-left: var(--ux-space-xl);
        padding-right: 0;

        .ux-timeline__marker {
          left: calc(-1 * var(--ux-space-xl) + 4px);
          right: auto;
        }

        .ux-timeline__marker--icon {
          left: calc(-1 * var(--ux-space-xl) - 4px);
        }
      }
    }

    .ux-timeline__marker {
      left: auto;
      right: calc(-1 * var(--ux-space-xl) + 4px);

      &--icon {
        right: calc(-1 * var(--ux-space-xl) - 4px);
      }
    }
  }

  /* ========================================
     Right-aligned Timeline
     ======================================== */

  &--right {
    padding-left: 0;
    padding-right: var(--ux-space-xl);

    &::before {
      left: auto;
      right: 11px;
    }

    .ux-timeline__marker {
      left: auto;
      right: calc(-1 * var(--ux-space-xl) + 4px);

      &--icon {
        right: calc(-1 * var(--ux-space-xl) - 4px);
      }
    }

    .ux-timeline__content {
      text-align: right;
    }

    .ux-timeline__header {
      flex-direction: row-reverse;
    }

    .ux-timeline__footer {
      justify-content: flex-end;
    }
  }

  /* ========================================
     Horizontal Timeline
     ======================================== */

  &--horizontal {
    display: flex;
    overflow-x: auto;
    padding: var(--ux-space-xl) 0 var(--ux-space-md);
    gap: 0;
    -webkit-overflow-scrolling: touch;

    &::before {
      content: '';
      position: absolute;
      left: 0;
      right: 0;
      top: 11px;
      height: 2px;
      background: var(--ux-border-color);
    }

    .ux-timeline__item {
      flex: 0 0 auto;
      min-width: 200px;
      max-width: 280px;
      padding-bottom: 0;
      padding-right: var(--ux-space-lg);

      &:last-child {
        padding-right: 0;
      }
    }

    .ux-timeline__marker {
      position: absolute;
      left: 50%;
      top: calc(-1 * var(--ux-space-xl) + 4px);
      transform: translateX(-50%);

      &--icon {
        top: calc(-1 * var(--ux-space-xl) - 4px);
      }
    }

    .ux-timeline__content {
      height: 100%;
    }
  }

  /* ========================================
     Animated Timeline
     ======================================== */

  &--animated::before {
    background: linear-gradient(
      to bottom,
      var(--ux-primary) var(--timeline-progress, 0%),
      var(--ux-border-color) var(--timeline-progress, 0%)
    );
  }

  &--horizontal.ux-timeline--animated::before {
    background: linear-gradient(
      to right,
      var(--ux-primary) var(--timeline-progress, 0%),
      var(--ux-border-color) var(--timeline-progress, 0%)
    );
  }

  /* ========================================
     Activity Feed Style
     ======================================== */

  &--activity {
    padding-left: var(--ux-space-2xl);

    .ux-timeline__marker {
      left: calc(-1 * var(--ux-space-2xl) + 4px);
      width: 32px;
      height: 32px;
      background: var(--ux-surface-secondary);
      border: none;

      svg {
        width: 16px;
        height: 16px;
        color: var(--ux-text-secondary);
      }
    }

    .ux-timeline__content {
      background: transparent;
      border: none;
      padding: 0;
    }

    .ux-timeline__title {
      font-size: var(--ux-font-size-sm);
      font-weight: 400;

      strong {
        font-weight: 600;
        color: var(--ux-text);
      }
    }

    .ux-timeline__time {
      display: block;
      margin-top: 2px;
    }
  }

  /* ========================================
     Glass Variant
     ======================================== */

  &--glass {
    .ux-timeline__content {
      background: var(--ux-glass-bg);
      backdrop-filter: blur(var(--ux-glass-blur)) saturate(var(--ux-glass-saturation));
      -webkit-backdrop-filter: blur(var(--ux-glass-blur)) saturate(var(--ux-glass-saturation));
      border-color: var(--ux-glass-border);
    }

    .ux-timeline__group-title {
      background: var(--ux-glass-bg);
      backdrop-filter: blur(var(--ux-glass-blur));
      -webkit-backdrop-filter: blur(var(--ux-glass-blur));
    }
  }
}

/* ========================================
   Timeline Item
   ======================================== */

.ux-timeline__item {
  position: relative;
  padding-bottom: var(--ux-space-lg);

  &:last-child {
    padding-bottom: 0;
  }

  &--loading {
    .ux-timeline__content {
      opacity: 0.6;
    }

    .ux-timeline__marker {
      animation: ux-timeline-pulse 1.5s infinite;
    }
  }

  &--clickable {
    cursor: pointer;

    .ux-timeline__content {
      transition: all var(--ux-transition-fast) var(--ux-ease);
    }

    &:hover .ux-timeline__content {
      border-color: var(--ux-primary);
      box-shadow: var(--ux-shadow-sm);
    }
  }

  &--active {
    .ux-timeline__content {
      border-color: var(--ux-primary);
      background: rgba(var(--ux-primary-rgb), 0.05);
    }

    .ux-timeline__marker {
      background: var(--ux-primary);
      border-color: var(--ux-primary);
      box-shadow: 0 0 0 4px rgba(var(--ux-primary-rgb), 0.2);
    }
  }
}

@keyframes ux-timeline-pulse {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.2); opacity: 0.7; }
}

/* ========================================
   Marker
   ======================================== */

.ux-timeline__marker {
  position: absolute;
  left: calc(-1 * var(--ux-space-xl) + 4px);
  top: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  width: 16px;
  height: 16px;
  border-radius: 50%;
  background: var(--ux-surface);
  border: 2px solid var(--ux-border-color);
  z-index: 1;

  &--dot {
    width: 12px;
    height: 12px;
    left: calc(-1 * var(--ux-space-xl) + 6px);
    background: var(--ux-primary);
    border: none;
  }

  &--icon {
    width: 32px;
    height: 32px;
    left: calc(-1 * var(--ux-space-xl) - 4px);
    background: var(--ux-primary);
    border: none;
    color: var(--ux-primary-contrast);

    svg {
      width: 16px;
      height: 16px;
    }
  }

  /* Color variants */
  &--primary {
    background: var(--ux-primary);
    border-color: var(--ux-primary);
  }

  &--success {
    background: var(--ux-success);
    border-color: var(--ux-success);
  }

  &--warning {
    background: var(--ux-warning);
    border-color: var(--ux-warning);
  }

  &--danger {
    background: var(--ux-danger);
    border-color: var(--ux-danger);
  }

  &--secondary {
    background: var(--ux-gray-400);
    border-color: var(--ux-gray-400);
  }
}

/* ========================================
   Content
   ======================================== */

.ux-timeline__content {
  background: var(--ux-surface);
  border: 1px solid var(--ux-border-color);
  border-radius: var(--ux-radius-lg);
  padding: var(--ux-space-md);
}

.ux-timeline__header {
  display: flex;
  align-items: flex-start;
  justify-content: space-between;
  gap: var(--ux-space-sm);
  margin-bottom: var(--ux-space-xs);
}

.ux-timeline__title {
  font-size: var(--ux-font-size-md);
  font-weight: 600;
  color: var(--ux-text);
  margin: 0;
}

.ux-timeline__time {
  font-size: var(--ux-font-size-xs);
  color: var(--ux-text-tertiary);
  white-space: nowrap;
}

.ux-timeline__subtitle {
  font-size: var(--ux-font-size-sm);
  color: var(--ux-text-secondary);
  margin: 0;
}

.ux-timeline__body {
  font-size: var(--ux-font-size-sm);
  color: var(--ux-text-secondary);
  margin-top: var(--ux-space-sm);

  p {
    margin: 0 0 var(--ux-space-xs);

    &:last-child {
      margin-bottom: 0;
    }
  }
}

.ux-timeline__footer {
  display: flex;
  align-items: center;
  gap: var(--ux-space-sm);
  margin-top: var(--ux-space-md);
  padding-top: var(--ux-space-sm);
  border-top: 1px solid var(--ux-border-color);
}

/* ========================================
   Grouped Timeline
   ======================================== */

.ux-timeline__group {
  margin-bottom: var(--ux-space-lg);
}

.ux-timeline__group-title {
  display: inline-flex;
  align-items: center;
  gap: var(--ux-space-sm);
  padding: var(--ux-space-xs) var(--ux-space-md);
  background: var(--ux-surface-secondary);
  border-radius: 999px;
  font-size: var(--ux-font-size-sm);
  font-weight: 600;
  color: var(--ux-text-secondary);
  margin-bottom: var(--ux-space-md);
  margin-left: calc(-1 * var(--ux-space-xl) + 24px);
}

/* ========================================
   Horizontal Scroll Navigation
   ======================================== */

.ux-timeline-scroll {
  position: relative;

  &__container {
    overflow: hidden;
  }

  &__nav {
    position: absolute;
    top: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: var(--ux-surface);
    border: 1px solid var(--ux-border-color);
    border-radius: 50%;
    box-shadow: var(--ux-shadow-md);
    cursor: pointer;
    z-index: 10;
    transition: all var(--ux-transition-fast) var(--ux-ease);

    &:hover {
      background: var(--ux-surface-secondary);
    }

    &:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    &--prev {
      left: 0;
    }

    &--next {
      right: 0;
    }

    svg {
      width: 20px;
      height: 20px;
      color: var(--ux-text);
    }
  }
}

/* ========================================
   Dark Mode
   ======================================== */

@media (prefers-color-scheme: dark) {
  .ux-timeline--activity .ux-timeline__marker {
    background: var(--ux-surface-tertiary);
  }
}

.ux-dark .ux-timeline--activity .ux-timeline__marker {
  background: var(--ux-surface-tertiary);
}

/* ========================================
   Responsive
   ======================================== */

@media (max-width: 767px) {
  .ux-timeline--alternating {
    padding-left: var(--ux-space-xl);

    &::before {
      left: 11px;
      transform: none;
    }

    .ux-timeline__item,
    .ux-timeline__item:nth-child(even) {
      width: 100%;
      margin-left: 0;
      padding-left: 0;
      padding-right: 0;
    }

    .ux-timeline__marker,
    .ux-timeline__item:nth-child(even) .ux-timeline__marker {
      left: calc(-1 * var(--ux-space-xl) + 4px);
      right: auto;
    }

    .ux-timeline__marker--icon,
    .ux-timeline__item:nth-child(even) .ux-timeline__marker--icon {
      left: calc(-1 * var(--ux-space-xl) - 4px);
      right: auto;
    }
  }

  .ux-timeline--horizontal .ux-timeline__item {
    min-width: 160px;
  }
}

/* ========================================
   Reduced Motion
   ======================================== */

@media (prefers-reduced-motion: reduce) {
  .ux-timeline__item--loading .ux-timeline__marker {
    animation: none;
  }

  .ux-timeline__item--clickable .ux-timeline__content {
    transition: none;
  }
}
