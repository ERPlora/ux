/**
 * UX Sparkline Component
 * Part of the UX CSS Library
 */

@use '../core/mixins' as *;

// ========================================
// UX Sparkline - Base
// ========================================

.ux-sparkline {
  display: inline-flex;
  align-items: center;
  gap: var(--ux-space-sm);
  font-family: var(--ux-font-family);

  &__svg {
    display: block;
    overflow: visible;
  }

  // ========================================
  // Line Chart
  // ========================================

  &__line {
    fill: none;
    stroke: var(--ux-primary);
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
  }

  &__area {
    fill: url(#sparklineGradient);
    opacity: 0.2;
  }

  &__dot {
    fill: var(--ux-primary);

    &--last {
      fill: var(--ux-primary);
      stroke: var(--ux-surface);
      stroke-width: 2;
    }
  }

  // ========================================
  // Bar Chart
  // ========================================

  &__bar {
    fill: var(--ux-primary);
    rx: 2;

    &--negative {
      fill: var(--ux-danger);
    }
  }

  // ========================================
  // Reference Line
  // ========================================

  &__reference {
    stroke: var(--ux-text-tertiary);
    stroke-width: 1;
    stroke-dasharray: 4 2;
  }

  // ========================================
  // Color Variants
  // ========================================

  &--success {
    .ux-sparkline__line,
    .ux-sparkline__dot,
    .ux-sparkline__bar {
      stroke: var(--ux-success);
      fill: var(--ux-success);
    }

    .ux-sparkline__line {
      fill: none;
    }
  }

  &--danger {
    .ux-sparkline__line,
    .ux-sparkline__dot,
    .ux-sparkline__bar {
      stroke: var(--ux-danger);
      fill: var(--ux-danger);
    }

    .ux-sparkline__line {
      fill: none;
    }
  }

  &--warning {
    .ux-sparkline__line,
    .ux-sparkline__dot,
    .ux-sparkline__bar {
      stroke: var(--ux-warning);
      fill: var(--ux-warning);
    }

    .ux-sparkline__line {
      fill: none;
    }
  }

  // ========================================
  // Value Display
  // ========================================

  &__value {
    font-size: var(--ux-font-size-sm);
    font-weight: 600;
    color: var(--ux-text);
    font-variant-numeric: tabular-nums;
  }

  &__change {
    display: inline-flex;
    align-items: center;
    gap: 0.125rem;
    font-size: var(--ux-font-size-xs);
    font-weight: 500;

    &--positive {
      color: var(--ux-success);
    }

    &--negative {
      color: var(--ux-danger);
    }

    &--neutral {
      color: var(--ux-text-secondary);
    }

    svg {
      width: 12px;
      height: 12px;
    }
  }

  // ========================================
  // Size Variants
  // ========================================

  &--sm .ux-sparkline__line {
    stroke-width: 1.5;
  }

  &--lg .ux-sparkline__line {
    stroke-width: 2.5;
  }

  // ========================================
  // Interactive
  // ========================================

  &--interactive {
    cursor: pointer;

    &:hover .ux-sparkline__line {
      stroke-width: 2.5;
    }
  }

  &__tooltip {
    position: absolute;
    padding: 0.375rem 0.625rem;
    background: var(--ux-gray-900);
    border-radius: var(--ux-radius-sm);
    font-size: 0.75rem;
    color: white;
    white-space: nowrap;
    pointer-events: none;
    transform: translate(-50%, -100%);
    margin-top: -8px;
    z-index: var(--ux-z-tooltip);

    &::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 4px solid transparent;
      border-top-color: var(--ux-gray-900);
    }
  }

  // ========================================
  // Animated
  // ========================================

  &--animated .ux-sparkline__line {
    stroke-dasharray: 1000;
    stroke-dashoffset: 1000;
    animation: ux-sparkline-draw 1s ease-out forwards;
  }
}

@keyframes ux-sparkline-draw {
  to {
    stroke-dashoffset: 0;
  }
}

// ========================================
// Reduced Motion
// ========================================

@media (prefers-reduced-motion: reduce) {
  .ux-sparkline--animated .ux-sparkline__line {
    animation: none;
    stroke-dasharray: none;
    stroke-dashoffset: 0;
  }
}
