/**
 * UX Stock-indicator Component
 * Part of the UX CSS Library
 */

@use '../core/mixins' as *;

// Stock Indicator Variables
:root {
  --ux-stock-indicator-height: 24px;
  --ux-stock-indicator-padding: 0 var(--ux-space-sm);
  --ux-stock-indicator-gap: var(--ux-space-xs);
  --ux-stock-indicator-font-size: 0.8125rem;
  --ux-stock-indicator-border-radius: var(--ux-radius-sm);

  // Dot
  --ux-stock-indicator-dot-size: 8px;

  // State Colors
  --ux-stock-in-stock: var(--ux-green-500);
  --ux-stock-in-stock-bg: var(--ux-green-50);
  --ux-stock-low-stock: var(--ux-yellow-500);
  --ux-stock-low-stock-bg: var(--ux-yellow-50);
  --ux-stock-out-of-stock: var(--ux-red-500);
  --ux-stock-out-of-stock-bg: var(--ux-red-50);
  --ux-stock-backorder: var(--ux-blue-500);
  --ux-stock-backorder-bg: var(--ux-blue-50);
}

// Base Stock Indicator
.ux-stock-indicator {
  display: inline-flex;
  align-items: center;
  gap: var(--ux-stock-indicator-gap);
  height: var(--ux-stock-indicator-height);
  padding: var(--ux-stock-indicator-padding);
  font-size: var(--ux-stock-indicator-font-size);
  font-weight: 500;
  line-height: 1;
  white-space: nowrap;
  border-radius: var(--ux-stock-indicator-border-radius);
  background: transparent;
  transition: opacity var(--ux-transition-fast) var(--ux-ease-default);

  // Dot Element
  &__dot {
    width: var(--ux-stock-indicator-dot-size);
    height: var(--ux-stock-indicator-dot-size);
    border-radius: 50%;
    flex-shrink: 0;
    background: currentColor;
  }

  // Label Element
  &__label {
    color: var(--ux-text-secondary);
  }

  // Count Element
  &__count {
    font-weight: 600;
    font-variant-numeric: tabular-nums;
    color: var(--ux-text);
  }

  // =====================
  // STATE MODIFIERS
  // =====================

  // In Stock
  &--in-stock {
    color: var(--ux-stock-in-stock);

    .ux-stock-indicator__label {
      color: var(--ux-stock-in-stock);
    }
  }

  // Low Stock
  &--low-stock {
    color: var(--ux-stock-low-stock);

    .ux-stock-indicator__label {
      color: var(--ux-stock-low-stock);
    }

    // Pulse animation for low stock
    .ux-stock-indicator__dot {
      animation: ux-stock-pulse 2s ease-in-out infinite;
    }
  }

  // Out of Stock
  &--out-of-stock {
    color: var(--ux-stock-out-of-stock);

    .ux-stock-indicator__label {
      color: var(--ux-stock-out-of-stock);
    }
  }

  // Backorder
  &--backorder {
    color: var(--ux-stock-backorder);

    .ux-stock-indicator__label {
      color: var(--ux-stock-backorder);
    }
  }

  // =====================
  // VARIANT MODIFIERS
  // =====================

  // Compact - Dot only
  &--compact {
    padding: 0;
    height: auto;
    gap: 0;

    .ux-stock-indicator__label,
    .ux-stock-indicator__count {
      display: none;
    }
  }

  // Badge - Pill shape with background
  &--badge {
    border-radius: 9999px;
    padding: 0 var(--ux-space-sm);

    &.ux-stock-indicator--in-stock {
      background: var(--ux-stock-in-stock-bg);
    }

    &.ux-stock-indicator--low-stock {
      background: var(--ux-stock-low-stock-bg);
    }

    &.ux-stock-indicator--out-of-stock {
      background: var(--ux-stock-out-of-stock-bg);
    }

    &.ux-stock-indicator--backorder {
      background: var(--ux-stock-backorder-bg);
    }
  }
}

@keyframes ux-stock-pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

// =====================
// DARK MODE
// =====================

@media (prefers-color-scheme: dark) {
  :root {
    --ux-stock-in-stock-bg: rgba(34, 197, 94, 0.15);
    --ux-stock-low-stock-bg: rgba(234, 179, 8, 0.15);
    --ux-stock-out-of-stock-bg: rgba(239, 68, 68, 0.15);
    --ux-stock-backorder-bg: rgba(59, 130, 246, 0.15);
  }
}

.ux-dark {
  --ux-stock-in-stock-bg: rgba(34, 197, 94, 0.15);
  --ux-stock-low-stock-bg: rgba(234, 179, 8, 0.15);
  --ux-stock-out-of-stock-bg: rgba(239, 68, 68, 0.15);
  --ux-stock-backorder-bg: rgba(59, 130, 246, 0.15);
}

// =====================
// REDUCED MOTION
// =====================

@media (prefers-reduced-motion: reduce) {
  .ux-stock-indicator--low-stock .ux-stock-indicator__dot {
    animation: none;
  }
}
