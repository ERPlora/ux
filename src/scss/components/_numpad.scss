@use '../core/mixins' as *;

/**
 * UX Numpad Component
 * Part of the UX CSS Library
 * https://github.com/user/ux
 */

/* ========================================
   UX Numpad Container
   ======================================== */

:root {
  --ux-numpad-key-size: 64px;
  --ux-numpad-key-size-sm: 52px;
  --ux-numpad-key-size-lg: 76px;
  --ux-numpad-gap: var(--ux-space-sm);
  --ux-numpad-border-radius: var(--ux-border-radius-lg);
  --ux-numpad-font-size: 1.5rem;
  --ux-numpad-font-size-sm: 1.25rem;
  --ux-numpad-font-size-lg: 1.75rem;
}

.ux-numpad {
  display: flex;
  flex-direction: column;
  gap: var(--ux-space-md);
  padding: var(--ux-space-md);
  background-color: var(--ux-surface);
  border-radius: var(--ux-numpad-border-radius);
  max-width: fit-content;

  &--full-width {
    max-width: 100%;
  }

  &--compact {
    padding: var(--ux-space-sm);
    gap: var(--ux-space-sm);
  }

  /* ========================================
     Numpad Display
     ======================================== */

  &__display {
    display: flex;
    align-items: center;
    justify-content: flex-end;
    min-height: 56px;
    padding: var(--ux-space-md) var(--ux-space-lg);
    background-color: var(--ux-surface-secondary);
    border: 1px solid var(--ux-border-color);
    border-radius: var(--ux-border-radius-lg);
    font-family: 'SF Mono', 'Menlo', 'Monaco', monospace;
    font-size: 2rem;
    font-weight: 600;
    color: var(--ux-text);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;

    &--lg {
      min-height: 72px;
      font-size: 2.5rem;
    }

    &--sm {
      min-height: 44px;
      font-size: 1.5rem;
      padding: var(--ux-space-sm) var(--ux-space-md);
    }
  }

  &__display-label {
    font-size: var(--ux-font-size-sm);
    font-weight: 400;
    color: var(--ux-text-secondary);
    margin-right: auto;
    font-family: inherit;
  }

  &__display-value {
    font-variant-numeric: tabular-nums;
  }

  &__display-currency {
    font-size: 0.75em;
    color: var(--ux-text-secondary);
    margin-right: var(--ux-space-xs);
  }

  /* ========================================
     Numpad Grid
     ======================================== */

  &__grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--ux-numpad-gap);

    &--4cols {
      grid-template-columns: repeat(4, 1fr);
    }
  }

  /* ========================================
     Numpad Keys
     ======================================== */

  &__key {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: var(--ux-numpad-key-size);
    min-height: var(--ux-numpad-key-size);
    padding: var(--ux-space-sm);
    background-color: var(--ux-surface);
    border: 1px solid var(--ux-border-color);
    border-radius: var(--ux-border-radius-lg);
    font-size: var(--ux-numpad-font-size);
    font-weight: 500;
    color: var(--ux-text);
    cursor: pointer;
    user-select: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: transparent;
    transition:
      background-color var(--ux-transition-fast) var(--ux-ease),
      transform 100ms var(--ux-ease),
      box-shadow var(--ux-transition-fast) var(--ux-ease);

    &:hover {
      background-color: var(--ux-surface-secondary);
    }

    &:active {
      transform: scale(0.95);
      background-color: var(--ux-surface-tertiary);
    }

    &:focus-visible {
      outline: 2px solid var(--ux-primary);
      outline-offset: 2px;
    }

    svg {
      width: 24px;
      height: 24px;
    }

    /* Key spanning 2 columns (e.g., 0 key) */
    &--wide {
      grid-column: span 2;
    }

    /* Key spanning 2 rows */
    &--tall {
      grid-row: span 2;
    }

    /* Action keys (backspace, clear, etc.) */
    &--action {
      background-color: var(--ux-surface-secondary);
      color: var(--ux-text-secondary);

      &:hover {
        background-color: var(--ux-surface-tertiary);
      }
    }

    /* Primary action key (enter, confirm) */
    &--primary {
      background-color: var(--ux-primary);
      border-color: var(--ux-primary);
      color: var(--ux-primary-contrast);

      &:hover {
        background-color: var(--ux-primary-shade);
      }

      &:active {
        background-color: var(--ux-primary-shade);
      }
    }

    /* Success key */
    &--success {
      background-color: var(--ux-success);
      border-color: var(--ux-success);
      color: white;

      &:hover {
        background-color: var(--ux-success-shade, #34c759);
      }
    }

    /* Danger key (clear all, delete) */
    &--danger {
      background-color: transparent;
      border-color: var(--ux-danger);
      color: var(--ux-danger);

      &:hover {
        background-color: rgba(var(--ux-danger-rgb, 255, 59, 48), 0.1);
      }
    }

    /* Disabled key */
    &:disabled,
    &--disabled {
      opacity: 0.4;
      cursor: not-allowed;
      pointer-events: none;
    }
  }

  /* Key Sizes */
  &--sm &__key {
    min-width: var(--ux-numpad-key-size-sm);
    min-height: var(--ux-numpad-key-size-sm);
    font-size: var(--ux-numpad-font-size-sm);

    svg {
      width: 20px;
      height: 20px;
    }
  }

  &--lg &__key {
    min-width: var(--ux-numpad-key-size-lg);
    min-height: var(--ux-numpad-key-size-lg);
    font-size: var(--ux-numpad-font-size-lg);

    svg {
      width: 28px;
      height: 28px;
    }
  }

  /* ========================================
     Quick Amount Buttons
     ======================================== */

  &__quick-amounts {
    display: flex;
    flex-wrap: wrap;
    gap: var(--ux-space-xs);
  }

  &__quick-btn {
    flex: 1;
    min-width: 60px;
    padding: var(--ux-space-sm) var(--ux-space-md);
    background-color: var(--ux-surface-secondary);
    border: 1px solid var(--ux-border-color);
    border-radius: var(--ux-border-radius);
    font-size: var(--ux-font-size-sm);
    font-weight: 500;
    color: var(--ux-text);
    cursor: pointer;
    transition:
      background-color var(--ux-transition-fast) var(--ux-ease),
      transform 100ms var(--ux-ease);

    &:hover {
      background-color: var(--ux-surface-tertiary);
    }

    &:active {
      transform: scale(0.97);
    }
  }

  /* ========================================
     Glass Variant
     ======================================== */

  &--glass {
    background: var(--ux-glass-bg);
    backdrop-filter: blur(var(--ux-glass-blur)) saturate(var(--ux-glass-saturation));
    -webkit-backdrop-filter: blur(var(--ux-glass-blur)) saturate(var(--ux-glass-saturation));
    border: 0.5px solid var(--ux-glass-border);

    .ux-numpad__display {
      background: var(--ux-glass-bg-thin);
      border-color: var(--ux-glass-border);
    }

    .ux-numpad__key {
      background: var(--ux-glass-bg-thin);
      border-color: var(--ux-glass-border);

      &:hover {
        background: var(--ux-glass-bg);
      }

      &--action {
        background: var(--ux-glass-bg);
      }
    }
  }

  /* ========================================
     Calculator Layout
     ======================================== */

  &--calculator &__grid {
    grid-template-columns: repeat(4, 1fr);
  }

  &--calculator &__key--operator {
    background-color: var(--ux-warning);
    border-color: var(--ux-warning);
    color: white;

    &:hover {
      background-color: var(--ux-warning-shade, #ff9500);
    }
  }

  /* ========================================
     PIN Entry Layout
     ======================================== */

  &--pin {
    max-width: 280px;

    .ux-numpad__display {
      letter-spacing: 1rem;
      text-align: center;
      justify-content: center;
    }
  }

  &__pin-dots {
    display: flex;
    justify-content: center;
    gap: var(--ux-space-md);
    padding: var(--ux-space-md);
  }

  &__pin-dot {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    background-color: var(--ux-border-color);
    transition: background-color var(--ux-transition-fast) var(--ux-ease);

    &--filled {
      background-color: var(--ux-primary);
    }
  }
}

/* ========================================
   Responsive
   ======================================== */

@media (max-width: 767px) {
  .ux-numpad {
    width: 100%;
    max-width: 100%;

    &__key {
      min-width: 0;
      min-height: 56px;
    }

    &__display {
      font-size: 1.75rem;
    }
  }
}

/* ========================================
   Dark Mode
   ======================================== */

@media (prefers-color-scheme: dark) {
  .ux-numpad__key {
    border-color: var(--ux-border-color);
  }
}

.ux-dark .ux-numpad__key {
  border-color: var(--ux-border-color);
}

/* ========================================
   PIN Pad Component
   ======================================== */

:root {
  --ux-pinpad-dot-size: 18px;
  --ux-pinpad-key-size: 68px;
  --ux-pinpad-key-size-sm: 56px;
  --ux-pinpad-key-size-lg: 80px;
}

.ux-pinpad {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--ux-space-lg);
  padding: var(--ux-space-lg);

  &__label {
    font-size: var(--ux-font-size-sm);
    color: var(--ux-text-secondary);
    margin: 0;
  }

  /* PIN Dots */
  &__dots {
    display: flex;
    gap: var(--ux-space-md);
  }

  &__dot {
    width: var(--ux-pinpad-dot-size);
    height: var(--ux-pinpad-dot-size);
    border-radius: 50%;
    border: 2px solid var(--ux-border-color);
    background: transparent;
    transition: all 0.2s ease;

    &--filled {
      background: var(--ux-primary);
      border-color: var(--ux-primary);
      transform: scale(1.15);
      box-shadow: 0 0 12px var(--ux-primary);
    }

    &--error {
      background: var(--ux-danger);
      border-color: var(--ux-danger);
      box-shadow: 0 0 12px var(--ux-danger);
      animation: ux-pinpad-shake 0.5s ease;
    }

    &--success {
      background: var(--ux-success);
      border-color: var(--ux-success);
      box-shadow: 0 0 12px var(--ux-success);
    }
  }

  /* PIN Pad Grid */
  &__grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: var(--ux-space-sm);
    max-width: 260px;
  }

  /* PIN Pad Keys */
  &__key {
    display: flex;
    align-items: center;
    justify-content: center;
    width: var(--ux-pinpad-key-size);
    height: var(--ux-pinpad-key-size);
    font-size: 1.5rem;
    font-weight: 500;
    color: var(--ux-text);
    background: transparent;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    user-select: none;
    -webkit-user-select: none;
    -webkit-tap-highlight-color: transparent;
    transition:
      background-color var(--ux-transition-fast) var(--ux-ease),
      transform 100ms var(--ux-ease);

    &:hover {
      background: rgba(var(--ux-text-rgb, 0, 0, 0), 0.05);
    }

    &:active {
      transform: scale(0.92);
      background: rgba(var(--ux-text-rgb, 0, 0, 0), 0.1);
    }

    &:focus-visible {
      outline: 2px solid var(--ux-primary);
      outline-offset: 2px;
    }

    &:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      pointer-events: none;
    }

    &--hidden {
      visibility: hidden;
      pointer-events: none;
    }

    svg {
      width: 24px;
      height: 24px;
    }
  }

  /* Glass Variant */
  &--glass &__key {
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    background: rgba(255, 255, 255, 0.1);
    border: 1px solid rgba(255, 255, 255, 0.2);

    &:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    &:active {
      background: rgba(255, 255, 255, 0.25);
    }
  }

  /* Size Variants */
  &--sm {
    &__key {
      width: var(--ux-pinpad-key-size-sm);
      height: var(--ux-pinpad-key-size-sm);
      font-size: 1.25rem;
    }

    &__dot {
      width: 14px;
      height: 14px;
    }
  }

  &--lg {
    &__key {
      width: var(--ux-pinpad-key-size-lg);
      height: var(--ux-pinpad-key-size-lg);
      font-size: 1.75rem;
    }

    &__dot {
      width: 22px;
      height: 22px;
    }
  }

  /* Loading State */
  &__loading {
    display: flex;
    align-items: center;
    gap: var(--ux-space-sm);
    font-size: var(--ux-font-size-sm);
    color: var(--ux-text-secondary);
  }

  /* Hint */
  &__hint {
    font-size: var(--ux-font-size-xs);
    color: var(--ux-text-tertiary);
    margin: 0;
  }

  /* Error Message */
  &__error {
    font-size: var(--ux-font-size-sm);
    color: var(--ux-danger);
    margin: 0;
  }
}

@keyframes ux-pinpad-shake {
  0%, 100% { transform: translateX(0); }
  20% { transform: translateX(-8px); }
  40% { transform: translateX(8px); }
  60% { transform: translateX(-4px); }
  80% { transform: translateX(4px); }
}

/* Dark Mode Glass */
@media (prefers-color-scheme: dark) {
  .ux-pinpad--glass .ux-pinpad__key {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);

    &:hover {
      background: rgba(255, 255, 255, 0.1);
    }
  }
}

.ux-dark .ux-pinpad--glass .ux-pinpad__key {
  background: rgba(255, 255, 255, 0.05);
  border-color: rgba(255, 255, 255, 0.1);

  &:hover {
    background: rgba(255, 255, 255, 0.1);
  }
}
