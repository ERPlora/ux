/**
 * UX Event-card Component
 * Part of the UX CSS Library
 */

// ========================================
// UX Event Card Base
// ========================================

.ux-event-card {
  position: relative;
  display: flex;
  flex-direction: column;
  background-color: var(--ux-surface);
  border-radius: var(--ux-card-border-radius);
  box-shadow: var(--ux-shadow-sm);
  overflow: hidden;
  transition: transform var(--ux-transition-fast) var(--ux-ease),
              box-shadow var(--ux-transition-fast) var(--ux-ease);

  &:hover {
    box-shadow: var(--ux-shadow-md);
  }

  // ========================================
  // Category Color Bar (left border)
  // ========================================

  &::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    width: 4px;
    background-color: var(--ux-event-category-color, var(--ux-primary));
    border-radius: var(--ux-card-border-radius) 0 0 var(--ux-card-border-radius);
  }

  // Category Colors
  &--work { --ux-event-category-color: var(--ux-blue-500); }
  &--personal { --ux-event-category-color: var(--ux-green-500); }
  &--meeting { --ux-event-category-color: var(--ux-purple-500); }
  &--deadline { --ux-event-category-color: var(--ux-red-500); }
  &--reminder { --ux-event-category-color: var(--ux-yellow-500); }
  &--holiday { --ux-event-category-color: var(--ux-orange-500); }
  &--travel { --ux-event-category-color: var(--ux-cyan-500); }
  &--health { --ux-event-category-color: var(--ux-rose-500); }
  &--social { --ux-event-category-color: var(--ux-indigo-500); }
  &--other { --ux-event-category-color: var(--ux-gray-500); }

  // ========================================
  // Header
  // ========================================

  &__header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    padding: var(--ux-space-md) var(--ux-space-md) var(--ux-space-sm);
    padding-left: calc(var(--ux-space-md) + 8px);
    gap: var(--ux-space-sm);
  }

  &__header-content {
    flex: 1;
    min-width: 0;
  }

  &__header-actions {
    display: flex;
    align-items: center;
    gap: var(--ux-space-xs);
    flex-shrink: 0;
  }

  // ========================================
  // Title
  // ========================================

  &__title {
    font-size: var(--ux-font-size-md);
    font-weight: 600;
    color: var(--ux-text);
    margin: 0;
    line-height: 1.3;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;

    a {
      color: inherit;
      text-decoration: none;

      &:hover {
        color: var(--ux-primary);
      }
    }
  }

  // ========================================
  // Description
  // ========================================

  &__description {
    font-size: var(--ux-font-size-sm);
    color: var(--ux-text-secondary);
    margin: var(--ux-space-xs) 0 0;
    line-height: 1.4;
    overflow: hidden;
    text-overflow: ellipsis;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
  }

  // ========================================
  // Content
  // ========================================

  &__content {
    display: flex;
    flex-direction: column;
    gap: var(--ux-space-sm);
    padding: 0 var(--ux-space-md) var(--ux-space-md);
    padding-left: calc(var(--ux-space-md) + 8px);
  }

  // ========================================
  // Meta Row
  // ========================================

  &__meta {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--ux-space-sm) var(--ux-space-md);
    font-size: var(--ux-font-size-sm);
    color: var(--ux-text-secondary);
  }

  &__meta-item {
    display: inline-flex;
    align-items: center;
    gap: var(--ux-space-xs);

    svg {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
      opacity: 0.7;
    }
  }

  // ========================================
  // Time Display
  // ========================================

  &__time {
    display: inline-flex;
    align-items: center;
    gap: var(--ux-space-xs);
    font-weight: 500;
    color: var(--ux-text);

    svg {
      width: 16px;
      height: 16px;
      color: var(--ux-event-category-color, var(--ux-primary));
    }
  }

  &__time-range {
    display: flex;
    align-items: center;
    gap: var(--ux-space-xs);
  }

  &__time-separator {
    color: var(--ux-text-tertiary);
  }

  // ========================================
  // Duration Badge
  // ========================================

  &__duration {
    display: inline-flex;
    align-items: center;
    gap: var(--ux-space-xs);
    padding: 2px 8px;
    font-size: var(--ux-font-size-xs);
    font-weight: 500;
    background-color: var(--ux-surface-secondary);
    color: var(--ux-text-secondary);
    border-radius: var(--ux-radius-full);

    svg {
      width: 12px;
      height: 12px;
    }
  }

  // ========================================
  // Location
  // ========================================

  &__location {
    display: inline-flex;
    align-items: center;
    gap: var(--ux-space-xs);
    color: var(--ux-text-secondary);
    font-size: var(--ux-font-size-sm);

    svg {
      width: 16px;
      height: 16px;
      flex-shrink: 0;
      color: var(--ux-text-tertiary);
    }

    a {
      color: var(--ux-primary);
      text-decoration: none;

      &:hover {
        text-decoration: underline;
      }
    }
  }

  // ========================================
  // Attendees (Avatar Stack)
  // ========================================

  &__attendees {
    display: flex;
    align-items: center;
    gap: var(--ux-space-sm);
  }

  &__attendees-stack {
    display: flex;
    flex-direction: row-reverse;

    .ux-avatar {
      width: 28px;
      height: 28px;
      font-size: 10px;
      margin-left: -8px;
      border: 2px solid var(--ux-surface);
      box-sizing: content-box;

      &:last-child {
        margin-left: 0;
      }
    }
  }

  &__attendees-more {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    margin-left: -8px;
    font-size: 10px;
    font-weight: 600;
    background-color: var(--ux-surface-secondary);
    color: var(--ux-text-secondary);
    border-radius: 50%;
    border: 2px solid var(--ux-surface);
    box-sizing: content-box;
  }

  &__attendees-label {
    font-size: var(--ux-font-size-xs);
    color: var(--ux-text-tertiary);
  }

  // ========================================
  // Category Tag
  // ========================================

  &__category {
    display: inline-flex;
    align-items: center;
    gap: var(--ux-space-xs);
    padding: 2px 8px;
    font-size: var(--ux-font-size-xs);
    font-weight: 500;
    background-color: rgba(var(--ux-event-category-color-rgb, var(--ux-primary-rgb)), 0.12);
    color: var(--ux-event-category-color, var(--ux-primary));
    border-radius: var(--ux-radius-full);

    &::before {
      content: '';
      width: 6px;
      height: 6px;
      background-color: var(--ux-event-category-color, var(--ux-primary));
      border-radius: 50%;
    }
  }

  // Category tag colors
  &--work &__category {
    background-color: rgba(59, 130, 246, 0.12);
    color: var(--ux-blue-600);
  }

  &--personal &__category {
    background-color: rgba(34, 197, 94, 0.12);
    color: var(--ux-green-600);
  }

  &--meeting &__category {
    background-color: rgba(168, 85, 247, 0.12);
    color: var(--ux-purple-600);
  }

  &--deadline &__category {
    background-color: rgba(239, 68, 68, 0.12);
    color: var(--ux-red-600);
  }

  &--reminder &__category {
    background-color: rgba(234, 179, 8, 0.12);
    color: var(--ux-yellow-600);
  }

  &--holiday &__category {
    background-color: rgba(249, 115, 22, 0.12);
    color: var(--ux-orange-600);
  }

  &--travel &__category {
    background-color: rgba(6, 182, 212, 0.12);
    color: var(--ux-cyan-600);
  }

  &--health &__category {
    background-color: rgba(244, 63, 94, 0.12);
    color: var(--ux-rose-600);
  }

  &--social &__category {
    background-color: rgba(99, 102, 241, 0.12);
    color: var(--ux-indigo-600);
  }

  &--other &__category {
    background-color: rgba(107, 114, 128, 0.12);
    color: var(--ux-gray-600);
  }

  // ========================================
  // Indicators
  // ========================================

  &__indicators {
    display: flex;
    align-items: center;
    gap: var(--ux-space-xs);
  }

  &__indicator {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    background-color: var(--ux-surface-secondary);
    color: var(--ux-text-tertiary);

    svg {
      width: 12px;
      height: 12px;
    }

    &--reminder {
      background-color: rgba(234, 179, 8, 0.15);
      color: var(--ux-yellow-600);
    }

    &--recurring {
      background-color: rgba(59, 130, 246, 0.15);
      color: var(--ux-blue-600);
    }
  }

  // ========================================
  // Footer
  // ========================================

  &__footer {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--ux-space-sm) var(--ux-space-md);
    padding-left: calc(var(--ux-space-md) + 8px);
    border-top: 1px solid var(--ux-border-color);
    gap: var(--ux-space-sm);
  }

  &__footer-start,
  &__footer-end {
    display: flex;
    align-items: center;
    gap: var(--ux-space-xs);
  }

  &__footer-end {
    margin-left: auto;
  }

  // ========================================
  // RSVP Status
  // ========================================

  &__rsvp {
    display: inline-flex;
    align-items: center;
    gap: var(--ux-space-xs);
    padding: 4px 10px;
    font-size: var(--ux-font-size-xs);
    font-weight: 500;
    border-radius: var(--ux-radius-full);

    svg {
      width: 14px;
      height: 14px;
    }

    &--going {
      background-color: rgba(34, 197, 94, 0.12);
      color: var(--ux-green-600);
    }

    &--maybe {
      background-color: rgba(234, 179, 8, 0.12);
      color: var(--ux-yellow-600);
    }

    &--declined {
      background-color: rgba(239, 68, 68, 0.12);
      color: var(--ux-red-600);
    }

    &--pending {
      background-color: var(--ux-surface-secondary);
      color: var(--ux-text-secondary);
    }
  }

  // ========================================
  // Compact Variant
  // ========================================

  &--compact {
    flex-direction: row;
    align-items: center;
    padding: var(--ux-space-xs) var(--ux-space-sm);
    padding-left: calc(var(--ux-space-sm) + 6px);
    gap: var(--ux-space-sm);
    min-height: 32px;
    box-shadow: none;
    border: 1px solid var(--ux-border-color);

    &::before {
      width: 3px;
    }

    &:hover {
      box-shadow: var(--ux-shadow-sm);
    }

    .ux-event-card__header {
      padding: 0;
      flex: 1;
      min-width: 0;
    }

    .ux-event-card__title {
      font-size: var(--ux-font-size-sm);
    }

    .ux-event-card__content,
    .ux-event-card__footer,
    .ux-event-card__description {
      display: none;
    }

    .ux-event-card__time {
      font-size: var(--ux-font-size-xs);
      font-weight: 400;
      color: var(--ux-text-secondary);
      white-space: nowrap;

      svg {
        display: none;
      }
    }

    .ux-event-card__indicators {
      flex-shrink: 0;
    }

    .ux-event-card__indicator {
      width: 16px;
      height: 16px;

      svg {
        width: 10px;
        height: 10px;
      }
    }
  }

  // ========================================
  // All-Day Event Variant
  // ========================================

  &--all-day {
    background-color: rgba(var(--ux-event-category-color-rgb, var(--ux-primary-rgb)), 0.08);
    border-left: none;

    &::before {
      display: none;
    }

    .ux-event-card__title {
      color: var(--ux-event-category-color, var(--ux-primary));
    }

    .ux-event-card__time {
      display: none;
    }

    .ux-event-card__all-day-badge {
      display: inline-flex;
      align-items: center;
      padding: 2px 8px;
      font-size: var(--ux-font-size-xs);
      font-weight: 500;
      background-color: var(--ux-event-category-color, var(--ux-primary));
      color: white;
      border-radius: var(--ux-radius-full);
    }
  }

  &__all-day-badge {
    display: none;
  }

  // All-day category backgrounds
  &--all-day.ux-event-card--work { background-color: rgba(59, 130, 246, 0.1); }
  &--all-day.ux-event-card--personal { background-color: rgba(34, 197, 94, 0.1); }
  &--all-day.ux-event-card--meeting { background-color: rgba(168, 85, 247, 0.1); }
  &--all-day.ux-event-card--deadline { background-color: rgba(239, 68, 68, 0.1); }
  &--all-day.ux-event-card--reminder { background-color: rgba(234, 179, 8, 0.1); }
  &--all-day.ux-event-card--holiday { background-color: rgba(249, 115, 22, 0.1); }
  &--all-day.ux-event-card--travel { background-color: rgba(6, 182, 212, 0.1); }
  &--all-day.ux-event-card--health { background-color: rgba(244, 63, 94, 0.1); }
  &--all-day.ux-event-card--social { background-color: rgba(99, 102, 241, 0.1); }
  &--all-day.ux-event-card--other { background-color: rgba(107, 114, 128, 0.1); }

  // ========================================
  // Recurring Event
  // ========================================

  &--recurring .ux-event-card__title::after {
    content: '';
    display: inline-block;
    width: 14px;
    height: 14px;
    margin-left: var(--ux-space-xs);
    vertical-align: middle;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2'%3E%3Cpath d='M17 2.1l4 4-4 4'%3E%3C/path%3E%3Cpath d='M3 12.2v-2a4 4 0 014-4h12.8M7 21.9l-4-4 4-4'%3E%3C/path%3E%3Cpath d='M21 11.8v2a4 4 0 01-4 4H4.2'%3E%3C/path%3E%3C/svg%3E");
    background-size: contain;
    background-repeat: no-repeat;
    opacity: 0.6;
  }

  // ========================================
  // Clickable
  // ========================================

  &--clickable {
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;

    &:active {
      transform: scale(0.98);
    }
  }

  // ========================================
  // Past Event
  // ========================================

  &--past {
    opacity: 0.6;

    &::before {
      opacity: 0.5;
    }
  }

  // ========================================
  // Cancelled Event
  // ========================================

  &--cancelled {
    opacity: 0.5;

    .ux-event-card__title {
      text-decoration: line-through;
      color: var(--ux-text-secondary);
    }
  }

  // ========================================
  // Glass Variant
  // ========================================

  &--glass {
    box-shadow: var(--ux-glass-shadow), var(--ux-glass-highlight);
    border: 0.5px solid var(--ux-glass-border);

    &::before {
      background-color: var(--ux-event-category-color, var(--ux-primary));
    }

    &:hover {
      box-shadow: var(--ux-glass-shadow), var(--ux-glass-highlight), 0 8px 32px rgba(0, 0, 0, 0.1);
    }

    .ux-event-card__footer {
      border-top-color: var(--ux-glass-border);
    }

    .ux-event-card__duration,
    .ux-event-card__indicator,
    .ux-event-card__attendees-more {
      background: var(--ux-glass-bg-thin);
    }
  }

  // ========================================
  // Outline Variant
  // ========================================

  &--outline {
    box-shadow: none;
    border: 1px solid var(--ux-border-color);

    &:hover {
      box-shadow: var(--ux-shadow-sm);
      border-color: var(--ux-event-category-color, var(--ux-primary));
    }
  }

  // ========================================
  // Size Variants
  // ========================================

  &--sm {
    .ux-event-card__header {
      padding: var(--ux-space-sm) var(--ux-space-sm) var(--ux-space-xs);
      padding-left: calc(var(--ux-space-sm) + 6px);
    }

    .ux-event-card__content {
      padding: 0 var(--ux-space-sm) var(--ux-space-sm);
      padding-left: calc(var(--ux-space-sm) + 6px);
    }

    .ux-event-card__title {
      font-size: var(--ux-font-size-sm);
    }

    .ux-event-card__description {
      font-size: var(--ux-font-size-xs);
    }

    &::before {
      width: 3px;
    }
  }

  &--lg {
    .ux-event-card__header {
      padding: var(--ux-space-lg) var(--ux-space-lg) var(--ux-space-md);
      padding-left: calc(var(--ux-space-lg) + 10px);
    }

    .ux-event-card__content {
      padding: 0 var(--ux-space-lg) var(--ux-space-lg);
      padding-left: calc(var(--ux-space-lg) + 10px);
      gap: var(--ux-space-md);
    }

    .ux-event-card__footer {
      padding: var(--ux-space-md) var(--ux-space-lg);
      padding-left: calc(var(--ux-space-lg) + 10px);
    }

    .ux-event-card__title {
      font-size: var(--ux-font-size-lg);
    }

    &::before {
      width: 5px;
    }
  }
}

// ========================================
// Event Card Grid
// ========================================

.ux-event-card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
  gap: var(--ux-space-md);

  .ux-event-card {
    margin: 0;
  }
}

// ========================================
// Event Card List
// ========================================

.ux-event-card-list {
  display: flex;
  flex-direction: column;
  gap: var(--ux-space-sm);

  .ux-event-card {
    margin: 0;
  }
}

// ========================================
// Responsive
// ========================================

@media (max-width: 767px) {
  .ux-event-card-grid {
    grid-template-columns: 1fr;
  }

  .ux-event-card__meta {
    flex-direction: column;
    align-items: flex-start;
    gap: var(--ux-space-xs);
  }

  .ux-event-card__footer {
    flex-wrap: wrap;
  }
}

// ========================================
// Dark Mode
// ========================================

@media (prefers-color-scheme: dark) {
  :root:not(.ux-theme-light):not(.ux-light) {
    .ux-event-card--all-day {
      background-color: rgba(var(--ux-event-category-color-rgb, var(--ux-primary-rgb)), 0.15);
    }

    .ux-event-card__category {
      background-color: rgba(var(--ux-event-category-color-rgb, var(--ux-primary-rgb)), 0.2);
    }

    .ux-event-card--recurring .ux-event-card__title::after {
      filter: invert(1);
      opacity: 0.5;
    }
  }
}

.ux-dark,
.ux-theme-dark {
  .ux-event-card--all-day {
    background-color: rgba(var(--ux-event-category-color-rgb, var(--ux-primary-rgb)), 0.15);
  }

  .ux-event-card__category {
    background-color: rgba(var(--ux-event-category-color-rgb, var(--ux-primary-rgb)), 0.2);
  }

  .ux-event-card--recurring .ux-event-card__title::after {
    filter: invert(1);
    opacity: 0.5;
  }
}

// ========================================
// Reduced Motion
// ========================================

@media (prefers-reduced-motion: reduce) {
  .ux-event-card {
    transition: none;
  }

  .ux-event-card--clickable:active {
    transform: none;
  }
}
