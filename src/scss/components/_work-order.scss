/**
 * UX Work-order Component
 * Part of the UX CSS Library
 * https://github.com/user/ux
 */

/* ==========================================================================
   Work Order Variables
   ========================================================================== */

:root {
  --ux-work-order-width: 360px;
  --ux-work-order-padding: var(--ux-space-md);
  --ux-work-order-border-radius: var(--ux-radius-lg, 12px);
  --ux-work-order-font-family: var(--ux-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif);

  /* Status colors */
  --ux-work-order-pending: var(--ux-gray-500, #6b7280);
  --ux-work-order-pending-bg: rgba(107, 114, 128, 0.1);
  --ux-work-order-in-progress: var(--ux-primary, #3b82f6);
  --ux-work-order-in-progress-bg: rgba(59, 130, 246, 0.1);
  --ux-work-order-completed: var(--ux-success, #22c55e);
  --ux-work-order-completed-bg: rgba(34, 197, 94, 0.1);
  --ux-work-order-on-hold: var(--ux-warning, #f59e0b);
  --ux-work-order-on-hold-bg: rgba(245, 158, 11, 0.1);

  /* Priority colors */
  --ux-work-order-priority-low: var(--ux-gray-400, #9ca3af);
  --ux-work-order-priority-normal: var(--ux-primary, #3b82f6);
  --ux-work-order-priority-high: var(--ux-warning, #f59e0b);
  --ux-work-order-priority-urgent: var(--ux-danger, #ef4444);
}

/* ==========================================================================
   Work Order Container
   ========================================================================== */

.ux-work-order {
  position: relative;
  display: flex;
  flex-direction: column;
  width: var(--ux-work-order-width);
  background-color: var(--ux-surface, #ffffff);
  border-radius: var(--ux-work-order-border-radius);
  box-shadow: var(--ux-shadow-md, 0 4px 6px -1px rgba(0, 0, 0, 0.1));
  overflow: hidden;
  font-family: var(--ux-work-order-font-family);
  transition: box-shadow var(--ux-transition-fast, 150ms) var(--ux-ease, ease);

  &:hover {
    box-shadow: var(--ux-shadow-lg, 0 10px 15px -3px rgba(0, 0, 0, 0.1));
  }

  /* Priority indicator strip */
  &::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    width: 4px;
    background-color: var(--ux-work-order-priority-color, var(--ux-work-order-priority-normal));
  }

  /* ==========================================================================
     Work Order Header
     ========================================================================== */

  &__header {
    display: flex;
    flex-direction: column;
    gap: var(--ux-space-xs, 4px);
    padding: var(--ux-work-order-padding);
    padding-left: calc(var(--ux-work-order-padding) + 8px);
    border-bottom: 1px solid var(--ux-border-color, #e5e7eb);
  }

  &__header-top {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--ux-space-sm, 8px);
  }

  &__number {
    font-size: var(--ux-font-size-lg, 1.125rem);
    font-weight: 700;
    color: var(--ux-text, #111827);
    margin: 0;
    font-variant-numeric: tabular-nums;
  }

  &__status {
    display: inline-flex;
    align-items: center;
    gap: var(--ux-space-xs, 4px);
    padding: 4px 10px;
    border-radius: 9999px;
    font-size: var(--ux-font-size-xs, 0.75rem);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    background-color: var(--ux-work-order-status-bg, var(--ux-work-order-pending-bg));
    color: var(--ux-work-order-status-color, var(--ux-work-order-pending));

    &--pulse &-dot {
      animation: ux-work-order-pulse 1.5s ease-in-out infinite;
    }

    &--pending {
      --ux-work-order-status-bg: var(--ux-work-order-pending-bg);
      --ux-work-order-status-color: var(--ux-work-order-pending);
    }

    &--in-progress {
      --ux-work-order-status-bg: var(--ux-work-order-in-progress-bg);
      --ux-work-order-status-color: var(--ux-work-order-in-progress);
    }

    &--completed {
      --ux-work-order-status-bg: var(--ux-work-order-completed-bg);
      --ux-work-order-status-color: var(--ux-work-order-completed);
    }

    &--on-hold {
      --ux-work-order-status-bg: var(--ux-work-order-on-hold-bg);
      --ux-work-order-status-color: var(--ux-work-order-on-hold);
    }
  }

  &__status-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background-color: currentColor;
  }

  /* Product info */
  &__product {
    display: flex;
    flex-direction: column;
    gap: 2px;
    margin-top: var(--ux-space-xs, 4px);
  }

  &__product-name {
    font-size: var(--ux-font-size-md, 1rem);
    font-weight: 600;
    color: var(--ux-text, #111827);
    line-height: 1.3;
    margin: 0;
  }

  &__product-sku {
    font-size: var(--ux-font-size-xs, 0.75rem);
    font-family: monospace;
    color: var(--ux-text-tertiary, #9ca3af);
  }

  /* ==========================================================================
     Work Order Priority
     ========================================================================== */

  &__priority {
    display: inline-flex;
    align-items: center;
    gap: var(--ux-space-xs, 4px);
    font-size: var(--ux-font-size-xs, 0.75rem);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;

    &--low {
      color: var(--ux-work-order-priority-low);
    }

    &--normal {
      color: var(--ux-work-order-priority-normal);
    }

    &--high {
      color: var(--ux-work-order-priority-high);
    }

    &--urgent {
      color: var(--ux-work-order-priority-urgent);
    }
  }

  &__priority-icon {
    width: 12px;
    height: 12px;

    svg {
      width: 100%;
      height: 100%;
    }
  }

  /* Priority strip variants */
  &--priority-low {
    --ux-work-order-priority-color: var(--ux-work-order-priority-low);
  }

  &--priority-normal {
    --ux-work-order-priority-color: var(--ux-work-order-priority-normal);
  }

  &--priority-high {
    --ux-work-order-priority-color: var(--ux-work-order-priority-high);
  }

  &--priority-urgent {
    --ux-work-order-priority-color: var(--ux-work-order-priority-urgent);
    box-shadow: 0 0 0 2px var(--ux-work-order-priority-urgent),
                var(--ux-shadow-md, 0 4px 6px -1px rgba(0, 0, 0, 0.1));

    &::before {
      animation: ux-work-order-urgent-strip 1.5s ease-in-out infinite;
    }
  }

  /* ==========================================================================
     Work Order Content
     ========================================================================== */

  &__content {
    display: flex;
    flex-direction: column;
    gap: var(--ux-space-md, 16px);
    padding: var(--ux-work-order-padding);
    padding-left: calc(var(--ux-work-order-padding) + 8px);
  }

  /* ==========================================================================
     Quantity Section
     ========================================================================== */

  &__quantities {
    display: flex;
    align-items: center;
    gap: var(--ux-space-lg, 24px);
  }

  &__quantity {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }

  &__quantity-label {
    font-size: var(--ux-font-size-xs, 0.75rem);
    color: var(--ux-text-tertiary, #9ca3af);
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  &__quantity-value {
    font-size: var(--ux-font-size-xl, 1.25rem);
    font-weight: 700;
    color: var(--ux-text, #111827);
    font-variant-numeric: tabular-nums;

    &--completed {
      color: var(--ux-success, #22c55e);
    }

    &--remaining {
      color: var(--ux-text-secondary, #6b7280);
    }
  }

  /* ==========================================================================
     Progress Section
     ========================================================================== */

  &__progress {
    display: flex;
    flex-direction: column;
    gap: var(--ux-space-xs, 4px);
  }

  &__progress-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  &__progress-label {
    font-size: var(--ux-font-size-sm, 0.875rem);
    color: var(--ux-text-secondary, #6b7280);
  }

  &__progress-value {
    font-size: var(--ux-font-size-sm, 0.875rem);
    font-weight: 600;
    color: var(--ux-text, #111827);
    font-variant-numeric: tabular-nums;
  }

  &__progress-bar {
    width: 100%;
    height: 8px;
    background-color: var(--ux-light, #f3f4f6);
    border-radius: 4px;
    overflow: hidden;
  }

  &__progress-fill {
    height: 100%;
    background-color: var(--ux-primary, #3b82f6);
    border-radius: 4px;
    transition: width var(--ux-transition-normal, 200ms) var(--ux-ease, ease);

    &--success {
      background-color: var(--ux-success, #22c55e);
    }

    &--warning {
      background-color: var(--ux-warning, #f59e0b);
    }
  }

  /* ==========================================================================
     Due Date Section
     ========================================================================== */

  &__due-date {
    display: flex;
    align-items: center;
    gap: var(--ux-space-xs, 4px);
    font-size: var(--ux-font-size-sm, 0.875rem);
    color: var(--ux-text-secondary, #6b7280);

    &--overdue {
      color: var(--ux-danger, #ef4444);
      font-weight: 600;

      .ux-work-order__due-date-icon {
        opacity: 1;
      }
    }

    &--warning {
      color: var(--ux-warning, #f59e0b);
      font-weight: 500;

      .ux-work-order__due-date-icon {
        opacity: 1;
      }
    }
  }

  &__due-date-icon {
    width: 14px;
    height: 14px;
    opacity: 0.7;

    svg {
      width: 100%;
      height: 100%;
    }
  }

  /* ==========================================================================
     Machine/Workstation Section
     ========================================================================== */

  &__machine {
    display: flex;
    align-items: center;
    gap: var(--ux-space-xs, 4px);
    font-size: var(--ux-font-size-sm, 0.875rem);
    color: var(--ux-text-secondary, #6b7280);
  }

  &__machine-icon {
    width: 14px;
    height: 14px;
    opacity: 0.7;

    svg {
      width: 100%;
      height: 100%;
    }
  }

  &__machine-name {
    font-weight: 500;
    color: var(--ux-text, #111827);
  }

  /* ==========================================================================
     Materials/BOM Section
     ========================================================================== */

  &__materials {
    display: flex;
    flex-direction: column;
    gap: var(--ux-space-xs, 4px);
  }

  &__materials-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: var(--ux-font-size-sm, 0.875rem);
    font-weight: 600;
    color: var(--ux-text, #111827);
  }

  &__materials-count {
    font-size: var(--ux-font-size-xs, 0.75rem);
    color: var(--ux-text-tertiary, #9ca3af);
    font-weight: 400;
  }

  &__materials-list {
    display: flex;
    flex-direction: column;
    gap: var(--ux-space-xs, 4px);
    padding: 0;
    margin: 0;
    list-style: none;
  }

  &__material {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--ux-space-xs, 4px) var(--ux-space-sm, 8px);
    background-color: var(--ux-surface-secondary, #f9fafb);
    border-radius: var(--ux-border-radius, 6px);
    font-size: var(--ux-font-size-sm, 0.875rem);

    &--shortage {
      background-color: rgba(239, 68, 68, 0.1);

      .ux-work-order__material-qty {
        color: var(--ux-danger, #ef4444);
        font-weight: 600;
      }
    }
  }

  &__material-name {
    color: var(--ux-text, #111827);
  }

  &__material-qty {
    color: var(--ux-text-secondary, #6b7280);
    font-variant-numeric: tabular-nums;
  }

  /* ==========================================================================
     Meta Section (row of metadata items)
     ========================================================================== */

  &__meta {
    display: flex;
    flex-wrap: wrap;
    gap: var(--ux-space-md, 16px);
  }

  &__meta-item {
    display: flex;
    align-items: center;
    gap: var(--ux-space-xs, 4px);
    font-size: var(--ux-font-size-sm, 0.875rem);
    color: var(--ux-text-secondary, #6b7280);
  }

  &__meta-icon {
    width: 14px;
    height: 14px;
    opacity: 0.7;

    svg {
      width: 100%;
      height: 100%;
    }
  }

  /* ==========================================================================
     Actions Section
     ========================================================================== */

  &__actions {
    display: flex;
    align-items: center;
    gap: var(--ux-space-sm, 8px);
    padding: var(--ux-work-order-padding);
    padding-left: calc(var(--ux-work-order-padding) + 8px);
    border-top: 1px solid var(--ux-border-color, #e5e7eb);
  }

  &__action {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--ux-space-xs, 4px);
    padding: var(--ux-space-sm, 8px) var(--ux-space-md, 16px);
    border: none;
    border-radius: 8px;
    font-size: var(--ux-font-size-sm, 0.875rem);
    font-weight: 600;
    cursor: pointer;
    transition: all var(--ux-transition-fast, 150ms) var(--ux-ease, ease);
    -webkit-tap-highlight-color: transparent;

    &--start {
      background-color: var(--ux-primary, #3b82f6);
      color: white;

      &:hover {
        background-color: var(--ux-primary-shade, #2563eb);
      }
    }

    &--pause {
      background-color: var(--ux-warning, #f59e0b);
      color: white;

      &:hover {
        background-color: var(--ux-warning-shade, #d97706);
      }
    }

    &--complete {
      background-color: var(--ux-success, #22c55e);
      color: white;

      &:hover {
        background-color: var(--ux-success-shade, #16a34a);
      }
    }

    &--secondary {
      background-color: var(--ux-surface-tertiary, #e5e7eb);
      color: var(--ux-text, #111827);

      &:hover {
        background-color: var(--ux-border-color, #d1d5db);
      }
    }

    &:active {
      transform: scale(0.98);
    }

    &:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }
  }

  &__action-icon {
    width: 16px;
    height: 16px;

    svg {
      width: 100%;
      height: 100%;
    }
  }

  /* ==========================================================================
     Compact Variant
     ========================================================================== */

  &--compact {
    --ux-work-order-padding: var(--ux-space-sm, 8px);

    .ux-work-order__number {
      font-size: var(--ux-font-size-md, 1rem);
    }

    .ux-work-order__product-name {
      font-size: var(--ux-font-size-sm, 0.875rem);
    }

    .ux-work-order__quantities {
      gap: var(--ux-space-md, 16px);
    }

    .ux-work-order__quantity-value {
      font-size: var(--ux-font-size-lg, 1.125rem);
    }

    .ux-work-order__materials {
      display: none;
    }

    .ux-work-order__content {
      gap: var(--ux-space-sm, 8px);
    }
  }

  /* ==========================================================================
     Detailed Variant
     ========================================================================== */

  &--detailed {
    --ux-work-order-width: 420px;

    .ux-work-order__header {
      background-color: var(--ux-surface-secondary, #f9fafb);
    }
  }

  /* ==========================================================================
     Full Width
     ========================================================================== */

  &--full {
    --ux-work-order-width: 100%;
  }

  /* ==========================================================================
     Glass Variant (iOS 26 Liquid Glass)
     ========================================================================== */

  &--glass {
    box-shadow: var(--ux-glass-shadow, 0 8px 32px rgba(0, 0, 0, 0.08)),
                var(--ux-glass-highlight, inset 0 1px 0 rgba(255, 255, 255, 0.5));
    border: 0.5px solid var(--ux-glass-border, rgba(255, 255, 255, 0.18));

    .ux-work-order__header {
      background: var(--ux-glass-bg-thin, rgba(255, 255, 255, 0.5));
      border-bottom-color: var(--ux-glass-border, rgba(255, 255, 255, 0.18));
    }

    .ux-work-order__actions {
      background: var(--ux-glass-bg-thin, rgba(255, 255, 255, 0.5));
      border-top-color: var(--ux-glass-border, rgba(255, 255, 255, 0.18));
    }

    .ux-work-order__material {
      background: var(--ux-glass-bg-thin, rgba(255, 255, 255, 0.5));
    }

    .ux-work-order__progress-bar {
      background: var(--ux-glass-bg-thin, rgba(255, 255, 255, 0.5));
    }
  }
}

@keyframes ux-work-order-pulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.5; transform: scale(1.2); }
}

@keyframes ux-work-order-urgent-strip {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* ==========================================================================
   Work Order Grid
   ========================================================================== */

.ux-work-order-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(var(--ux-work-order-width), 1fr));
  gap: var(--ux-space-lg, 24px);
  padding: var(--ux-space-md, 16px);

  .ux-work-order {
    width: 100%;
  }
}

/* Kanban-style columns */
.ux-work-order-column {
  display: flex;
  flex-direction: column;
  gap: var(--ux-space-md, 16px);
  min-width: var(--ux-work-order-width);
  padding: var(--ux-space-md, 16px);
  background-color: var(--ux-surface-secondary, #f9fafb);
  border-radius: var(--ux-border-radius-lg, 12px);

  &__header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--ux-space-sm, 8px);
    font-size: var(--ux-font-size-sm, 0.875rem);
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: var(--ux-text-secondary, #6b7280);
  }

  &__count {
    display: flex;
    align-items: center;
    justify-content: center;
    min-width: 24px;
    height: 24px;
    padding: 0 8px;
    border-radius: 12px;
    font-size: var(--ux-font-size-xs, 0.75rem);
    font-weight: 700;
    background-color: var(--ux-surface-tertiary, #e5e7eb);
    color: var(--ux-text, #111827);
  }
}

/* ==========================================================================
   Dark Mode
   ========================================================================== */

@media (prefers-color-scheme: dark) {
  :root:not(.ux-light):not(.ux-theme-light) {
    --ux-work-order-pending-bg: rgba(107, 114, 128, 0.2);
    --ux-work-order-in-progress-bg: rgba(59, 130, 246, 0.2);
    --ux-work-order-completed-bg: rgba(34, 197, 94, 0.2);
    --ux-work-order-on-hold-bg: rgba(245, 158, 11, 0.2);
  }

  :root:not(.ux-light):not(.ux-theme-light) .ux-work-order__material {
    background-color: var(--ux-gray-800, #1f2937);
  }

  :root:not(.ux-light):not(.ux-theme-light) .ux-work-order__action--secondary {
    background-color: var(--ux-gray-700, #374151);
    color: var(--ux-gray-100, #f3f4f6);

    &:hover {
      background-color: var(--ux-gray-600, #4b5563);
    }
  }

  :root:not(.ux-light):not(.ux-theme-light) .ux-work-order-column {
    background-color: var(--ux-gray-800, #1f2937);
  }

  :root:not(.ux-light):not(.ux-theme-light) .ux-work-order-column__count {
    background-color: var(--ux-gray-700, #374151);
    color: var(--ux-gray-100, #f3f4f6);
  }

  :root:not(.ux-light):not(.ux-theme-light) .ux-work-order__progress-bar {
    background-color: var(--ux-gray-700, #374151);
  }
}

.ux-dark .ux-work-order__material,
.ux-theme-dark .ux-work-order__material {
  background-color: var(--ux-gray-800, #1f2937);
}

.ux-dark .ux-work-order__action--secondary,
.ux-theme-dark .ux-work-order__action--secondary {
  background-color: var(--ux-gray-700, #374151);
  color: var(--ux-gray-100, #f3f4f6);

  &:hover {
    background-color: var(--ux-gray-600, #4b5563);
  }
}

.ux-dark .ux-work-order-column,
.ux-theme-dark .ux-work-order-column {
  background-color: var(--ux-gray-800, #1f2937);
}

.ux-dark .ux-work-order-column__count,
.ux-theme-dark .ux-work-order-column__count {
  background-color: var(--ux-gray-700, #374151);
  color: var(--ux-gray-100, #f3f4f6);
}

.ux-dark .ux-work-order__progress-bar,
.ux-theme-dark .ux-work-order__progress-bar {
  background-color: var(--ux-gray-700, #374151);
}

/* ==========================================================================
   Reduced Motion
   ========================================================================== */

@media (prefers-reduced-motion: reduce) {
  .ux-work-order,
  .ux-work-order__action,
  .ux-work-order__progress-fill {
    transition: none;
  }

  .ux-work-order__status--pulse .ux-work-order__status-dot,
  .ux-work-order--priority-urgent::before {
    animation: none;
  }
}
