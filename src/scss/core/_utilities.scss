/**
 * UX Utilities
 * Utility classes for common styling patterns
 * Part of the UX CSS Library
 */

@use 'mixins' as *;

// ==========================================================
// CSS Reset
// ==========================================================

*, *::before, *::after {
  box-sizing: border-box;
}

* {
  margin: 0;
  padding: 0;
}

html {
  -webkit-text-size-adjust: 100%;
  -webkit-tap-highlight-color: transparent;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  touch-action: manipulation;
}

body {
  font-family: var(--ux-font-family);
  font-size: var(--ux-font-size-base);
  line-height: 1.5;
  color: var(--ux-text);
  background-color: var(--ux-background);
  min-height: 100dvh;
}

// Prevent zoom on input focus (iOS)
input, select, textarea {
  font-size: 16px;
}

// ==========================================================
// Visibility
// ==========================================================

.ux-sr-only {
  @include sr-only;
}

.ux-hidden {
  display: none !important;
}

.ux-invisible {
  visibility: hidden !important;
}

// Responsive visibility
@media (max-width: 575px) {
  .ux-hidden-xs { display: none !important; }
  .ux-visible-xs { display: block !important; }
  .ux-visible-xs-flex { display: flex !important; }
}

@media (min-width: 576px) and (max-width: 767px) {
  .ux-hidden-sm { display: none !important; }
  .ux-visible-sm { display: block !important; }
  .ux-visible-sm-flex { display: flex !important; }
}

@media (min-width: 768px) and (max-width: 991px) {
  .ux-hidden-md { display: none !important; }
  .ux-visible-md { display: block !important; }
  .ux-visible-md-flex { display: flex !important; }
}

@media (min-width: 992px) and (max-width: 1199px) {
  .ux-hidden-lg { display: none !important; }
  .ux-visible-lg { display: block !important; }
  .ux-visible-lg-flex { display: flex !important; }
}

@media (min-width: 1200px) {
  .ux-hidden-xl { display: none !important; }
  .ux-visible-xl { display: block !important; }
  .ux-visible-xl-flex { display: flex !important; }
}

// Mobile/Desktop shortcuts
@include mobile {
  .ux-desktop-only { display: none !important; }
}

@include desktop {
  .ux-mobile-only { display: none !important; }
}

// ==========================================================
// Display
// ==========================================================

.ux-block { display: block; }
.ux-inline { display: inline; }
.ux-inline-block { display: inline-block; }
.ux-flex { display: flex; }
.ux-inline-flex { display: inline-flex; }
.ux-grid { display: grid; }

// ==========================================================
// Flexbox
// ==========================================================

.ux-flex-col { flex-direction: column; }
.ux-flex-row { flex-direction: row; }
.ux-flex-wrap { flex-wrap: wrap; }
.ux-flex-nowrap { flex-wrap: nowrap; }

.ux-items-start { align-items: flex-start; }
.ux-items-center { align-items: center; }
.ux-items-end { align-items: flex-end; }
.ux-items-stretch { align-items: stretch; }

.ux-justify-start { justify-content: flex-start; }
.ux-justify-center { justify-content: center; }
.ux-justify-end { justify-content: flex-end; }
.ux-justify-between { justify-content: space-between; }
.ux-justify-around { justify-content: space-around; }

.ux-flex-1 { flex: 1; }
.ux-flex-auto { flex: auto; }
.ux-flex-none { flex: none; }

// Gap
.ux-gap-0 { gap: 0; }
.ux-gap-xs { gap: var(--ux-space-xs); }
.ux-gap-sm { gap: var(--ux-space-sm); }
.ux-gap-md { gap: var(--ux-space-md); }
.ux-gap-lg { gap: var(--ux-space-lg); }
.ux-gap-xl { gap: var(--ux-space-xl); }

// ==========================================================
// Spacing
// ==========================================================

// Padding
.ux-p-0 { padding: 0; }
.ux-p-xs { padding: var(--ux-space-xs); }
.ux-p-sm { padding: var(--ux-space-sm); }
.ux-p-md { padding: var(--ux-space-md); }
.ux-p-lg { padding: var(--ux-space-lg); }
.ux-p-xl { padding: var(--ux-space-xl); }

.ux-px-0 { padding-left: 0; padding-right: 0; }
.ux-px-sm { padding-left: var(--ux-space-sm); padding-right: var(--ux-space-sm); }
.ux-px-md { padding-left: var(--ux-space-md); padding-right: var(--ux-space-md); }
.ux-px-lg { padding-left: var(--ux-space-lg); padding-right: var(--ux-space-lg); }

.ux-py-0 { padding-top: 0; padding-bottom: 0; }
.ux-py-sm { padding-top: var(--ux-space-sm); padding-bottom: var(--ux-space-sm); }
.ux-py-md { padding-top: var(--ux-space-md); padding-bottom: var(--ux-space-md); }
.ux-py-lg { padding-top: var(--ux-space-lg); padding-bottom: var(--ux-space-lg); }

// Margin
.ux-m-0 { margin: 0; }
.ux-m-xs { margin: var(--ux-space-xs); }
.ux-m-sm { margin: var(--ux-space-sm); }
.ux-m-md { margin: var(--ux-space-md); }
.ux-m-lg { margin: var(--ux-space-lg); }
.ux-m-xl { margin: var(--ux-space-xl); }
.ux-m-auto { margin: auto; }

.ux-mx-auto { margin-left: auto; margin-right: auto; }
.ux-my-auto { margin-top: auto; margin-bottom: auto; }

.ux-mt-0 { margin-top: 0; }
.ux-mt-xs { margin-top: var(--ux-space-xs); }
.ux-mt-sm { margin-top: var(--ux-space-sm); }
.ux-mt-md { margin-top: var(--ux-space-md); }
.ux-mt-lg { margin-top: var(--ux-space-lg); }
.ux-mt-xl { margin-top: var(--ux-space-xl); }

.ux-mb-0 { margin-bottom: 0; }
.ux-mb-xs { margin-bottom: var(--ux-space-xs); }
.ux-mb-sm { margin-bottom: var(--ux-space-sm); }
.ux-mb-md { margin-bottom: var(--ux-space-md); }
.ux-mb-lg { margin-bottom: var(--ux-space-lg); }
.ux-mb-xl { margin-bottom: var(--ux-space-xl); }

.ux-ml-0 { margin-left: 0; }
.ux-ml-auto { margin-left: auto; }
.ux-mr-0 { margin-right: 0; }
.ux-mr-auto { margin-right: auto; }

// ==========================================================
// Typography
// ==========================================================

.ux-text-xs { font-size: var(--ux-font-size-xs); }
.ux-text-sm { font-size: var(--ux-font-size-sm); }
.ux-text-base { font-size: var(--ux-font-size-base); }
.ux-text-md { font-size: var(--ux-font-size-md); }
.ux-text-lg { font-size: var(--ux-font-size-lg); }
.ux-text-xl { font-size: var(--ux-font-size-xl); }
.ux-text-2xl { font-size: var(--ux-font-size-2xl); }
.ux-text-3xl { font-size: var(--ux-font-size-3xl); }

.ux-text-left { text-align: left; }
.ux-text-center { text-align: center; }
.ux-text-right { text-align: right; }

.ux-font-normal { font-weight: 400; }
.ux-font-medium { font-weight: 500; }
.ux-font-semibold { font-weight: 600; }
.ux-font-bold { font-weight: 700; }

.ux-text-primary { color: var(--ux-primary); }
.ux-text-secondary { color: var(--ux-text-secondary); }
.ux-text-muted { color: var(--ux-text-muted); }
.ux-text-success { color: var(--ux-success); }
.ux-text-warning { color: var(--ux-warning); }
.ux-text-danger { color: var(--ux-danger); }

.ux-text-truncate {
  @include truncate;
}

.ux-line-clamp-2 {
  @include line-clamp(2);
}

.ux-line-clamp-3 {
  @include line-clamp(3);
}

// ==========================================================
// Sizing
// ==========================================================

.ux-w-full { width: 100%; }
.ux-w-auto { width: auto; }
.ux-h-full { height: 100%; }
.ux-h-auto { height: auto; }
.ux-h-screen { height: 100vh; height: 100dvh; }
.ux-min-h-screen { min-height: 100vh; min-height: 100dvh; }

// ==========================================================
// Positioning
// ==========================================================

.ux-relative { position: relative; }
.ux-absolute { position: absolute; }
.ux-fixed { position: fixed; }
.ux-sticky { position: sticky; top: 0; }

.ux-inset-0 { top: 0; right: 0; bottom: 0; left: 0; }
.ux-top-0 { top: 0; }
.ux-right-0 { right: 0; }
.ux-bottom-0 { bottom: 0; }
.ux-left-0 { left: 0; }

// ==========================================================
// Overflow
// ==========================================================

.ux-overflow-hidden { overflow: hidden; }
.ux-overflow-auto { overflow: auto; }
.ux-overflow-scroll { overflow: scroll; }
.ux-overflow-visible { overflow: visible; }
.ux-overflow-x-auto { overflow-x: auto; }
.ux-overflow-y-auto { overflow-y: auto; }
.ux-overflow-x-hidden { overflow-x: hidden; }
.ux-overflow-y-hidden { overflow-y: hidden; }

.ux-scrollbar-none {
  @include hide-scrollbar;
}

.ux-scrollbar-thin {
  @include thin-scrollbar;
}

// ==========================================================
// Border Radius
// ==========================================================

.ux-rounded-none { border-radius: 0; }
.ux-rounded-sm { border-radius: var(--ux-border-radius-sm); }
.ux-rounded { border-radius: var(--ux-border-radius); }
.ux-rounded-md { border-radius: var(--ux-border-radius-md); }
.ux-rounded-lg { border-radius: var(--ux-border-radius-lg); }
.ux-rounded-xl { border-radius: var(--ux-border-radius-xl); }
.ux-rounded-full { border-radius: 9999px; }

// ==========================================================
// Shadows
// ==========================================================

.ux-shadow-none { box-shadow: none; }
.ux-shadow-sm { box-shadow: var(--ux-shadow-sm); }
.ux-shadow-md { box-shadow: var(--ux-shadow-md); }
.ux-shadow-lg { box-shadow: var(--ux-shadow-lg); }
.ux-shadow-xl { box-shadow: var(--ux-shadow-xl); }

// ==========================================================
// Interactive States
// ==========================================================

.ux-disabled {
  @include disabled;
}

.ux-loading {
  pointer-events: none;
  cursor: wait;
}

.ux-clickable {
  cursor: pointer;
}

.ux-select-none {
  user-select: none;
  -webkit-user-select: none;
}

.ux-select-text {
  user-select: text;
  -webkit-user-select: text;
}

.ux-pointer-none {
  pointer-events: none;
}

.ux-pointer-auto {
  pointer-events: auto;
}

// ==========================================================
// Focus
// ==========================================================

.ux-focus-visible {
  @include focus-visible;
}

.ux-focus-ring {
  @include focus-ring;
}

// ==========================================================
// Safe Areas
// ==========================================================

.ux-safe-top { padding-top: var(--ux-safe-top); }
.ux-safe-bottom { padding-bottom: var(--ux-safe-bottom); }
.ux-safe-left { padding-left: var(--ux-safe-left); }
.ux-safe-right { padding-right: var(--ux-safe-right); }
.ux-safe-all {
  padding-top: var(--ux-safe-top);
  padding-right: var(--ux-safe-right);
  padding-bottom: var(--ux-safe-bottom);
  padding-left: var(--ux-safe-left);
}

// ==========================================================
// State Utilities (Animated)
// ==========================================================

.ux-state-hidden {
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transition: var(--ux-transition-fade);
}

.ux-state-visible {
  opacity: 1;
  visibility: visible;
  pointer-events: auto;
  transition: var(--ux-transition-fade);
}

.ux-state-hidden--fast,
.ux-state-visible--fast {
  transition-duration: var(--ux-transition-fast);
}

.ux-state-hidden--slow,
.ux-state-visible--slow {
  transition-duration: var(--ux-transition-slow);
}

// ==========================================================
// Backdrop
// ==========================================================

.ux-backdrop {
  @include fixed-fill;
  background: var(--ux-backdrop-color);
  z-index: var(--ux-z-modal-backdrop);
}

.ux-backdrop--blur {
  backdrop-filter: blur(4px);
  -webkit-backdrop-filter: blur(4px);
}

.ux-backdrop--heavy {
  background: var(--ux-backdrop-color-heavy);
}

.ux-backdrop--light {
  background: var(--ux-backdrop-color-light);
}

// ==========================================================
// Scroll Lock
// ==========================================================

.ux-scroll-locked {
  overflow: hidden !important;
  position: fixed !important;
  width: 100% !important;
  height: 100% !important;
}

// ==========================================================
// Touch Effects
// ==========================================================

.ux-tap {
  @include touch-feedback;
}

.ux-ripple {
  @include ripple;
}

// ==========================================================
// iFrame
// ==========================================================

.ux-frame {
  flex: 1;
  width: 100%;
  height: 100%;
  border: none;
  min-height: 0;
}

// ==========================================================
// Scroll Container
// ==========================================================

.ux-scroll {
  overflow-y: auto;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: contain;
}

// ==========================================================
// Accessibility Utilities
// ==========================================================

// Enhanced focus ring for Windows/keyboard navigation
.ux-focus-ring-enhanced {
  &:focus {
    outline: none;
  }

  &:focus-visible {
    outline: var(--ux-focus-ring-width) var(--ux-focus-ring-style) var(--ux-focus-ring-color);
    outline-offset: var(--ux-focus-ring-offset);
    box-shadow: 0 0 0 calc(var(--ux-focus-ring-width) + var(--ux-focus-ring-offset)) rgba(var(--ux-primary-rgb), 0.25);
  }
}

// Skip link for keyboard navigation
.ux-skip-link {
  @include sr-only;

  &:focus {
    position: fixed;
    top: var(--ux-space-sm);
    left: var(--ux-space-sm);
    z-index: calc(var(--ux-z-toast) + 100);
    width: auto;
    height: auto;
    padding: var(--ux-space-sm) var(--ux-space-lg);
    clip: auto;
    white-space: normal;
    background: var(--ux-surface);
    color: var(--ux-text);
    border: 2px solid var(--ux-primary);
    border-radius: var(--ux-border-radius);
    box-shadow: var(--ux-shadow-lg);
    font-weight: 600;
  }
}

// Live region for screen reader announcements
.ux-live-region {
  @include sr-only;
}

// Minimum touch target utility
.ux-touch-target {
  min-width: var(--ux-min-touch-target);
  min-height: var(--ux-min-touch-target);
}

.ux-touch-target-sm {
  min-width: var(--ux-min-touch-target-sm);
  min-height: var(--ux-min-touch-target-sm);
}

// High contrast mode support
@media (forced-colors: active) {
  .ux-button,
  .ux-input,
  .ux-toggle,
  .ux-checkbox,
  .ux-radio {
    forced-color-adjust: none;
  }
}

// ==========================================================
// Windows Scrollbar Support
// ==========================================================

// Standard scrollbar for all platforms
* {
  scrollbar-width: thin;
  scrollbar-color: var(--ux-scrollbar-thumb) transparent;
}

*::-webkit-scrollbar {
  width: 12px;
  height: 12px;
}

*::-webkit-scrollbar-track {
  background: transparent;
}

*::-webkit-scrollbar-thumb {
  background-color: var(--ux-scrollbar-thumb);
  border-radius: 6px;
  border: 3px solid transparent;
  background-clip: content-box;

  &:hover {
    background-color: var(--ux-scrollbar-thumb-hover);
  }
}

// ==========================================================
// Print Utilities
// ==========================================================

@media print {
  .ux-no-print {
    display: none !important;
  }

  .ux-print-only {
    display: block !important;
  }

  // Reset backgrounds for print
  body {
    background: white !important;
    color: black !important;
  }

  .ux-button,
  .ux-card,
  .ux-modal {
    box-shadow: none !important;
    border: 1px solid #ccc !important;
  }
}

// ==========================================================
// Universal Glass Selector (iOS 26 Liquid Glass)
// ==========================================================

// Any class containing "--glass" automatically inherits glass morphism
[class*="--glass"] {
  background: var(--ux-glass-bg);
  backdrop-filter: blur(var(--ux-glass-blur)) saturate(var(--ux-glass-saturation));
  -webkit-backdrop-filter: blur(var(--ux-glass-blur)) saturate(var(--ux-glass-saturation));
  border-color: var(--ux-glass-border);
}
