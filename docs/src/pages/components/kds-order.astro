---
import DocsLayout from '../../layouts/DocsLayout.astro';
import CodePreview from '../../components/CodePreview.astro';
---

<DocsLayout title="KDS Order">
  <p class="text-base-content/70 mb-6">Kitchen Display System order cards for restaurant/food service operations. Status-coded cards with elapsed timers, item lists, and action buttons for kitchen workflow management.</p>

  <CodePreview
    title="Pending Order"
    semantic={`<div class="kds-order kds-order-pending" style="max-width: 320px;">
  <div class="kds-order-header">
    <div>
      <div class="kds-order-id">#057</div>
      <div class="kds-order-table">Table 4 - ERPlora Cafe</div>
    </div>
    <div class="kds-order-time">
      <div class="kds-order-elapsed">3:42</div>
      <div class="kds-order-started">14:18</div>
    </div>
  </div>
  <div class="kds-order-body">
    <ul class="kds-order-items">
      <li class="kds-order-item">
        <span class="kds-order-item-qty">2</span>
        <div class="kds-order-item-details">
          <div class="kds-order-item-name">Grilled Chicken Wrap</div>
          <div class="kds-order-item-notes">No onions</div>
        </div>
        <span class="kds-order-item-status kds-order-item-status-pending"></span>
      </li>
      <li class="kds-order-item">
        <span class="kds-order-item-qty">1</span>
        <div class="kds-order-item-details">
          <div class="kds-order-item-name">Caesar Salad</div>
          <div class="kds-order-item-notes">Dressing on side</div>
        </div>
        <span class="kds-order-item-status kds-order-item-status-pending"></span>
      </li>
      <li class="kds-order-item">
        <span class="kds-order-item-qty">2</span>
        <div class="kds-order-item-details">
          <div class="kds-order-item-name">Sparkling Water</div>
        </div>
        <span class="kds-order-item-status kds-order-item-status-pending"></span>
      </li>
    </ul>
  </div>
  <div class="kds-order-footer">
    <button class="kds-order-action kds-order-action-secondary">Recall</button>
    <button class="kds-order-action kds-order-action-primary">Start</button>
  </div>
</div>`}
    tailwind={`<div class="overflow-hidden cursor-pointer max-w-xs bg-base-100 rounded-box border-3 border-warning hover:-translate-y-0.5 hover:shadow-lg transition-all">
  <div class="flex justify-between items-start p-4 pb-3 border-b-2 border-warning mb-3">
    <div>
      <div class="text-xl font-bold">#057</div>
      <div class="text-sm text-base-content/60 mt-1">Table 4 - ERPlora Cafe</div>
    </div>
    <div class="text-right">
      <div class="font-bold text-2xl text-warning">3:42</div>
      <div class="text-xs text-base-content/40">14:18</div>
    </div>
  </div>
  <div class="px-4">
    <ul class="list-none m-0 p-0">
      <li class="flex items-start gap-2 py-2 border-b border-base-300">
        <span class="flex items-center justify-center font-bold text-sm shrink-0 w-7 h-7 bg-base-200 rounded">2</span>
        <div class="flex-1 min-w-0">
          <div class="font-semibold">Grilled Chicken Wrap</div>
          <div class="text-xs italic text-warning">No onions</div>
        </div>
        <span class="shrink-0 rounded-full w-2.5 h-2.5 mt-2 bg-warning"></span>
      </li>
      <li class="flex items-start gap-2 py-2 border-b border-base-300">
        <span class="flex items-center justify-center font-bold text-sm shrink-0 w-7 h-7 bg-base-200 rounded">1</span>
        <div class="flex-1 min-w-0">
          <div class="font-semibold">Caesar Salad</div>
          <div class="text-xs italic text-warning">Dressing on side</div>
        </div>
        <span class="shrink-0 rounded-full w-2.5 h-2.5 mt-2 bg-warning"></span>
      </li>
      <li class="flex items-start gap-2 py-2">
        <span class="flex items-center justify-center font-bold text-sm shrink-0 w-7 h-7 bg-base-200 rounded">2</span>
        <div class="flex-1 min-w-0">
          <div class="font-semibold">Sparkling Water</div>
        </div>
        <span class="shrink-0 rounded-full w-2.5 h-2.5 mt-2 bg-warning"></span>
      </li>
    </ul>
  </div>
  <div class="flex gap-2 p-4 pt-3 border-t border-base-300 mt-3">
    <button class="flex-1 flex items-center justify-center gap-2 font-semibold text-sm py-3 rounded bg-base-200 hover:bg-base-300">Recall</button>
    <button class="flex-1 flex items-center justify-center gap-2 font-semibold text-sm py-3 rounded bg-warning text-white hover:brightness-110">Start</button>
  </div>
</div>`}
    js={`// Transition order from pending to preparing
function startOrder(orderEl) {
  orderEl.classList.remove('kds-order-pending');
  orderEl.classList.add('kds-order-preparing');
}

// Action button handler
document.querySelectorAll('.kds-order-action-primary').forEach(btn => {
  btn.addEventListener('click', () => {
    const order = btn.closest('.kds-order');
    startOrder(order);
    btn.textContent = 'Ready';
  });
});`}
  />

  <CodePreview
    title="Status Variants"
    semantic={`<div class="flex gap-4 flex-wrap">
  <!-- Preparing -->
  <div class="kds-order kds-order-preparing" style="max-width: 260px;">
    <div class="kds-order-header">
      <div>
        <div class="kds-order-id">#058</div>
        <div class="kds-order-table">Bar - ERPlora</div>
      </div>
      <div class="kds-order-time">
        <div class="kds-order-elapsed">5:12</div>
        <div class="kds-order-started">14:15</div>
      </div>
    </div>
    <div class="kds-order-body">
      <ul class="kds-order-items">
        <li class="kds-order-item">
          <span class="kds-order-item-qty">1</span>
          <div class="kds-order-item-details">
            <div class="kds-order-item-name">Ribeye Steak</div>
            <div class="kds-order-item-station">Grill Station</div>
          </div>
          <span class="kds-order-item-status kds-order-item-status-preparing"></span>
        </li>
        <li class="kds-order-item">
          <span class="kds-order-item-qty">1</span>
          <div class="kds-order-item-details">
            <div class="kds-order-item-name">Fries</div>
          </div>
          <span class="kds-order-item-status kds-order-item-status-ready"></span>
        </li>
      </ul>
    </div>
    <div class="kds-order-footer">
      <button class="kds-order-action kds-order-action-primary">Ready</button>
    </div>
  </div>

  <!-- Ready -->
  <div class="kds-order kds-order-ready" style="max-width: 260px;">
    <div class="kds-order-header">
      <div>
        <div class="kds-order-id">#055</div>
        <div class="kds-order-table">Table 7</div>
      </div>
      <div class="kds-order-time">
        <div class="kds-order-elapsed">8:30</div>
        <div class="kds-order-started">14:12</div>
      </div>
    </div>
    <div class="kds-order-body">
      <ul class="kds-order-items">
        <li class="kds-order-item">
          <span class="kds-order-item-qty">2</span>
          <div class="kds-order-item-details">
            <div class="kds-order-item-name">Margherita Pizza</div>
          </div>
          <span class="kds-order-item-status kds-order-item-status-ready"></span>
        </li>
      </ul>
    </div>
    <div class="kds-order-footer">
      <button class="kds-order-action kds-order-action-primary">Bump</button>
    </div>
  </div>

  <!-- Completed -->
  <div class="kds-order kds-order-completed" style="max-width: 260px;">
    <div class="kds-order-header">
      <div>
        <div class="kds-order-id">#052</div>
        <div class="kds-order-table">Table 2</div>
      </div>
      <div class="kds-order-time">
        <div class="kds-order-elapsed">12:05</div>
        <div class="kds-order-started">14:08</div>
      </div>
    </div>
    <div class="kds-order-body">
      <ul class="kds-order-items">
        <li class="kds-order-item">
          <span class="kds-order-item-qty">1</span>
          <div class="kds-order-item-details">
            <div class="kds-order-item-name">Fish & Chips</div>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>`}
    tailwind={`<!-- Status is controlled by modifier classes on .kds-order:
  .kds-order-pending   → warning (yellow) border
  .kds-order-preparing → info (blue) border + pulsing item dots
  .kds-order-ready     → success (green) border
  .kds-order-completed → muted border + reduced opacity
  .kds-order-alert     → error (red) border + pulse animation

Each variant sets --kds-status-color which cascades to header border and elapsed time color -->`}
    js={`// Status lifecycle: pending → preparing → ready → completed
function advanceStatus(orderEl) {
  const statuses = ['pending', 'preparing', 'ready', 'completed'];
  const current = statuses.find(s => orderEl.classList.contains('kds-order-' + s));
  const idx = statuses.indexOf(current);
  if (idx < statuses.length - 1) {
    orderEl.classList.remove('kds-order-' + current);
    orderEl.classList.add('kds-order-' + statuses[idx + 1]);
  }
}`}
  />

  <CodePreview
    title="Alert & Priority"
    semantic={`<div class="kds-order kds-order-alert kds-order-priority-high" style="max-width: 320px;">
  <span class="kds-order-priority">RUSH</span>
  <div class="kds-order-header">
    <div>
      <div class="kds-order-id">#061</div>
      <div class="kds-order-table">Table 1 - ERPlora VIP</div>
    </div>
    <div class="kds-order-time">
      <div class="kds-order-elapsed">11:20</div>
      <div class="kds-order-started">14:09</div>
    </div>
  </div>
  <div class="kds-order-body">
    <ul class="kds-order-items">
      <li class="kds-order-item">
        <span class="kds-order-item-qty">1</span>
        <div class="kds-order-item-details">
          <div class="kds-order-item-name">Lobster Risotto</div>
          <div class="kds-order-item-notes">Extra truffle oil</div>
          <div class="kds-order-item-station">Main Kitchen</div>
        </div>
        <span class="kds-order-item-status kds-order-item-status-preparing"></span>
      </li>
      <li class="kds-order-item">
        <span class="kds-order-item-qty">2</span>
        <div class="kds-order-item-details">
          <div class="kds-order-item-name">Wagyu Burger</div>
          <div class="kds-order-item-notes">Medium rare</div>
          <div class="kds-order-item-station">Grill Station</div>
        </div>
        <span class="kds-order-item-status kds-order-item-status-pending"></span>
      </li>
      <li class="kds-order-item">
        <span class="kds-order-item-qty">2</span>
        <div class="kds-order-item-details">
          <div class="kds-order-item-name">Truffle Fries</div>
        </div>
        <span class="kds-order-item-status kds-order-item-status-ready"></span>
      </li>
    </ul>
  </div>
  <div class="kds-order-footer">
    <button class="kds-order-action kds-order-action-secondary">Recall</button>
    <button class="kds-order-action kds-order-action-primary">Bump All</button>
  </div>
</div>`}
    tailwind={`<!-- .kds-order-alert adds:
  - Red border via --kds-status-color: var(--color-error)
  - Subtle red background tint
  - Pulsing box-shadow animation (kds-pulse)

.kds-order-priority-high + .kds-order-priority creates:
  - Absolute positioned "RUSH" badge at top-right
  - Red background with white text -->`}
    js={`// Auto-escalate orders past threshold
function checkAlertThreshold(orderEl, maxMinutes = 10) {
  const elapsed = orderEl.querySelector('.kds-order-elapsed');
  const [min] = elapsed.textContent.split(':').map(Number);
  if (min >= maxMinutes) {
    orderEl.classList.add('kds-order-alert');
  }
}

// Run check every 30 seconds
setInterval(() => {
  document.querySelectorAll('.kds-order:not(.kds-order-completed)')
    .forEach(el => checkAlertThreshold(el));
}, 30000);`}
  />

  <CodePreview
    title="Compact Variant"
    semantic={`<div class="flex gap-3 flex-wrap">
  <div class="kds-order kds-order-pending kds-order-compact" style="max-width: 240px;">
    <div class="kds-order-header">
      <div>
        <div class="kds-order-id">#063</div>
        <div class="kds-order-table">Counter</div>
      </div>
      <div class="kds-order-time">
        <div class="kds-order-elapsed">1:15</div>
      </div>
    </div>
    <div class="kds-order-body">
      <ul class="kds-order-items">
        <li class="kds-order-item">
          <span class="kds-order-item-qty">1</span>
          <div class="kds-order-item-details">
            <div class="kds-order-item-name">Latte</div>
          </div>
        </li>
        <li class="kds-order-item">
          <span class="kds-order-item-qty">1</span>
          <div class="kds-order-item-details">
            <div class="kds-order-item-name">Croissant</div>
          </div>
        </li>
      </ul>
    </div>
    <div class="kds-order-footer">
      <button class="kds-order-action kds-order-action-primary">Done</button>
    </div>
  </div>

  <div class="kds-order kds-order-preparing kds-order-compact" style="max-width: 240px;">
    <div class="kds-order-header">
      <div>
        <div class="kds-order-id">#064</div>
        <div class="kds-order-table">Drive-Thru</div>
      </div>
      <div class="kds-order-time">
        <div class="kds-order-elapsed">2:45</div>
      </div>
    </div>
    <div class="kds-order-body">
      <ul class="kds-order-items">
        <li class="kds-order-item">
          <span class="kds-order-item-qty">3</span>
          <div class="kds-order-item-details">
            <div class="kds-order-item-name">Espresso</div>
          </div>
        </li>
      </ul>
    </div>
    <div class="kds-order-footer">
      <button class="kds-order-action kds-order-action-primary">Ready</button>
    </div>
  </div>
</div>`}
    tailwind={`<!-- .kds-order-compact reduces padding and font sizes:
  - Header/body/footer use 0.5rem horizontal padding
  - Order ID becomes text-base (instead of text-xl)
  - Elapsed time becomes text-xl (instead of 1.5rem)
  - Items have 0.25rem vertical padding
  Ideal for high-density KDS displays with many orders -->`}
    js={`// Compact mode toggle for KDS display density
function toggleCompactMode(container) {
  container.querySelectorAll('.kds-order').forEach(order => {
    order.classList.toggle('kds-order-compact');
  });
}`}
  />

  <!-- Classes Reference -->
  <div class="overflow-x-auto mt-12">
    <h2 class="text-xl font-bold mb-4">Classes Reference</h2>
    <table class="table w-full">
      <thead>
        <tr>
          <th>Class</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
        <tr><td><code>kds-order</code></td><td>Base KDS order card with border, hover lift, and press scale</td></tr>
        <tr><td><code>kds-order-pending</code></td><td>Warning (yellow) status color</td></tr>
        <tr><td><code>kds-order-preparing</code></td><td>Info (blue) status color</td></tr>
        <tr><td><code>kds-order-ready</code></td><td>Success (green) status color</td></tr>
        <tr><td><code>kds-order-alert</code></td><td>Error (red) status with pulse animation</td></tr>
        <tr><td><code>kds-order-completed</code></td><td>Muted status with reduced opacity</td></tr>
        <tr><td><code>kds-order-compact</code></td><td>Reduced padding and font sizes for dense layouts</td></tr>
        <tr><td><code>kds-order-priority-high</code></td><td>Enables absolute-positioned priority badge</td></tr>
        <tr><td><code>kds-order-priority</code></td><td>Priority badge element (e.g., "RUSH")</td></tr>
        <tr><td><code>kds-order-bumped</code></td><td>Bump scale animation on order completion</td></tr>
        <tr><td><code>kds-order-header</code></td><td>Header with order ID, table, and timer</td></tr>
        <tr><td><code>kds-order-id</code></td><td>Order number display</td></tr>
        <tr><td><code>kds-order-table</code></td><td>Table/location label</td></tr>
        <tr><td><code>kds-order-time</code></td><td>Timer container (right-aligned)</td></tr>
        <tr><td><code>kds-order-elapsed</code></td><td>Elapsed time display (color matches status)</td></tr>
        <tr><td><code>kds-order-started</code></td><td>Start time label</td></tr>
        <tr><td><code>kds-order-body</code></td><td>Body wrapper for items list</td></tr>
        <tr><td><code>kds-order-items</code></td><td>Unstyled list container</td></tr>
        <tr><td><code>kds-order-item</code></td><td>Single item row with qty, details, and status</td></tr>
        <tr><td><code>kds-order-item-qty</code></td><td>Quantity badge</td></tr>
        <tr><td><code>kds-order-item-details</code></td><td>Item name, notes, and station container</td></tr>
        <tr><td><code>kds-order-item-name</code></td><td>Item name text</td></tr>
        <tr><td><code>kds-order-item-notes</code></td><td>Special instructions (italic, warning color)</td></tr>
        <tr><td><code>kds-order-item-station</code></td><td>Kitchen station label</td></tr>
        <tr><td><code>kds-order-item-status</code></td><td>Status dot indicator</td></tr>
        <tr><td><code>kds-order-item-status-pending</code></td><td>Yellow dot</td></tr>
        <tr><td><code>kds-order-item-status-preparing</code></td><td>Blue pulsing dot</td></tr>
        <tr><td><code>kds-order-item-status-ready</code></td><td>Green dot</td></tr>
        <tr><td><code>kds-order-footer</code></td><td>Footer with action buttons</td></tr>
        <tr><td><code>kds-order-action</code></td><td>Base action button</td></tr>
        <tr><td><code>kds-order-action-primary</code></td><td>Primary action (status-colored background)</td></tr>
        <tr><td><code>kds-order-action-secondary</code></td><td>Secondary action (neutral background)</td></tr>
      </tbody>
    </table>
  </div>
</DocsLayout>
