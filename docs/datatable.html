<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>DataTable - UX Library</title>
  <script src="https://unpkg.com/htmx.org@2.0.4"></script>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="../components/ux-core.js"></script>
  <script src="../components/ux-navbar.js"></script>
  <script src="../components/ux-button.js"></script>
  <script src="../components/ux-badge.js"></script>
  <script src="../components/ux-input.js"></script>
  <script src="../components/ux-searchbar.js"></script>
  <script src="../components/ux-checkbox.js"></script>
  <script src="../components/ux-datatable.js"></script>
  <style>
    .demo-section { margin-bottom: var(--ux-space-xl); padding: var(--ux-space-lg); }
    .demo-section h3 { font-size: var(--ux-font-size-lg); font-weight: 600; margin-bottom: var(--ux-space-md); }
    .demo-section p { font-size: var(--ux-font-size-md); color: var(--ux-text-secondary); margin-bottom: var(--ux-space-md); }
    .demo-box { background: var(--ux-surface); border-radius: var(--ux-border-radius-lg); margin-bottom: var(--ux-space-md); overflow: hidden; }
    .code-block { background: #1a1a2e; color: #e5e5e5; padding: var(--ux-space-md); border-radius: var(--ux-border-radius); font-family: monospace; font-size: var(--ux-font-size-md); overflow-x: auto; white-space: pre; }
  </style>
</head>
<body class="ux-app">

  <!-- Basic DataTable -->
  <div class="demo-section">
    <h3>DataTable Basico</h3>
    <p>Tabla de datos con ordenamiento, paginacion y busqueda. En movil cambia automaticamente a vista "No More Tables".</p>

    <div class="demo-box" x-data="uxDatatable({
      columns: [
        { key: 'id', label: 'ID', sortable: true, type: 'number' },
        { key: 'name', label: 'Nombre', sortable: true },
        { key: 'email', label: 'Email', sortable: true },
        { key: 'role', label: 'Rol', sortable: true },
        { key: 'status', label: 'Estado', sortable: true }
      ],
      rows: [
        { id: 1, name: 'Juan Garcia', email: 'juan@example.com', role: 'Admin', status: 'Activo' },
        { id: 2, name: 'Maria Lopez', email: 'maria@example.com', role: 'Editor', status: 'Activo' },
        { id: 3, name: 'Carlos Rodriguez', email: 'carlos@example.com', role: 'Usuario', status: 'Inactivo' },
        { id: 4, name: 'Ana Martinez', email: 'ana@example.com', role: 'Editor', status: 'Activo' },
        { id: 5, name: 'Pedro Sanchez', email: 'pedro@example.com', role: 'Usuario', status: 'Activo' },
        { id: 6, name: 'Laura Fernandez', email: 'laura@example.com', role: 'Admin', status: 'Activo' },
        { id: 7, name: 'Miguel Torres', email: 'miguel@example.com', role: 'Usuario', status: 'Inactivo' },
        { id: 8, name: 'Sofia Ruiz', email: 'sofia@example.com', role: 'Editor', status: 'Activo' }
      ],
      perPage: 5,
      searchPlaceholder: 'Buscar usuarios...',
      labels: {
        showing: 'Mostrando',
        to: 'a',
        of: 'de',
        entries: 'registros',
        perPage: 'por pagina'
      }
    })" class="ux-datatable ux-datatable--bordered ux-datatable--responsive">

      <!-- Toolbar -->
      <div class="ux-datatable__toolbar">
        <div class="ux-datatable__toolbar-start">
          <span class="ux-text-sm ux-text-secondary" x-text="sortedRows.length + ' usuarios'"></span>
        </div>
        <div class="ux-datatable__toolbar-end">
          <input type="search"
                 class="ux-input ux-datatable__search"
                 :placeholder="searchPlaceholder"
                 x-model="searchQuery"
                 @input.debounce.300ms="onSearch()">
        </div>
      </div>

      <!-- Table Body -->
      <div class="ux-datatable__body">
        <table class="ux-datatable__table" x-bind="ariaAttrs">
          <thead class="ux-datatable__thead">
            <tr>
              <template x-for="col in columns" :key="col.key">
                <th class="ux-datatable__th"
                    :class="{
                      'ux-datatable__th--sortable': col.sortable,
                      'ux-datatable__th--sorted': isSorted(col),
                      'ux-datatable__th--sorted-desc': isSorted(col) && sortDirection === 'desc'
                    }"
                    @click="sortBy(col)">
                  <span x-text="col.label"></span>
                  <span x-show="col.sortable" class="ux-datatable__sort-icon">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M12 5v14M5 12l7-7 7 7"/>
                    </svg>
                  </span>
                </th>
              </template>
            </tr>
          </thead>
          <tbody class="ux-datatable__tbody">
            <template x-if="paginatedRows.length === 0">
              <tr>
                <td :colspan="columns.length" class="ux-datatable__empty">
                  <div class="ux-datatable__empty-icon" x-html="getIcon('empty')"></div>
                  <h4 class="ux-datatable__empty-title" x-text="emptyTitle"></h4>
                  <p class="ux-datatable__empty-text" x-text="emptyText"></p>
                </td>
              </tr>
            </template>
            <template x-for="row in paginatedRows" :key="getRowId(row)">
              <tr class="ux-datatable__tr">
                <template x-for="col in columns" :key="col.key">
                  <td class="ux-datatable__td" :data-label="col.label">
                    <span x-text="formatCellValue(row, col)"></span>
                  </td>
                </template>
              </tr>
            </template>
          </tbody>
        </table>
      </div>

      <!-- Footer -->
      <div class="ux-datatable__footer">
        <div class="ux-datatable__info" x-text="showingInfo"></div>
        <div class="ux-datatable__pagination">
          <button class="ux-datatable__page-btn" @click="goToPage(1)" :disabled="currentPage === 1">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M11 17l-5-5 5-5M18 17l-5-5 5-5"/>
            </svg>
          </button>
          <button class="ux-datatable__page-btn" @click="goToPage(currentPage - 1)" :disabled="currentPage === 1">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M15 18l-6-6 6-6"/>
            </svg>
          </button>
          <template x-for="page in visiblePages" :key="page">
            <button class="ux-datatable__page-btn"
                    :class="{ 'ux-datatable__page-btn--active': page === currentPage }"
                    @click="typeof page === 'number' && goToPage(page)"
                    :disabled="page === '...'"
                    x-text="page">
            </button>
          </template>
          <button class="ux-datatable__page-btn" @click="goToPage(currentPage + 1)" :disabled="currentPage === totalPages">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18l6-6-6-6"/>
            </svg>
          </button>
          <button class="ux-datatable__page-btn" @click="goToPage(totalPages)" :disabled="currentPage === totalPages">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M13 7l5 5-5 5M6 7l5 5-5 5"/>
            </svg>
          </button>
        </div>
      </div>
    </div>

    <pre class="code-block">&lt;div x-data="uxDatatable({
  columns: [
    { key: 'id', label: 'ID', sortable: true, type: 'number' },
    { key: 'name', label: 'Nombre', sortable: true },
    { key: 'email', label: 'Email', sortable: true },
    { key: 'status', label: 'Estado', sortable: true }
  ],
  rows: [...],
  perPage: 10,
  labels: { showing: 'Mostrando', to: 'a', of: 'de', entries: 'registros' }
})" class="ux-datatable ux-datatable--responsive"&gt;
  ...
&lt;/div&gt;</pre>
  </div>

  <!-- With Selection and Actions -->
  <div class="demo-section">
    <h3>Con Seleccion y Acciones</h3>
    <p>Tabla con checkboxes para seleccion multiple y botones de accion por fila.</p>

    <div class="demo-box" x-data="uxDatatable({
      columns: [
        { key: 'name', label: 'Producto', sortable: true },
        { key: 'category', label: 'Categoria', sortable: true },
        { key: 'price', label: 'Precio', sortable: true, type: 'number', format: (v) => '$' + v.toFixed(2) },
        { key: 'stock', label: 'Stock', sortable: true, type: 'number' }
      ],
      rows: [
        { id: 1, name: 'Laptop Pro 15', category: 'Electronica', price: 1299.99, stock: 45 },
        { id: 2, name: 'Mouse Wireless', category: 'Accesorios', price: 29.99, stock: 120 },
        { id: 3, name: 'Teclado Mecanico', category: 'Accesorios', price: 89.99, stock: 78 },
        { id: 4, name: 'Monitor 27\"', category: 'Electronica', price: 399.99, stock: 22 },
        { id: 5, name: 'Webcam HD', category: 'Accesorios', price: 59.99, stock: 95 }
      ],
      selectable: true,
      perPage: 10,
      paginated: false
    })" class="ux-datatable ux-datatable--bordered ux-datatable--responsive" @row-action.window="alert($event.detail.action + ': ' + $event.detail.row.name)">

      <!-- Header -->
      <div class="ux-datatable__header">
        <div>
          <h3 class="ux-datatable__title">Inventario</h3>
          <p class="ux-datatable__subtitle" x-text="selectedRows.length + ' seleccionados'"></p>
        </div>
        <div class="ux-datatable__actions">
          <button class="ux-button ux-button--outline ux-button--sm" :disabled="selectedRows.length === 0">
            Exportar
          </button>
          <button class="ux-button ux-button--primary ux-button--sm">
            Nuevo Producto
          </button>
        </div>
      </div>

      <!-- Table Body -->
      <div class="ux-datatable__body">
        <table class="ux-datatable__table">
          <thead class="ux-datatable__thead">
            <tr>
              <th class="ux-datatable__th ux-datatable__th--checkbox">
                <input type="checkbox" class="ux-checkbox" x-model="selectAll" @change="toggleSelectAll()">
              </th>
              <template x-for="col in columns" :key="col.key">
                <th class="ux-datatable__th"
                    :class="{
                      'ux-datatable__th--sortable': col.sortable,
                      'ux-datatable__th--sorted': isSorted(col),
                      'ux-datatable__th--sorted-desc': isSorted(col) && sortDirection === 'desc'
                    }"
                    @click="sortBy(col)">
                  <span x-text="col.label"></span>
                  <span x-show="col.sortable" class="ux-datatable__sort-icon">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M12 5v14M5 12l7-7 7 7"/>
                    </svg>
                  </span>
                </th>
              </template>
              <th class="ux-datatable__th ux-datatable__th--actions">Acciones</th>
            </tr>
          </thead>
          <tbody class="ux-datatable__tbody">
            <template x-for="row in paginatedRows" :key="getRowId(row)">
              <tr class="ux-datatable__tr" :class="{ 'ux-datatable__tr--selected': isRowSelected(row) }">
                <td class="ux-datatable__td ux-datatable__td--checkbox" data-label="">
                  <input type="checkbox" class="ux-checkbox" :checked="isRowSelected(row)" @change="toggleRowSelection(row)">
                </td>
                <template x-for="col in columns" :key="col.key">
                  <td class="ux-datatable__td" :data-label="col.label">
                    <span x-text="formatCellValue(row, col)"></span>
                  </td>
                </template>
                <td class="ux-datatable__td ux-datatable__td--actions" data-label="">
                  <div class="ux-datatable__row-actions">
                    <button class="ux-datatable__row-action" @click="onAction('edit', row, $event)" title="Editar">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/>
                        <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/>
                      </svg>
                    </button>
                    <button class="ux-datatable__row-action ux-datatable__row-action--danger" @click="onAction('delete', row, $event)" title="Eliminar">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2"/>
                      </svg>
                    </button>
                  </div>
                </td>
              </tr>
            </template>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Force Responsive View -->
  <div class="demo-section">
    <h3>Vista Responsive Forzada</h3>
    <p>La clase <code>ux-datatable--force-responsive</code> muestra siempre la vista movil "No More Tables".</p>

    <div class="demo-box" x-data="uxDatatable({
      columns: [
        { key: 'name', label: 'Cliente', sortable: true },
        { key: 'email', label: 'Email' },
        { key: 'phone', label: 'Telefono' },
        { key: 'company', label: 'Empresa' }
      ],
      rows: [
        { id: 1, name: 'Roberto Diaz', email: 'roberto@empresa.com', phone: '+34 612 345 678', company: 'Tech Corp' },
        { id: 2, name: 'Elena Vega', email: 'elena@startup.io', phone: '+34 623 456 789', company: 'StartUp Inc' },
        { id: 3, name: 'Fernando Gil', email: 'fernando@agency.es', phone: '+34 634 567 890', company: 'Digital Agency' }
      ],
      paginated: false,
      searchable: false
    })" class="ux-datatable ux-datatable--force-responsive" style="padding: var(--ux-space-lg);">

      <div class="ux-datatable__body">
        <table class="ux-datatable__table">
          <thead class="ux-datatable__thead">
            <tr>
              <template x-for="col in columns" :key="col.key">
                <th class="ux-datatable__th" x-text="col.label"></th>
              </template>
            </tr>
          </thead>
          <tbody class="ux-datatable__tbody">
            <template x-for="row in paginatedRows" :key="getRowId(row)">
              <tr class="ux-datatable__tr">
                <template x-for="(col, index) in columns" :key="col.key">
                  <td class="ux-datatable__td"
                      :class="{ 'ux-datatable__td--primary': index === 0 }"
                      :data-label="col.label">
                    <span x-text="formatCellValue(row, col)"></span>
                  </td>
                </template>
              </tr>
            </template>
          </tbody>
        </table>
      </div>
    </div>

    <pre class="code-block">&lt;div class="ux-datatable ux-datatable--force-responsive"&gt;
  &lt;!-- Always shows mobile card view --&gt;
&lt;/div&gt;</pre>
  </div>

  <!-- View Toggle -->
  <div class="demo-section">
    <h3>Toggle Vista Tabla/Tarjetas</h3>
    <p>Botones de cambio de vista para que el usuario elija entre vista de tabla o tarjetas.</p>

    <div class="demo-box" x-data="uxDatatable({
      columns: [
        { key: 'name', label: 'Nombre', sortable: true },
        { key: 'department', label: 'Departamento', sortable: true },
        { key: 'email', label: 'Email' },
        { key: 'location', label: 'Ubicacion' }
      ],
      rows: [
        { id: 1, name: 'Ana Martinez', department: 'Desarrollo', email: 'ana@empresa.com', location: 'Madrid' },
        { id: 2, name: 'Carlos Ruiz', department: 'Diseno', email: 'carlos@empresa.com', location: 'Barcelona' },
        { id: 3, name: 'Elena Torres', department: 'Marketing', email: 'elena@empresa.com', location: 'Valencia' },
        { id: 4, name: 'Miguel Santos', department: 'Desarrollo', email: 'miguel@empresa.com', location: 'Sevilla' },
        { id: 5, name: 'Laura Vega', department: 'RRHH', email: 'laura@empresa.com', location: 'Madrid' }
      ],
      paginated: false,
      showViewToggle: true,
      labels: {
        viewTable: 'Vista tabla',
        viewCards: 'Vista tarjetas'
      }
    })" class="ux-datatable ux-datatable--bordered" :class="viewModeClass">

      <!-- Toolbar with View Toggle -->
      <div class="ux-datatable__toolbar">
        <div class="ux-datatable__toolbar-start">
          <span class="ux-text-sm ux-text-secondary" x-text="rows.length + ' empleados'"></span>
        </div>
        <div class="ux-datatable__toolbar-end">
          <!-- View Toggle Buttons -->
          <div class="ux-datatable__view-toggle" role="group" aria-label="Cambiar vista">
            <button type="button"
                    class="ux-datatable__view-btn"
                    :class="{ 'ux-datatable__view-btn--active': viewMode === 'table' }"
                    @click="setViewMode('table')"
                    :title="labels.viewTable"
                    :aria-pressed="viewMode === 'table'">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <path d="M3 9h18M3 15h18M9 3v18M15 3v18"/>
              </svg>
            </button>
            <button type="button"
                    class="ux-datatable__view-btn"
                    :class="{ 'ux-datatable__view-btn--active': viewMode === 'cards' }"
                    @click="setViewMode('cards')"
                    :title="labels.viewCards"
                    :aria-pressed="viewMode === 'cards'">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="7" height="7" rx="1"/>
                <rect x="14" y="3" width="7" height="7" rx="1"/>
                <rect x="3" y="14" width="7" height="7" rx="1"/>
                <rect x="14" y="14" width="7" height="7" rx="1"/>
              </svg>
            </button>
          </div>

          <input type="search"
                 class="ux-input ux-datatable__search"
                 placeholder="Buscar..."
                 x-model="searchQuery"
                 @input.debounce.300ms="onSearch()">
        </div>
      </div>

      <!-- Table Body -->
      <div class="ux-datatable__body">
        <table class="ux-datatable__table" x-bind="ariaAttrs">
          <thead class="ux-datatable__thead">
            <tr>
              <template x-for="col in columns" :key="col.key">
                <th class="ux-datatable__th"
                    :class="{
                      'ux-datatable__th--sortable': col.sortable,
                      'ux-datatable__th--sorted': isSorted(col),
                      'ux-datatable__th--sorted-desc': isSorted(col) && sortDirection === 'desc'
                    }"
                    @click="sortBy(col)">
                  <span x-text="col.label"></span>
                  <span x-show="col.sortable" class="ux-datatable__sort-icon">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M12 5v14M5 12l7-7 7 7"/>
                    </svg>
                  </span>
                </th>
              </template>
            </tr>
          </thead>
          <tbody class="ux-datatable__tbody">
            <template x-for="row in paginatedRows" :key="getRowId(row)">
              <tr class="ux-datatable__tr">
                <template x-for="(col, index) in columns" :key="col.key">
                  <td class="ux-datatable__td"
                      :class="{ 'ux-datatable__td--primary': index === 0 }"
                      :data-label="col.label">
                    <span x-text="formatCellValue(row, col)"></span>
                  </td>
                </template>
              </tr>
            </template>
          </tbody>
        </table>
      </div>
    </div>

    <pre class="code-block">&lt;div x-data="uxDatatable({
  columns: [...],
  rows: [...],
  showViewToggle: true,
  labels: {
    viewTable: 'Vista tabla',
    viewCards: 'Vista tarjetas'
  }
})" class="ux-datatable" :class="viewModeClass"&gt;

  &lt;!-- View Toggle Buttons --&gt;
  &lt;div class="ux-datatable__view-toggle"&gt;
    &lt;button class="ux-datatable__view-btn"
            :class="{ 'ux-datatable__view-btn--active': viewMode === 'table' }"
            @click="setViewMode('table')"&gt;
      &lt;!-- Table icon --&gt;
    &lt;/button&gt;
    &lt;button class="ux-datatable__view-btn"
            :class="{ 'ux-datatable__view-btn--active': viewMode === 'cards' }"
            @click="setViewMode('cards')"&gt;
      &lt;!-- Cards icon --&gt;
    &lt;/button&gt;
  &lt;/div&gt;

  ...
&lt;/div&gt;</pre>
  </div>

  <!-- Column Filters and Bulk Actions -->
  <div class="demo-section">
    <h3>Filtros por Columna y Acciones Masivas</h3>
    <p>Tabla con filtros por columna (texto, select) y barra de acciones masivas cuando hay filas seleccionadas.</p>

    <div class="demo-box" x-data="uxDatatable({
      columns: [
        { key: 'name', label: 'Nombre', sortable: true, filterable: true },
        { key: 'department', label: 'Departamento', sortable: true, filterable: true, filterType: 'select' },
        { key: 'status', label: 'Estado', sortable: true, filterable: true, filterType: 'select' },
        { key: 'salary', label: 'Salario', sortable: true, type: 'number', format: (v) => '$' + v.toLocaleString() }
      ],
      rows: [
        { id: 1, name: 'Ana Martinez', department: 'Desarrollo', status: 'Activo', salary: 55000 },
        { id: 2, name: 'Carlos Ruiz', department: 'Diseno', status: 'Activo', salary: 48000 },
        { id: 3, name: 'Elena Torres', department: 'Marketing', status: 'Inactivo', salary: 52000 },
        { id: 4, name: 'Miguel Santos', department: 'Desarrollo', status: 'Activo', salary: 62000 },
        { id: 5, name: 'Laura Vega', department: 'RRHH', status: 'Activo', salary: 45000 },
        { id: 6, name: 'Pedro Garcia', department: 'Desarrollo', status: 'Vacaciones', salary: 58000 },
        { id: 7, name: 'Sofia Lopez', department: 'Marketing', status: 'Activo', salary: 50000 },
        { id: 8, name: 'Diego Fernandez', department: 'Diseno', status: 'Inactivo', salary: 47000 }
      ],
      selectable: true,
      filterable: true,
      showFilters: true,
      perPage: 10,
      paginated: false,
      bulkActions: [
        { key: 'export', label: 'Exportar', icon: 'export' },
        { key: 'delete', label: 'Eliminar', icon: 'delete', danger: true }
      ],
      labels: {
        selected: 'seleccionados',
        clearSelection: 'Limpiar seleccion',
        clearFilters: 'Limpiar filtros',
        all: 'Todos'
      }
    })" class="ux-datatable ux-datatable--bordered ux-datatable--responsive"
       @bulk-action.window="alert($event.detail.action + ': ' + $event.detail.selectedRows.length + ' filas')">

      <!-- Bulk Actions Toolbar (shown when rows selected) -->
      <template x-if="selectedRows.length > 0">
        <div class="ux-datatable__bulk-toolbar">
          <div class="ux-datatable__bulk-info">
            <span class="ux-datatable__bulk-count" x-text="selectedRows.length"></span>
            <span x-text="labels.selected"></span>
          </div>
          <div class="ux-datatable__bulk-actions">
            <button type="button" class="ux-datatable__bulk-btn" @click="onBulkAction('export', $event)">
              <span x-html="getIcon('export')"></span>
              Exportar
            </button>
            <button type="button" class="ux-datatable__bulk-btn ux-datatable__bulk-btn--danger" @click="onBulkAction('delete', $event)">
              <span x-html="getIcon('delete')"></span>
              Eliminar
            </button>
            <button type="button" class="ux-datatable__bulk-clear" @click="clearSelection()" :title="labels.clearSelection">
              <span x-html="getIcon('close')"></span>
            </button>
          </div>
        </div>
      </template>

      <!-- Regular Toolbar (shown when no rows selected) -->
      <template x-if="selectedRows.length === 0">
        <div class="ux-datatable__toolbar">
          <div class="ux-datatable__toolbar-start">
            <span class="ux-text-sm ux-text-secondary" x-text="filteredRows.length + ' empleados'"></span>
            <button type="button" class="ux-button ux-button--outline ux-button--sm" @click="toggleFilters()">
              <span x-html="getIcon('filter')"></span>
              Filtros
            </button>
          </div>
          <div class="ux-datatable__toolbar-end">
            <input type="search"
                   class="ux-input ux-datatable__search"
                   placeholder="Buscar..."
                   x-model="searchQuery"
                   @input.debounce.300ms="onSearch()">
          </div>
        </div>
      </template>

      <!-- Active Filters Tags -->
      <template x-if="hasActiveFilters">
        <div class="ux-datatable__active-filters">
          <template x-for="filter in activeFiltersList" :key="filter.key">
            <span class="ux-datatable__filter-tag">
              <span class="ux-datatable__filter-tag-label" x-text="filter.label + ':'"></span>
              <span x-text="filter.value"></span>
              <button type="button" class="ux-datatable__filter-tag-remove" @click="clearColumnFilter(filter.key)">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
              </button>
            </span>
          </template>
          <button type="button" class="ux-datatable__clear-filters" @click="clearAllFilters()" x-text="labels.clearFilters"></button>
        </div>
      </template>

      <!-- Table Body -->
      <div class="ux-datatable__body">
        <table class="ux-datatable__table">
          <thead class="ux-datatable__thead">
            <tr>
              <th class="ux-datatable__th ux-datatable__th--checkbox">
                <input type="checkbox" class="ux-checkbox" x-model="selectAll" @change="toggleSelectAll()">
              </th>
              <template x-for="col in columns" :key="col.key">
                <th class="ux-datatable__th"
                    :class="{
                      'ux-datatable__th--sortable': col.sortable,
                      'ux-datatable__th--sorted': isSorted(col),
                      'ux-datatable__th--sorted-desc': isSorted(col) && sortDirection === 'desc'
                    }"
                    @click="sortBy(col)">
                  <span x-text="col.label"></span>
                  <span x-show="col.sortable" class="ux-datatable__sort-icon">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M12 5v14M5 12l7-7 7 7"/>
                    </svg>
                  </span>
                </th>
              </template>
            </tr>
            <!-- Filter Row -->
            <tr class="ux-datatable__filters" x-show="showFilters && filterable">
              <td class="ux-datatable__filter-cell"></td>
              <template x-for="col in columns" :key="'filter-' + col.key">
                <td class="ux-datatable__filter-cell">
                  <template x-if="col.filterable !== false">
                    <!-- Select filter -->
                    <template x-if="col.filterType === 'select'">
                      <select class="ux-datatable__filter-select"
                              x-model="columnFilters[col.key]"
                              @change="setColumnFilter(col.key, $event.target.value)">
                        <option value="" x-text="labels.all"></option>
                        <template x-for="opt in getUniqueValues(col.key)" :key="opt">
                          <option :value="opt" x-text="opt"></option>
                        </template>
                      </select>
                    </template>
                    <!-- Text filter (default) -->
                    <template x-if="col.filterType !== 'select' && col.filterType !== 'date-range'">
                      <div class="ux-datatable__filter-wrapper">
                        <input type="text"
                               class="ux-datatable__filter-input"
                               :placeholder="labels.filterBy + '...'"
                               x-model="columnFilters[col.key]"
                               @input.debounce.300ms="setColumnFilter(col.key, $event.target.value)">
                      </div>
                    </template>
                  </template>
                </td>
              </template>
            </tr>
          </thead>
          <tbody class="ux-datatable__tbody">
            <template x-if="paginatedRows.length === 0">
              <tr>
                <td :colspan="columns.length + 1" class="ux-datatable__empty">
                  <div class="ux-datatable__empty-icon" x-html="getIcon('empty')"></div>
                  <h4 class="ux-datatable__empty-title" x-text="emptyTitle"></h4>
                  <p class="ux-datatable__empty-text" x-text="emptyText"></p>
                </td>
              </tr>
            </template>
            <template x-for="row in paginatedRows" :key="getRowId(row)">
              <tr class="ux-datatable__tr" :class="{ 'ux-datatable__tr--selected': isRowSelected(row) }">
                <td class="ux-datatable__td ux-datatable__td--checkbox" data-label="">
                  <input type="checkbox" class="ux-checkbox" :checked="isRowSelected(row)" @change="toggleRowSelection(row)">
                </td>
                <template x-for="col in columns" :key="col.key">
                  <td class="ux-datatable__td" :data-label="col.label">
                    <span x-text="formatCellValue(row, col)"></span>
                  </td>
                </template>
              </tr>
            </template>
          </tbody>
        </table>
      </div>
    </div>

    <pre class="code-block">&lt;div x-data="uxDatatable({
  columns: [
    { key: 'name', label: 'Nombre', filterable: true },
    { key: 'department', label: 'Depto', filterType: 'select' },
    { key: 'status', label: 'Estado', filterType: 'select' }
  ],
  rows: [...],
  selectable: true,
  filterable: true,
  showFilters: true
})"&gt;
  &lt;!-- Bulk Actions Toolbar --&gt;
  &lt;template x-if="selectedRows.length &gt; 0"&gt;
    &lt;div class="ux-datatable__bulk-toolbar"&gt;
      &lt;div class="ux-datatable__bulk-info"&gt;
        &lt;span class="ux-datatable__bulk-count" x-text="selectedRows.length"&gt;&lt;/span&gt;
        seleccionados
      &lt;/div&gt;
      &lt;div class="ux-datatable__bulk-actions"&gt;
        &lt;button @click="onBulkAction('export')"&gt;Exportar&lt;/button&gt;
        &lt;button @click="onBulkAction('delete')"&gt;Eliminar&lt;/button&gt;
        &lt;button @click="clearSelection()"&gt;&times;&lt;/button&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/template&gt;

  &lt;!-- Filter Row in thead --&gt;
  &lt;tr class="ux-datatable__filters" x-show="showFilters"&gt;
    &lt;td class="ux-datatable__filter-cell"&gt;
      &lt;select x-model="columnFilters[col.key]"&gt;...&lt;/select&gt;
    &lt;/td&gt;
  &lt;/tr&gt;
&lt;/div&gt;</pre>
  </div>

  <!-- With Custom Cell Rendering -->
  <div class="demo-section">
    <h3>Con Badges y Formato Personalizado</h3>
    <p>Uso de badges y formato personalizado en celdas.</p>

    <div class="demo-box" x-data="{
      ...uxDatatable({
        columns: [
          { key: 'id', label: '#', type: 'number' },
          { key: 'title', label: 'Pedido' },
          { key: 'customer', label: 'Cliente' },
          { key: 'amount', label: 'Total', type: 'number' },
          { key: 'status', label: 'Estado' },
          { key: 'date', label: 'Fecha', type: 'date' }
        ],
        rows: [
          { id: 1001, title: 'Pedido #1001', customer: 'Juan Garcia', amount: 299.99, status: 'completed', date: '2024-01-15' },
          { id: 1002, title: 'Pedido #1002', customer: 'Maria Lopez', amount: 149.50, status: 'pending', date: '2024-01-16' },
          { id: 1003, title: 'Pedido #1003', customer: 'Carlos Ruiz', amount: 599.00, status: 'processing', date: '2024-01-16' },
          { id: 1004, title: 'Pedido #1004', customer: 'Ana Torres', amount: 89.99, status: 'cancelled', date: '2024-01-17' }
        ],
        paginated: false
      }),
      getStatusClass(status) {
        const classes = {
          'completed': 'ux-badge--success',
          'pending': 'ux-badge--warning',
          'processing': 'ux-badge--primary',
          'cancelled': 'ux-badge--danger'
        };
        return classes[status] || 'ux-badge--secondary';
      },
      getStatusLabel(status) {
        const labels = {
          'completed': 'Completado',
          'pending': 'Pendiente',
          'processing': 'Procesando',
          'cancelled': 'Cancelado'
        };
        return labels[status] || status;
      },
      formatAmount(amount) {
        return new Intl.NumberFormat('es-ES', { style: 'currency', currency: 'EUR' }).format(amount);
      },
      formatDate(date) {
        return new Date(date).toLocaleDateString('es-ES', { day: '2-digit', month: 'short', year: 'numeric' });
      }
    }" class="ux-datatable ux-datatable--bordered ux-datatable--striped ux-datatable--responsive">

      <div class="ux-datatable__body">
        <table class="ux-datatable__table">
          <thead class="ux-datatable__thead">
            <tr>
              <th class="ux-datatable__th">#</th>
              <th class="ux-datatable__th">Pedido</th>
              <th class="ux-datatable__th">Cliente</th>
              <th class="ux-datatable__th ux-datatable__th--right">Total</th>
              <th class="ux-datatable__th ux-datatable__th--center">Estado</th>
              <th class="ux-datatable__th">Fecha</th>
            </tr>
          </thead>
          <tbody class="ux-datatable__tbody">
            <template x-for="row in rows" :key="row.id">
              <tr class="ux-datatable__tr ux-datatable__tr--clickable" @click="onRowClick(row, $event)">
                <td class="ux-datatable__td" data-label="#">
                  <span class="ux-text-secondary" x-text="row.id"></span>
                </td>
                <td class="ux-datatable__td ux-datatable__td--primary" data-label="Pedido">
                  <strong x-text="row.title"></strong>
                </td>
                <td class="ux-datatable__td" data-label="Cliente" x-text="row.customer"></td>
                <td class="ux-datatable__td ux-datatable__td--right" data-label="Total">
                  <strong x-text="formatAmount(row.amount)"></strong>
                </td>
                <td class="ux-datatable__td ux-datatable__td--center" data-label="Estado">
                  <span class="ux-badge ux-badge--soft" :class="getStatusClass(row.status)" x-text="getStatusLabel(row.status)"></span>
                </td>
                <td class="ux-datatable__td" data-label="Fecha" x-text="formatDate(row.date)"></td>
              </tr>
            </template>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Compact Size -->
  <div class="demo-section">
    <h3>Tamano Compacto</h3>
    <p>Tabla con padding reducido para mostrar mas datos.</p>

    <div class="demo-box" x-data="uxDatatable({
      columns: [
        { key: 'code', label: 'Codigo' },
        { key: 'name', label: 'Nombre' },
        { key: 'qty', label: 'Cant.', type: 'number' },
        { key: 'price', label: 'Precio', type: 'number' }
      ],
      rows: [
        { code: 'SKU001', name: 'Articulo A', qty: 10, price: 25.00 },
        { code: 'SKU002', name: 'Articulo B', qty: 5, price: 35.00 },
        { code: 'SKU003', name: 'Articulo C', qty: 20, price: 15.00 },
        { code: 'SKU004', name: 'Articulo D', qty: 8, price: 45.00 },
        { code: 'SKU005', name: 'Articulo E', qty: 15, price: 20.00 }
      ],
      paginated: false
    })" class="ux-datatable ux-datatable--bordered ux-datatable--compact ux-datatable--responsive">

      <div class="ux-datatable__body">
        <table class="ux-datatable__table">
          <thead class="ux-datatable__thead">
            <tr>
              <template x-for="col in columns" :key="col.key">
                <th class="ux-datatable__th" x-text="col.label"></th>
              </template>
            </tr>
          </thead>
          <tbody class="ux-datatable__tbody">
            <template x-for="row in rows" :key="row.code">
              <tr class="ux-datatable__tr">
                <template x-for="col in columns" :key="col.key">
                  <td class="ux-datatable__td" :data-label="col.label" x-text="formatCellValue(row, col)"></td>
                </template>
              </tr>
            </template>
          </tbody>
        </table>
      </div>
    </div>

    <pre class="code-block">&lt;div class="ux-datatable ux-datatable--compact"&gt;...&lt;/div&gt;</pre>
  </div>

  <!-- Alpine.js Component -->
  <div class="demo-section">
    <h3>Componente Alpine.js</h3>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">// Configuracion del componente uxDatatable
uxDatatable({
  // Columnas
  columns: [
    {
      key: 'name',           // Clave del campo en los datos
      label: 'Nombre',       // Etiqueta visible (para i18n)
      sortable: true,        // Permitir ordenar
      type: 'string',        // Tipo: string, number, date
      format: (val) => val,  // Funcion de formato
      getValue: (row) => row.name, // Funcion para obtener valor
      defaultValue: '-'      // Valor por defecto si es null
    }
  ],

  // Datos
  rows: [...],              // Array de objetos

  // Seleccion
  selectable: false,        // Habilitar checkboxes

  // Ordenamiento
  sortable: true,           // Habilitar ordenamiento
  sortColumn: null,         // Columna inicial
  sortDirection: 'asc',     // Direccion inicial

  // Paginacion
  paginated: true,          // Habilitar paginacion
  perPage: 10,              // Registros por pagina
  perPageOptions: [10, 25, 50, 100],

  // Busqueda
  searchable: true,         // Habilitar busqueda
  searchPlaceholder: 'Buscar...',

  // Responsive
  responsive: true,         // Vista movil automatica
  forceResponsive: false,   // Forzar vista movil

  // Vista manual
  viewMode: 'table',        // 'table' o 'cards'
  showViewToggle: false,    // Mostrar botones de toggle

  // Estados
  loading: false,           // Mostrar cargando
  emptyTitle: 'Sin datos',
  emptyText: 'No hay registros',

  // Labels (i18n)
  labels: {
    showing: 'Mostrando',
    to: 'a',
    of: 'de',
    entries: 'registros',
    perPage: 'por pagina',
    viewTable: 'Vista tabla',
    viewCards: 'Vista tarjetas'
  }
})

// Propiedades reactivas:
filteredRows      // Filas filtradas por busqueda
sortedRows        // Filas ordenadas
paginatedRows     // Filas de la pagina actual
totalPages        // Total de paginas
selectedRows      // IDs de filas seleccionadas

// Metodos:
sortBy(column)              // Ordenar por columna
goToPage(page)              // Ir a pagina
setViewMode(mode)           // Cambiar vista ('table'/'cards')
toggleSelectAll()           // Seleccionar todas
toggleRowSelection(row)     // Seleccionar fila
isRowSelected(row)          // Verificar seleccion
getCellValue(row, col)      // Obtener valor
formatCellValue(row, col)   // Formatear valor

// Eventos emitidos:
@sort-change                // { column, direction }
@page-change                // { page }
@per-page-change            // { perPage }
@search                     // { query }
@view-mode-change           // { mode }
@selection-change           // { selected }
@row-click                  // { row, event }
@row-action                 // { action, row, event }</pre>
    </div>
  </div>

  <!-- HTMX Integration -->
  <div class="demo-section">
    <h3>Integracion con HTMX</h3>
    <p>HTMX es la tecnologia principal para cargar y manipular datos de tablas desde el servidor.</p>

    <h4 style="margin-top: var(--ux-space-lg); font-size: var(--ux-font-size-md);">Cargar datos al iniciar</h4>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">&lt;!-- Tabla que carga datos al cargar la pagina --&gt;
&lt;table class="ux-datatable__table"&gt;
  &lt;thead class="ux-datatable__thead"&gt;
    &lt;tr&gt;
      &lt;th class="ux-datatable__th"&gt;ID&lt;/th&gt;
      &lt;th class="ux-datatable__th"&gt;Nombre&lt;/th&gt;
      &lt;th class="ux-datatable__th"&gt;Email&lt;/th&gt;
      &lt;th class="ux-datatable__th"&gt;Estado&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody id="users-body"
         hx-get="/api/users"
         hx-trigger="load"
         hx-indicator="#loading-indicator"&gt;
    &lt;tr&gt;
      &lt;td colspan="4"&gt;
        &lt;div id="loading-indicator" class="htmx-indicator ux-spinner"&gt;&lt;/div&gt;
        Cargando...
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;!-- Respuesta del servidor --&gt;
&lt;tr class="ux-datatable__tr"&gt;
  &lt;td class="ux-datatable__td"&gt;1&lt;/td&gt;
  &lt;td class="ux-datatable__td"&gt;Juan Garcia&lt;/td&gt;
  &lt;td class="ux-datatable__td"&gt;juan@email.com&lt;/td&gt;
  &lt;td class="ux-datatable__td"&gt;
    &lt;span class="ux-badge ux-color-success"&gt;Activo&lt;/span&gt;
  &lt;/td&gt;
&lt;/tr&gt;
...</pre>
    </div>

    <h4 style="margin-top: var(--ux-space-xl); font-size: var(--ux-font-size-md);">Ordenamiento en servidor</h4>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">&lt;!-- Headers con ordenamiento via HTMX --&gt;
&lt;thead class="ux-datatable__thead"&gt;
  &lt;tr&gt;
    &lt;th class="ux-datatable__th ux-datatable__th--sortable"
        hx-get="/api/users?sort=name&amp;dir=asc"
        hx-target="#users-body"
        hx-swap="innerHTML"
        hx-indicator="#sort-spinner"&gt;
      Nombre
      &lt;span class="ux-datatable__sort-icon"&gt;...&lt;/span&gt;
    &lt;/th&gt;
    &lt;th class="ux-datatable__th ux-datatable__th--sortable"
        hx-get="/api/users?sort=email&amp;dir=asc"
        hx-target="#users-body"&gt;
      Email
      &lt;span class="ux-datatable__sort-icon"&gt;...&lt;/span&gt;
    &lt;/th&gt;
    &lt;th class="ux-datatable__th ux-datatable__th--sortable"
        hx-get="/api/users?sort=created_at&amp;dir=desc"
        hx-target="#users-body"&gt;
      Fecha
    &lt;/th&gt;
  &lt;/tr&gt;
&lt;/thead&gt;</pre>
    </div>

    <h4 style="margin-top: var(--ux-space-xl); font-size: var(--ux-font-size-md);">Busqueda en servidor</h4>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">&lt;!-- Barra de busqueda con HTMX --&gt;
&lt;div class="ux-datatable__toolbar"&gt;
  &lt;div class="ux-datatable__toolbar-end"&gt;
    &lt;input type="search"
           class="ux-input ux-datatable__search"
           name="q"
           placeholder="Buscar usuarios..."
           hx-get="/api/users/search"
           hx-trigger="input changed delay:300ms, search"
           hx-target="#users-body"
           hx-indicator="#search-spinner"&gt;
    &lt;span id="search-spinner" class="htmx-indicator ux-spinner ux-spinner--sm"&gt;&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
    </div>

    <h4 style="margin-top: var(--ux-space-xl); font-size: var(--ux-font-size-md);">Paginacion en servidor</h4>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">&lt;!-- Footer con paginacion HTMX --&gt;
&lt;div class="ux-datatable__footer"&gt;
  &lt;div class="ux-datatable__info"&gt;Mostrando 1-10 de 100&lt;/div&gt;
  &lt;div class="ux-datatable__pagination"&gt;
    &lt;button class="ux-datatable__page-btn"
            hx-get="/api/users?page=1"
            hx-target="#users-body"&gt;
      1
    &lt;/button&gt;
    &lt;button class="ux-datatable__page-btn ux-datatable__page-btn--active"
            hx-get="/api/users?page=2"
            hx-target="#users-body"&gt;
      2
    &lt;/button&gt;
    &lt;button class="ux-datatable__page-btn"
            hx-get="/api/users?page=3"
            hx-target="#users-body"&gt;
      3
    &lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Servidor devuelve filas + actualiza paginacion OOB --&gt;
&lt;tr class="ux-datatable__tr"&gt;...fila 11...&lt;/tr&gt;
&lt;tr class="ux-datatable__tr"&gt;...fila 12...&lt;/tr&gt;
...
&lt;div id="pagination" hx-swap-oob="true"&gt;
  &lt;!-- Paginacion actualizada --&gt;
&lt;/div&gt;</pre>
    </div>

    <h4 style="margin-top: var(--ux-space-xl); font-size: var(--ux-font-size-md);">Editar fila inline</h4>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">&lt;!-- Click para editar fila --&gt;
&lt;tr class="ux-datatable__tr" id="user-row-123"&gt;
  &lt;td class="ux-datatable__td"&gt;Juan Garcia&lt;/td&gt;
  &lt;td class="ux-datatable__td"&gt;juan@email.com&lt;/td&gt;
  &lt;td class="ux-datatable__td"&gt;
    &lt;button class="ux-datatable__row-action"
            hx-get="/api/users/123/edit"
            hx-target="#user-row-123"
            hx-swap="outerHTML"&gt;
      Editar
    &lt;/button&gt;
  &lt;/td&gt;
&lt;/tr&gt;

&lt;!-- Servidor devuelve fila en modo edicion --&gt;
&lt;tr class="ux-datatable__tr ux-datatable__tr--editing" id="user-row-123"&gt;
  &lt;td class="ux-datatable__td"&gt;
    &lt;input type="text" name="name" value="Juan Garcia" class="ux-input"&gt;
  &lt;/td&gt;
  &lt;td class="ux-datatable__td"&gt;
    &lt;input type="email" name="email" value="juan@email.com" class="ux-input"&gt;
  &lt;/td&gt;
  &lt;td class="ux-datatable__td"&gt;
    &lt;button class="ux-button ux-button--sm ux-color-primary"
            hx-put="/api/users/123"
            hx-include="closest tr"
            hx-target="#user-row-123"
            hx-swap="outerHTML"&gt;
      Guardar
    &lt;/button&gt;
    &lt;button class="ux-button ux-button--sm"
            hx-get="/api/users/123"
            hx-target="#user-row-123"
            hx-swap="outerHTML"&gt;
      Cancelar
    &lt;/button&gt;
  &lt;/td&gt;
&lt;/tr&gt;</pre>
    </div>

    <h4 style="margin-top: var(--ux-space-xl); font-size: var(--ux-font-size-md);">Eliminar fila con confirmacion</h4>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">&lt;!-- Boton eliminar con confirmacion --&gt;
&lt;button class="ux-datatable__row-action ux-datatable__row-action--danger"
        hx-delete="/api/users/123"
        hx-target="closest tr"
        hx-swap="outerHTML swap:1s"
        hx-confirm="Estas seguro de eliminar este usuario?"&gt;
  Eliminar
&lt;/button&gt;

&lt;!-- Servidor devuelve fila vacia o animacion de salida --&gt;
&lt;tr class="ux-datatable__tr ux-datatable__tr--deleted"&gt;
  &lt;td colspan="4" style="text-align: center; opacity: 0.5;"&gt;
    Usuario eliminado
  &lt;/td&gt;
&lt;/tr&gt;</pre>
    </div>

    <h4 style="margin-top: var(--ux-space-xl); font-size: var(--ux-font-size-md);">Acciones masivas</h4>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">&lt;!-- Formulario para acciones masivas --&gt;
&lt;form id="bulk-form"&gt;
  &lt;table class="ux-datatable__table"&gt;
    &lt;thead&gt;
      &lt;tr&gt;
        &lt;th class="ux-datatable__th ux-datatable__th--checkbox"&gt;
          &lt;input type="checkbox" class="ux-checkbox" id="select-all"&gt;
        &lt;/th&gt;
        &lt;th class="ux-datatable__th"&gt;Nombre&lt;/th&gt;
      &lt;/tr&gt;
    &lt;/thead&gt;
    &lt;tbody id="users-body"&gt;
      &lt;tr class="ux-datatable__tr"&gt;
        &lt;td class="ux-datatable__td ux-datatable__td--checkbox"&gt;
          &lt;input type="checkbox" name="ids[]" value="1" class="ux-checkbox"&gt;
        &lt;/td&gt;
        &lt;td class="ux-datatable__td"&gt;Juan Garcia&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr class="ux-datatable__tr"&gt;
        &lt;td class="ux-datatable__td ux-datatable__td--checkbox"&gt;
          &lt;input type="checkbox" name="ids[]" value="2" class="ux-checkbox"&gt;
        &lt;/td&gt;
        &lt;td class="ux-datatable__td"&gt;Maria Lopez&lt;/td&gt;
      &lt;/tr&gt;
    &lt;/tbody&gt;
  &lt;/table&gt;

  &lt;!-- Barra de acciones masivas --&gt;
  &lt;div class="ux-datatable__bulk-toolbar"&gt;
    &lt;button type="button"
            hx-post="/api/users/bulk/export"
            hx-include="#bulk-form"
            hx-swap="none"&gt;
      Exportar seleccionados
    &lt;/button&gt;
    &lt;button type="button"
            hx-delete="/api/users/bulk"
            hx-include="#bulk-form"
            hx-target="#users-body"
            hx-confirm="Eliminar usuarios seleccionados?"&gt;
      Eliminar seleccionados
    &lt;/button&gt;
  &lt;/div&gt;
&lt;/form&gt;</pre>
    </div>

    <h4 style="margin-top: var(--ux-space-xl); font-size: var(--ux-font-size-md);">Cargar detalles expandibles via HTMX</h4>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">&lt;!-- Fila con contenido expandible cargado bajo demanda --&gt;
&lt;tr class="ux-datatable__tr ux-datatable__tr--expandable" id="order-row-1"&gt;
  &lt;td class="ux-datatable__td ux-datatable__td--expand"&gt;
    &lt;button class="ux-datatable__expand-btn"
            hx-get="/api/orders/1/details"
            hx-target="#order-details-1"
            hx-swap="innerHTML"
            hx-trigger="click once"&gt;
      &lt;svg&gt;...&lt;/svg&gt;
    &lt;/button&gt;
  &lt;/td&gt;
  &lt;td class="ux-datatable__td"&gt;ORD-001&lt;/td&gt;
  &lt;td class="ux-datatable__td"&gt;Juan Garcia&lt;/td&gt;
  &lt;td class="ux-datatable__td"&gt;$299.99&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class="ux-datatable__expand-row"&gt;
  &lt;td colspan="4"&gt;
    &lt;div id="order-details-1" class="ux-datatable__expand-content"&gt;
      &lt;!-- Cargado via HTMX al expandir --&gt;
      &lt;div class="htmx-indicator"&gt;Cargando detalles...&lt;/div&gt;
    &lt;/div&gt;
  &lt;/td&gt;
&lt;/tr&gt;

&lt;!-- Servidor devuelve detalles --&gt;
&lt;div class="ux-datatable__expand-inner"&gt;
  &lt;div class="ux-datatable__detail-list"&gt;
    &lt;div class="ux-datatable__detail-item"&gt;
      &lt;span class="ux-datatable__detail-label"&gt;Direccion&lt;/span&gt;
      &lt;span class="ux-datatable__detail-value"&gt;Calle Principal 123&lt;/span&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  &lt;table class="ux-datatable__table"&gt;
    &lt;!-- Sub-tabla de items --&gt;
  &lt;/table&gt;
&lt;/div&gt;</pre>
    </div>

    <h4 style="margin-top: var(--ux-space-xl); font-size: var(--ux-font-size-md);">Filtros con HTMX</h4>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">&lt;!-- Fila de filtros --&gt;
&lt;tr class="ux-datatable__filters"&gt;
  &lt;td class="ux-datatable__filter-cell"&gt;
    &lt;input type="text"
           name="filter_name"
           class="ux-datatable__filter-input"
           placeholder="Filtrar..."
           hx-get="/api/users"
           hx-trigger="input changed delay:300ms"
           hx-target="#users-body"
           hx-include="[name^='filter_']"&gt;
  &lt;/td&gt;
  &lt;td class="ux-datatable__filter-cell"&gt;
    &lt;select name="filter_status"
            class="ux-datatable__filter-select"
            hx-get="/api/users"
            hx-trigger="change"
            hx-target="#users-body"
            hx-include="[name^='filter_']"&gt;
      &lt;option value=""&gt;Todos&lt;/option&gt;
      &lt;option value="active"&gt;Activo&lt;/option&gt;
      &lt;option value="inactive"&gt;Inactivo&lt;/option&gt;
    &lt;/select&gt;
  &lt;/td&gt;
&lt;/tr&gt;</pre>
    </div>

    <h4 style="margin-top: var(--ux-space-xl); font-size: var(--ux-font-size-md);">Polling para datos en tiempo real</h4>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">&lt;!-- Tabla que se actualiza cada 30 segundos --&gt;
&lt;tbody id="orders-body"
       hx-get="/api/orders/recent"
       hx-trigger="load, every 30s"
       hx-swap="innerHTML"&gt;
  &lt;!-- Filas actualizadas automaticamente --&gt;
&lt;/tbody&gt;

&lt;!-- O actualizar contador en header --&gt;
&lt;div class="ux-datatable__header"&gt;
  &lt;span id="order-count"
        hx-get="/api/orders/count"
        hx-trigger="every 10s"
        hx-swap="innerHTML"&gt;
    15 pedidos
  &lt;/span&gt;
&lt;/div&gt;</pre>
    </div>
  </div>

  <!-- Expandable Rows -->
  <div class="demo-section">
    <h3>Filas Expandibles</h3>
    <p>Tabla con filas que se pueden expandir para mostrar contenido adicional como detalles, sub-tablas o formularios.</p>

    <div class="demo-box" x-data="uxDatatable({
      columns: [
        { key: 'orderNumber', label: 'Pedido', sortable: true },
        { key: 'customer', label: 'Cliente', sortable: true },
        { key: 'date', label: 'Fecha', sortable: true, type: 'date' },
        { key: 'total', label: 'Total', sortable: true, type: 'number' },
        { key: 'status', label: 'Estado', sortable: true }
      ],
      rows: [
        {
          id: 1,
          orderNumber: 'ORD-001',
          customer: 'Juan Garcia',
          date: '2024-01-15',
          total: 299.99,
          status: 'Completado',
          items: [
            { name: 'Laptop Pro', qty: 1, price: 250.00 },
            { name: 'Mouse Wireless', qty: 2, price: 24.99 }
          ],
          shipping: 'Calle Principal 123, Madrid',
          notes: 'Entregar por la tarde'
        },
        {
          id: 2,
          orderNumber: 'ORD-002',
          customer: 'Maria Lopez',
          date: '2024-01-16',
          total: 149.50,
          status: 'Pendiente',
          items: [
            { name: 'Teclado Mecanico', qty: 1, price: 89.99 },
            { name: 'Cable USB-C', qty: 3, price: 19.83 }
          ],
          shipping: 'Av. Libertad 456, Barcelona',
          notes: ''
        },
        {
          id: 3,
          orderNumber: 'ORD-003',
          customer: 'Carlos Ruiz',
          date: '2024-01-17',
          total: 599.00,
          status: 'Procesando',
          items: [
            { name: 'Monitor 27\"', qty: 1, price: 399.00 },
            { name: 'Webcam HD', qty: 1, price: 200.00 }
          ],
          shipping: 'Plaza Mayor 789, Valencia',
          notes: 'Regalo - incluir tarjeta'
        }
      ],
      expandable: true,
      paginated: false
    })" class="ux-datatable ux-datatable--bordered ux-datatable--responsive">

      <div class="ux-datatable__header">
        <div>
          <h3 class="ux-datatable__title">Pedidos</h3>
          <p class="ux-datatable__subtitle">Click en la flecha para ver detalles</p>
        </div>
        <div class="ux-datatable__actions">
          <button type="button"
                  class="ux-button ux-button--outline ux-button--sm"
                  @click="toggleExpandAll()">
            <span x-text="expandAllState ? 'Colapsar todos' : 'Expandir todos'"></span>
          </button>
        </div>
      </div>

      <div class="ux-datatable__body">
        <table class="ux-datatable__table">
          <thead class="ux-datatable__thead">
            <tr>
              <th class="ux-datatable__th ux-datatable__th--expand">
                <button type="button"
                        class="ux-datatable__expand-all-btn"
                        :class="{ 'ux-datatable__expand-all-btn--expanded': expandAllState }"
                        @click="toggleExpandAll()"
                        title="Expandir/Colapsar todos">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 18l6-6-6-6"/>
                  </svg>
                </button>
              </th>
              <template x-for="col in columns" :key="col.key">
                <th class="ux-datatable__th"
                    :class="{
                      'ux-datatable__th--sortable': col.sortable,
                      'ux-datatable__th--sorted': isSorted(col),
                      'ux-datatable__th--sorted-desc': isSorted(col) && sortDirection === 'desc'
                    }"
                    @click="sortBy(col)">
                  <span x-text="col.label"></span>
                  <span x-show="col.sortable" class="ux-datatable__sort-icon">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M12 5v14M5 12l7-7 7 7"/>
                    </svg>
                  </span>
                </th>
              </template>
            </tr>
          </thead>
          <tbody class="ux-datatable__tbody">
            <template x-for="row in paginatedRows" :key="getRowId(row)">
              <template x-fragment>
                <!-- Main Row -->
                <tr class="ux-datatable__tr ux-datatable__tr--expandable"
                    :class="{ 'ux-datatable__tr--expanded': isRowExpanded(row) }"
                    @click="toggleRowExpand(row, $event)">
                  <td class="ux-datatable__td ux-datatable__td--expand">
                    <button type="button"
                            class="ux-datatable__expand-btn"
                            :class="{ 'ux-datatable__expand-btn--expanded': isRowExpanded(row) }"
                            @click.stop="toggleRowExpand(row, $event)"
                            :aria-expanded="isRowExpanded(row)">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 18l6-6-6-6"/>
                      </svg>
                    </button>
                  </td>
                  <template x-for="col in columns" :key="col.key">
                    <td class="ux-datatable__td" :data-label="col.label">
                      <template x-if="col.key === 'total'">
                        <strong x-text="'$' + row.total.toFixed(2)"></strong>
                      </template>
                      <template x-if="col.key === 'status'">
                        <span class="ux-badge ux-badge--soft"
                              :class="{
                                'ux-color-success--soft': row.status === 'Completado',
                                'ux-color-warning--soft': row.status === 'Pendiente',
                                'ux-color-primary--soft': row.status === 'Procesando'
                              }"
                              x-text="row.status"></span>
                      </template>
                      <template x-if="col.key !== 'total' && col.key !== 'status'">
                        <span x-text="formatCellValue(row, col)"></span>
                      </template>
                    </td>
                  </template>
                </tr>

                <!-- Expanded Content Row -->
                <tr class="ux-datatable__expand-row" x-show="isRowExpanded(row)">
                  <td :colspan="columns.length + 1">
                    <div class="ux-datatable__expand-content"
                         :class="{ 'ux-datatable__expand-content--open': isRowExpanded(row) }">
                      <div class="ux-datatable__expand-inner">
                        <div class="ux-datatable__expand-body">
                          <!-- Detail Grid -->
                          <div class="ux-datatable__detail-list" style="margin-bottom: var(--ux-space-lg);">
                            <div class="ux-datatable__detail-item">
                              <span class="ux-datatable__detail-label">Direccion de envio</span>
                              <span class="ux-datatable__detail-value" x-text="row.shipping"></span>
                            </div>
                            <div class="ux-datatable__detail-item">
                              <span class="ux-datatable__detail-label">Notas</span>
                              <span class="ux-datatable__detail-value" x-text="row.notes || 'Sin notas'"></span>
                            </div>
                          </div>

                          <!-- Items Sub-table -->
                          <h4 style="font-size: var(--ux-font-size-sm); font-weight: 600; margin-bottom: var(--ux-space-sm); color: var(--ux-text-secondary);">ARTICULOS DEL PEDIDO</h4>
                          <table class="ux-datatable__table" style="border: 1px solid var(--ux-border-color); border-radius: var(--ux-border-radius);">
                            <thead>
                              <tr>
                                <th class="ux-datatable__th" style="background: var(--ux-surface);">Producto</th>
                                <th class="ux-datatable__th ux-datatable__th--center" style="background: var(--ux-surface);">Cantidad</th>
                                <th class="ux-datatable__th ux-datatable__th--right" style="background: var(--ux-surface);">Precio</th>
                              </tr>
                            </thead>
                            <tbody>
                              <template x-for="item in row.items" :key="item.name">
                                <tr>
                                  <td class="ux-datatable__td" x-text="item.name"></td>
                                  <td class="ux-datatable__td ux-datatable__td--center" x-text="item.qty"></td>
                                  <td class="ux-datatable__td ux-datatable__td--right" x-text="'$' + item.price.toFixed(2)"></td>
                                </tr>
                              </template>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </td>
                </tr>
              </template>
            </template>
          </tbody>
        </table>
      </div>
    </div>

    <pre class="code-block">&lt;div x-data="uxDatatable({
  columns: [...],
  rows: [
    {
      id: 1,
      name: 'Item',
      // Additional data for expanded view
      details: { ... },
      items: [...]
    }
  ],
  expandable: true,
  singleExpand: false  // Allow multiple rows expanded
})" class="ux-datatable"&gt;

  &lt;!-- Expand column header --&gt;
  &lt;th class="ux-datatable__th ux-datatable__th--expand"&gt;
    &lt;button class="ux-datatable__expand-all-btn" @click="toggleExpandAll()"&gt;
      &lt;svg&gt;...&lt;/svg&gt;
    &lt;/button&gt;
  &lt;/th&gt;

  &lt;!-- Main row with expand button --&gt;
  &lt;tr class="ux-datatable__tr ux-datatable__tr--expandable"
      :class="{ 'ux-datatable__tr--expanded': isRowExpanded(row) }"&gt;
    &lt;td class="ux-datatable__td ux-datatable__td--expand"&gt;
      &lt;button class="ux-datatable__expand-btn"
              :class="{ 'ux-datatable__expand-btn--expanded': isRowExpanded(row) }"
              @click="toggleRowExpand(row)"&gt;
        &lt;svg&gt;...&lt;/svg&gt;
      &lt;/button&gt;
    &lt;/td&gt;
    &lt;!-- Other columns --&gt;
  &lt;/tr&gt;

  &lt;!-- Expanded content row --&gt;
  &lt;tr class="ux-datatable__expand-row" x-show="isRowExpanded(row)"&gt;
    &lt;td :colspan="columns.length + 1"&gt;
      &lt;div class="ux-datatable__expand-content"
           :class="{ 'ux-datatable__expand-content--open': isRowExpanded(row) }"&gt;
        &lt;div class="ux-datatable__expand-inner"&gt;
          &lt;div class="ux-datatable__expand-body"&gt;
            &lt;!-- Your expanded content here --&gt;
          &lt;/div&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/td&gt;
  &lt;/tr&gt;
&lt;/div&gt;

// Methods for expandable rows:
toggleRowExpand(row)     // Toggle single row
isRowExpanded(row)       // Check if expanded
expandRow(row)           // Expand single row
collapseRow(row)         // Collapse single row
toggleExpandAll()        // Toggle all rows
expandAll()              // Expand all rows
collapseAll()            // Collapse all rows
getExpandedData()        // Get expanded rows data

// Events:
@row-expand              // { row, rowId }
@row-collapse            // { row, rowId }
@expand-all              // { expanded: true/false }</pre>
  </div>

  <!-- Single Expand Mode -->
  <div class="demo-section">
    <h3>Modo Single Expand</h3>
    <p>Solo permite una fila expandida a la vez. Al expandir una nueva fila, la anterior se colapsa automaticamente.</p>

    <div class="demo-box" x-data="uxDatatable({
      columns: [
        { key: 'name', label: 'Producto', sortable: true },
        { key: 'sku', label: 'SKU' },
        { key: 'price', label: 'Precio', type: 'number' },
        { key: 'stock', label: 'Stock', type: 'number' }
      ],
      rows: [
        { id: 1, name: 'Laptop Pro 15', sku: 'LP-15-001', price: 1299.99, stock: 45, specs: { cpu: 'Intel i7', ram: '16GB', storage: '512GB SSD' } },
        { id: 2, name: 'Monitor 27\" 4K', sku: 'MN-27-4K', price: 499.99, stock: 23, specs: { resolution: '3840x2160', panel: 'IPS', refresh: '60Hz' } },
        { id: 3, name: 'Teclado Mecanico RGB', sku: 'KB-RGB-01', price: 149.99, stock: 78, specs: { switches: 'Cherry MX Red', layout: 'Full-size', backlight: 'RGB' } }
      ],
      expandable: true,
      singleExpand: true,
      paginated: false
    })" class="ux-datatable ux-datatable--bordered">

      <div class="ux-datatable__body">
        <table class="ux-datatable__table">
          <thead class="ux-datatable__thead">
            <tr>
              <th class="ux-datatable__th ux-datatable__th--expand"></th>
              <template x-for="col in columns" :key="col.key">
                <th class="ux-datatable__th" x-text="col.label"></th>
              </template>
            </tr>
          </thead>
          <tbody class="ux-datatable__tbody">
            <template x-for="row in paginatedRows" :key="getRowId(row)">
              <template x-fragment>
                <tr class="ux-datatable__tr ux-datatable__tr--expandable"
                    :class="{ 'ux-datatable__tr--expanded': isRowExpanded(row) }"
                    @click="toggleRowExpand(row, $event)">
                  <td class="ux-datatable__td ux-datatable__td--expand">
                    <button type="button"
                            class="ux-datatable__expand-btn"
                            :class="{ 'ux-datatable__expand-btn--expanded': isRowExpanded(row) }"
                            @click.stop="toggleRowExpand(row, $event)">
                      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 18l6-6-6-6"/>
                      </svg>
                    </button>
                  </td>
                  <td class="ux-datatable__td"><strong x-text="row.name"></strong></td>
                  <td class="ux-datatable__td"><code x-text="row.sku"></code></td>
                  <td class="ux-datatable__td" x-text="'$' + row.price.toFixed(2)"></td>
                  <td class="ux-datatable__td">
                    <span class="ux-badge"
                          :class="row.stock > 50 ? 'ux-color-success' : row.stock > 20 ? 'ux-color-warning' : 'ux-color-danger'"
                          x-text="row.stock + ' uds'"></span>
                  </td>
                </tr>

                <tr class="ux-datatable__expand-row" x-show="isRowExpanded(row)">
                  <td :colspan="columns.length + 1">
                    <div class="ux-datatable__expand-content"
                         :class="{ 'ux-datatable__expand-content--open': isRowExpanded(row) }">
                      <div class="ux-datatable__expand-inner">
                        <div class="ux-datatable__expand-body">
                          <h4 style="font-size: var(--ux-font-size-sm); font-weight: 600; margin-bottom: var(--ux-space-md); color: var(--ux-text-secondary);">ESPECIFICACIONES</h4>
                          <div class="ux-datatable__detail-list">
                            <template x-for="(value, key) in row.specs" :key="key">
                              <div class="ux-datatable__detail-item">
                                <span class="ux-datatable__detail-label" x-text="key"></span>
                                <span class="ux-datatable__detail-value" x-text="value"></span>
                              </div>
                            </template>
                          </div>
                        </div>
                      </div>
                    </div>
                  </td>
                </tr>
              </template>
            </template>
          </tbody>
        </table>
      </div>
    </div>

    <pre class="code-block">&lt;div x-data="uxDatatable({
  expandable: true,
  singleExpand: true  // Only one row can be expanded at a time
})"&gt;
  ...
&lt;/div&gt;</pre>
  </div>

  <!-- CSS Classes -->
  <div class="demo-section">
    <h3>Clases CSS</h3>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">/* Contenedor */
.ux-datatable                    // Contenedor principal
.ux-datatable--bordered          // Con borde
.ux-datatable--inset             // Con margen
.ux-datatable--striped           // Filas alternadas
.ux-datatable--compact           // Padding reducido
.ux-datatable--responsive        // Vista movil automatica
.ux-datatable--force-responsive  // Siempre vista movil

/* Cabecera */
.ux-datatable__th--sortable      // Columna ordenable
.ux-datatable__th--sorted        // Columna ordenada
.ux-datatable__th--sorted-desc   // Ordenado descendente
.ux-datatable__th--center        // Alineado centro
.ux-datatable__th--right         // Alineado derecha
.ux-datatable__th--checkbox      // Columna checkbox
.ux-datatable__th--actions       // Columna acciones

/* Celdas */
.ux-datatable__td--center        // Alineado centro
.ux-datatable__td--right         // Alineado derecha
.ux-datatable__td--truncate      // Truncar texto largo
.ux-datatable__td--primary       // Celda destacada (responsive)
.ux-datatable__td--checkbox      // Celda checkbox
.ux-datatable__td--actions       // Celda acciones

/* Filas */
.ux-datatable__tr--selected      // Fila seleccionada
.ux-datatable__tr--clickable     // Fila clickeable

/* View Toggle */
.ux-datatable__view-toggle       // Contenedor botones
.ux-datatable__view-btn          // Boton de vista
.ux-datatable__view-btn--active  // Boton activo

/* Expandable Rows */
.ux-datatable__th--expand        // Columna expand en header
.ux-datatable__td--expand        // Celda expand
.ux-datatable__expand-btn        // Boton expandir fila
.ux-datatable__expand-btn--expanded  // Boton cuando expandido
.ux-datatable__expand-all-btn    // Boton expandir todos
.ux-datatable__expand-all-btn--expanded // Expandir todos activo
.ux-datatable__tr--expandable    // Fila expandible
.ux-datatable__tr--expanded      // Fila expandida
.ux-datatable__expand-row        // Fila con contenido expandido
.ux-datatable__expand-content    // Contenedor animacion
.ux-datatable__expand-content--open // Contenedor abierto
.ux-datatable__expand-inner      // Inner para overflow
.ux-datatable__expand-body       // Contenido expandido
.ux-datatable__detail-list       // Grid de detalles
.ux-datatable__detail-item       // Item de detalle
.ux-datatable__detail-label      // Label de detalle
.ux-datatable__detail-value      // Valor de detalle</pre>
    </div>
  </div>
</body>
</html>
