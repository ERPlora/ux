<pre class="ux-code-block" data-lang="python"># views.py - Endpoints HTMX
from django.http import HttpResponse

def wizard_validate_view(request, step):
    """Valida el paso actual y avanza o muestra errores."""
    form_class = WIZARD_FORMS[step - 1][1]
    form = form_class(request.POST)

    if form.is_valid():
        # Guardar datos en sesion
        request.session[f'wizard_step_{step}'] = form.cleaned_data
        # Renderizar siguiente paso
        return render(request, 'wizard/wizard_base.html', {
            'current_step': step + 1,
            'total_steps': len(WIZARD_FORMS),
            # ... resto del contexto
        })

    # Si hay errores, re-renderizar paso actual con errores
    return render(request, 'wizard/wizard_base.html', {
        'current_step': step,
        'form': form,
        'errors': form.errors,
        # ... resto del contexto
    })

def wizard_step_view(request, step):
    """Carga un paso especifico (para navegacion hacia atras)."""
    # Recuperar datos guardados si existen
    saved_data = request.session.get(f'wizard_step_{step}', {})
    form_class = WIZARD_FORMS[step - 1][1]
    form = form_class(initial=saved_data)

    return render(request, 'wizard/wizard_base.html', {
        'current_step': step,
        'form': form,
        # ... resto del contexto
    })

def wizard_submit_view(request):
    """Procesa el formulario completo."""
    # Recopilar datos de todos los pasos
    all_data = {}
    for i in range(1, len(WIZARD_FORMS) + 1):
        step_data = request.session.get(f'wizard_step_{i}', {})
        all_data.update(step_data)

    # Crear usuario/registro
    user = User.objects.create(**all_data)

    # Limpiar sesion
    for i in range(1, len(WIZARD_FORMS) + 1):
        request.session.pop(f'wizard_step_{i}', None)

    return render(request, 'wizard/complete.html', {'user': user})</pre>
