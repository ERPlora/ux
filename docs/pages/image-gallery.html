<section class="component-section">
  <h3>Grid Basico</h3>
  <p>Galeria de imagenes con grid de 3 columnas y lightbox.</p>
  <ux-playground src="examples/image-gallery/grid-basico.html"></ux-playground>
</section>

<section class="component-section">
  <h3>4 Columnas</h3>
  <p>Grid con 4 columnas para mas imagenes.</p>
  <ux-playground src="examples/image-gallery/4-columnas.html"></ux-playground>
</section>

<section class="component-section">
  <h3>Con Limite (+X mas)</h3>
  <p>Mostrar solo algunas imagenes con indicador de cuantas mas hay.</p>
  <ux-playground src="examples/image-gallery/con-limite.html"></ux-playground>
</section>

<section class="component-section">
  <h3>Aspecto Paisaje</h3>
  <p>Imagenes con aspecto 16:9.</p>
  <ux-playground src="examples/image-gallery/aspecto-paisaje.html"></ux-playground>
</section>

<section class="component-section">
  <h3>Layout Masonry</h3>
  <p>Imagenes con diferentes alturas en formato masonry.</p>
  <ux-playground src="examples/image-gallery/masonry.html"></ux-playground>
</section>

<section class="component-section">
  <h3>Opciones</h3>
  <p>Configuracion disponible para el componente.</p>
  <div class="demo-box">
    <table style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr style="text-align: left; border-bottom: 1px solid var(--ux-border-color);">
          <th style="padding: var(--ux-space-sm);">Opcion</th>
          <th style="padding: var(--ux-space-sm);">Tipo</th>
          <th style="padding: var(--ux-space-sm);">Default</th>
          <th style="padding: var(--ux-space-sm);">Descripcion</th>
        </tr>
      </thead>
      <tbody>
        <tr style="border-bottom: 1px solid var(--ux-border-color);">
          <td style="padding: var(--ux-space-sm);"><code>images</code></td>
          <td style="padding: var(--ux-space-sm);">Array</td>
          <td style="padding: var(--ux-space-sm);">[]</td>
          <td style="padding: var(--ux-space-sm);">Array de {src, thumb, title, description}</td>
        </tr>
        <tr style="border-bottom: 1px solid var(--ux-border-color);">
          <td style="padding: var(--ux-space-sm);"><code>maxVisible</code></td>
          <td style="padding: var(--ux-space-sm);">Number</td>
          <td style="padding: var(--ux-space-sm);">0</td>
          <td style="padding: var(--ux-space-sm);">Maximo de imagenes visibles (0 = todas)</td>
        </tr>
        <tr style="border-bottom: 1px solid var(--ux-border-color);">
          <td style="padding: var(--ux-space-sm);"><code>showThumbs</code></td>
          <td style="padding: var(--ux-space-sm);">Boolean</td>
          <td style="padding: var(--ux-space-sm);">true</td>
          <td style="padding: var(--ux-space-sm);">Mostrar miniaturas en lightbox</td>
        </tr>
        <tr style="border-bottom: 1px solid var(--ux-border-color);">
          <td style="padding: var(--ux-space-sm);"><code>enableZoom</code></td>
          <td style="padding: var(--ux-space-sm);">Boolean</td>
          <td style="padding: var(--ux-space-sm);">true</td>
          <td style="padding: var(--ux-space-sm);">Permitir zoom en lightbox</td>
        </tr>
        <tr style="border-bottom: 1px solid var(--ux-border-color);">
          <td style="padding: var(--ux-space-sm);"><code>loop</code></td>
          <td style="padding: var(--ux-space-sm);">Boolean</td>
          <td style="padding: var(--ux-space-sm);">true</td>
          <td style="padding: var(--ux-space-sm);">Loop al final de la galeria</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>

<section class="component-section">
  <h3>Clases CSS</h3>
  <p>Clases disponibles para personalizar la galeria.</p>
  <div class="demo-box">
    <table style="width: 100%; border-collapse: collapse;">
      <thead>
        <tr style="text-align: left; border-bottom: 1px solid var(--ux-border-color);">
          <th style="padding: var(--ux-space-sm);">Clase</th>
          <th style="padding: var(--ux-space-sm);">Descripcion</th>
        </tr>
      </thead>
      <tbody>
        <tr style="border-bottom: 1px solid var(--ux-border-color);">
          <td style="padding: var(--ux-space-sm);"><code>.ux-gallery--cols-2/3/4/5</code></td>
          <td style="padding: var(--ux-space-sm);">Numero de columnas</td>
        </tr>
        <tr style="border-bottom: 1px solid var(--ux-border-color);">
          <td style="padding: var(--ux-space-sm);"><code>.ux-gallery--cols-auto</code></td>
          <td style="padding: var(--ux-space-sm);">Columnas automaticas (min 200px)</td>
        </tr>
        <tr style="border-bottom: 1px solid var(--ux-border-color);">
          <td style="padding: var(--ux-space-sm);"><code>.ux-gallery--masonry</code></td>
          <td style="padding: var(--ux-space-sm);">Layout masonry</td>
        </tr>
        <tr style="border-bottom: 1px solid var(--ux-border-color);">
          <td style="padding: var(--ux-space-sm);"><code>.ux-gallery--featured</code></td>
          <td style="padding: var(--ux-space-sm);">Primera imagen destacada</td>
        </tr>
        <tr style="border-bottom: 1px solid var(--ux-border-color);">
          <td style="padding: var(--ux-space-sm);"><code>.ux-gallery--wide</code></td>
          <td style="padding: var(--ux-space-sm);">Aspecto 16:9</td>
        </tr>
      </tbody>
    </table>
  </div>
</section>

<section class="component-section">
  <h3>Eventos</h3>
  <p>Eventos emitidos por el componente.</p>
  <div class="demo-box">
    <ul style="margin: 0; padding-left: var(--ux-space-lg);">
      <li><code>gallery:open</code> - Lightbox abierto ({ index, image })</li>
      <li><code>gallery:close</code> - Lightbox cerrado</li>
      <li><code>gallery:change</code> - Imagen cambiada ({ index, image })</li>
    </ul>
  </div>
  <pre class="ux-code-block" data-lang="html"><div x-data="uxImageGallery({ images: [...] })"
     @gallery:open="console.log('Abierto:', $event.detail.index)"
     @gallery:change="trackView($event.detail.image)">
</div></pre>
</section>

<section class="component-section">
  <h3>HTMX + Django</h3>
  <p>Integracion con Django para cargar imagenes dinamicamente desde el servidor.</p>

  <div class="demo-box">
    <h4 style="margin-bottom: var(--ux-space-sm); font-weight: 600;">Template Django (galeria.html)</h4>
    <p style="font-size: var(--ux-font-size-sm); color: var(--ux-text-secondary);">Renderiza la galeria con imagenes desde el modelo.</p>
  </div>
  <pre class="ux-code-block" data-lang="html"><!-- templates/galeria.html -->
<div class="ux-gallery ux-gallery--cols-3"
     x-data="uxImageGallery({
       images: [
         {% for imagen in producto.imagenes.all %}
         {
           src: '{{ imagen.imagen.url }}',
           thumb: '{{ imagen.thumbnail.url }}',
           title: '{{ imagen.titulo|escapejs }}'
         }{% if not forloop.last %},{% endif %}
         {% endfor %}
       ],
       maxVisible: 4
     })">
  <div class="ux-gallery__grid">
    <template x-for="(image, index) in visibleImages" :key="index">
      <div class="ux-gallery__item" @click="openLightbox(index)">
        <img :src="image.thumb || image.src" loading="lazy">
        <template x-if="index === visibleImages.length - 1 && remainingCount > 0">
          <div class="ux-gallery__more">+<span x-text="remainingCount"></span></div>
        </template>
      </div>
    </template>
  </div>

  <!-- Lightbox template... -->
</div></pre>

  <div class="demo-box">
    <h4 style="margin-bottom: var(--ux-space-sm); font-weight: 600;">Carga dinamica con HTMX</h4>
    <p style="font-size: var(--ux-font-size-sm); color: var(--ux-text-secondary);">Carga la galeria de un producto sin recargar la pagina.</p>
  </div>
  <pre class="ux-code-block" data-lang="html"><!-- Lista de productos con carga de galeria -->
<div class="ux-card"
     hx-get="/productos/{{ producto.id }}/galeria/"
     hx-trigger="click"
     hx-target="#galeria-modal .ux-modal__content"
     hx-swap="innerHTML"
     @htmx:after-swap="$dispatch('modal:open')">
  <img src="{{ producto.imagen_principal.thumbnail.url }}" alt="{{ producto.nombre }}">
  <h4>{{ producto.nombre }}</h4>
  <p>{{ producto.imagenes.count }} imagenes</p>
</div>

<!-- Modal para mostrar galeria -->
<div id="galeria-modal"
     x-data="uxModal()"
     @modal:open.window="open()">
  <div class="ux-modal" x-show="isOpen">
    <div class="ux-modal__header">
      <h3>Galeria de Imagenes</h3>
      <button @click="close()">&times;</button>
    </div>
    <div class="ux-modal__content">
      <!-- Contenido cargado via HTMX -->
    </div>
  </div>
</div></pre>

  <div class="demo-box">
    <h4 style="margin-bottom: var(--ux-space-sm); font-weight: 600;">Vista Django</h4>
    <p style="font-size: var(--ux-font-size-sm); color: var(--ux-text-secondary);">Endpoint que retorna el fragmento HTML de la galeria.</p>
  </div>
  <pre class="ux-code-block" data-lang="python"># views.py
from django.shortcuts import get_object_or_404
from django.template.response import TemplateResponse

def producto_galeria(request, producto_id):
    producto = get_object_or_404(Producto, id=producto_id)
    return TemplateResponse(request, 'partials/galeria.html', {
        'producto': producto
    })</pre>

  <div class="demo-box">
    <h4 style="margin-bottom: var(--ux-space-sm); font-weight: 600;">Modelo Django</h4>
    <p style="font-size: var(--ux-font-size-sm); color: var(--ux-text-secondary);">Modelo de imagen con soporte para thumbnails.</p>
  </div>
  <pre class="ux-code-block" data-lang="python"># models.py
from django.db import models
from imagekit.models import ImageSpecField
from imagekit.processors import ResizeToFill

class Producto(models.Model):
    nombre = models.CharField(max_length=200)

    @property
    def imagen_principal(self):
        return self.imagenes.first()

class ImagenProducto(models.Model):
    producto = models.ForeignKey(
        Producto,
        related_name='imagenes',
        on_delete=models.CASCADE
    )
    imagen = models.ImageField(upload_to='productos/')
    titulo = models.CharField(max_length=100, blank=True)
    orden = models.PositiveIntegerField(default=0)

    # Thumbnail automatico con django-imagekit
    thumbnail = ImageSpecField(
        source='imagen',
        processors=[ResizeToFill(300, 300)],
        format='JPEG',
        options={'quality': 80}
    )

    class Meta:
        ordering = ['orden']</pre>

  <div class="demo-box">
    <h4 style="margin-bottom: var(--ux-space-sm); font-weight: 600;">Galeria con Infinite Scroll</h4>
    <p style="font-size: var(--ux-font-size-sm); color: var(--ux-text-secondary);">Cargar mas imagenes al hacer scroll.</p>
  </div>
  <pre class="ux-code-block" data-lang="html"><!-- Galeria con paginacion HTMX -->
<div id="galeria-container"
     x-data="uxImageGallery({ images: [] })"
     x-init="$watch('images', () => $el.dispatchEvent(new CustomEvent('gallery:updated')))">

  <div class="ux-gallery ux-gallery--cols-4">
    <div class="ux-gallery__grid"
         hx-get="/api/imagenes/?page=1"
         hx-trigger="load"
         hx-swap="innerHTML">
    </div>
  </div>

  <!-- Trigger para cargar mas -->
  <div hx-get="/api/imagenes/?page={{ next_page }}"
       hx-trigger="revealed"
       hx-swap="beforeend"
       hx-target=".ux-gallery__grid"
       class="ux-spinner">
  </div>
</div>

<!-- Partial que retorna Django (partials/imagen_item.html) -->
{% for imagen in imagenes %}
<div class="ux-gallery__item"
     @click="openLightbox({{ forloop.counter0 }})"
     x-init="images.push({ src: '{{ imagen.url }}', title: '{{ imagen.titulo }}' })">
  <img src="{{ imagen.thumbnail.url }}" loading="lazy">
</div>
{% endfor %}</pre>

</section>
