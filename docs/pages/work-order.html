<style>
  .demo-section { margin-bottom: var(--ux-space-xl); padding: var(--ux-space-lg); }
  .demo-section h3 { font-size: var(--ux-font-size-lg); font-weight: 600; margin-bottom: var(--ux-space-md); color: var(--ux-text); }
  .demo-section p { font-size: var(--ux-font-size-md); color: var(--ux-text-secondary); margin-bottom: var(--ux-space-md); }
  .section-label { font-weight: 600; margin-bottom: var(--ux-space-sm); display: block; color: var(--ux-text); }
  .demo-row { display: flex; flex-wrap: wrap; gap: var(--ux-space-lg); margin-bottom: var(--ux-space-lg); }
</style>

<!-- Basic Work Order Card -->
<div class="demo-section">
  <h3>Work Order Card</h3>
  <p>Work order cards for manufacturing and production tracking. Display order details, quantities, progress, and action buttons.</p>

  <ux-playground src="examples/work-order/tarjeta-basica.html"></ux-playground>
</div>

<!-- Priority Variants -->
<div class="demo-section">
  <h3>Priority Variants</h3>
  <p>Work orders support four priority levels: low, normal, high, and urgent. The priority indicator is shown on the left edge.</p>

  <ux-playground src="examples/work-order/variantes-prioridad.html"></ux-playground>
</div>

<!-- Status Variants -->
<div class="demo-section">
  <h3>Status Variants</h3>
  <p>Work orders have four status states: pending, in-progress, on-hold, and completed.</p>

  <ux-playground src="examples/work-order/variantes-estado.html"></ux-playground>
</div>

<!-- Compact Variant -->
<div class="demo-section">
  <h3>Compact Variant</h3>
  <p>Use the compact variant for denser displays like dashboard lists or mobile views.</p>

  <ux-playground src="examples/work-order/compacto.html"></ux-playground>
</div>

<!-- Material Shortage Warning -->
<div class="demo-section">
  <h3>Material Shortage Warning</h3>
  <p>Highlight materials that have shortages to alert operators.</p>

  <ux-playground src="examples/work-order/escasez-materiales.html"></ux-playground>
</div>

<!-- Overdue Work Order -->
<div class="demo-section">
  <h3>Overdue Warning</h3>
  <p>Work orders past their due date are highlighted with a warning style.</p>

  <ux-playground src="examples/work-order/orden-vencida.html"></ux-playground>
</div>

<!-- Glass Variant -->
<div class="demo-section">
  <h3>Glass Variant</h3>
  <p>Glass morphism style for modern interfaces.</p>

  <ux-playground src="examples/work-order/glass.html"></ux-playground>
</div>

<!-- HTMX + Django -->
<div class="demo-section">
  <h3>HTMX + Django</h3>
  <p>Manage work orders with HTMX and Django for real-time production tracking.</p>

  <pre class="ux-code-block" data-lang="html"><!-- Load work orders from Django -->
<div class="ux-work-order-grid"
     hx-get="{% url 'workorders:list' %}?status=pending"
     hx-trigger="load"
     hx-swap="innerHTML">
  <div class="ux-spinner"></div>
</div>

<!-- Work order card with HTMX actions -->
<div id="wo-{{ work_order.id }}"
     class="ux-work-order ux-work-order--priority-{{ work_order.priority }}">
  <div class="ux-work-order__header">
    <div class="ux-work-order__header-top">
      <h4 class="ux-work-order__number">{{ work_order.number }}</h4>
      <span class="ux-work-order__status ux-work-order__status--{{ work_order.status }}">
        <span class="ux-work-order__status-dot"></span>
        <span>{{ work_order.get_status_display }}</span>
      </span>
    </div>
    <div class="ux-work-order__product">
      <h5 class="ux-work-order__product-name">{{ work_order.product.name }}</h5>
      <span class="ux-work-order__product-sku">{{ work_order.product.sku }}</span>
    </div>
  </div>

  <div class="ux-work-order__content">
    <div class="ux-work-order__quantities">
      <div class="ux-work-order__quantity">
        <span class="ux-work-order__quantity-label">Ordered</span>
        <span class="ux-work-order__quantity-value">{{ work_order.quantity_ordered }}</span>
      </div>
      <div class="ux-work-order__quantity">
        <span class="ux-work-order__quantity-label">Completed</span>
        <span class="ux-work-order__quantity-value">{{ work_order.quantity_completed }}</span>
      </div>
    </div>

    <div class="ux-work-order__progress">
      <div class="ux-work-order__progress-bar">
        <div class="ux-work-order__progress-fill" style="width: {{ work_order.progress_percent }}%"></div>
      </div>
    </div>
  </div>

  <div class="ux-work-order__actions">
    {% if work_order.status == 'pending' %}
    <button class="ux-work-order__action ux-work-order__action--start"
            hx-post="{% url 'workorders:start' work_order.id %}"
            hx-target="#wo-{{ work_order.id }}"
            hx-swap="outerHTML">
      Start
    </button>
    {% elif work_order.status == 'in-progress' %}
    <button class="ux-work-order__action ux-work-order__action--pause"
            hx-post="{% url 'workorders:pause' work_order.id %}"
            hx-target="#wo-{{ work_order.id }}"
            hx-swap="outerHTML">
      Pause
    </button>
    <button class="ux-work-order__action ux-work-order__action--complete"
            hx-post="{% url 'workorders:complete' work_order.id %}"
            hx-confirm="Mark this work order as complete?"
            hx-target="#wo-{{ work_order.id }}"
            hx-swap="outerHTML">
      Complete
    </button>
    {% endif %}
  </div>
</div>

<!-- Increment completed quantity -->
<button class="ux-work-order__action"
        hx-post="{% url 'workorders:increment' work_order.id %}"
        hx-vals='{"amount": 10}'
        hx-target="#wo-{{ work_order.id }}"
        hx-swap="outerHTML">
  +10 Units
</button>

<!-- Filter work orders by status -->
<div class="ux-segment">
  <button class="ux-segment__button"
          hx-get="{% url 'workorders:list' %}?status=pending"
          hx-target="#work-orders-grid">Pending</button>
  <button class="ux-segment__button"
          hx-get="{% url 'workorders:list' %}?status=in-progress"
          hx-target="#work-orders-grid">In Progress</button>
  <button class="ux-segment__button"
          hx-get="{% url 'workorders:list' %}?status=completed"
          hx-target="#work-orders-grid">Completed</button>
</div></pre>
  <pre class="ux-code-block" data-lang="python"># views.py
from django.http import JsonResponse
from django.shortcuts import render, get_object_or_404
from django.views.decorators.http import require_POST, require_GET
from django.contrib.auth.decorators import login_required
from django.utils import timezone

@login_required
def workorders_page(request):
    """Render work orders management page."""
    return render(request, 'workorders/index.html')

@login_required
@require_GET
def workorders_list(request):
    """Return filtered work orders as HTML partial."""
    status = request.GET.get('status')
    priority = request.GET.get('priority')
    machine = request.GET.get('machine')

    work_orders = WorkOrder.objects.select_related('product', 'machine')

    if status:
        work_orders = work_orders.filter(status=status)
    if priority:
        work_orders = work_orders.filter(priority=priority)
    if machine:
        work_orders = work_orders.filter(machine_id=machine)

    work_orders = work_orders.order_by('-priority', 'due_date')[:50]

    return render(request, 'workorders/partials/list.html', {
        'work_orders': work_orders
    })

@login_required
@require_POST
def start_workorder(request, workorder_id):
    """Start a work order."""
    work_order = get_object_or_404(WorkOrder, id=workorder_id)
    work_order.status = 'in-progress'
    work_order.started_at = timezone.now()
    work_order.save()

    return render(request, 'workorders/partials/card.html', {
        'work_order': work_order
    })

@login_required
@require_POST
def pause_workorder(request, workorder_id):
    """Pause a work order."""
    work_order = get_object_or_404(WorkOrder, id=workorder_id)
    work_order.status = 'on-hold'
    work_order.save()

    return render(request, 'workorders/partials/card.html', {
        'work_order': work_order
    })

@login_required
@require_POST
def complete_workorder(request, workorder_id):
    """Mark a work order as complete."""
    work_order = get_object_or_404(WorkOrder, id=workorder_id)
    work_order.status = 'completed'
    work_order.completed_at = timezone.now()
    work_order.quantity_completed = work_order.quantity_ordered
    work_order.save()

    return render(request, 'workorders/partials/card.html', {
        'work_order': work_order
    })

@login_required
@require_POST
def increment_quantity(request, workorder_id):
    """Increment completed quantity."""
    work_order = get_object_or_404(WorkOrder, id=workorder_id)
    amount = int(request.POST.get('amount', 1))

    work_order.quantity_completed = min(
        work_order.quantity_completed + amount,
        work_order.quantity_ordered
    )
    work_order.save()

    # Auto-complete if quantity reached
    if work_order.quantity_completed >= work_order.quantity_ordered:
        work_order.status = 'completed'
        work_order.completed_at = timezone.now()
        work_order.save()

    return render(request, 'workorders/partials/card.html', {
        'work_order': work_order
    })

@login_required
@require_POST
def update_status(request, workorder_id):
    """Update work order status via PATCH-like request."""
    work_order = get_object_or_404(WorkOrder, id=workorder_id)
    new_status = request.POST.get('status')

    if new_status in ['pending', 'in-progress', 'on-hold', 'completed']:
        work_order.status = new_status
        if new_status == 'in-progress' and not work_order.started_at:
            work_order.started_at = timezone.now()
        elif new_status == 'completed':
            work_order.completed_at = timezone.now()
        work_order.save()

    return render(request, 'workorders/partials/card.html', {
        'work_order': work_order
    })

@login_required
def workorder_detail(request, workorder_id):
    """Return work order details as HTML partial."""
    work_order = get_object_or_404(
        WorkOrder.objects.select_related('product', 'machine')
        .prefetch_related('materials'),
        id=workorder_id
    )
    return render(request, 'workorders/partials/detail.html', {
        'work_order': work_order
    })

# urls.py
from django.urls import path
from . import views

app_name = 'workorders'
urlpatterns = [
    path('', views.workorders_page, name='index'),
    path('list/', views.workorders_list, name='list'),
    path('<int:workorder_id>/', views.workorder_detail, name='detail'),
    path('<int:workorder_id>/start/', views.start_workorder, name='start'),
    path('<int:workorder_id>/pause/', views.pause_workorder, name='pause'),
    path('<int:workorder_id>/complete/', views.complete_workorder, name='complete'),
    path('<int:workorder_id>/increment/', views.increment_quantity, name='increment'),
    path('<int:workorder_id>/status/', views.update_status, name='update-status'),
]</pre>
</div>

<!-- API Reference -->
<div class="demo-section">
  <h3>Alpine.js Component API</h3>
  <div style="background: var(--ux-surface); padding: var(--ux-space-lg); border-radius: var(--ux-border-radius-lg);">
    <pre class="ux-code-block" data-lang="javascript">// uxWorkOrder Component
uxWorkOrder({
  // Identification
  workOrderNumber: 'WO-2024-0142',
  workOrderId: 142,

  // Product info
  product: {
    name: 'Product Name',
    sku: 'SKU-001',
    description: 'Optional description'
  },

  // Status: 'pending', 'in-progress', 'completed', 'on-hold'
  status: 'pending',

  // Priority: 'low', 'normal', 'high', 'urgent'
  priority: 'normal',

  // Quantities
  quantityOrdered: 500,
  quantityCompleted: 0,

  // Due date
  dueDate: new Date('2024-01-15'),

  // Machine/Workstation
  machine: 'CNC Mill #3',

  // Materials (BOM)
  materials: [
    { name: 'Material A', qty: '50 units', shortage: false },
    { name: 'Material B', qty: 'SHORTAGE', shortage: true }
  ],

  // Timer (auto-started when status is 'in-progress')
  startedAt: new Date(),

  // Display options
  showMaterials: true,
  showProgress: true,
  showActions: true,

  // Custom labels (i18n)
  labels: {
    ordered: 'Ordered',
    completed: 'Completed',
    remaining: 'Remaining',
    progress: 'Progress',
    start: 'Start',
    pause: 'Pause',
    complete: 'Complete'
  }
})

// Properties (reactive)
quantityRemaining     // Ordered - Completed
progressPercent       // 0-100
isOverdue             // true if past due date
isDueSoon             // true if due within 24h
formattedDueDate      // Formatted date string
formattedElapsedTime  // HH:MM:SS or MM:SS
statusLabel           // Translated status
priorityLabel         // Translated priority
hasShortage           // true if any material has shortage

// Methods
start()               // Set status to 'in-progress', start timer
pause()               // Set status to 'on-hold', pause timer
resume()              // Resume from 'on-hold'
complete()            // Set status to 'completed'
incrementCompleted(n) // Add n to completed quantity
setCompleted(n)       // Set completed quantity to n
setStatus(status)     // Set status directly
getIcon(name)         // Get SVG icon by name
getData()             // Get all work order data as object

// Events
@work-order:status-change  // { workOrderId, oldStatus, newStatus }
@work-order:quantity-change // { workOrderId, quantityCompleted, quantityRemaining }</pre>
  </div>
</div>

<!-- CSS Classes Reference -->
<div class="demo-section">
  <h3>CSS Classes Reference</h3>
  <div style="background: var(--ux-surface); padding: var(--ux-space-lg); border-radius: var(--ux-border-radius-lg);">
    <pre class="ux-code-block" data-lang="css">/* Container */
.ux-work-order                    // Base card
.ux-work-order--compact           // Compact variant
.ux-work-order--detailed          // Detailed variant (wider)
.ux-work-order--full              // Full width
.ux-work-order--glass             // Glass morphism variant

/* Priority (left border indicator) */
.ux-work-order--priority-low
.ux-work-order--priority-normal
.ux-work-order--priority-high
.ux-work-order--priority-urgent   // Has pulse animation

/* Header */
.ux-work-order__header
.ux-work-order__header-top
.ux-work-order__number            // Work order number
.ux-work-order__product
.ux-work-order__product-name
.ux-work-order__product-sku

/* Status badge */
.ux-work-order__status
.ux-work-order__status--pending
.ux-work-order__status--in-progress
.ux-work-order__status--completed
.ux-work-order__status--on-hold
.ux-work-order__status--pulse     // Animated dot
.ux-work-order__status-dot

/* Priority label */
.ux-work-order__priority
.ux-work-order__priority--low
.ux-work-order__priority--normal
.ux-work-order__priority--high
.ux-work-order__priority--urgent

/* Content */
.ux-work-order__content
.ux-work-order__quantities
.ux-work-order__quantity
.ux-work-order__quantity-label
.ux-work-order__quantity-value
.ux-work-order__quantity-value--completed
.ux-work-order__quantity-value--remaining

/* Progress */
.ux-work-order__progress
.ux-work-order__progress-header
.ux-work-order__progress-label
.ux-work-order__progress-value
.ux-work-order__progress-bar
.ux-work-order__progress-fill
.ux-work-order__progress-fill--success
.ux-work-order__progress-fill--warning

/* Due date */
.ux-work-order__due-date
.ux-work-order__due-date--overdue
.ux-work-order__due-date--warning
.ux-work-order__due-date-icon

/* Machine */
.ux-work-order__machine
.ux-work-order__machine-icon
.ux-work-order__machine-name

/* Materials */
.ux-work-order__materials
.ux-work-order__materials-header
.ux-work-order__materials-count
.ux-work-order__materials-list
.ux-work-order__material
.ux-work-order__material--shortage
.ux-work-order__material-name
.ux-work-order__material-qty

/* Meta row */
.ux-work-order__meta
.ux-work-order__meta-item
.ux-work-order__meta-icon

/* Actions */
.ux-work-order__actions
.ux-work-order__action
.ux-work-order__action--start
.ux-work-order__action--pause
.ux-work-order__action--complete
.ux-work-order__action--secondary
.ux-work-order__action-icon

/* Grid layouts */
.ux-work-order-grid               // Auto-fill grid
.ux-work-order-column             // Kanban column
.ux-work-order-column__header
.ux-work-order-column__count</pre>
  </div>
</div>
