# views.py
from django.http import HttpResponse
from django.template.loader import render_to_string
from .models import City

def get_cities(request):
    """Retorna opciones de ciudades filtradas por pais."""
    country_id = request.GET.get('country')

    if not country_id:
        return HttpResponse('<option value="">Selecciona un pais primero</option>')

    cities = City.objects.filter(country_id=country_id).order_by('name')

    # Opción 1: Render directo
    html = '<option value="">Selecciona una ciudad</option>'
    for city in cities:
        html += f'<option value="{city.id}">{city.name}</option>'
    return HttpResponse(html)

    # Opción 2: Usando template parcial
    # return HttpResponse(render_to_string('partials/city_options.html', {'cities': cities}))
