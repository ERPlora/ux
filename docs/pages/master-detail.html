<style>
    .demo-section { margin-bottom: var(--ux-space-2xl); }
    .demo-section h3 { font-size: var(--ux-font-size-lg); font-weight: 600; margin-bottom: var(--ux-space-md); }
    .demo-section h4 { font-size: var(--ux-font-size-md); font-weight: 500; margin: var(--ux-space-lg) 0 var(--ux-space-sm); }
    .demo-section p { font-size: var(--ux-font-size-md); color: var(--ux-text-secondary); margin-bottom: var(--ux-space-md); }
    .demo-frame {
      background: var(--ux-surface);
      border: 1px solid var(--ux-border-color);
      border-radius: var(--ux-border-radius-lg);
      overflow: hidden;
      margin-bottom: var(--ux-space-md);
    }
    .demo-frame--tall {
      height: 450px;
    }
    .class-table {
      width: 100%;
      border-collapse: collapse;
      font-size: var(--ux-font-size-md);
    }
    .class-table th, .class-table td {
      padding: var(--ux-space-sm) var(--ux-space-md);
      text-align: left;
      border-bottom: 1px solid var(--ux-border-color);
    }
    .class-table th {
      background: var(--ux-surface-secondary);
      font-weight: 600;
    }
    .class-table code {
      background: var(--ux-surface-secondary);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: var(--ux-font-size-md);
    }
    /* Demo items */
    .demo-list-item {
      display: flex;
      align-items: center;
      gap: var(--ux-space-sm);
      padding: var(--ux-space-md);
      cursor: pointer;
      transition: background var(--ux-transition-fast);
      border-bottom: 1px solid var(--ux-border-color);
    }
    .demo-list-item:hover {
      background: var(--ux-surface-secondary);
    }
    .demo-list-item--selected {
      background: rgba(var(--ux-primary-rgb), 0.1);
    }
    .demo-list-item__icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--ux-primary);
      color: var(--ux-primary-contrast);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
    }
    .demo-list-item__content {
      flex: 1;
    }
    .demo-list-item__title {
      font-weight: 500;
      margin-bottom: 2px;
    }
    .demo-list-item__subtitle {
      font-size: var(--ux-font-size-sm);
      color: var(--ux-text-secondary);
    }
  </style>

<div>
    <!-- Intro -->
    <div class="demo-section">
      <h3>Master-Detail</h3>
      <p>Layout de dos paneles con lista maestra a la izquierda y detalle a la derecha. Ideal para interfaces de administracion como roles, usuarios, configuraciones, etc.</p>
    </div>

    <!-- Basic Demo -->
    <div class="demo-section">
      <h3>Demo Basico</h3>
      <p>Panel izquierdo con lista de items, panel derecho con detalle del item seleccionado.</p>

      <ux-playground src="examples/master-detail/demo-basico.html"></ux-playground>
      <div class="demo-frame demo-frame--tall" x-data="{
        selectedId: null,
        items: [
          { id: 1, name: 'Admin', users: 3, description: 'Acceso total al sistema' },
          { id: 2, name: 'Manager', users: 5, description: 'Gestion de operaciones' },
          { id: 3, name: 'Cashier', users: 12, description: 'Operaciones de caja' },
          { id: 4, name: 'Viewer', users: 8, description: 'Solo lectura' }
        ],
        get selectedItem() {
          return this.items.find(i => i.id === this.selectedId);
        }
      }">
        <div class="ux-master-detail" style="height: 100%;">
          <!-- Master Panel -->
          <div class="ux-master-detail__master">
            <div class="ux-master-detail__master-header">
              <h2 style="font-size: var(--ux-font-size-lg); font-weight: 600; margin: 0 0 var(--ux-space-sm);">Roles</h2>
              <div class="ux-searchbar ux-searchbar--outline ux-searchbar--sm">
                <div class="ux-searchbar__container">
                  <span class="ux-searchbar__icon">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/>
                    </svg>
                  </span>
                  <input type="search" class="ux-searchbar__input" placeholder="Buscar roles...">
                </div>
              </div>
            </div>
            <div class="ux-master-detail__master-content">
              <template x-for="item in items" :key="item.id">
                <div class="demo-list-item"
                     :class="{ 'demo-list-item--selected': selectedId === item.id }"
                     @click="selectedId = item.id">
                  <div class="demo-list-item__icon" x-text="item.name.charAt(0)"></div>
                  <div class="demo-list-item__content">
                    <div class="demo-list-item__title" x-text="item.name"></div>
                    <div class="demo-list-item__subtitle" x-text="item.users + ' usuarios'"></div>
                  </div>
                </div>
              </template>
            </div>
          </div>

          <!-- Detail Panel -->
          <div class="ux-master-detail__detail">
            <template x-if="!selectedId">
              <div class="ux-master-detail__empty">
                <div>
                  <div class="ux-master-detail__empty-icon">
                    <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <path d="M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z"/>
                      <path d="M12 6v6l4 2"/>
                    </svg>
                  </div>
                  <h3 class="ux-master-detail__empty-title">Selecciona un rol</h3>
                  <p class="ux-master-detail__empty-text">Elige un rol de la lista para ver sus detalles</p>
                </div>
              </div>
            </template>
            <template x-if="selectedId">
              <div>
                <div class="ux-master-detail__detail-header">
                  <div style="display: flex; align-items: center; justify-content: space-between;">
                    <h2 style="font-size: var(--ux-font-size-xl); font-weight: 600; margin: 0;" x-text="selectedItem?.name"></h2>
                    <button class="ux-button ux-button--sm ux-button--outline ux-color-primary--outline">Editar</button>
                  </div>
                </div>
                <div class="ux-master-detail__detail-content" style="padding: var(--ux-space-lg);">
                  <p style="color: var(--ux-text-secondary); margin-bottom: var(--ux-space-lg);" x-text="selectedItem?.description"></p>
                  <div style="display: flex; gap: var(--ux-space-md);">
                    <span class="ux-badge ux-color-primary--soft" x-text="selectedItem?.users + ' usuarios'"></span>
                    <span class="ux-badge ux-color-success--soft">Activo</span>
                  </div>
                </div>
              </div>
            </template>
          </div>
        </div>
      </div>

      <pre class="ux-code-block" data-lang="html"><div class="ux-master-detail">
  <!-- Master Panel -->
  <div class="ux-master-detail__master">
    <div class="ux-master-detail__master-header">
      <h2>Titulo</h2>
      <!-- Searchbar, filters, etc -->
    </div>
    <div class="ux-master-detail__master-content">
      <!-- Lista de items -->
    </div>
  </div>

  <!-- Detail Panel -->
  <div class="ux-master-detail__detail">
    <div class="ux-master-detail__detail-header">...</div>
    <div class="ux-master-detail__detail-content">...</div>
  </div>
</div></pre>
    </div>

    <!-- With Navbar -->
    <div class="demo-section">
      <h3>Con Navbar</h3>
      <p>Usa <code>.ux-master-detail--has-navbar</code> para calcular la altura correcta considerando la barra de navegacion.</p>

      <pre class="ux-code-block" data-lang="html"><!-- Resta automaticamente la altura del navbar (56px por defecto) -->
<div class="ux-master-detail ux-master-detail--has-navbar">
  ...
</div>

<!-- Altura completa (100dvh) -->
<div class="ux-master-detail ux-master-detail--full-height">
  ...
</div></pre>
    </div>

    <!-- Width Variants -->
    <div class="demo-section">
      <h3>Variantes de Ancho</h3>

      <h4>Default (280px)</h4>
      <pre class="ux-code-block" data-lang="html"><div class="ux-master-detail">...</div></pre>

      <h4>Narrow (240px)</h4>
      <pre class="ux-code-block" data-lang="html"><div class="ux-master-detail ux-master-detail--narrow-master">...</div></pre>

      <h4>Wide (350px)</h4>
      <pre class="ux-code-block" data-lang="html"><div class="ux-master-detail ux-master-detail--wide-master">...</div></pre>

      <h4>Custom Width</h4>
      <pre class="ux-code-block" data-lang="html"><div class="ux-master-detail" style="--ux-master-detail-master-width: 320px;">
  ...
</div></pre>
    </div>

    <!-- Mobile Behavior -->
    <div class="demo-section">
      <h3>Comportamiento Movil</h3>
      <p>En pantallas menores a 768px, el layout cambia a vertical:</p>
      <ul style="color: var(--ux-text-secondary); margin-bottom: var(--ux-space-md); padding-left: var(--ux-space-lg);">
        <li>Master panel: Se apila arriba con altura maxima del 40vh</li>
        <li>Detail panel: Ocupa el resto del espacio</li>
        <li>Ambos paneles son scrollables independientemente</li>
      </ul>

      <pre class="ux-code-block" data-lang="html"><!-- Personalizar altura del master en movil -->
<div class="ux-master-detail"
     style="--ux-master-detail-mobile-master-height: 50vh;">
  ...
</div></pre>
    </div>

    <!-- CSS Classes Reference -->
    <div class="demo-section">
      <h3>Referencia de Clases</h3>

      <h4>Container</h4>
      <table class="class-table">
        <thead>
          <tr><th>Clase</th><th>Descripcion</th></tr>
        </thead>
        <tbody>
          <tr><td><code>.ux-master-detail</code></td><td>Contenedor principal</td></tr>
          <tr><td><code>.ux-master-detail--full-height</code></td><td>Altura 100dvh</td></tr>
          <tr><td><code>.ux-master-detail--has-navbar</code></td><td>Resta altura del navbar (calc(100dvh - 56px))</td></tr>
          <tr><td><code>.ux-master-detail--narrow-master</code></td><td>Panel master de 240px</td></tr>
          <tr><td><code>.ux-master-detail--wide-master</code></td><td>Panel master de 350px</td></tr>
          <tr><td><code>.ux-master-detail--glass</code></td><td>Variante glass morphism</td></tr>
        </tbody>
      </table>

      <h4>Master Panel</h4>
      <table class="class-table">
        <thead>
          <tr><th>Clase</th><th>Descripcion</th></tr>
        </thead>
        <tbody>
          <tr><td><code>.ux-master-detail__master</code></td><td>Panel izquierdo (lista)</td></tr>
          <tr><td><code>.ux-master-detail__master-header</code></td><td>Header del master (titulo, busqueda)</td></tr>
          <tr><td><code>.ux-master-detail__master-content</code></td><td>Contenido scrollable del master</td></tr>
          <tr><td><code>.ux-master-detail__master-footer</code></td><td>Footer opcional del master</td></tr>
        </tbody>
      </table>

      <h4>Detail Panel</h4>
      <table class="class-table">
        <thead>
          <tr><th>Clase</th><th>Descripcion</th></tr>
        </thead>
        <tbody>
          <tr><td><code>.ux-master-detail__detail</code></td><td>Panel derecho (detalle)</td></tr>
          <tr><td><code>.ux-master-detail__detail-header</code></td><td>Header del detalle</td></tr>
          <tr><td><code>.ux-master-detail__detail-content</code></td><td>Contenido scrollable del detalle</td></tr>
          <tr><td><code>.ux-master-detail__detail-footer</code></td><td>Footer opcional del detalle</td></tr>
        </tbody>
      </table>

      <h4>Empty State</h4>
      <table class="class-table">
        <thead>
          <tr><th>Clase</th><th>Descripcion</th></tr>
        </thead>
        <tbody>
          <tr><td><code>.ux-master-detail__empty</code></td><td>Contenedor del estado vacio</td></tr>
          <tr><td><code>.ux-master-detail__empty-icon</code></td><td>Icono del estado vacio</td></tr>
          <tr><td><code>.ux-master-detail__empty-title</code></td><td>Titulo del estado vacio</td></tr>
          <tr><td><code>.ux-master-detail__empty-text</code></td><td>Texto descriptivo del estado vacio</td></tr>
        </tbody>
      </table>
    </div>

    <!-- CSS Variables -->
    <div class="demo-section">
      <h3>Variables CSS</h3>
      <table class="class-table">
        <thead>
          <tr><th>Variable</th><th>Default</th><th>Descripcion</th></tr>
        </thead>
        <tbody>
          <tr><td><code>--ux-master-detail-master-width</code></td><td>280px</td><td>Ancho del panel master</td></tr>
          <tr><td><code>--ux-master-detail-master-min-width</code></td><td>240px</td><td>Ancho minimo del panel master</td></tr>
          <tr><td><code>--ux-master-detail-master-max-width</code></td><td>400px</td><td>Ancho maximo del panel master</td></tr>
          <tr><td><code>--ux-master-detail-breakpoint</code></td><td>768px</td><td>Breakpoint para comportamiento movil</td></tr>
          <tr><td><code>--ux-master-detail-mobile-master-height</code></td><td>40vh</td><td>Altura del master en movil</td></tr>
        </tbody>
      </table>
    </div>

    <!-- Alpine.js Component -->
    <div class="demo-section">
      <h3>Componente Alpine.js (Opcional)</h3>
      <p>Para funcionalidad interactiva avanzada, usa el componente <code>uxMasterDetail</code>.</p>

      <pre class="ux-code-block" data-lang="html"><div class="ux-master-detail ux-master-detail--collapsible"
     x-data="uxMasterDetail({ initialSelection: 'role-1' })"
     :class="containerClasses">

  <div class="ux-master-detail__master">
    <template x-for="item in items">
      <div @click="select(item.id)"
           :class="{ 'selected': isSelected(item.id) }">
        ...
      </div>
    </template>
  </div>

  <div class="ux-master-detail__detail">
    <!-- En movil, boton para abrir master -->
    <button @click="toggleMaster()">Ver lista</button>
    ...
  </div>
</div></pre>

      <h4>Opciones</h4>
      <table class="class-table">
        <thead>
          <tr><th>Opcion</th><th>Tipo</th><th>Default</th><th>Descripcion</th></tr>
        </thead>
        <tbody>
          <tr><td><code>initialSelection</code></td><td>any</td><td>null</td><td>ID del item seleccionado inicialmente</td></tr>
          <tr><td><code>masterOpenByDefault</code></td><td>boolean</td><td>false</td><td>Master abierto por defecto en movil</td></tr>
        </tbody>
      </table>

      <h4>Metodos</h4>
      <table class="class-table">
        <thead>
          <tr><th>Metodo</th><th>Descripcion</th></tr>
        </thead>
        <tbody>
          <tr><td><code>select(id)</code></td><td>Selecciona un item y cierra master en movil</td></tr>
          <tr><td><code>toggleMaster()</code></td><td>Toggle del panel master (solo movil)</td></tr>
          <tr><td><code>openMaster()</code></td><td>Abre el panel master (solo movil)</td></tr>
          <tr><td><code>closeMaster()</code></td><td>Cierra el panel master (solo movil)</td></tr>
          <tr><td><code>isSelected(id)</code></td><td>Retorna true si el item esta seleccionado</td></tr>
        </tbody>
      </table>

      <h4>Eventos</h4>
      <table class="class-table">
        <thead>
          <tr><th>Evento</th><th>Detalle</th><th>Descripcion</th></tr>
        </thead>
        <tbody>
          <tr><td><code>masterdetail:select</code></td><td>{ id }</td><td>Cuando se selecciona un item</td></tr>
          <tr><td><code>masterdetail:toggle</code></td><td>{ open }</td><td>Cuando se toggle el master</td></tr>
          <tr><td><code>masterdetail:open</code></td><td>-</td><td>Cuando se abre el master</td></tr>
          <tr><td><code>masterdetail:close</code></td><td>-</td><td>Cuando se cierra el master</td></tr>
        </tbody>
      </table>
    </div>

    <!-- HTMX + Django -->
    <div class="demo-section">
      <h3>HTMX + Django</h3>
      <p>Integracion con HTMX para cargar contenido dinamicamente desde Django. El panel master carga la lista y al hacer clic en un item, el detalle se carga via HTMX.</p>

      <h4>Template Base (master_detail.html)</h4>
      <pre class="ux-code-block" data-lang="html"><div class="ux-master-detail ux-master-detail--has-navbar">
  <!-- Master Panel -->
  <div class="ux-master-detail__master">
    <div class="ux-master-detail__master-header">
      <h2>Roles</h2>
      <input type="search"
             class="ux-searchbar__input"
             name="q"
             placeholder="Buscar..."
             hx-get="{% url 'roles:list' %}"
             hx-trigger="input changed delay:300ms"
             hx-target="#master-list">
    </div>
    <div id="master-list"
         class="ux-master-detail__master-content"
         hx-get="{% url 'roles:list' %}"
         hx-trigger="load">
      <!-- Lista cargada via HTMX -->
    </div>
  </div>

  <!-- Detail Panel -->
  <div id="detail-panel" class="ux-master-detail__detail">
    <div class="ux-master-detail__empty">
      <div>
        <h3 class="ux-master-detail__empty-title">Selecciona un rol</h3>
        <p class="ux-master-detail__empty-text">Elige un rol de la lista</p>
      </div>
    </div>
  </div>
</div></pre>

      <h4>Partial: Lista de Items (partials/role_list.html)</h4>
      <pre class="ux-code-block" data-lang="html">{% for role in roles %}
<div class="ux-list__item"
     hx-get="{% url 'roles:detail' role.id %}"
     hx-target="#detail-panel"
     hx-swap="innerHTML"
     hx-push-url="true">
  <div class="ux-list__content">
    <div class="ux-list__title">{{ role.name }}</div>
    <div class="ux-list__subtitle">{{ role.users_count }} usuarios</div>
  </div>
  <span class="ux-badge ux-color-{{ role.status }}--soft">
    {{ role.get_status_display }}
  </span>
</div>
{% empty %}
<div class="ux-master-detail__empty">
  <p>No se encontraron roles</p>
</div>
{% endfor %}</pre>

      <h4>Partial: Detalle del Item (partials/role_detail.html)</h4>
      <pre class="ux-code-block" data-lang="html"><div class="ux-master-detail__detail-header">
  <div style="display: flex; justify-content: space-between; align-items: center;">
    <h2>{{ role.name }}</h2>
    <div style="display: flex; gap: var(--ux-space-sm);">
      <button class="ux-button ux-button--sm ux-button--outline ux-color-primary--outline"
              hx-get="{% url 'roles:edit' role.id %}"
              hx-target="#detail-panel">
        Editar
      </button>
      <button class="ux-button ux-button--sm ux-button--outline ux-color-danger--outline"
              hx-delete="{% url 'roles:delete' role.id %}"
              hx-confirm="Eliminar {{ role.name }}?"
              hx-target="#master-list">
        Eliminar
      </button>
    </div>
  </div>
</div>
<div class="ux-master-detail__detail-content">
  <p>{{ role.description }}</p>

  <h4>Permisos</h4>
  <ul class="ux-list ux-list--inset">
    {% for permission in role.permissions.all %}
    <li class="ux-list__item">
      {{ permission.name }}
    </li>
    {% endfor %}
  </ul>
</div></pre>

      <h4>Django Views</h4>
      <pre class="ux-code-block" data-lang="python"># views.py
from django.shortcuts import render, get_object_or_404
from django.http import HttpResponse
from .models import Role

def role_list(request):
    """Lista de roles (partial para HTMX)"""
    q = request.GET.get('q', '')
    roles = Role.objects.all()
    if q:
        roles = roles.filter(name__icontains=q)

    # Si es HTMX, devolver solo el partial
    if request.headers.get('HX-Request'):
        return render(request, 'roles/partials/role_list.html', {'roles': roles})

    # Si es navegacion directa, devolver la pagina completa
    return render(request, 'roles/master_detail.html', {'roles': roles})

def role_detail(request, pk):
    """Detalle de rol (partial para HTMX)"""
    role = get_object_or_404(Role, pk=pk)
    return render(request, 'roles/partials/role_detail.html', {'role': role})

def role_delete(request, pk):
    """Eliminar rol y refrescar lista"""
    role = get_object_or_404(Role, pk=pk)
    role.delete()
    # Retornar lista actualizada
    roles = Role.objects.all()
    return render(request, 'roles/partials/role_list.html', {'roles': roles})</pre>

      <h4>URLs</h4>
      <pre class="ux-code-block" data-lang="python"># urls.py
from django.urls import path
from . import views

app_name = 'roles'

urlpatterns = [
    path('', views.role_list, name='list'),
    path('<int:pk>/', views.role_detail, name='detail'),
    path('<int:pk>/edit/', views.role_edit, name='edit'),
    path('<int:pk>/delete/', views.role_delete, name='delete'),
]</pre>

      <h4>Crear Nuevo Item con Modal</h4>
      <pre class="ux-code-block" data-lang="html"><!-- Boton en el master-header -->
<button class="ux-button ux-button--sm ux-color-primary"
        hx-get="{% url 'roles:create' %}"
        hx-target="#modal-container"
        hx-swap="innerHTML">
  + Nuevo
</button>

<!-- Container para modal (fuera del master-detail) -->
<div id="modal-container"></div>

<!-- Partial: Modal de creacion (partials/role_form_modal.html) -->
<div class="ux-modal-backdrop" onclick="this.parentElement.innerHTML=''"></div>
<div class="ux-modal ux-modal--open">
  <div class="ux-modal__header">
    <h3>Nuevo Rol</h3>
    <button onclick="document.getElementById('modal-container').innerHTML=''">
      &times;
    </button>
  </div>
  <form hx-post="{% url 'roles:create' %}"
        hx-target="#master-list"
        hx-on::after-request="document.getElementById('modal-container').innerHTML=''">
    {% csrf_token %}
    <div class="ux-modal__content">
      {{ form.as_p }}
    </div>
    <div class="ux-modal__footer">
      <button type="button"
              class="ux-button ux-button--outline"
              onclick="document.getElementById('modal-container').innerHTML=''">
        Cancelar
      </button>
      <button type="submit" class="ux-button ux-color-primary">
        Guardar
      </button>
    </div>
  </form>
</div></pre>

      <h4>Indicador de Carga</h4>
      <pre class="ux-code-block" data-lang="html"><!-- Agregar clase htmx-indicator al spinner -->
<style>
  .htmx-indicator { opacity: 0; transition: opacity 200ms; }
  .htmx-request .htmx-indicator { opacity: 1; }
</style>

<div id="detail-panel" class="ux-master-detail__detail">
  <div class="htmx-indicator" style="padding: var(--ux-space-xl); text-align: center;">
    <div class="ux-spinner ux-color-primary"></div>
  </div>
  <!-- Contenido del detalle -->
</div></pre>

      <h4>Seleccion Activa con CSS</h4>
      <pre class="ux-code-block" data-lang="html"><!-- Usar hx-vals para pasar el ID seleccionado -->
<div class="ux-list__item"
     :class="{ 'ux-list__item--selected': selectedId === {{ role.id }} }"
     hx-get="{% url 'roles:detail' role.id %}"
     hx-target="#detail-panel"
     @click="selectedId = {{ role.id }}">
  ...
</div>

<!-- O usando solo HTMX con hx-on -->
<div class="ux-list__item"
     hx-get="{% url 'roles:detail' role.id %}"
     hx-target="#detail-panel"
     hx-on::after-request="
       document.querySelectorAll('.ux-list__item--selected')
         .forEach(el => el.classList.remove('ux-list__item--selected'));
       this.classList.add('ux-list__item--selected');
     ">
  ...
</div></pre>
    </div>

  </div>