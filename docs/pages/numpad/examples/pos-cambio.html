<form class="ux-numpad" style="width: 320px;"
      x-data="{ cashReceived: 0, total: 25.50 }"
      hx-post="/api/pos/calculate-change"
      hx-trigger="input from:#cash-received"
      hx-target="#change-display"
      hx-swap="innerHTML">

  <input type="hidden" name="total" :value="total">

  <div style="display: flex; justify-content: space-between; padding: var(--ux-space-md); background: var(--ux-surface-secondary); border-radius: var(--ux-border-radius); margin-bottom: var(--ux-space-md);">
    <span>Total a pagar:</span>
    <strong x-text="'$' + total.toFixed(2)"></strong>
  </div>

  <div class="ux-numpad__display">
    <span class="ux-numpad__display-label">Efectivo recibido</span>
    <span class="ux-numpad__display-currency">$</span>
    <input type="text"
           id="cash-received"
           name="cash_received"
           class="ux-numpad__display-value"
           x-model="cashReceived"
           readonly
           style="background: transparent; border: none; font: inherit; color: inherit; text-align: right; width: 100%;">
  </div>

  <div class="ux-numpad__quick-amounts">
    <button type="button" class="ux-numpad__quick-btn" @click="cashReceived = 30">$30</button>
    <button type="button" class="ux-numpad__quick-btn" @click="cashReceived = 50">$50</button>
    <button type="button" class="ux-numpad__quick-btn" @click="cashReceived = 100">$100</button>
  </div>

  <div class="ux-numpad__grid">
    <button type="button" class="ux-numpad__key" @click="cashReceived = String(cashReceived) + '7'">7</button>
    <button type="button" class="ux-numpad__key" @click="cashReceived = String(cashReceived) + '8'">8</button>
    <button type="button" class="ux-numpad__key" @click="cashReceived = String(cashReceived) + '9'">9</button>
    <button type="button" class="ux-numpad__key" @click="cashReceived = String(cashReceived) + '4'">4</button>
    <button type="button" class="ux-numpad__key" @click="cashReceived = String(cashReceived) + '5'">5</button>
    <button type="button" class="ux-numpad__key" @click="cashReceived = String(cashReceived) + '6'">6</button>
    <button type="button" class="ux-numpad__key" @click="cashReceived = String(cashReceived) + '1'">1</button>
    <button type="button" class="ux-numpad__key" @click="cashReceived = String(cashReceived) + '2'">2</button>
    <button type="button" class="ux-numpad__key" @click="cashReceived = String(cashReceived) + '3'">3</button>
    <button type="button" class="ux-numpad__key ux-numpad__key--danger" @click="cashReceived = 0">C</button>
    <button type="button" class="ux-numpad__key" @click="cashReceived = String(cashReceived) + '0'">0</button>
    <button type="button" class="ux-numpad__key" @click="cashReceived = String(cashReceived).slice(0, -1) || 0">&#9003;</button>
  </div>

  <div id="change-display" style="text-align: center; padding: var(--ux-space-md); font-size: var(--ux-font-size-xl); font-weight: 700;">
    <template x-if="Number(cashReceived) >= total">
      <span style="color: var(--ux-success);">Cambio: $<span x-text="(Number(cashReceived) - total).toFixed(2)"></span></span>
    </template>
    <template x-if="Number(cashReceived) < total && Number(cashReceived) > 0">
      <span style="color: var(--ux-danger);">Falta: $<span x-text="(total - Number(cashReceived)).toFixed(2)"></span></span>
    </template>
  </div>

  <button type="submit"
          class="ux-button ux-color-success"
          style="width: 100%;"
          :disabled="Number(cashReceived) < total"
          hx-post="/api/pos/complete-sale"
          hx-target="#sale-result">
    Completar Venta
  </button>
</form>
<div id="sale-result"></div>
