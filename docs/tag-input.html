<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Tag Input - UX Library</title>
  <link rel="stylesheet" href="../bootstrap-grid.min.css">
  <script src="../dist/ux.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
      background: var(--ux-surface-secondary);
      padding: 2rem;
      padding-bottom: 4rem;
    }
    .demo-section {
      margin-bottom: 3rem;
    }
    .demo-section h2 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--ux-text);
    }
    .demo-box {
      background: var(--ux-surface);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1rem;
    }
    .demo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }
    code {
      background: var(--ux-surface-tertiary);
      padding: 0.125rem 0.375rem;
      border-radius: 4px;
      font-size: 0.875rem;
    }
    pre {
      background: var(--ux-gray-900);
      color: var(--ux-gray-100);
      padding: 1rem;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 0.8125rem;
      line-height: 1.5;
    }
    .result-display {
      margin-top: 1rem;
      padding: 0.75rem;
      background: var(--ux-surface-secondary);
      border-radius: 8px;
      font-size: 0.8125rem;
      font-family: monospace;
    }
    .demo-glass-bg {
      background: linear-gradient(135deg, var(--ux-purple-400), var(--ux-indigo-500));
      padding: 2rem;
      border-radius: 16px;
    }
    label {
      display: block;
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--ux-text-secondary);
      margin-bottom: 0.5rem;
    }
  </style>
</head>
<body class="ux-app">

  <h1 style="margin-bottom: 0.5rem;">Tag Input</h1>
  <p style="color: var(--ux-text-secondary); margin-bottom: 2rem;">
    Campo de entrada para múltiples valores (tags/chips). Soporta autocompletado, validación y límites.
  </p>

  <!-- Basic Tag Input -->
  <section class="demo-section">
    <h2>Tag Input Básico</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Escribe y pulsa Enter o coma para añadir tags. Backspace para eliminar el último.
    </p>

    <div class="demo-box">
      <div x-data="uxTagInput({ placeholder: 'Añade etiquetas...' })" class="ux-tag-input-wrapper" style="max-width: 500px;">
        <div class="ux-tag-input" @click="focus()">
          <template x-for="(tag, index) in tags" :key="index">
            <span class="ux-tag">
              <span class="ux-tag__text" x-text="getLabel(tag)"></span>
              <button type="button" class="ux-tag__remove" @click.stop="removeTag(index)" x-html="closeIcon"></button>
            </span>
          </template>
          <input type="text"
                 class="ux-tag-input__field"
                 x-ref="input"
                 x-model="inputValue"
                 :placeholder="tags.length === 0 ? placeholder : ''"
                 :disabled="disabled"
                 @input="onInput($event)"
                 @keydown="onKeydown($event)"
                 @focus="onFocus()"
                 @blur="onBlur()">
        </div>

        <div class="result-display" x-show="tags.length > 0">
          Tags: <span x-text="JSON.stringify(tags)"></span>
        </div>
      </div>
    </div>

    <pre>&lt;div x-data="uxTagInput({ placeholder: 'Añade etiquetas...' })"&gt;
  &lt;div class="ux-tag-input" @click="focus()"&gt;
    &lt;template x-for="(tag, index) in tags"&gt;
      &lt;span class="ux-tag"&gt;
        &lt;span class="ux-tag__text" x-text="getLabel(tag)"&gt;&lt;/span&gt;
        &lt;button class="ux-tag__remove" @click.stop="removeTag(index)"&gt;×&lt;/button&gt;
      &lt;/span&gt;
    &lt;/template&gt;
    &lt;input type="text" class="ux-tag-input__field" x-ref="input"
           x-model="inputValue" @keydown="onKeydown($event)"&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
  </section>

  <!-- With Suggestions -->
  <section class="demo-section">
    <h2>Con Sugerencias</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Autocomplete con lista de sugerencias predefinidas.
    </p>

    <div class="demo-box">
      <div x-data="uxTagInput({
        placeholder: 'Buscar tecnología...',
        suggestions: ['JavaScript', 'TypeScript', 'Python', 'Ruby', 'Go', 'Rust', 'Java', 'C#', 'PHP', 'Swift', 'Kotlin', 'React', 'Vue', 'Angular', 'Node.js'],
        allowCreate: true
      })" class="ux-tag-input-wrapper" style="max-width: 500px;">
        <label>Tecnologías</label>
        <div class="ux-tag-input" @click="focus()">
          <template x-for="(tag, index) in tags" :key="index">
            <span class="ux-tag">
              <span class="ux-tag__text" x-text="getLabel(tag)"></span>
              <button type="button" class="ux-tag__remove" @click.stop="removeTag(index)" x-html="closeIcon"></button>
            </span>
          </template>
          <input type="text"
                 class="ux-tag-input__field"
                 x-ref="input"
                 x-model="inputValue"
                 :placeholder="tags.length === 0 ? placeholder : ''"
                 @input="onInput($event)"
                 @keydown="onKeydown($event)"
                 @focus="onFocus()"
                 @blur="onBlur()">
        </div>

        <!-- Suggestions dropdown -->
        <div class="ux-tag-input__suggestions" :class="{ 'ux-tag-input__suggestions--open': isOpen }">
          <template x-for="(suggestion, index) in filteredSuggestions" :key="index">
            <div class="ux-tag-input__suggestion"
                 :class="{ 'ux-tag-input__suggestion--active': index === activeIndex }"
                 @click="selectSuggestion(suggestion)"
                 @mouseenter="activeIndex = index"
                 x-text="getLabel(suggestion)">
            </div>
          </template>
          <div class="ux-tag-input__suggestion ux-tag-input__suggestion-create"
               x-show="allowCreate && inputValue.trim() && !filteredSuggestions.some(s => getLabel(s).toLowerCase() === inputValue.toLowerCase())"
               :class="{ 'ux-tag-input__suggestion--active': activeIndex === filteredSuggestions.length }"
               @click="addTag(inputValue)">
            Crear "<span x-text="inputValue"></span>"
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- With Max Tags -->
  <section class="demo-section">
    <h2>Con Límite de Tags</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Limita el número máximo de tags permitidos.
    </p>

    <div class="demo-box">
      <div x-data="uxTagInput({
        placeholder: 'Máximo 5 tags...',
        maxTags: 5,
        showCounter: true,
        value: ['Tag 1', 'Tag 2']
      })" class="ux-tag-input-wrapper" style="max-width: 500px;">
        <label>Tags (máximo 5)</label>
        <div class="ux-tag-input" :class="{ 'ux-tag-input--error': isAtLimit }" @click="focus()">
          <template x-for="(tag, index) in tags" :key="index">
            <span class="ux-tag">
              <span class="ux-tag__text" x-text="getLabel(tag)"></span>
              <button type="button" class="ux-tag__remove" @click.stop="removeTag(index)" x-html="closeIcon"></button>
            </span>
          </template>
          <input type="text"
                 class="ux-tag-input__field"
                 x-ref="input"
                 x-model="inputValue"
                 :placeholder="canAddMore ? placeholder : 'Límite alcanzado'"
                 :disabled="!canAddMore"
                 @input="onInput($event)"
                 @keydown="onKeydown($event)"
                 @focus="onFocus()"
                 @blur="onBlur()">
          <span class="ux-tag-input__counter" :class="{ 'ux-tag-input__counter--limit': isAtLimit }"
                x-text="tags.length + '/' + maxTags"></span>
        </div>
      </div>
    </div>
  </section>

  <!-- Tag Colors -->
  <section class="demo-section">
    <h2>Colores de Tags</h2>

    <div class="demo-box">
      <div x-data="{
        tags: [
          { label: 'Primary', color: '' },
          { label: 'Secondary', color: 'secondary' },
          { label: 'Success', color: 'success' },
          { label: 'Warning', color: 'warning' },
          { label: 'Danger', color: 'danger' }
        ]
      }">
        <div style="display: flex; flex-wrap: wrap; gap: 0.5rem;">
          <template x-for="tag in tags" :key="tag.label">
            <span class="ux-tag" :class="tag.color ? 'ux-tag--' + tag.color : ''">
              <span class="ux-tag__text" x-text="tag.label"></span>
            </span>
          </template>
        </div>
      </div>
    </div>

    <pre>.ux-tag                // Primary (default)
.ux-tag--secondary     // Gris
.ux-tag--success       // Verde
.ux-tag--warning       // Amarillo
.ux-tag--danger        // Rojo</pre>
  </section>

  <!-- Sizes -->
  <section class="demo-section">
    <h2>Tamaños</h2>

    <div class="demo-grid">
      <div class="demo-box">
        <label>Small</label>
        <div x-data="uxTagInput({ value: ['Small', 'Tags'] })" class="ux-tag-input-wrapper">
          <div class="ux-tag-input ux-tag-input--sm" @click="focus()">
            <template x-for="(tag, index) in tags" :key="index">
              <span class="ux-tag">
                <span class="ux-tag__text" x-text="getLabel(tag)"></span>
                <button type="button" class="ux-tag__remove" @click.stop="removeTag(index)" x-html="closeIcon"></button>
              </span>
            </template>
            <input type="text" class="ux-tag-input__field" x-ref="input" x-model="inputValue"
                   @keydown="onKeydown($event)">
          </div>
        </div>
      </div>

      <div class="demo-box">
        <label>Default</label>
        <div x-data="uxTagInput({ value: ['Default', 'Tags'] })" class="ux-tag-input-wrapper">
          <div class="ux-tag-input" @click="focus()">
            <template x-for="(tag, index) in tags" :key="index">
              <span class="ux-tag">
                <span class="ux-tag__text" x-text="getLabel(tag)"></span>
                <button type="button" class="ux-tag__remove" @click.stop="removeTag(index)" x-html="closeIcon"></button>
              </span>
            </template>
            <input type="text" class="ux-tag-input__field" x-ref="input" x-model="inputValue"
                   @keydown="onKeydown($event)">
          </div>
        </div>
      </div>

      <div class="demo-box">
        <label>Large</label>
        <div x-data="uxTagInput({ value: ['Large', 'Tags'] })" class="ux-tag-input-wrapper">
          <div class="ux-tag-input ux-tag-input--lg" @click="focus()">
            <template x-for="(tag, index) in tags" :key="index">
              <span class="ux-tag">
                <span class="ux-tag__text" x-text="getLabel(tag)"></span>
                <button type="button" class="ux-tag__remove" @click.stop="removeTag(index)" x-html="closeIcon"></button>
              </span>
            </template>
            <input type="text" class="ux-tag-input__field" x-ref="input" x-model="inputValue"
                   @keydown="onKeydown($event)">
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- With Validation -->
  <section class="demo-section">
    <h2>Con Validación</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Valida tags antes de añadirlos (ej: solo emails).
    </p>

    <div class="demo-box">
      <div x-data="{
        ...uxTagInput({
          placeholder: 'Añadir email...',
          validateTag: function(tag) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(tag)) {
              return 'Debe ser un email válido';
            }
            return true;
          }
        }),
        errorMsg: ''
      }"
      @tag-input:invalid.window="errorMsg = $event.detail.reason; setTimeout(() => errorMsg = '', 3000)"
      class="ux-tag-input-wrapper" style="max-width: 500px;">
        <label>Emails</label>
        <div class="ux-tag-input" :class="{ 'ux-tag-input--error': errorMsg }" @click="focus()">
          <template x-for="(tag, index) in tags" :key="index">
            <span class="ux-tag">
              <span class="ux-tag__text" x-text="getLabel(tag)"></span>
              <button type="button" class="ux-tag__remove" @click.stop="removeTag(index)" x-html="closeIcon"></button>
            </span>
          </template>
          <input type="text"
                 class="ux-tag-input__field"
                 x-ref="input"
                 x-model="inputValue"
                 :placeholder="placeholder"
                 @input="onInput($event)"
                 @keydown="onKeydown($event)"
                 @focus="onFocus()"
                 @blur="onBlur()">
        </div>
        <p x-show="errorMsg" x-text="errorMsg" style="color: var(--ux-danger); font-size: 0.8125rem; margin-top: 0.5rem;"></p>
      </div>
    </div>

    <pre>uxTagInput({
  validateTag: function(tag) {
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!emailRegex.test(tag)) {
      return 'Debe ser un email válido';
    }
    return true;
  }
})</pre>
  </section>

  <!-- Glass Variant -->
  <section class="demo-section">
    <h2>Glass Variant</h2>

    <div class="demo-glass-bg">
      <div x-data="uxTagInput({
        placeholder: 'Add tags...',
        value: ['Glass', 'Style']
      })" class="ux-tag-input-wrapper ux-tag-input-wrapper--glass" style="max-width: 400px;">
        <div class="ux-tag-input ux-tag-input--glass" @click="focus()">
          <template x-for="(tag, index) in tags" :key="index">
            <span class="ux-tag">
              <span class="ux-tag__text" x-text="getLabel(tag)"></span>
              <button type="button" class="ux-tag__remove" @click.stop="removeTag(index)" x-html="closeIcon"></button>
            </span>
          </template>
          <input type="text"
                 class="ux-tag-input__field"
                 x-ref="input"
                 x-model="inputValue"
                 :placeholder="tags.length === 0 ? placeholder : ''"
                 @input="onInput($event)"
                 @keydown="onKeydown($event)"
                 @focus="onFocus()"
                 @blur="onBlur()"
                 style="color: white;">
        </div>
      </div>
    </div>
  </section>

  <!-- Events -->
  <section class="demo-section">
    <h2>Eventos</h2>

    <div class="demo-box" x-data="{
      ...uxTagInput({ placeholder: 'Añade tags...' }),
      events: []
    }"
    @tag-input:add="events.unshift('add: ' + $event.detail.tag)"
    @tag-input:remove="events.unshift('remove: ' + $event.detail.tag)"
    @tag-input:change="events.unshift('change: [' + $event.detail.tags.join(', ') + ']')">
      <div class="row g-3">
        <div class="col-md-6">
          <div class="ux-tag-input-wrapper">
            <div class="ux-tag-input" @click="focus()">
              <template x-for="(tag, index) in tags" :key="index">
                <span class="ux-tag">
                  <span class="ux-tag__text" x-text="getLabel(tag)"></span>
                  <button type="button" class="ux-tag__remove" @click.stop="removeTag(index)" x-html="closeIcon"></button>
                </span>
              </template>
              <input type="text" class="ux-tag-input__field" x-ref="input" x-model="inputValue"
                     :placeholder="tags.length === 0 ? placeholder : ''"
                     @input="onInput($event)" @keydown="onKeydown($event)">
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div style="background: var(--ux-gray-900); color: var(--ux-green-400); padding: 0.75rem; border-radius: 8px; font-family: monospace; font-size: 0.75rem; max-height: 150px; overflow-y: auto;">
            <template x-for="(event, i) in events.slice(0, 10)" :key="i">
              <div x-text="event"></div>
            </template>
            <div x-show="events.length === 0" style="color: var(--ux-gray-500);">
              Añade o elimina tags...
            </div>
          </div>
        </div>
      </div>
    </div>

    <h3>Eventos disponibles</h3>
    <pre>@tag-input:add       // Tag añadido
@tag-input:remove    // Tag eliminado
@tag-input:change    // Lista de tags cambiada
@tag-input:invalid   // Tag no válido (con validación)
@tag-input:duplicate // Tag duplicado rechazado
@tag-input:clear     // Todos los tags eliminados
@tag-input:focus     // Input enfocado
@tag-input:blur      // Input perdió foco</pre>
  </section>

  <!-- API Reference -->
  <section class="demo-section">
    <h2>API Reference</h2>

    <h3>Opciones</h3>
    <pre>uxTagInput({
  placeholder: 'Add tag...',     // Placeholder del input
  suggestions: [],               // Array de sugerencias
  maxTags: Infinity,             // Máximo de tags
  maxLength: 50,                 // Longitud máxima por tag
  allowCreate: true,             // Permitir crear nuevos tags
  allowDuplicates: false,        // Permitir duplicados
  delimiter: ',',                // Delimitador para separar tags
  validateTag: null,             // Función de validación
  transformTag: null,            // Función de transformación
  disabled: false,               // Deshabilitado
  showCounter: false,            // Mostrar contador
  value: []                      // Tags iniciales
})</pre>

    <h3>Propiedades</h3>
    <pre>tags              // Array de tags actuales
inputValue        // Valor del input
isOpen            // Dropdown abierto
canAddMore        // Puede añadir más tags
isAtLimit         // Ha alcanzado el límite</pre>

    <h3>Métodos</h3>
    <pre>addTag(value)           // Añadir tag
removeTag(index)        // Eliminar tag por índice
removeLastTag()         // Eliminar último tag
clearAll()              // Eliminar todos
selectSuggestion(item)  // Seleccionar sugerencia
focus()                 // Enfocar el input
getLabel(item)          // Obtener texto del tag
getValue(item)          // Obtener valor del tag</pre>

    <h3>Clases CSS</h3>
    <pre>.ux-tag-input              // Contenedor
.ux-tag-input--sm          // Pequeño
.ux-tag-input--lg          // Grande
.ux-tag-input--glass       // Glass morphism
.ux-tag-input--disabled    // Deshabilitado
.ux-tag-input--error       // Estado error
.ux-tag                    // Tag individual
.ux-tag--secondary/success/warning/danger  // Colores</pre>
  </section>

</body>
</html>
