<style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
      background: var(--ux-surface-secondary);
      
      
    }
    .demo-section {
      margin-bottom: 3rem;
    }
    .demo-section h2 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--ux-text);
    }
    .demo-section h3 {
      font-size: 1rem;
      font-weight: 500;
      margin-bottom: 0.75rem;
      color: var(--ux-text-secondary);
    }
    .demo-box {
      background: var(--ux-surface);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1rem;
    }
    .demo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }
    code {
      background: var(--ux-surface-tertiary);
      padding: 0.125rem 0.375rem;
      border-radius: 4px;
      font-size: 0.875rem;
    }
    .event-log {
      font-family: monospace;
      font-size: 0.75rem;
      background: var(--ux-gray-900);
      color: var(--ux-green-400);
      padding: 0.75rem;
      border-radius: 8px;
      max-height: 150px;
      overflow-y: auto;
    }
    .demo-glass-bg {
      background: linear-gradient(135deg, var(--ux-cyan-400), var(--ux-blue-500));
      
      border-radius: 16px;
    }
    .result-display {
      margin-top: 1rem;
      padding: 0.75rem;
      background: var(--ux-surface-secondary);
      border-radius: 8px;
      font-size: 0.875rem;
    }
  </style>

<h1 style="margin-bottom: 0.5rem;">Autocomplete</h1>
  <p style="color: var(--ux-text-secondary); margin-bottom: 2rem;">
    Campo de b√∫squeda con sugerencias, resaltado de coincidencias y navegaci√≥n por teclado.
  </p>

  <!-- Basic Autocomplete (Vanilla JS) -->
  <section class="demo-section">
    <h2>Autocomplete B√°sico (Vanilla JS)</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Usando <code>data-ux-autocomplete</code> - funciona sin Alpine.js
    </p>

    <div class="demo-box">
      <div class="ux-autocomplete"
           data-ux-autocomplete
           data-items='["Apple", "Banana", "Cherry", "Date", "Elderberry", "Fig", "Grape", "Honeydew"]'
           style="max-width: 400px;"
           id="autocomplete-vanilla-demo">
        <input type="text"
               class="ux-autocomplete__input"
               placeholder="Search fruits..."
               autocomplete="off">
        <ul class="ux-autocomplete__list"></ul>
      </div>

      <div id="autocomplete-result" class="result-display" style="display: none;">
        Seleccionado: <strong id="autocomplete-value"></strong>
      </div>

      <script>
        document.getElementById('autocomplete-vanilla-demo').addEventListener('ux:autocomplete:select', function(e) {
          var result = document.getElementById('autocomplete-result');
          var value = document.getElementById('autocomplete-value');
          result.style.display = 'block';
          value.textContent = e.detail.label;
        });
      </script>
    </div>

    <pre class="ux-code-block" data-lang="html">&lt;!-- Vanilla JS with data-ux-autocomplete --&gt;
&lt;div class="ux-autocomplete"
     data-ux-autocomplete
     data-items='["Apple", "Banana", "Cherry"]'&gt;
  &lt;input type="text" class="ux-autocomplete__input" placeholder="Search..."&gt;
  &lt;ul class="ux-autocomplete__list"&gt;&lt;/ul&gt;
&lt;/div&gt;

&lt;script&gt;
// Listen for events
element.addEventListener('ux:autocomplete:select', (e) =&gt; {
  console.log('Selected:', e.detail.label, e.detail.value);
});
element.addEventListener('ux:autocomplete:search', (e) =&gt; {
  console.log('Query:', e.detail.query);
});
&lt;/script&gt;</pre>
  </section>

  <!-- Basic Autocomplete (Alpine.js) -->
  <section class="demo-section">
    <h2>Autocomplete B√°sico (Alpine.js)</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      B√∫squeda simple con lista de sugerencias.
    </p>

    <div class="demo-box" x-data="uxAutocomplete({
      items: [
        { label: 'Apple', value: 'apple' },
        { label: 'Banana', value: 'banana' },
        { label: 'Cherry', value: 'cherry' },
        { label: 'Date', value: 'date' },
        { label: 'Elderberry', value: 'elderberry' },
        { label: 'Fig', value: 'fig' },
        { label: 'Grape', value: 'grape' },
        { label: 'Honeydew', value: 'honeydew' }
      ],
      placeholder: 'Search fruits...'
    })">
      <div class="ux-autocomplete" style="max-width: 400px;">
        <input type="text"
               class="ux-autocomplete__input"
               :class="{ 'ux-autocomplete__input--loading': isLoading }"
               x-ref="input"
               x-model="query"
               :placeholder="placeholder"
               @input="onInput()"
               @focus="onFocus()"
               @blur="onBlur()"
               @keydown="onKeydown($event)"
               autocomplete="off">

        <button class="ux-autocomplete__clear"
                :class="{ 'ux-autocomplete__clear--hidden': !query }"
                @click="clear()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>

        <div class="ux-autocomplete__dropdown"
             :class="{ 'ux-autocomplete__dropdown--open': isOpen }">
          <ul class="ux-autocomplete__list" x-show="filteredItems.length > 0">
            <template x-for="(item, index) in filteredItems" :key="getValue(item)">
              <li class="ux-autocomplete__item"
                  :class="{ 'ux-autocomplete__item--active': index === activeIndex }"
                  @click="select(item)"
                  @mouseenter="activeIndex = index">
                <span class="ux-autocomplete__item-label" x-html="highlight(getLabel(item))"></span>
              </li>
            </template>
          </ul>

          <div class="ux-autocomplete__empty" x-show="filteredItems.length === 0 && showEmpty && query.length >= minChars">
            <div class="ux-autocomplete__empty-icon" x-html="icons.empty"></div>
            <span class="ux-autocomplete__empty-text" x-text="emptyText"></span>
          </div>
        </div>
      </div>

      <div class="result-display" x-show="selectedValue">
        Seleccionado: <strong x-text="selectedValue"></strong>
      </div>
    </div>

    <pre class="ux-code-block" data-lang="html">&lt;div x-data="uxAutocomplete({
  items: [
    { label: 'Apple', value: 'apple' },
    { label: 'Banana', value: 'banana' },
    ...
  ],
  placeholder: 'Search fruits...'
})"&gt;
  &lt;div class="ux-autocomplete"&gt;
    &lt;input type="text"
           class="ux-autocomplete__input"
           x-model="query"
           @input="onInput()"
           @keydown="onKeydown($event)"&gt;
    ...
  &lt;/div&gt;
&lt;/div&gt;</pre>
  </section>

  <!-- With Descriptions -->
  <section class="demo-section">
    <h2>Con Descripciones</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Items con descripci√≥n adicional y iconos.
    </p>

    <div class="demo-box" x-data="uxAutocomplete({
      items: [
        { label: 'Madrid', value: 'madrid', description: 'Capital de Espa√±a', icon: 'üèõÔ∏è' },
        { label: 'Barcelona', value: 'barcelona', description: 'Catalu√±a, Espa√±a', icon: '‚õ±Ô∏è' },
        { label: 'Valencia', value: 'valencia', description: 'Comunidad Valenciana', icon: 'üçä' },
        { label: 'Sevilla', value: 'sevilla', description: 'Andaluc√≠a, Espa√±a', icon: 'üåû' },
        { label: 'Bilbao', value: 'bilbao', description: 'Pa√≠s Vasco, Espa√±a', icon: 'üèîÔ∏è' },
        { label: 'M√°laga', value: 'malaga', description: 'Costa del Sol', icon: 'üèñÔ∏è' },
        { label: 'Zaragoza', value: 'zaragoza', description: 'Arag√≥n, Espa√±a', icon: '‚õ™' },
        { label: 'Palma', value: 'palma', description: 'Islas Baleares', icon: 'üå¥' }
      ],
      placeholder: 'Buscar ciudad...'
    })">
      <div class="ux-autocomplete" style="max-width: 400px;">
        <input type="text"
               class="ux-autocomplete__input"
               x-ref="input"
               x-model="query"
               :placeholder="placeholder"
               @input="onInput()"
               @focus="onFocus()"
               @blur="onBlur()"
               @keydown="onKeydown($event)"
               autocomplete="off">

        <button class="ux-autocomplete__clear"
                :class="{ 'ux-autocomplete__clear--hidden': !query }"
                @click="clear()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>

        <div class="ux-autocomplete__dropdown"
             :class="{ 'ux-autocomplete__dropdown--open': isOpen }">
          <ul class="ux-autocomplete__list" x-show="filteredItems.length > 0">
            <template x-for="(item, index) in filteredItems" :key="getValue(item)">
              <li class="ux-autocomplete__item"
                  :class="{ 'ux-autocomplete__item--active': index === activeIndex }"
                  @click="select(item)"
                  @mouseenter="activeIndex = index">
                <span style="font-size: 1.5rem; margin-right: 0.5rem;" x-text="item.icon"></span>
                <div class="ux-autocomplete__item-content">
                  <div class="ux-autocomplete__item-label" x-html="highlight(getLabel(item))"></div>
                  <div class="ux-autocomplete__item-description" x-html="highlight(getDescription(item))"></div>
                </div>
              </li>
            </template>
          </ul>

          <div class="ux-autocomplete__empty" x-show="filteredItems.length === 0 && query.length >= minChars">
            <div class="ux-autocomplete__empty-icon" x-html="icons.empty"></div>
            <span class="ux-autocomplete__empty-text" x-text="emptyText"></span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Grouped Results -->
  <section class="demo-section">
    <h2>Resultados Agrupados</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Items organizados por grupos o categor√≠as.
    </p>

    <div class="demo-box" x-data="uxAutocomplete({
      items: [
        { label: 'JavaScript', value: 'js', group: 'Frontend' },
        { label: 'TypeScript', value: 'ts', group: 'Frontend' },
        { label: 'React', value: 'react', group: 'Frontend' },
        { label: 'Vue.js', value: 'vue', group: 'Frontend' },
        { label: 'Node.js', value: 'node', group: 'Backend' },
        { label: 'Python', value: 'python', group: 'Backend' },
        { label: 'Ruby', value: 'ruby', group: 'Backend' },
        { label: 'PostgreSQL', value: 'postgres', group: 'Database' },
        { label: 'MongoDB', value: 'mongo', group: 'Database' },
        { label: 'Redis', value: 'redis', group: 'Database' }
      ],
      placeholder: 'Buscar tecnolog√≠a...'
    })">
      <div class="ux-autocomplete" style="max-width: 400px;">
        <input type="text"
               class="ux-autocomplete__input"
               x-ref="input"
               x-model="query"
               :placeholder="placeholder"
               @input="onInput()"
               @focus="onFocus()"
               @blur="onBlur()"
               @keydown="onKeydown($event)"
               autocomplete="off">

        <div class="ux-autocomplete__dropdown"
             :class="{ 'ux-autocomplete__dropdown--open': isOpen }">
          <div class="ux-autocomplete__list" x-show="filteredItems.length > 0">
            <template x-for="[groupName, items] in groupedItems" :key="groupName">
              <div class="ux-autocomplete__group">
                <div class="ux-autocomplete__group-label" x-text="groupName !== '__ungrouped__' ? groupName : ''"></div>
                <template x-for="(item, index) in items" :key="getValue(item)">
                  <div class="ux-autocomplete__item"
                       :class="{ 'ux-autocomplete__item--active': filteredItems.indexOf(item) === activeIndex }"
                       @click="select(item)"
                       @mouseenter="activeIndex = filteredItems.indexOf(item)">
                    <span class="ux-autocomplete__item-label" x-html="highlight(getLabel(item))"></span>
                  </div>
                </template>
              </div>
            </template>
          </div>

          <div class="ux-autocomplete__empty" x-show="filteredItems.length === 0 && query.length >= minChars">
            <span class="ux-autocomplete__empty-text" x-text="emptyText"></span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Multi-select Tags -->
  <section class="demo-section">
    <h2>Multi-selecci√≥n con Tags</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Selecciona m√∫ltiples items que se muestran como tags.
    </p>

    <div class="demo-box" x-data="uxAutocomplete({
      items: [
        { label: 'Design', value: 'design' },
        { label: 'Development', value: 'development' },
        { label: 'Marketing', value: 'marketing' },
        { label: 'Sales', value: 'sales' },
        { label: 'Support', value: 'support' },
        { label: 'Finance', value: 'finance' },
        { label: 'HR', value: 'hr' },
        { label: 'Legal', value: 'legal' }
      ],
      placeholder: 'Add skills...',
      multiple: true
    })">
      <div class="ux-autocomplete" style="max-width: 500px;">
        <div class="ux-autocomplete__tags" @click="$refs.input.focus()">
          <template x-for="(item, index) in selectedItems" :key="getValue(item)">
            <span class="ux-autocomplete__tag">
              <span x-text="getLabel(item)"></span>
              <button class="ux-autocomplete__tag-remove" @click.stop="removeSelected(index)">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M18 6L6 18M6 6l12 12"/>
                </svg>
              </button>
            </span>
          </template>
          <input type="text"
                 class="ux-autocomplete__tags-input"
                 x-ref="input"
                 x-model="query"
                 :placeholder="selectedItems.length === 0 ? placeholder : ''"
                 @input="onInput()"
                 @focus="onFocus()"
                 @blur="onBlur()"
                 @keydown="onKeydown($event)"
                 autocomplete="off">
        </div>

        <div class="ux-autocomplete__dropdown"
             :class="{ 'ux-autocomplete__dropdown--open': isOpen }">
          <ul class="ux-autocomplete__list" x-show="filteredItems.length > 0">
            <template x-for="(item, index) in filteredItems" :key="getValue(item)">
              <li class="ux-autocomplete__item"
                  :class="{ 'ux-autocomplete__item--active': index === activeIndex }"
                  @click="select(item)"
                  @mouseenter="activeIndex = index">
                <span class="ux-autocomplete__item-label" x-html="highlight(getLabel(item))"></span>
              </li>
            </template>
          </ul>

          <div class="ux-autocomplete__empty" x-show="filteredItems.length === 0 && query.length >= minChars">
            <span class="ux-autocomplete__empty-text" x-text="emptyText"></span>
          </div>
        </div>
      </div>

      <div class="result-display" x-show="selectedItems.length > 0">
        Valores: <strong x-text="selectedItems.map(i => getValue(i)).join(', ')"></strong>
      </div>
    </div>
  </section>

  <!-- Async / Remote Data -->
  <section class="demo-section">
    <h2>Datos Remotos (Async)</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      B√∫squeda con datos remotos usando funci√≥n async personalizada.
    </p>

    <div class="demo-box" x-data="{
      ...uxAutocomplete({
        placeholder: 'Buscar usuario...',
        debounce: 500,
        fetchFn: async function(query) {
          // Simulated API call
          await new Promise(resolve => setTimeout(resolve, 800));
          const users = [
            { label: 'Ana Garc√≠a', value: 'ana', description: 'ana@example.com' },
            { label: 'Carlos L√≥pez', value: 'carlos', description: 'carlos@example.com' },
            { label: 'Mar√≠a Rodr√≠guez', value: 'maria', description: 'maria@example.com' },
            { label: 'Pedro Mart√≠nez', value: 'pedro', description: 'pedro@example.com' },
            { label: 'Laura S√°nchez', value: 'laura', description: 'laura@example.com' },
            { label: 'Antonio Fern√°ndez', value: 'antonio', description: 'antonio@example.com' }
          ];
          return users.filter(u =>
            u.label.toLowerCase().includes(query.toLowerCase()) ||
            u.description.toLowerCase().includes(query.toLowerCase())
          );
        }
      })
    }">
      <div class="ux-autocomplete" style="max-width: 400px;">
        <input type="text"
               class="ux-autocomplete__input"
               :class="{ 'ux-autocomplete__input--loading': isLoading }"
               x-ref="input"
               x-model="query"
               :placeholder="placeholder"
               @input="onInput()"
               @focus="onFocus()"
               @blur="onBlur()"
               @keydown="onKeydown($event)"
               autocomplete="off">

        <button class="ux-autocomplete__clear"
                :class="{ 'ux-autocomplete__clear--hidden': !query || isLoading }"
                @click="clear()">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12"/>
          </svg>
        </button>

        <div class="ux-autocomplete__dropdown"
             :class="{ 'ux-autocomplete__dropdown--open': isOpen || isLoading }">

          <div class="ux-autocomplete__loading" x-show="isLoading">
            <div class="ux-autocomplete__loading-spinner"></div>
          </div>

          <ul class="ux-autocomplete__list" x-show="filteredItems.length > 0 && !isLoading">
            <template x-for="(item, index) in filteredItems" :key="getValue(item)">
              <li class="ux-autocomplete__item"
                  :class="{ 'ux-autocomplete__item--active': index === activeIndex }"
                  @click="select(item)"
                  @mouseenter="activeIndex = index">
                <div class="ux-autocomplete__item-content">
                  <div class="ux-autocomplete__item-label" x-html="highlight(getLabel(item))"></div>
                  <div class="ux-autocomplete__item-description" x-html="highlight(getDescription(item))"></div>
                </div>
              </li>
            </template>
          </ul>

          <div class="ux-autocomplete__empty" x-show="filteredItems.length === 0 && !isLoading && query.length >= minChars">
            <span class="ux-autocomplete__empty-text" x-text="emptyText"></span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Sizes -->
  <section class="demo-section">
    <h2>Tama√±os</h2>

    <div class="demo-grid">
      <div class="demo-box" x-data="uxAutocomplete({
        items: ['Small', 'Medium', 'Large'],
        placeholder: 'Small input...'
      })">
        <h3>Small</h3>
        <div class="ux-autocomplete ux-autocomplete--sm">
          <input type="text" class="ux-autocomplete__input" x-model="query"
                 :placeholder="placeholder" @input="onInput()" @keydown="onKeydown($event)" autocomplete="off">
          <div class="ux-autocomplete__dropdown" :class="{ 'ux-autocomplete__dropdown--open': isOpen }">
            <ul class="ux-autocomplete__list">
              <template x-for="(item, index) in filteredItems" :key="item">
                <li class="ux-autocomplete__item" :class="{ 'ux-autocomplete__item--active': index === activeIndex }"
                    @click="select(item)">
                  <span x-html="highlight(item)"></span>
                </li>
              </template>
            </ul>
          </div>
        </div>
      </div>

      <div class="demo-box" x-data="uxAutocomplete({
        items: ['Small', 'Medium', 'Large'],
        placeholder: 'Default input...'
      })">
        <h3>Default</h3>
        <div class="ux-autocomplete">
          <input type="text" class="ux-autocomplete__input" x-model="query"
                 :placeholder="placeholder" @input="onInput()" @keydown="onKeydown($event)" autocomplete="off">
          <div class="ux-autocomplete__dropdown" :class="{ 'ux-autocomplete__dropdown--open': isOpen }">
            <ul class="ux-autocomplete__list">
              <template x-for="(item, index) in filteredItems" :key="item">
                <li class="ux-autocomplete__item" :class="{ 'ux-autocomplete__item--active': index === activeIndex }"
                    @click="select(item)">
                  <span x-html="highlight(item)"></span>
                </li>
              </template>
            </ul>
          </div>
        </div>
      </div>

      <div class="demo-box" x-data="uxAutocomplete({
        items: ['Small', 'Medium', 'Large'],
        placeholder: 'Large input...'
      })">
        <h3>Large</h3>
        <div class="ux-autocomplete ux-autocomplete--lg">
          <input type="text" class="ux-autocomplete__input" x-model="query"
                 :placeholder="placeholder" @input="onInput()" @keydown="onKeydown($event)" autocomplete="off">
          <div class="ux-autocomplete__dropdown" :class="{ 'ux-autocomplete__dropdown--open': isOpen }">
            <ul class="ux-autocomplete__list">
              <template x-for="(item, index) in filteredItems" :key="item">
                <li class="ux-autocomplete__item" :class="{ 'ux-autocomplete__item--active': index === activeIndex }"
                    @click="select(item)">
                  <span x-html="highlight(item)"></span>
                </li>
              </template>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Glass Variant -->
  <section class="demo-section">
    <h2>Glass Variant</h2>

    <div class="demo-glass-bg">
      <div x-data="uxAutocomplete({
        items: [
          { label: 'Dashboard', value: 'dashboard' },
          { label: 'Settings', value: 'settings' },
          { label: 'Profile', value: 'profile' },
          { label: 'Reports', value: 'reports' },
          { label: 'Analytics', value: 'analytics' }
        ],
        placeholder: 'Search...'
      })">
        <div class="ux-autocomplete ux-autocomplete--glass" style="max-width: 350px;">
          <input type="text"
                 class="ux-autocomplete__input"
                 x-ref="input"
                 x-model="query"
                 :placeholder="placeholder"
                 @input="onInput()"
                 @focus="onFocus()"
                 @blur="onBlur()"
                 @keydown="onKeydown($event)"
                 autocomplete="off">

          <button class="ux-autocomplete__clear"
                  :class="{ 'ux-autocomplete__clear--hidden': !query }"
                  @click="clear()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 6L6 18M6 6l12 12"/>
            </svg>
          </button>

          <div class="ux-autocomplete__dropdown"
               :class="{ 'ux-autocomplete__dropdown--open': isOpen }">
            <ul class="ux-autocomplete__list">
              <template x-for="(item, index) in filteredItems" :key="getValue(item)">
                <li class="ux-autocomplete__item"
                    :class="{ 'ux-autocomplete__item--active': index === activeIndex }"
                    @click="select(item)">
                  <span x-html="highlight(getLabel(item))"></span>
                </li>
              </template>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Events -->
  <section class="demo-section">
    <h2>Eventos</h2>

    <div class="demo-box" x-data="{
      ...uxAutocomplete({
        items: ['Option A', 'Option B', 'Option C', 'Option D'],
        placeholder: 'Search...'
      }),
      eventLog: []
    }"
    @autocomplete:select="eventLog.unshift('select: ' + $event.detail.value)"
    @autocomplete:input="eventLog.unshift('input: ' + $event.detail.query)"
    @autocomplete:clear="eventLog.unshift('clear')">
      <div class="row g-3">
        <div class="col-md-6">
          <div class="ux-autocomplete">
            <input type="text"
                   class="ux-autocomplete__input"
                   x-ref="input"
                   x-model="query"
                   :placeholder="placeholder"
                   @input="onInput()"
                   @focus="onFocus()"
                   @blur="onBlur()"
                   @keydown="onKeydown($event)"
                   autocomplete="off">

            <button class="ux-autocomplete__clear"
                    :class="{ 'ux-autocomplete__clear--hidden': !query }"
                    @click="clear()">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M18 6L6 18M6 6l12 12"/>
              </svg>
            </button>

            <div class="ux-autocomplete__dropdown"
                 :class="{ 'ux-autocomplete__dropdown--open': isOpen }">
              <ul class="ux-autocomplete__list">
                <template x-for="(item, index) in filteredItems" :key="item">
                  <li class="ux-autocomplete__item"
                      :class="{ 'ux-autocomplete__item--active': index === activeIndex }"
                      @click="select(item)">
                    <span x-html="highlight(item)"></span>
                  </li>
                </template>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <h4 style="font-size: 0.875rem; margin-bottom: 0.5rem;">Event Log:</h4>
          <div class="event-log">
            <template x-for="(event, i) in eventLog.slice(0, 10)" :key="i">
              <div x-text="event"></div>
            </template>
            <div x-show="eventLog.length === 0" style="color: var(--ux-gray-500);">
              Escribe para ver eventos...
            </div>
          </div>
        </div>
      </div>
    </div>

    <h3>Eventos disponibles</h3>
    <pre class="ux-code-block" data-lang="javascript">@autocomplete:select   // Item seleccionado
@autocomplete:input    // Query cambiado
@autocomplete:clear    // Campo limpiado
@autocomplete:remove   // Tag eliminado (multi-select)
@autocomplete:focus    // Input focused
@autocomplete:blur     // Input blurred</pre>
  </section>

  <!-- API Reference -->
  <section class="demo-section">
    <h2>API Reference</h2>

    <h3>Opciones</h3>
    <pre class="ux-code-block" data-lang="javascript">uxAutocomplete({
  items: [],                    // Array de items
  placeholder: 'Search...',     // Placeholder del input
  minChars: 1,                  // M√≠nimo de caracteres para buscar
  debounce: 300,                // Debounce en ms
  maxItems: 10,                 // M√°ximo de resultados
  highlightMatches: true,       // Resaltar coincidencias
  closeOnSelect: true,          // Cerrar al seleccionar
  clearOnSelect: false,         // Limpiar al seleccionar
  showEmpty: true,              // Mostrar estado vac√≠o
  emptyText: 'No results',      // Texto estado vac√≠o
  labelKey: 'label',            // Key para el label
  valueKey: 'value',            // Key para el value
  descriptionKey: 'description', // Key para descripci√≥n
  groupKey: 'group',            // Key para grupos
  filterFn: null,               // Funci√≥n de filtrado custom
  fetchFn: null,                // Funci√≥n async para datos remotos
  multiple: false,              // Multi-selecci√≥n
  value: null                   // Valor inicial
})</pre>

    <h3>Propiedades reactivas</h3>
    <pre class="ux-code-block" data-lang="javascript">query           // Texto del input
isOpen          // Dropdown visible
isLoading       // Cargando (async)
activeIndex     // √çndice activo
filteredItems   // Items filtrados
selectedItems   // Items seleccionados (multiple)
selectedValue   // Valor seleccionado (single)</pre>

    <h3>M√©todos</h3>
    <pre class="ux-code-block" data-lang="javascript">search()                // Ejecutar b√∫squeda
select(item)            // Seleccionar item
removeSelected(index)   // Eliminar selecci√≥n (multiple)
clear()                 // Limpiar todo
highlight(text)         // Resaltar texto
getLabel(item)          // Obtener label
getValue(item)          // Obtener value
getDescription(item)    // Obtener descripci√≥n
getGroup(item)          // Obtener grupo</pre>

    <h3>Navegaci√≥n por teclado</h3>
    <pre class="ux-code-block" data-lang="text">‚Üì           Siguiente item / Abrir dropdown
‚Üë           Item anterior
Enter       Seleccionar item activo
Escape      Cerrar dropdown
Backspace   Eliminar √∫ltimo tag (multiple)
Tab         Cerrar dropdown</pre>
  </section>

  <!-- HTMX + Django -->
  <section class="demo-section">
    <h2>HTMX + Django</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Integraci√≥n con Django usando HTMX para b√∫squeda en servidor.
    </p>

    <h3>Template Django (autocomplete_field.html)</h3>
    <pre class="ux-code-block" data-lang="html">&lt;div class="ux-autocomplete" style="max-width: 400px;"&gt;
  &lt;input type="text"
         name="search"
         class="ux-autocomplete__input"
         placeholder="Buscar producto..."
         hx-get="{% url 'search_products' %}"
         hx-trigger="input changed delay:300ms"
         hx-target="#autocomplete-results"
         hx-indicator=".ux-autocomplete__loading"
         autocomplete="off"&gt;

  &lt;div class="ux-autocomplete__loading" style="display:none;"&gt;
    &lt;div class="ux-autocomplete__loading-spinner"&gt;&lt;/div&gt;
  &lt;/div&gt;

  &lt;!-- Hidden input para el valor seleccionado --&gt;
  &lt;input type="hidden" name="product_id" id="product-id-input"&gt;

  &lt;div id="autocomplete-results" class="ux-autocomplete__dropdown"&gt;
    &lt;!-- Los resultados se cargan aqu√≠ via HTMX --&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>

    <h3>Vista Django (views.py)</h3>
    <pre class="ux-code-block" data-lang="python">from django.http import HttpResponse
from django.template.loader import render_to_string
from .models import Product

def search_products(request):
    query = request.GET.get('search', '').strip()

    if len(query) < 2:
        return HttpResponse('')

    products = Product.objects.filter(
        name__icontains=query
    ).select_related('category')[:10]

    html = render_to_string('partials/product_results.html', {
        'products': products,
        'query': query
    })
    return HttpResponse(html)</pre>

    <h3>Partial de resultados (partials/product_results.html)</h3>
    <pre class="ux-code-block" data-lang="html">{% if products %}
&lt;ul class="ux-autocomplete__list ux-autocomplete__dropdown--open"&gt;
  {% for product in products %}
  &lt;li class="ux-autocomplete__item"
      hx-get="{% url 'select_product' product.id %}"
      hx-target="#product-details"
      hx-on:click="
        document.getElementById('product-id-input').value = '{{ product.id }}';
        document.querySelector('.ux-autocomplete__input').value = '{{ product.name }}';
        document.getElementById('autocomplete-results').innerHTML = '';
      "&gt;
    &lt;div class="ux-autocomplete__item-content"&gt;
      &lt;div class="ux-autocomplete__item-label"&gt;{{ product.name }}&lt;/div&gt;
      &lt;div class="ux-autocomplete__item-description"&gt;{{ product.category.name }} - ${{ product.price }}&lt;/div&gt;
    &lt;/div&gt;
  &lt;/li&gt;
  {% endfor %}
&lt;/ul&gt;
{% else %}
&lt;div class="ux-autocomplete__dropdown--open"&gt;
  &lt;div class="ux-autocomplete__empty"&gt;
    &lt;span class="ux-autocomplete__empty-text"&gt;No se encontraron productos&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;
{% endif %}</pre>

    <h3>URLs Django (urls.py)</h3>
    <pre class="ux-code-block" data-lang="python">from django.urls import path
from . import views

urlpatterns = [
    path('search/products/', views.search_products, name='search_products'),
    path('product/&lt;int:pk&gt;/', views.select_product, name='select_product'),
]</pre>

    <h3>Modelo Django (models.py)</h3>
    <pre class="ux-code-block" data-lang="python">from django.db import models

class Category(models.Model):
    name = models.CharField(max_length=100)

class Product(models.Model):
    name = models.CharField(max_length=200, db_index=True)
    category = models.ForeignKey(Category, on_delete=models.CASCADE)
    price = models.DecimalField(max_digits=10, decimal_places=2)

    class Meta:
        indexes = [
            models.Index(fields=['name']),
        ]</pre>

    <h3>Con resaltado de coincidencias</h3>
    <pre class="ux-code-block" data-lang="python"># views.py
import re
from django.utils.html import escape
from django.utils.safestring import mark_safe

def highlight_match(text, query):
    """Resalta las coincidencias del query en el texto."""
    if not query:
        return escape(text)

    escaped_text = escape(text)
    escaped_query = escape(query)
    pattern = re.compile(f'({re.escape(escaped_query)})', re.IGNORECASE)
    return mark_safe(pattern.sub(r'&lt;mark class="ux-autocomplete__highlight"&gt;\1&lt;/mark&gt;', escaped_text))

def search_products(request):
    query = request.GET.get('search', '').strip()

    if len(query) < 2:
        return HttpResponse('')

    products = Product.objects.filter(name__icontains=query)[:10]

    # Agregar nombres resaltados
    results = [{
        'product': p,
        'highlighted_name': highlight_match(p.name, query)
    } for p in products]

    return render(request, 'partials/product_results.html', {
        'results': results
    })</pre>

    <h3>Multi-select con Django</h3>
    <pre class="ux-code-block" data-lang="html">&lt;div x-data="{ selectedIds: [] }"&gt;
  &lt;div class="ux-autocomplete"&gt;
    &lt;div class="ux-autocomplete__tags"&gt;
      &lt;template x-for="id in selectedIds" :key="id"&gt;
        &lt;span class="ux-autocomplete__tag"
              hx-get="/api/tag-label/"
              hx-vals='{"id": id}'
              hx-trigger="load"&gt;
          &lt;span class="tag-label"&gt;Cargando...&lt;/span&gt;
          &lt;button type="button" @click="selectedIds = selectedIds.filter(i =&gt; i !== id)"&gt;√ó&lt;/button&gt;
        &lt;/span&gt;
      &lt;/template&gt;

      &lt;input type="text"
             class="ux-autocomplete__tags-input"
             hx-get="{% url 'search_tags' %}"
             hx-trigger="input changed delay:300ms"
             hx-target="#tag-results"
             placeholder="Agregar etiqueta..."&gt;
    &lt;/div&gt;

    &lt;div id="tag-results"&gt;&lt;/div&gt;

    &lt;!-- Hidden inputs para el form --&gt;
    &lt;template x-for="id in selectedIds" :key="id"&gt;
      &lt;input type="hidden" name="tags" :value="id"&gt;
    &lt;/template&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
  </section>