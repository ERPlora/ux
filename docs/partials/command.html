<style>
    .demo-section { margin-bottom: var(--ux-space-xl); padding: var(--ux-space-lg); }
    .demo-section h3 { font-size: var(--ux-font-size-lg); font-weight: 600; margin-bottom: var(--ux-space-md); }
    .demo-section p { font-size: var(--ux-font-size-md); color: var(--ux-text-secondary); margin-bottom: var(--ux-space-md); }
    .demo-box { background: var(--ux-surface); border-radius: var(--ux-border-radius-lg); padding: var(--ux-space-lg); margin-bottom: var(--ux-space-md); }
    .demo-output { padding: var(--ux-space-md); background: var(--ux-surface-secondary); border-radius: var(--ux-radius-md); font-size: var(--ux-font-size-sm); color: var(--ux-text-secondary); margin-top: var(--ux-space-md); }
    .shortcut-hint { display: inline-flex; align-items: center; gap: 4px; padding: 4px 8px; background: var(--ux-surface-secondary); border-radius: var(--ux-radius-md); font-family: monospace; font-size: var(--ux-font-size-sm); }
    .shortcut-key { display: inline-flex; align-items: center; justify-content: center; min-width: 24px; height: 24px; padding: 0 6px; background: var(--ux-surface); border: 1px solid var(--ux-border-color); border-radius: var(--ux-radius-sm); font-size: 0.75rem; }
  </style>

<div class="demo-section">
    <h3>Command Palette (Cmd+K)</h3>
    <p>Paleta de comandos para navegacion rapida y acciones. Presiona <span class="shortcut-hint"><span class="shortcut-key">⌘</span><span class="shortcut-key">K</span></span> o haz click en el boton.</p>

    <div class="demo-box" x-data="uxCommand({
      placeholder: 'Buscar comandos, archivos, acciones...',
      groups: [
        {
          name: 'Navegacion',
          commands: [
            { id: 'home', title: 'Ir a Inicio', description: 'Pagina principal', icon: 'folder', shortcut: 'Cmd+H', keywords: ['home', 'inicio'] },
            { id: 'settings', title: 'Configuracion', description: 'Ajustes de la aplicacion', icon: 'settings', shortcut: 'Cmd+,', keywords: ['settings', 'config'] },
            { id: 'profile', title: 'Mi Perfil', description: 'Ver y editar perfil', icon: 'user', keywords: ['profile', 'cuenta'] }
          ]
        },
        {
          name: 'Acciones',
          commands: [
            { id: 'new-file', title: 'Nuevo Archivo', description: 'Crear un nuevo documento', icon: 'file', shortcut: 'Cmd+N' },
            { id: 'new-folder', title: 'Nueva Carpeta', description: 'Crear una carpeta', icon: 'folder', shortcut: 'Cmd+Shift+N' },
            { id: 'search', title: 'Buscar en Archivos', description: 'Buscar texto en todos los archivos', icon: 'search', shortcut: 'Cmd+Shift+F' }
          ]
        },
        {
          name: 'Tema',
          commands: [
            { id: 'theme-light', title: 'Tema Claro', description: 'Cambiar a modo claro', keywords: ['light', 'claro'] },
            { id: 'theme-dark', title: 'Tema Oscuro', description: 'Cambiar a modo oscuro', keywords: ['dark', 'oscuro'] },
            { id: 'theme-system', title: 'Tema del Sistema', description: 'Usar preferencia del sistema', keywords: ['system', 'auto'] }
          ]
        }
      ]
    })" @command:execute.window="console.log('Comando ejecutado:', $event.detail.command)">
      <!-- Trigger Button -->
      <button class="ux-button ux-button--outline" @click="open()">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"/><path d="M21 21l-4.35-4.35"/>
        </svg>
        Buscar comandos...
        <span class="shortcut-hint" style="margin-left: auto;">
          <span class="shortcut-key">⌘</span><span class="shortcut-key">K</span>
        </span>
      </button>

      <!-- Backdrop -->
      <div class="ux-command-backdrop"
           :class="{ 'ux-command-backdrop--open': isOpen }"
           @click="close()"></div>

      <!-- Command Palette -->
      <div class="ux-command" :class="{ 'ux-command--open': isOpen }">
        <!-- Search -->
        <div class="ux-command__search">
          <span class="ux-command__search-icon" x-html="icons.search"></span>
          <input type="text"
                 class="ux-command__input"
                 :placeholder="placeholder"
                 x-model="query"
                 @input="filterCommands()"
                 @keydown="handleKeydown($event)"
                 autocomplete="off"
                 spellcheck="false">
          <div class="ux-command__shortcut">
            <span class="ux-command__key">Esc</span>
          </div>
        </div>

        <!-- Results -->
        <div class="ux-command__results">
          <!-- Loading -->
          <div x-show="loading" class="ux-command__loading">
            <div class="ux-command__loading-spinner"></div>
          </div>

          <!-- Empty State -->
          <div x-show="!loading && filteredCommands.length === 0" class="ux-command__empty">
            <div class="ux-command__empty-icon" x-html="icons.empty"></div>
            <div class="ux-command__empty-title">Sin resultados</div>
            <div class="ux-command__empty-description">No se encontraron comandos para "<span x-text="query"></span>"</div>
          </div>

          <!-- Results List -->
          <template x-for="(group, groupIndex) in filteredCommands" :key="group.group">
            <div class="ux-command__group">
              <div class="ux-command__group-title" x-text="group.group"></div>
              <ul class="ux-command__list">
                <template x-for="(cmd, itemIndex) in group.commands" :key="cmd.id">
                  <li class="ux-command__item"
                      :class="{ 'ux-command__item--active': isActiveItem(groupIndex, itemIndex) }"
                      @click="executeCommand(cmd)"
                      @mouseenter="activeIndex = groupIndex > 0 ? filteredCommands.slice(0, groupIndex).reduce((a, g) => a + g.commands.length, 0) + itemIndex : itemIndex">
                    <div class="ux-command__item-icon" x-html="getIcon(cmd)"></div>
                    <div class="ux-command__item-content">
                      <div class="ux-command__item-title" x-html="highlightMatch(cmd.title, query)"></div>
                      <div class="ux-command__item-description" x-text="cmd.description" x-show="cmd.description"></div>
                    </div>
                    <div x-show="cmd.recent" class="ux-command__recent">
                      <span x-html="icons.clock" style="width:12px;height:12px;"></span>
                      Reciente
                    </div>
                    <div x-show="cmd.shortcut && showShortcuts" class="ux-command__item-shortcut">
                      <template x-for="key in formatShortcut(cmd.shortcut)" :key="key">
                        <span class="ux-command__key" x-text="key"></span>
                      </template>
                    </div>
                  </li>
                </template>
              </ul>
            </div>
          </template>
        </div>

        <!-- Footer -->
        <div x-show="showFooter" class="ux-command__footer">
          <div class="ux-command__footer-hints">
            <span class="ux-command__footer-hint">
              <span class="ux-command__key">↑</span>
              <span class="ux-command__key">↓</span>
              Navegar
            </span>
            <span class="ux-command__footer-hint">
              <span class="ux-command__key">↵</span>
              Seleccionar
            </span>
            <span class="ux-command__footer-hint">
              <span class="ux-command__key">Esc</span>
              Cerrar
            </span>
          </div>
          <button x-show="recentCommands.length > 0"
                  @click="clearRecent()"
                  style="background:none;border:none;color:var(--ux-text-tertiary);cursor:pointer;font-size:inherit;">
            Limpiar recientes
          </button>
        </div>
      </div>

      <div class="demo-output">
        <strong>Tip:</strong> Presiona <span class="shortcut-key">⌘</span>+<span class="shortcut-key">K</span> en cualquier momento para abrir la paleta de comandos.
      </div>
    </div>

    <pre class="ux-code-block" data-lang="html">&lt;div x-data="uxCommand({
  placeholder: 'Buscar comandos...',
  groups: [
    {
      name: 'Navegacion',
      commands: [
        { id: 'home', title: 'Ir a Inicio', icon: 'folder', shortcut: 'Cmd+H' },
        { id: 'settings', title: 'Configuracion', icon: 'settings' }
      ]
    },
    {
      name: 'Acciones',
      commands: [
        { id: 'new-file', title: 'Nuevo Archivo', shortcut: 'Cmd+N' }
      ]
    }
  ]
})"&gt;
  &lt;button @click="open()"&gt;Abrir paleta (Cmd+K)&lt;/button&gt;
  &lt;!-- ... estructura de la paleta ... --&gt;
&lt;/div&gt;</pre>
  </div>

  <div class="demo-section">
    <h3>Variante Glass</h3>
    <p>Efecto glass morphism para fondos con gradiente.</p>
    <div class="demo-box" style="background: linear-gradient(135deg, var(--ux-primary-tint) 0%, var(--ux-tertiary-tint) 100%); padding: var(--ux-space-xl);">
      <div x-data="uxCommand({
        placeholder: 'Buscar...',
        commands: [
          { id: 'cmd1', title: 'Accion 1', description: 'Descripcion de la accion' },
          { id: 'cmd2', title: 'Accion 2', description: 'Otra descripcion' },
          { id: 'cmd3', title: 'Accion 3', description: 'Mas acciones' }
        ]
      })">
        <button class="ux-button ux-button--glass" @click="open()">
          Abrir paleta glass
        </button>

        <div class="ux-command-backdrop"
             :class="{ 'ux-command-backdrop--open': isOpen }"
             @click="close()"></div>

        <div class="ux-command ux-command--glass" :class="{ 'ux-command--open': isOpen }">
          <div class="ux-command__search">
            <span class="ux-command__search-icon" x-html="icons.search"></span>
            <input type="text" class="ux-command__input" :placeholder="placeholder"
                   x-model="query" @input="filterCommands()" @keydown="handleKeydown($event)">
            <div class="ux-command__shortcut"><span class="ux-command__key">Esc</span></div>
          </div>
          <div class="ux-command__results">
            <template x-for="(group, gi) in filteredCommands" :key="group.group">
              <div class="ux-command__group">
                <div class="ux-command__group-title" x-text="group.group"></div>
                <ul class="ux-command__list">
                  <template x-for="(cmd, ii) in group.commands" :key="cmd.id">
                    <li class="ux-command__item" :class="{ 'ux-command__item--active': isActiveItem(gi, ii) }"
                        @click="executeCommand(cmd)">
                      <div class="ux-command__item-icon" x-html="getIcon(cmd)"></div>
                      <div class="ux-command__item-content">
                        <div class="ux-command__item-title" x-text="cmd.title"></div>
                        <div class="ux-command__item-description" x-text="cmd.description"></div>
                      </div>
                    </li>
                  </template>
                </ul>
              </div>
            </template>
          </div>
        </div>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">&lt;div class="ux-command ux-command--glass"&gt;...&lt;/div&gt;</pre>
  </div>

  <div class="demo-section">
    <h3>Con Acciones Ejecutables</h3>
    <p>Comandos que ejecutan funciones al seleccionarse.</p>
    <div class="demo-box" x-data="{
      ...uxCommand({
        placeholder: 'Ejecutar accion...',
        commands: [
          {
            id: 'alert',
            title: 'Mostrar Alerta',
            description: 'Muestra una alerta de prueba',
            icon: 'command',
            action: () => alert('Alerta ejecutada!')
          },
          {
            id: 'log',
            title: 'Log en Consola',
            description: 'Imprime mensaje en consola',
            action: () => console.log('Comando ejecutado desde la paleta!')
          },
          {
            id: 'toggle-dark',
            title: 'Alternar Modo Oscuro',
            description: 'Cambiar entre claro y oscuro',
            action: () => document.body.classList.toggle('ux-dark')
          },
          {
            id: 'scroll-top',
            title: 'Ir Arriba',
            description: 'Desplazar al inicio de la pagina',
            action: () => window.scrollTo({ top: 0, behavior: 'smooth' })
          }
        ]
      }),
      lastExecuted: null
    }" @command:execute.window="lastExecuted = $event.detail.command.title">
      <button class="ux-button ux-color-primary" @click="open()">
        Ejecutar Comando
      </button>

      <div class="ux-command-backdrop" :class="{ 'ux-command-backdrop--open': isOpen }" @click="close()"></div>
      <div class="ux-command" :class="{ 'ux-command--open': isOpen }">
        <div class="ux-command__search">
          <span class="ux-command__search-icon" x-html="icons.search"></span>
          <input type="text" class="ux-command__input" :placeholder="placeholder"
                 x-model="query" @input="filterCommands()" @keydown="handleKeydown($event)">
        </div>
        <div class="ux-command__results">
          <template x-for="(group, gi) in filteredCommands" :key="group.group">
            <div class="ux-command__group">
              <ul class="ux-command__list">
                <template x-for="(cmd, ii) in group.commands" :key="cmd.id">
                  <li class="ux-command__item" :class="{ 'ux-command__item--active': isActiveItem(gi, ii) }"
                      @click="executeCommand(cmd)">
                    <div class="ux-command__item-icon" x-html="getIcon(cmd)"></div>
                    <div class="ux-command__item-content">
                      <div class="ux-command__item-title" x-text="cmd.title"></div>
                      <div class="ux-command__item-description" x-text="cmd.description"></div>
                    </div>
                  </li>
                </template>
              </ul>
            </div>
          </template>
        </div>
      </div>

      <div class="demo-output" x-show="lastExecuted">
        Ultimo comando ejecutado: <strong x-text="lastExecuted"></strong>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">// Comandos con acciones ejecutables
{
  id: 'toggle-dark',
  title: 'Alternar Modo Oscuro',
  action: () => document.body.classList.toggle('ux-dark')
}</pre>
  </div>

  <div class="demo-section">
    <h3>Busqueda Asincrona</h3>
    <p>Cargar resultados desde una API o fuente externa.</p>
    <div class="demo-box" x-data="uxCommand({
      placeholder: 'Buscar usuarios...',
      loadResults: async (query) => {
        // Simular delay de API
        await new Promise(r => setTimeout(r, 500));

        // Datos de ejemplo
        const users = [
          { id: 'u1', title: 'Ana Garcia', description: 'ana@email.com', icon: 'user' },
          { id: 'u2', title: 'Carlos Lopez', description: 'carlos@email.com', icon: 'user' },
          { id: 'u3', title: 'Maria Rodriguez', description: 'maria@email.com', icon: 'user' },
          { id: 'u4', title: 'Pedro Martinez', description: 'pedro@email.com', icon: 'user' },
          { id: 'u5', title: 'Laura Sanchez', description: 'laura@email.com', icon: 'user' }
        ];

        // Filtrar por query
        const filtered = users.filter(u =>
          u.title.toLowerCase().includes(query.toLowerCase()) ||
          u.description.toLowerCase().includes(query.toLowerCase())
        );

        return [{ group: 'Usuarios', commands: filtered }];
      }
    })">
      <button class="ux-button ux-button--outline" @click="open()">
        Buscar Usuarios
      </button>

      <div class="ux-command-backdrop" :class="{ 'ux-command-backdrop--open': isOpen }" @click="close()"></div>
      <div class="ux-command" :class="{ 'ux-command--open': isOpen }">
        <div class="ux-command__search">
          <span class="ux-command__search-icon" x-html="icons.search"></span>
          <input type="text" class="ux-command__input" :placeholder="placeholder"
                 x-model="query" @input="filterCommands()" @keydown="handleKeydown($event)">
        </div>
        <div class="ux-command__results">
          <div x-show="loading" class="ux-command__loading">
            <div class="ux-command__loading-spinner"></div>
          </div>
          <div x-show="!loading && query && filteredCommands.length === 0" class="ux-command__empty">
            <div class="ux-command__empty-title">Sin resultados</div>
          </div>
          <div x-show="!loading && !query" class="ux-command__empty">
            <div class="ux-command__empty-icon" x-html="icons.search"></div>
            <div class="ux-command__empty-title">Escribe para buscar</div>
            <div class="ux-command__empty-description">Ingresa un nombre o email</div>
          </div>
          <template x-for="(group, gi) in filteredCommands" :key="group.group">
            <div class="ux-command__group">
              <div class="ux-command__group-title" x-text="group.group"></div>
              <ul class="ux-command__list">
                <template x-for="(cmd, ii) in group.commands" :key="cmd.id">
                  <li class="ux-command__item" :class="{ 'ux-command__item--active': isActiveItem(gi, ii) }"
                      @click="executeCommand(cmd)">
                    <div class="ux-command__item-icon" x-html="getIcon(cmd)"></div>
                    <div class="ux-command__item-content">
                      <div class="ux-command__item-title" x-html="highlightMatch(cmd.title, query)"></div>
                      <div class="ux-command__item-description" x-text="cmd.description"></div>
                    </div>
                  </li>
                </template>
              </ul>
            </div>
          </template>
        </div>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">uxCommand({
  loadResults: async (query) => {
    const response = await fetch(`/api/search?q=${query}`);
    const data = await response.json();
    return [{ group: 'Resultados', commands: data }];
  }
})</pre>
  </div>

  <div class="demo-section">
    <h3>API y Eventos</h3>
    <div class="demo-box">
      <pre class="ux-code-block" data-lang="html">// Opciones de configuracion
uxCommand({
  placeholder: 'Buscar...',        // Placeholder del input
  commands: [],                     // Lista plana de comandos
  groups: [],                       // Comandos agrupados
  maxRecent: 5,                     // Maximo de recientes
  closeOnSelect: true,              // Cerrar al seleccionar
  fuzzySearch: true,                // Busqueda difusa
  showShortcuts: true,              // Mostrar atajos
  showFooter: true,                 // Mostrar footer
  loadResults: null                 // Funcion async para busqueda
})

// Estructura de comando
{
  id: 'unique-id',                  // ID unico (requerido)
  title: 'Titulo',                  // Titulo del comando (requerido)
  description: 'Descripcion',       // Descripcion opcional
  icon: 'search',                   // Nombre de icono o SVG
  shortcut: 'Cmd+K',                // Atajo de teclado
  keywords: ['alias', 'tags'],      // Keywords para busqueda
  url: '/path',                     // URL para navegacion
  action: () => {},                 // Funcion a ejecutar
  group: 'Categoria'                // Grupo (si no se usan groups)
}

// Metodos
open()                              // Abrir paleta
close()                             // Cerrar paleta
toggle()                            // Alternar estado
filterCommands()                    // Filtrar comandos
executeCommand(cmd)                 // Ejecutar comando
clearRecent()                       // Limpiar recientes

// Eventos
@command:open                       // Paleta abierta
@command:close                      // Paleta cerrada
@command:execute                    // Comando ejecutado

// Iconos disponibles
icons.search, icons.arrow, icons.enter, icons.command,
icons.file, icons.folder, icons.settings, icons.user, icons.clock</pre>
    </div>
  </div>

  <div class="demo-section">
    <h3>Integracion con HTMX</h3>
    <p>Busqueda en tiempo real contra el servidor.</p>
    <div class="demo-box">
      <pre class="ux-code-block" data-lang="html">&lt;!-- Busqueda con HTMX --&gt;
&lt;div x-data="uxCommand({ placeholder: 'Buscar...' })"&gt;
  &lt;div class="ux-command__search"&gt;
    &lt;input type="text"
           class="ux-command__input"
           name="q"
           hx-get="/api/search"
           hx-trigger="keyup changed delay:300ms"
           hx-target="#command-results"
           hx-indicator=".ux-command__loading"&gt;
  &lt;/div&gt;
  &lt;div id="command-results" class="ux-command__results"&gt;
    &lt;!-- Resultados se cargan aqui --&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Respuesta del servidor --&gt;
&lt;div class="ux-command__group"&gt;
  &lt;div class="ux-command__group-title"&gt;Resultados&lt;/div&gt;
  &lt;ul class="ux-command__list"&gt;
    &lt;li class="ux-command__item"&gt;
      &lt;div class="ux-command__item-content"&gt;
        &lt;div class="ux-command__item-title"&gt;Resultado 1&lt;/div&gt;
      &lt;/div&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;</pre>
    </div>
  </div>

  <div class="demo-section">
    <h3>HTMX + Django</h3>
    <p>Integracion completa con Django para busqueda en tiempo real de comandos y acciones.</p>

    <div class="demo-box">
      <h4 style="margin-bottom: var(--ux-space-md); font-weight: 600;">Template HTML (command_palette.html)</h4>
      <pre class="ux-code-block" data-lang="html">&lt;!-- Command Palette con busqueda Django --&gt;
&lt;div x-data="uxCommand({ placeholder: 'Buscar comandos, paginas, usuarios...' })"&gt;
  &lt;button class="ux-button ux-button--outline" @click="open()"&gt;
    Buscar... &lt;span class="shortcut-hint"&gt;&lt;span class="shortcut-key"&gt;Cmd&lt;/span&gt;&lt;span class="shortcut-key"&gt;K&lt;/span&gt;&lt;/span&gt;
  &lt;/button&gt;

  &lt;div class="ux-command-backdrop" :class="{ 'ux-command-backdrop--open': isOpen }" @click="close()"&gt;&lt;/div&gt;

  &lt;div class="ux-command" :class="{ 'ux-command--open': isOpen }"&gt;
    &lt;div class="ux-command__search"&gt;
      &lt;span class="ux-command__search-icon" x-html="icons.search"&gt;&lt;/span&gt;
      &lt;input type="text"
             class="ux-command__input"
             name="q"
             :placeholder="placeholder"
             x-model="query"
             hx-get="{% url 'command_search' %}"
             hx-trigger="keyup changed delay:300ms"
             hx-target="#command-results"
             hx-indicator=".ux-command__loading"
             autocomplete="off"&gt;
      &lt;div class="ux-command__loading htmx-indicator"&gt;
        &lt;div class="ux-command__loading-spinner"&gt;&lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div id="command-results" class="ux-command__results"&gt;
      &lt;!-- Resultados iniciales o recientes --&gt;
      {% include 'partials/command_results.html' with results=recent_commands %}
    &lt;/div&gt;

    &lt;div class="ux-command__footer"&gt;
      &lt;div class="ux-command__footer-hints"&gt;
        &lt;span class="ux-command__footer-hint"&gt;
          &lt;span class="ux-command__key"&gt;↑↓&lt;/span&gt; Navegar
        &lt;/span&gt;
        &lt;span class="ux-command__footer-hint"&gt;
          &lt;span class="ux-command__key"&gt;↵&lt;/span&gt; Seleccionar
        &lt;/span&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
    </div>

    <div class="demo-box">
      <h4 style="margin-bottom: var(--ux-space-md); font-weight: 600;">Partial de resultados (partials/command_results.html)</h4>
      <pre class="ux-code-block" data-lang="html">&lt;!-- partials/command_results.html --&gt;
{% if results %}
  {% regroup results by category as grouped_results %}
  {% for group in grouped_results %}
    &lt;div class="ux-command__group"&gt;
      &lt;div class="ux-command__group-title"&gt;{{ group.grouper }}&lt;/div&gt;
      &lt;ul class="ux-command__list"&gt;
        {% for item in group.list %}
          &lt;li class="ux-command__item"
              hx-get="{{ item.url }}"
              hx-push-url="true"
              hx-target="body"
              @click="close()"&gt;
            &lt;div class="ux-command__item-icon"&gt;
              {% if item.icon %}
                &lt;svg width="16" height="16"&gt;&lt;use href="#icon-{{ item.icon }}"&gt;&lt;/use&gt;&lt;/svg&gt;
              {% endif %}
            &lt;/div&gt;
            &lt;div class="ux-command__item-content"&gt;
              &lt;div class="ux-command__item-title"&gt;{{ item.title }}&lt;/div&gt;
              {% if item.description %}
                &lt;div class="ux-command__item-description"&gt;{{ item.description }}&lt;/div&gt;
              {% endif %}
            &lt;/div&gt;
            {% if item.shortcut %}
              &lt;div class="ux-command__item-shortcut"&gt;
                &lt;span class="ux-command__key"&gt;{{ item.shortcut }}&lt;/span&gt;
              &lt;/div&gt;
            {% endif %}
          &lt;/li&gt;
        {% endfor %}
      &lt;/ul&gt;
    &lt;/div&gt;
  {% endfor %}
{% else %}
  &lt;div class="ux-command__empty"&gt;
    &lt;div class="ux-command__empty-title"&gt;Sin resultados&lt;/div&gt;
    &lt;div class="ux-command__empty-description"&gt;
      No se encontraron comandos para "{{ query }}"
    &lt;/div&gt;
  &lt;/div&gt;
{% endif %}</pre>
    </div>

    <div class="demo-box">
      <h4 style="margin-bottom: var(--ux-space-md); font-weight: 600;">Vista Django (views.py)</h4>
      <pre class="ux-code-block" data-lang="python"># views.py
from django.http import HttpResponse
from django.template.loader import render_to_string
from django.db.models import Q
from django.contrib.auth.decorators import login_required

@login_required
def command_search(request):
    query = request.GET.get('q', '').strip()
    results = []

    if query:
        # Buscar en paginas/navegacion
        pages = [
            {'title': 'Dashboard', 'url': '/', 'icon': 'home', 'category': 'Navegacion'},
            {'title': 'Productos', 'url': '/productos/', 'icon': 'box', 'category': 'Navegacion'},
            {'title': 'Pedidos', 'url': '/pedidos/', 'icon': 'clipboard', 'category': 'Navegacion'},
            {'title': 'Clientes', 'url': '/clientes/', 'icon': 'users', 'category': 'Navegacion'},
            {'title': 'Configuracion', 'url': '/settings/', 'icon': 'settings', 'category': 'Navegacion', 'shortcut': 'Cmd+,'},
        ]

        # Filtrar paginas
        for page in pages:
            if query.lower() in page['title'].lower():
                results.append(page)

        # Buscar usuarios
        from django.contrib.auth import get_user_model
        User = get_user_model()
        users = User.objects.filter(
            Q(first_name__icontains=query) |
            Q(last_name__icontains=query) |
            Q(email__icontains=query)
        )[:5]

        for user in users:
            results.append({
                'title': user.get_full_name() or user.username,
                'description': user.email,
                'url': f'/usuarios/{user.pk}/',
                'icon': 'user',
                'category': 'Usuarios'
            })

        # Buscar productos
        from products.models import Product
        products = Product.objects.filter(
            Q(name__icontains=query) |
            Q(sku__icontains=query)
        )[:5]

        for product in products:
            results.append({
                'title': product.name,
                'description': f'SKU: {product.sku} - ${product.price}',
                'url': f'/productos/{product.pk}/',
                'icon': 'box',
                'category': 'Productos'
            })

        # Acciones rapidas
        actions = [
            {'title': 'Nuevo Producto', 'url': '/productos/nuevo/', 'icon': 'plus', 'category': 'Acciones', 'shortcut': 'Cmd+N'},
            {'title': 'Nuevo Pedido', 'url': '/pedidos/nuevo/', 'icon': 'plus', 'category': 'Acciones'},
            {'title': 'Exportar Datos', 'url': '/export/', 'icon': 'download', 'category': 'Acciones'},
        ]

        for action in actions:
            if query.lower() in action['title'].lower():
                results.append(action)

    html = render_to_string('partials/command_results.html', {
        'results': results,
        'query': query
    })

    return HttpResponse(html)</pre>
    </div>

    <div class="demo-box">
      <h4 style="margin-bottom: var(--ux-space-md); font-weight: 600;">URLs (urls.py)</h4>
      <pre class="ux-code-block" data-lang="python"># urls.py
from django.urls import path
from . import views

urlpatterns = [
    path('command/search/', views.command_search, name='command_search'),
]</pre>
    </div>

    <div class="demo-box">
      <h4 style="margin-bottom: var(--ux-space-md); font-weight: 600;">Busqueda con modelo Command</h4>
      <pre class="ux-code-block" data-lang="python"># models.py - Modelo opcional para comandos personalizados
from django.db import models

class Command(models.Model):
    CATEGORY_CHOICES = [
        ('navigation', 'Navegacion'),
        ('action', 'Acciones'),
        ('settings', 'Configuracion'),
    ]

    title = models.CharField(max_length=100)
    description = models.CharField(max_length=255, blank=True)
    url = models.CharField(max_length=255)
    icon = models.CharField(max_length=50, default='command')
    shortcut = models.CharField(max_length=50, blank=True)
    category = models.CharField(max_length=50, choices=CATEGORY_CHOICES)
    keywords = models.TextField(blank=True, help_text='Palabras clave separadas por coma')
    is_active = models.BooleanField(default=True)
    order = models.IntegerField(default=0)

    class Meta:
        ordering = ['order', 'title']

    def matches(self, query):
        """Verifica si el comando coincide con la busqueda"""
        query = query.lower()
        if query in self.title.lower():
            return True
        if query in self.description.lower():
            return True
        keywords = [k.strip() for k in self.keywords.split(',')]
        return any(query in k.lower() for k in keywords)

# views.py - Busqueda con modelo
def command_search(request):
    query = request.GET.get('q', '').strip()

    if query:
        commands = Command.objects.filter(is_active=True)
        results = [
            {
                'title': cmd.title,
                'description': cmd.description,
                'url': cmd.url,
                'icon': cmd.icon,
                'shortcut': cmd.shortcut,
                'category': cmd.get_category_display()
            }
            for cmd in commands if cmd.matches(query)
        ]
    else:
        results = []

    return render(request, 'partials/command_results.html', {'results': results})</pre>
    </div>
  </div>

  <div class="demo-section">
    <h3>Atajos de Teclado</h3>
    <div class="demo-box">
      <table style="width: 100%; border-collapse: collapse; font-size: var(--ux-font-size-md);">
        <thead>
          <tr style="border-bottom: 1px solid var(--ux-border-color);">
            <th style="text-align: left; padding: var(--ux-space-sm);">Atajo</th>
            <th style="text-align: left; padding: var(--ux-space-sm);">Accion</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td style="padding: var(--ux-space-sm);"><span class="shortcut-key">⌘</span> + <span class="shortcut-key">K</span></td>
            <td style="padding: var(--ux-space-sm);">Abrir/cerrar paleta de comandos</td>
          </tr>
          <tr>
            <td style="padding: var(--ux-space-sm);"><span class="shortcut-key">↑</span> / <span class="shortcut-key">↓</span></td>
            <td style="padding: var(--ux-space-sm);">Navegar entre resultados</td>
          </tr>
          <tr>
            <td style="padding: var(--ux-space-sm);"><span class="shortcut-key">Tab</span> / <span class="shortcut-key">Shift</span>+<span class="shortcut-key">Tab</span></td>
            <td style="padding: var(--ux-space-sm);">Navegar siguiente/anterior</td>
          </tr>
          <tr>
            <td style="padding: var(--ux-space-sm);"><span class="shortcut-key">Enter</span></td>
            <td style="padding: var(--ux-space-sm);">Ejecutar comando seleccionado</td>
          </tr>
          <tr>
            <td style="padding: var(--ux-space-sm);"><span class="shortcut-key">Esc</span></td>
            <td style="padding: var(--ux-space-sm);">Cerrar paleta</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>