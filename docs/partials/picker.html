<style>
    .demo-section { margin-bottom: var(--ux-space-xl); }
    .demo-section h3 { font-size: var(--ux-font-size-lg); font-weight: 600; margin-bottom: var(--ux-space-md); color: var(--ux-text); }
    .demo-section p { font-size: var(--ux-font-size-md); color: var(--ux-text-secondary); margin-bottom: var(--ux-space-md); }
    .demo-box { background: var(--ux-surface); border-radius: var(--ux-border-radius-lg); padding: var(--ux-space-lg); margin-bottom: var(--ux-space-md); display: flex; flex-wrap: wrap; gap: var(--ux-space-md); align-items: center; }
  </style>

<!-- Basic Picker -->
    <section class="demo-section" x-data="uxPicker({
      columns: [
        { label: 'Color', options: ['Rojo', 'Verde', 'Azul', 'Amarillo', 'Naranja', 'Morado', 'Rosa', 'Negro', 'Blanco'], selectedIndex: 2 }
      ]
    })">
      <h3>Picker Basico</h3>
      <p>Selector de columna unica estilo iOS.</p>
      <div class="demo-box">
        <button class="ux-button ux-button ux-color-primary" @click="open()">Seleccionar Color</button>
        <span class="ux-text-secondary" x-text="'Seleccionado: ' + (columns[0].options[selectedIndexes[0]] || 'Ninguno')"></span>
      </div>

      <!-- Picker Backdrop -->
      <div class="ux-picker-backdrop" :class="{ 'ux-picker-backdrop--open': isOpen }" @click.self="cancel()">
        <div class="ux-picker">
          <div class="ux-picker__header">
            <button class="ux-picker__button ux-picker__button--cancel" @click="cancel()">Cancelar</button>
            <span class="ux-picker__title" x-text="title || 'Seleccionar'"></span>
            <button class="ux-picker__button ux-picker__button--confirm" @click="confirm()">Listo</button>
          </div>
          <div class="ux-picker__columns">
            <template x-for="(column, colIndex) in columns" :key="colIndex">
              <div class="ux-picker__column"
                   :class="{ 'ux-picker__column--dragging': _columnStates[colIndex]?.isDragging }"
                   @touchstart="onTouchStart($event, colIndex)"
                   @touchmove="onTouchMove($event, colIndex)"
                   @touchend="onTouchEnd($event, colIndex)"
                   @mousedown="onTouchStart($event, colIndex)"
                   @mousemove="onTouchMove($event, colIndex)"
                   @mouseup="onTouchEnd($event, colIndex)"
                   @mouseleave="onTouchEnd($event, colIndex)">
                <div class="ux-picker__column-wrapper" :style="{ transform: getColumnTransform(colIndex) }">
                  <template x-for="(option, optIndex) in column.options" :key="optIndex">
                    <div class="ux-picker__item"
                         :class="{ 'ux-picker__item--selected': isSelected(colIndex, optIndex) }"
                         @click="selectItem(colIndex, optIndex)"
                         x-text="typeof option === 'object' ? option.text : option"></div>
                  </template>
                </div>
              </div>
            </template>
          </div>
        </div>
      </div>

      <pre class="ux-code-block" data-lang="html">&lt;div x-data="uxPicker({
  columns: [{
    label: 'Color',
    options: ['Rojo', 'Verde', 'Azul'],
    selectedIndex: 0
  }]
})"&gt;
  &lt;button @click="open()"&gt;Abrir Picker&lt;/button&gt;

  &lt;!-- Picker backdrop y contenido --&gt;
  &lt;div class="ux-picker-backdrop"
       :class="{ 'ux-picker-backdrop--open': isOpen }"&gt;
    &lt;div class="ux-picker"&gt;...&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
    </section>

    <!-- Multi-column Picker -->
    <section class="demo-section" x-data="uxPicker({
      title: 'Fecha',
      columns: [
        { label: 'Dia', options: Array.from({length: 31}, (_, i) => i + 1), selectedIndex: 14 },
        { label: 'Mes', options: ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'], selectedIndex: 5 },
        { label: 'Ano', options: ['2022', '2023', '2024', '2025', '2026'], selectedIndex: 2 }
      ]
    })">
      <h3>Picker Multi-columna</h3>
      <p>Selector con multiples columnas para fechas u otros datos.</p>
      <div class="demo-box">
        <button class="ux-button ux-button ux-color-primary" @click="open()">Seleccionar Fecha</button>
        <span class="ux-text-secondary" x-text="'Fecha: ' + columns[0].options[selectedIndexes[0]] + ' ' + columns[1].options[selectedIndexes[1]] + ' ' + columns[2].options[selectedIndexes[2]]"></span>
      </div>

      <!-- Picker Backdrop -->
      <div class="ux-picker-backdrop" :class="{ 'ux-picker-backdrop--open': isOpen }" @click.self="cancel()">
        <div class="ux-picker">
          <div class="ux-picker__header">
            <button class="ux-picker__button ux-picker__button--cancel" @click="cancel()">Cancelar</button>
            <span class="ux-picker__title" x-text="title"></span>
            <button class="ux-picker__button ux-picker__button--confirm" @click="confirm()">Listo</button>
          </div>
          <div class="ux-picker__columns">
            <template x-for="(column, colIndex) in columns" :key="colIndex">
              <div class="ux-picker__column"
                   :class="{ 'ux-picker__column--dragging': _columnStates[colIndex]?.isDragging }"
                   @touchstart="onTouchStart($event, colIndex)"
                   @touchmove="onTouchMove($event, colIndex)"
                   @touchend="onTouchEnd($event, colIndex)"
                   @mousedown="onTouchStart($event, colIndex)"
                   @mousemove="onTouchMove($event, colIndex)"
                   @mouseup="onTouchEnd($event, colIndex)"
                   @mouseleave="onTouchEnd($event, colIndex)">
                <div class="ux-picker__column-wrapper" :style="{ transform: getColumnTransform(colIndex) }">
                  <template x-for="(option, optIndex) in column.options" :key="optIndex">
                    <div class="ux-picker__item"
                         :class="{ 'ux-picker__item--selected': isSelected(colIndex, optIndex) }"
                         @click="selectItem(colIndex, optIndex)"
                         x-text="typeof option === 'object' ? option.text : option"></div>
                  </template>
                </div>
              </div>
            </template>
          </div>
        </div>
      </div>

      <pre class="ux-code-block" data-lang="html">x-data="uxPicker({
  title: 'Fecha',
  columns: [
    { label: 'Dia', options: [1, 2, 3, ...31], selectedIndex: 14 },
    { label: 'Mes', options: ['Ene', 'Feb', ...], selectedIndex: 5 },
    { label: 'Ano', options: ['2023', '2024', '2025'], selectedIndex: 1 }
  ]
})"</pre>
    </section>

    <!-- Time Picker -->
    <section class="demo-section" x-data="uxPicker({
      title: 'Hora',
      columns: [
        { label: 'Hora', options: Array.from({length: 12}, (_, i) => String(i + 1).padStart(2, '0')), selectedIndex: 8 },
        { label: 'Minutos', options: Array.from({length: 60}, (_, i) => String(i).padStart(2, '0')), selectedIndex: 30 },
        { label: 'AM/PM', options: ['AM', 'PM'], selectedIndex: 0 }
      ]
    })">
      <h3>Selector de Hora</h3>
      <p>Picker configurado como selector de hora.</p>
      <div class="demo-box">
        <button class="ux-button ux-button ux-color-secondary" @click="open()">Seleccionar Hora</button>
        <span class="ux-text-secondary" x-text="'Hora: ' + columns[0].options[selectedIndexes[0]] + ':' + columns[1].options[selectedIndexes[1]] + ' ' + columns[2].options[selectedIndexes[2]]"></span>
      </div>

      <!-- Picker Backdrop -->
      <div class="ux-picker-backdrop" :class="{ 'ux-picker-backdrop--open': isOpen }" @click.self="cancel()">
        <div class="ux-picker">
          <div class="ux-picker__header">
            <button class="ux-picker__button ux-picker__button--cancel" @click="cancel()">Cancelar</button>
            <span class="ux-picker__title" x-text="title"></span>
            <button class="ux-picker__button ux-picker__button--confirm" @click="confirm()">Listo</button>
          </div>
          <div class="ux-picker__columns">
            <template x-for="(column, colIndex) in columns" :key="colIndex">
              <div class="ux-picker__column"
                   :class="{ 'ux-picker__column--dragging': _columnStates[colIndex]?.isDragging }"
                   @touchstart="onTouchStart($event, colIndex)"
                   @touchmove="onTouchMove($event, colIndex)"
                   @touchend="onTouchEnd($event, colIndex)"
                   @mousedown="onTouchStart($event, colIndex)"
                   @mousemove="onTouchMove($event, colIndex)"
                   @mouseup="onTouchEnd($event, colIndex)"
                   @mouseleave="onTouchEnd($event, colIndex)">
                <div class="ux-picker__column-wrapper" :style="{ transform: getColumnTransform(colIndex) }">
                  <template x-for="(option, optIndex) in column.options" :key="optIndex">
                    <div class="ux-picker__item"
                         :class="{ 'ux-picker__item--selected': isSelected(colIndex, optIndex) }"
                         @click="selectItem(colIndex, optIndex)"
                         x-text="typeof option === 'object' ? option.text : option"></div>
                  </template>
                </div>
              </div>
            </template>
          </div>
        </div>
      </div>
    </section>

    <!-- Inline Picker -->
    <section class="demo-section">
      <h3>Picker Inline</h3>
      <p>Picker mostrado directamente en la pagina sin modal.</p>
      <div class="demo-box" style="flex-direction: column;">
        <div class="ux-picker ux-picker--inline" style="max-width: 300px; width: 100%;"
             x-data="uxPicker({
               columns: [{ options: ['Pequeno', 'Mediano', 'Grande', 'Extra Grande'], selectedIndex: 1 }]
             })"
             x-init="isOpen = true">
          <div class="ux-picker__columns">
            <template x-for="(column, colIndex) in columns" :key="colIndex">
              <div class="ux-picker__column"
                   @touchstart="onTouchStart($event, colIndex)"
                   @touchmove="onTouchMove($event, colIndex)"
                   @touchend="onTouchEnd($event, colIndex)"
                   @mousedown="onTouchStart($event, colIndex)"
                   @mousemove="onTouchMove($event, colIndex)"
                   @mouseup="onTouchEnd($event, colIndex)"
                   @mouseleave="onTouchEnd($event, colIndex)">
                <div class="ux-picker__column-wrapper" :style="{ transform: getColumnTransform(colIndex) }">
                  <template x-for="(option, optIndex) in column.options" :key="optIndex">
                    <div class="ux-picker__item"
                         :class="{ 'ux-picker__item--selected': isSelected(colIndex, optIndex) }"
                         @click="selectItem(colIndex, optIndex)"
                         x-text="option"></div>
                  </template>
                </div>
              </div>
            </template>
          </div>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-picker ux-picker--inline"&gt;
  &lt;div class="ux-picker__columns"&gt;...&lt;/div&gt;
&lt;/div&gt;</pre>
    </section>

    <!-- Events -->
    <section class="demo-section">
      <h3>Eventos</h3>
      <p>Escuchar eventos del picker.</p>
      <pre class="ux-code-block" data-lang="html">&lt;div x-data="uxPicker({ columns: [...] })"
     @picker-confirm="console.log('Valores:', $event.detail.values)"
     @picker-cancel="console.log('Cancelado')"
     @picker-change="console.log('Columna:', $event.detail.columnIndex, 'Valor:', $event.detail.value)"&gt;
  ...
&lt;/div&gt;</pre>
    </section>

    <!-- HTMX + Django -->
    <section class="demo-section">
      <h3>HTMX + Django</h3>
      <p>Cargar opciones del picker dinamicamente desde el servidor.</p>

      <h4 style="font-size: var(--ux-font-size-md); margin: var(--ux-space-md) 0;">Picker con opciones dinamicas</h4>
      <pre class="ux-code-block" data-lang="html">&lt;!-- Boton que carga opciones y abre el picker --&gt;
&lt;div x-data="uxPicker({ columns: [] })"
     @htmx:after-request="
       if ($event.detail.successful) {
         columns = JSON.parse($event.detail.xhr.response);
         selectedIndexes = columns.map(c =&gt; c.selectedIndex || 0);
         open();
       }
     "&gt;
  &lt;button class="ux-button"
          hx-get="/api/picker-options/"
          hx-trigger="click"&gt;
    Seleccionar Categoria
  &lt;/button&gt;

  &lt;!-- Picker backdrop --&gt;
  &lt;div class="ux-picker-backdrop" :class="{ 'ux-picker-backdrop--open': isOpen }"&gt;
    &lt;div class="ux-picker"&gt;...&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>

      <h4 style="font-size: var(--ux-font-size-md); margin: var(--ux-space-md) 0;">Vista Django</h4>
      <pre class="ux-code-block" data-lang="python"># views.py
from django.http import JsonResponse

def picker_options(request):
    """Retorna opciones para el picker"""
    categorias = Categoria.objects.values_list('nombre', flat=True)

    columns = [{
        'label': 'Categoria',
        'options': list(categorias),
        'selectedIndex': 0
    }]

    return JsonResponse(columns, safe=False)</pre>

      <h4 style="font-size: var(--ux-font-size-md); margin: var(--ux-space-md) 0;">Picker cascada (columnas dependientes)</h4>
      <pre class="ux-code-block" data-lang="html">&lt;!-- Picker con columnas que dependen entre si --&gt;
&lt;div x-data="uxPicker({
       columns: [
         { label: 'Pais', options: [], selectedIndex: 0 },
         { label: 'Ciudad', options: [], selectedIndex: 0 }
       ]
     })"
     x-init="
       fetch('/api/paises/').then(r =&gt; r.json()).then(data =&gt; {
         columns[0].options = data;
       });
     "
     @picker-change="
       if ($event.detail.columnIndex === 0) {
         const pais = columns[0].options[$event.detail.optionIndex];
         fetch('/api/ciudades/?pais=' + encodeURIComponent(pais))
           .then(r =&gt; r.json())
           .then(data =&gt; {
             columns[1].options = data;
             selectedIndexes[1] = 0;
           });
       }
     "&gt;
  &lt;button class="ux-button" @click="open()"&gt;Seleccionar Ubicacion&lt;/button&gt;
  ...
&lt;/div&gt;</pre>

      <h4 style="font-size: var(--ux-font-size-md); margin: var(--ux-space-md) 0;">Enviar seleccion al servidor</h4>
      <pre class="ux-code-block" data-lang="html">&lt;!-- Enviar valor seleccionado via HTMX --&gt;
&lt;div x-data="uxPicker({ columns: [...] })"
     @picker-confirm="
       const valores = getValues();
       htmx.ajax('POST', '/api/guardar-seleccion/', {
         values: { seleccion: JSON.stringify(valores) },
         target: '#resultado'
       });
     "&gt;
  ...
&lt;/div&gt;

&lt;!-- O usando un input hidden --&gt;
&lt;form hx-post="/api/guardar/" hx-target="#resultado"&gt;
  &lt;div x-data="uxPicker({ columns: [...] })"
       @picker-confirm="$refs.input.value = JSON.stringify(getValues())"&gt;
    &lt;input type="hidden" name="seleccion" x-ref="input"&gt;
    &lt;button type="button" class="ux-button" @click="open()"&gt;Seleccionar&lt;/button&gt;
    ...
  &lt;/div&gt;
  &lt;button type="submit" class="ux-button ux-color-primary"&gt;Guardar&lt;/button&gt;
&lt;/form&gt;</pre>

      <h4 style="font-size: var(--ux-font-size-md); margin: var(--ux-space-md) 0;">Vista Django para columnas cascada</h4>
      <pre class="ux-code-block" data-lang="python"># views.py
def paises(request):
    paises = Pais.objects.values_list('nombre', flat=True)
    return JsonResponse(list(paises), safe=False)

def ciudades(request):
    pais = request.GET.get('pais')
    ciudades = Ciudad.objects.filter(
        pais__nombre=pais
    ).values_list('nombre', flat=True)
    return JsonResponse(list(ciudades), safe=False)

def guardar_seleccion(request):
    import json
    seleccion = json.loads(request.POST.get('seleccion', '[]'))
    # Procesar seleccion...
    return HttpResponse('&lt;div class="ux-alert"&gt;Guardado!&lt;/div&gt;')</pre>
    </section>

    <!-- API Table -->
    <section class="demo-section">
      <h3>API Alpine</h3>
      <table style="width: 100%; font-size: var(--ux-font-size-md);">
        <thead>
          <tr style="text-align: left; border-bottom: 1px solid var(--ux-border-color);">
            <th style="padding: var(--ux-space-sm);">Metodo/Propiedad</th>
            <th style="padding: var(--ux-space-sm);">Descripcion</th>
          </tr>
        </thead>
        <tbody>
          <tr><td style="padding: var(--ux-space-sm);"><code>open(options)</code></td><td style="padding: var(--ux-space-sm);">Abre el picker</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>close()</code></td><td style="padding: var(--ux-space-sm);">Cierra el picker</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>confirm()</code></td><td style="padding: var(--ux-space-sm);">Confirma y cierra</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>cancel()</code></td><td style="padding: var(--ux-space-sm);">Cancela y cierra</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>getValues()</code></td><td style="padding: var(--ux-space-sm);">Retorna array de valores seleccionados</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>setValues(values)</code></td><td style="padding: var(--ux-space-sm);">Establece valores programaticamente</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>scrollToIndex(col, idx)</code></td><td style="padding: var(--ux-space-sm);">Scroll a indice en columna</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>columns</code></td><td style="padding: var(--ux-space-sm);">Array de columnas con opciones</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>selectedIndexes</code></td><td style="padding: var(--ux-space-sm);">Array de indices seleccionados</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>isOpen</code></td><td style="padding: var(--ux-space-sm);">Estado de visibilidad</td></tr>
        </tbody>
      </table>
    </section>

    <!-- CSS Classes -->
    <section class="demo-section">
      <h3>Clases CSS</h3>
      <table style="width: 100%; font-size: var(--ux-font-size-md);">
        <thead>
          <tr style="text-align: left; border-bottom: 1px solid var(--ux-border-color);">
            <th style="padding: var(--ux-space-sm);">Clase</th>
            <th style="padding: var(--ux-space-sm);">Descripcion</th>
          </tr>
        </thead>
        <tbody>
          <tr><td style="padding: var(--ux-space-sm);"><code>.ux-picker-backdrop</code></td><td style="padding: var(--ux-space-sm);">Fondo oscuro</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>.ux-picker-backdrop--open</code></td><td style="padding: var(--ux-space-sm);">Estado visible</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>.ux-picker</code></td><td style="padding: var(--ux-space-sm);">Contenedor del picker</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>.ux-picker--inline</code></td><td style="padding: var(--ux-space-sm);">Picker sin modal</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>.ux-picker--sm</code></td><td style="padding: var(--ux-space-sm);">Tamano pequeno</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>.ux-picker--lg</code></td><td style="padding: var(--ux-space-sm);">Tamano grande</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>.ux-picker__header</code></td><td style="padding: var(--ux-space-sm);">Cabecera con botones</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>.ux-picker__columns</code></td><td style="padding: var(--ux-space-sm);">Contenedor de columnas</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>.ux-picker__column</code></td><td style="padding: var(--ux-space-sm);">Columna individual</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>.ux-picker__item</code></td><td style="padding: var(--ux-space-sm);">Item de columna</td></tr>
          <tr><td style="padding: var(--ux-space-sm);"><code>.ux-picker__item--selected</code></td><td style="padding: var(--ux-space-sm);">Item seleccionado</td></tr>
        </tbody>
      </table>
    </section>