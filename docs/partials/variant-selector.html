<style>
    .demo-section { margin-bottom: var(--ux-space-xl); }
    .demo-section h3 {
      font-size: var(--ux-font-size-lg);
      font-weight: 600;
      margin-bottom: var(--ux-space-md);
      color: var(--ux-text);
    }
    .demo-section p {
      font-size: var(--ux-font-size-md);
      color: var(--ux-text-secondary);
      margin-bottom: var(--ux-space-md);
    }
    .demo-box {
      background: var(--ux-surface);
      border-radius: var(--ux-border-radius-lg);
      padding: var(--ux-space-lg);
      margin-bottom: var(--ux-space-md);
    }
    .result-text {
      margin-top: var(--ux-space-md);
      padding: var(--ux-space-sm);
      background: var(--ux-gray-100);
      border-radius: var(--ux-radius-sm);
      font-size: var(--ux-font-size-sm);
    }
  </style>

<section class="demo-section">
      <h3>Selector de Talla</h3>
      <p>Selector basico para tallas de ropa o zapatos.</p>
      <div class="demo-box"
           x-data="uxVariantSelector({
             label: 'Talla',
             options: [
               { value: 'xs', label: 'XS' },
               { value: 's', label: 'S' },
               { value: 'm', label: 'M' },
               { value: 'l', label: 'L' },
               { value: 'xl', label: 'XL' },
               { value: 'xxl', label: 'XXL', available: false }
             ],
             selected: 'm'
           })">
        <div class="ux-variant-selector">
          <div class="ux-variant-selector__label">
            <span x-text="label"></span>
            <span class="ux-variant-selector__selected" x-text="selectedOption?.label"></span>
          </div>
          <div class="ux-variant-selector__options">
            <template x-for="opt in options" :key="opt.value">
              <button class="ux-variant-selector__option"
                      :class="{
                        'ux-variant-selector__option--selected': isSelected(opt.value),
                        'ux-variant-selector__option--unavailable': opt.available === false
                      }"
                      @click="select(opt.value)"
                      x-text="opt.label">
              </button>
            </template>
          </div>
        </div>
        <div class="result-text">Seleccionado: <strong x-text="selected"></strong></div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div x-data="uxVariantSelector({
  label: 'Talla',
  options: [
    { value: 'xs', label: 'XS' },
    { value: 's', label: 'S' },
    { value: 'm', label: 'M' },
    { value: 'l', label: 'L' },
    { value: 'xl', label: 'XL' },
    { value: 'xxl', label: 'XXL', available: false }
  ],
  selected: 'm'
})"&gt;
  &lt;div class="ux-variant-selector"&gt;
    &lt;div class="ux-variant-selector__options"&gt;
      &lt;template x-for="opt in options"&gt;
        &lt;button class="ux-variant-selector__option" @click="select(opt.value)"&gt;...&lt;/button&gt;
      &lt;/template&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
    </section>

    <section class="demo-section">
      <h3>Selector de Color</h3>
      <p>Swatches de colores para seleccionar variante de producto.</p>
      <div class="demo-box"
           x-data="uxVariantSelector({
             label: 'Color',
             options: [
               { value: 'black', label: 'Negro', color: '#000000' },
               { value: 'white', label: 'Blanco', color: '#ffffff' },
               { value: 'red', label: 'Rojo', color: '#ef4444' },
               { value: 'blue', label: 'Azul', color: '#3b82f6' },
               { value: 'green', label: 'Verde', color: '#22c55e' },
               { value: 'yellow', label: 'Amarillo', color: '#eab308', available: false }
             ],
             selected: 'black'
           })">
        <div class="ux-variant-selector ux-variant-selector--color">
          <div class="ux-variant-selector__label">
            <span x-text="label"></span>
            <span class="ux-variant-selector__selected" x-text="selectedOption?.label"></span>
          </div>
          <div class="ux-variant-selector__options">
            <template x-for="opt in options" :key="opt.value">
              <button class="ux-variant-selector__option"
                      :class="{
                        'ux-variant-selector__option--selected': isSelected(opt.value),
                        'ux-variant-selector__option--unavailable': opt.available === false,
                        'ux-variant-selector__option--light': isLightColor(opt.color)
                      }"
                      :style="'background-color: ' + opt.color"
                      @click="select(opt.value)"
                      :title="opt.label">
              </button>
            </template>
          </div>
        </div>
        <div class="result-text">Seleccionado: <strong x-text="selectedOption?.label"></strong></div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-variant-selector ux-variant-selector--color"&gt;
  &lt;div class="ux-variant-selector__options"&gt;
    &lt;button class="ux-variant-selector__option"
            :style="'background-color: ' + opt.color"&gt;&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
    </section>

    <section class="demo-section">
      <h3>Selector con Imagenes</h3>
      <p>Miniaturas de imagen para variantes visuales.</p>
      <div class="demo-box"
           x-data="uxVariantSelector({
             label: 'Estilo',
             options: [
               { value: 'solid', label: 'Solido', image: 'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=100&h=100&fit=crop' },
               { value: 'striped', label: 'Rayas', image: 'https://images.unsplash.com/photo-1562157873-818bc0726f68?w=100&h=100&fit=crop' },
               { value: 'print', label: 'Estampado', image: 'https://images.unsplash.com/photo-1618354691373-d851c5c3a990?w=100&h=100&fit=crop' }
             ],
             selected: 'solid'
           })">
        <div class="ux-variant-selector ux-variant-selector--image">
          <div class="ux-variant-selector__label">
            <span x-text="label"></span>
            <span class="ux-variant-selector__selected" x-text="selectedOption?.label"></span>
          </div>
          <div class="ux-variant-selector__options">
            <template x-for="opt in options" :key="opt.value">
              <button class="ux-variant-selector__option"
                      :class="{ 'ux-variant-selector__option--selected': isSelected(opt.value) }"
                      @click="select(opt.value)">
                <img :src="opt.image" :alt="opt.label">
              </button>
            </template>
          </div>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-variant-selector ux-variant-selector--image"&gt;
  &lt;button class="ux-variant-selector__option"&gt;
    &lt;img :src="opt.image"&gt;
  &lt;/button&gt;
&lt;/div&gt;</pre>
    </section>

    <section class="demo-section">
      <h3>Variante Chip</h3>
      <p>Estilo chip con bordes redondeados.</p>
      <div class="demo-box"
           x-data="uxVariantSelector({
             label: 'Material',
             options: [
               { value: 'cotton', label: 'Algodon' },
               { value: 'polyester', label: 'Poliester' },
               { value: 'linen', label: 'Lino' },
               { value: 'wool', label: 'Lana' }
             ],
             selected: 'cotton'
           })">
        <div class="ux-variant-selector ux-variant-selector--chip">
          <div class="ux-variant-selector__label">
            <span x-text="label"></span>
          </div>
          <div class="ux-variant-selector__options">
            <template x-for="opt in options" :key="opt.value">
              <button class="ux-variant-selector__option"
                      :class="{ 'ux-variant-selector__option--selected': isSelected(opt.value) }"
                      @click="select(opt.value)"
                      x-text="opt.label">
              </button>
            </template>
          </div>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-variant-selector ux-variant-selector--chip"&gt;...
&lt;/div&gt;</pre>
    </section>

    <section class="demo-section">
      <h3>Grupo de Botones</h3>
      <p>Opciones agrupadas como un segmento.</p>
      <div class="demo-box"
           x-data="uxVariantSelector({
             options: [
               { value: 'daily', label: 'Diario' },
               { value: 'weekly', label: 'Semanal' },
               { value: 'monthly', label: 'Mensual' }
             ],
             selected: 'weekly'
           })">
        <div class="ux-variant-selector ux-variant-selector--button-group">
          <div class="ux-variant-selector__options">
            <template x-for="opt in options" :key="opt.value">
              <button class="ux-variant-selector__option"
                      :class="{ 'ux-variant-selector__option--selected': isSelected(opt.value) }"
                      @click="select(opt.value)"
                      x-text="opt.label">
              </button>
            </template>
          </div>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-variant-selector ux-variant-selector--button-group"&gt;...
&lt;/div&gt;</pre>
    </section>

    <section class="demo-section">
      <h3>Con Precios</h3>
      <p>Mostrar diferencia de precio por variante.</p>
      <div class="demo-box"
           x-data="uxVariantSelector({
             label: 'Almacenamiento',
             options: [
               { value: '128', label: '128 GB', price: '$999' },
               { value: '256', label: '256 GB', price: '$1,099', priceDiff: '+$100' },
               { value: '512', label: '512 GB', price: '$1,299', priceDiff: '+$300' },
               { value: '1tb', label: '1 TB', price: '$1,499', priceDiff: '+$500' }
             ],
             selected: '128'
           })">
        <div class="ux-variant-selector">
          <div class="ux-variant-selector__label">
            <span x-text="label"></span>
            <span class="ux-variant-selector__selected" x-text="selectedOption?.price"></span>
          </div>
          <div class="ux-variant-selector__options">
            <template x-for="opt in options" :key="opt.value">
              <button class="ux-variant-selector__option"
                      :class="{ 'ux-variant-selector__option--selected': isSelected(opt.value) }"
                      @click="select(opt.value)"
                      style="min-width: 80px; padding: var(--ux-space-sm) var(--ux-space-md);">
                <div class="ux-variant-selector__option-content">
                  <span class="ux-variant-selector__option-name" x-text="opt.label"></span>
                  <span class="ux-variant-selector__option-price" x-text="opt.priceDiff || opt.price"></span>
                </div>
              </button>
            </template>
          </div>
        </div>
      </div>
    </section>

    <section class="demo-section">
      <h3>Dropdown</h3>
      <p>Selector en formato desplegable para muchas opciones.</p>
      <div class="demo-box"
           x-data="uxVariantSelector({
             label: 'Pais',
             options: [
               { value: 'es', label: 'Espana' },
               { value: 'mx', label: 'Mexico' },
               { value: 'ar', label: 'Argentina' },
               { value: 'co', label: 'Colombia' },
               { value: 'cl', label: 'Chile' },
               { value: 'pe', label: 'Peru' }
             ],
             selected: 'es'
           })"
           @click.outside="close()">
        <div class="ux-variant-selector ux-variant-selector--dropdown"
             :class="{ 'ux-variant-selector--open': isOpen }"
             style="max-width: 300px;">
          <div class="ux-variant-selector__label" x-text="label" style="margin-bottom: var(--ux-space-xs);"></div>
          <button class="ux-variant-selector__trigger" @click="toggle()">
            <span x-text="selectedLabel"></span>
            <svg class="ux-variant-selector__trigger-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </button>
          <div class="ux-variant-selector__menu">
            <template x-for="opt in options" :key="opt.value">
              <button class="ux-variant-selector__option"
                      :class="{ 'ux-variant-selector__option--selected': isSelected(opt.value) }"
                      @click="select(opt.value)"
                      x-text="opt.label">
              </button>
            </template>
          </div>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-variant-selector ux-variant-selector--dropdown"&gt;
  &lt;button class="ux-variant-selector__trigger" @click="toggle()"&gt;
    &lt;span x-text="selectedLabel"&gt;&lt;/span&gt;
  &lt;/button&gt;
  &lt;div class="ux-variant-selector__menu"&gt;
    ...
  &lt;/div&gt;
&lt;/div&gt;</pre>
    </section>

    <section class="demo-section">
      <h3>Con Indicador de Stock</h3>
      <p>Muestra disponibilidad de inventario.</p>
      <div class="demo-box"
           x-data="uxVariantSelector({
             label: 'Talla',
             options: [
               { value: 's', label: 'S', stock: 15 },
               { value: 'm', label: 'M', stock: 3 },
               { value: 'l', label: 'L', stock: 8 },
               { value: 'xl', label: 'XL', stock: 0, available: false }
             ],
             selected: 's'
           })">
        <div class="ux-variant-selector">
          <div class="ux-variant-selector__label">
            <span x-text="label"></span>
          </div>
          <div class="ux-variant-selector__options">
            <template x-for="opt in options" :key="opt.value">
              <button class="ux-variant-selector__option"
                      :class="{
                        'ux-variant-selector__option--selected': isSelected(opt.value),
                        'ux-variant-selector__option--unavailable': opt.available === false
                      }"
                      @click="select(opt.value)"
                      x-text="opt.label">
              </button>
            </template>
          </div>
          <div class="ux-variant-selector__stock"
               :class="'ux-variant-selector__stock--' + getStockStatus(selectedOption)">
            <span class="ux-variant-selector__stock-dot"></span>
            <span class="ux-variant-selector__stock-text" x-text="getStockText(selectedOption)"></span>
          </div>
        </div>
      </div>
    </section>

    <section class="demo-section">
      <h3>Seleccion Multiple</h3>
      <p>Permite seleccionar varias opciones (ej. toppings).</p>
      <div class="demo-box"
           x-data="uxVariantSelector({
             label: 'Extras',
             options: [
               { value: 'cheese', label: 'Queso extra' },
               { value: 'bacon', label: 'Bacon' },
               { value: 'mushroom', label: 'Champinones' },
               { value: 'onion', label: 'Cebolla' }
             ],
             multiple: true,
             selected: ['cheese']
           })">
        <div class="ux-variant-selector ux-variant-selector--chip">
          <div class="ux-variant-selector__label">
            <span x-text="label"></span>
            <span class="ux-variant-selector__selected" x-text="selected.length + ' seleccionados'"></span>
          </div>
          <div class="ux-variant-selector__options">
            <template x-for="opt in options" :key="opt.value">
              <button class="ux-variant-selector__option"
                      :class="{ 'ux-variant-selector__option--selected': isSelected(opt.value) }"
                      @click="select(opt.value)"
                      x-text="opt.label">
              </button>
            </template>
          </div>
        </div>
        <div class="result-text">Seleccionados: <strong x-text="selected.join(', ')"></strong></div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div x-data="uxVariantSelector({
  multiple: true,
  selected: ['cheese']
})"&gt;...
&lt;/div&gt;</pre>
    </section>

    <section class="demo-section">
      <h3>Opciones</h3>
      <p>Configuracion disponible para el componente.</p>
      <div class="demo-box">
        <table style="width: 100%; border-collapse: collapse;">
          <thead>
            <tr style="text-align: left; border-bottom: 1px solid var(--ux-border-color);">
              <th style="padding: var(--ux-space-sm);">Opcion</th>
              <th style="padding: var(--ux-space-sm);">Tipo</th>
              <th style="padding: var(--ux-space-sm);">Default</th>
              <th style="padding: var(--ux-space-sm);">Descripcion</th>
            </tr>
          </thead>
          <tbody>
            <tr style="border-bottom: 1px solid var(--ux-border-color);">
              <td style="padding: var(--ux-space-sm);"><code>options</code></td>
              <td style="padding: var(--ux-space-sm);">array</td>
              <td style="padding: var(--ux-space-sm);">[]</td>
              <td style="padding: var(--ux-space-sm);">Lista de opciones</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--ux-border-color);">
              <td style="padding: var(--ux-space-sm);"><code>selected</code></td>
              <td style="padding: var(--ux-space-sm);">string | array</td>
              <td style="padding: var(--ux-space-sm);">null</td>
              <td style="padding: var(--ux-space-sm);">Valor(es) seleccionado(s)</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--ux-border-color);">
              <td style="padding: var(--ux-space-sm);"><code>multiple</code></td>
              <td style="padding: var(--ux-space-sm);">boolean</td>
              <td style="padding: var(--ux-space-sm);">false</td>
              <td style="padding: var(--ux-space-sm);">Permitir seleccion multiple</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--ux-border-color);">
              <td style="padding: var(--ux-space-sm);"><code>label</code></td>
              <td style="padding: var(--ux-space-sm);">string</td>
              <td style="padding: var(--ux-space-sm);">''</td>
              <td style="padding: var(--ux-space-sm);">Etiqueta del selector</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <section class="demo-section">
      <h3>Formato de Opciones</h3>
      <p>Cada opcion puede tener las siguientes propiedades.</p>
      <div class="demo-box">
        <pre class="ux-code-block" data-lang="javascript" style="margin: 0;">{
  value: 'm',           // Valor unico (requerido)
  label: 'Medium',      // Texto a mostrar (requerido)
  available: true,      // Si esta disponible
  stock: 15,            // Cantidad en stock
  price: '$99',         // Precio de esta variante
  priceDiff: '+$10',    // Diferencia de precio
  color: '#ff0000',     // Color (para swatches)
  image: 'url...'       // URL de imagen (para thumbnails)
}</pre>
      </div>
    </section>

    <section class="demo-section">
      <h3>Eventos</h3>
      <p>Evento emitido cuando cambia la seleccion.</p>
      <div class="demo-box">
        <pre class="ux-code-block" data-lang="html" style="margin: 0;">&lt;div x-data="uxVariantSelector({ ... })"
     @variant:change="handleChange($event.detail)"&gt;
&lt;/div&gt;

// $event.detail para seleccion simple:
{ value: 'm', option: { ... } }

// $event.detail para seleccion multiple:
{ values: ['cheese', 'bacon'] }</pre>
      </div>
    </section>

    <section class="demo-section">
      <h3>HTMX + Django</h3>
      <p>Ejemplos de integracion con HTMX y Django para selectores de variantes de producto.</p>

      <h4 style="margin-top: var(--ux-space-lg); margin-bottom: var(--ux-space-sm); font-weight: 600;">Actualizar precio al cambiar variante</h4>
      <p>Cuando el usuario selecciona una variante, se actualiza el precio y disponibilidad via HTMX.</p>
      <div class="demo-box">
        <pre class="ux-code-block" data-lang="html" style="margin: 0;">&lt;!-- Template Django: product_detail.html --&gt;
&lt;div x-data="uxVariantSelector({
       label: 'Talla',
       options: {{ product.variants_json|safe }},
       selected: '{{ product.default_variant.sku }}'
     })"
     @variant:change="$refs.variantInput.value = $event.detail.value; htmx.trigger($refs.priceContainer, 'refresh')"&gt;

  &lt;input type="hidden" name="variant" x-ref="variantInput" :value="selected"&gt;

  &lt;div class="ux-variant-selector"&gt;
    &lt;div class="ux-variant-selector__label"&gt;
      &lt;span x-text="label"&gt;&lt;/span&gt;
      &lt;span class="ux-variant-selector__selected" x-text="selectedOption?.label"&gt;&lt;/span&gt;
    &lt;/div&gt;
    &lt;div class="ux-variant-selector__options"&gt;
      &lt;template x-for="opt in options" :key="opt.value"&gt;
        &lt;button class="ux-variant-selector__option"
                :class="{
                  'ux-variant-selector__option--selected': isSelected(opt.value),
                  'ux-variant-selector__option--unavailable': opt.available === false
                }"
                @click="select(opt.value)"
                x-text="opt.label"&gt;
        &lt;/button&gt;
      &lt;/template&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;!-- Contenedor de precio actualizado via HTMX --&gt;
  &lt;div id="price-container"
       x-ref="priceContainer"
       hx-get="{% url 'product_price' product.id %}"
       hx-trigger="refresh"
       hx-vals="js:{variant: document.querySelector('[name=variant]').value}"
       hx-swap="innerHTML"&gt;
    {% include 'partials/product_price.html' with variant=product.default_variant %}
  &lt;/div&gt;
&lt;/div&gt;</pre>
      </div>

      <h4 style="margin-top: var(--ux-space-lg); margin-bottom: var(--ux-space-sm); font-weight: 600;">Vista Django para precio</h4>
      <div class="demo-box">
        <pre class="ux-code-block" data-lang="python" style="margin: 0;"># views.py
from django.shortcuts import get_object_or_404
from django.template.response import TemplateResponse

def product_price(request, product_id):
    """Retorna el partial del precio para una variante especifica."""
    product = get_object_or_404(Product, id=product_id)
    variant_sku = request.GET.get('variant')
    variant = product.variants.filter(sku=variant_sku).first()

    if not variant:
        variant = product.default_variant

    return TemplateResponse(request, 'partials/product_price.html', {
        'variant': variant,
        'product': product,
    })</pre>
      </div>

      <h4 style="margin-top: var(--ux-space-lg); margin-bottom: var(--ux-space-sm); font-weight: 600;">Partial de precio</h4>
      <div class="demo-box">
        <pre class="ux-code-block" data-lang="html" style="margin: 0;">&lt;!-- partials/product_price.html --&gt;
&lt;div class="product-price"&gt;
  &lt;span class="product-price__current"&gt;{{ variant.price|currency }}&lt;/span&gt;
  {% if variant.compare_price %}
    &lt;span class="product-price__compare"&gt;{{ variant.compare_price|currency }}&lt;/span&gt;
  {% endif %}

  {% if variant.stock &gt; 0 %}
    &lt;div class="ux-variant-selector__stock ux-variant-selector__stock--{{ variant.stock_status }}"&gt;
      &lt;span class="ux-variant-selector__stock-dot"&gt;&lt;/span&gt;
      &lt;span class="ux-variant-selector__stock-text"&gt;
        {% if variant.stock &lt; 5 %}Solo {{ variant.stock }} disponibles{% else %}En stock{% endif %}
      &lt;/span&gt;
    &lt;/div&gt;
  {% else %}
    &lt;div class="ux-variant-selector__stock ux-variant-selector__stock--out"&gt;
      &lt;span class="ux-variant-selector__stock-dot"&gt;&lt;/span&gt;
      &lt;span class="ux-variant-selector__stock-text"&gt;Agotado&lt;/span&gt;
    &lt;/div&gt;
  {% endif %}
&lt;/div&gt;</pre>
      </div>

      <h4 style="margin-top: var(--ux-space-lg); margin-bottom: var(--ux-space-sm); font-weight: 600;">Modelo Django con variantes</h4>
      <div class="demo-box">
        <pre class="ux-code-block" data-lang="python" style="margin: 0;"># models.py
import json
from django.db import models

class Product(models.Model):
    name = models.CharField(max_length=200)

    @property
    def default_variant(self):
        return self.variants.filter(is_default=True).first() or self.variants.first()

    @property
    def variants_json(self):
        """Retorna las variantes en formato JSON para el componente."""
        return json.dumps([
            {
                'value': v.sku,
                'label': v.name,
                'price': str(v.price),
                'stock': v.stock,
                'available': v.stock > 0,
                'color': v.color_hex if v.color_hex else None,
                'image': v.image.url if v.image else None,
            }
            for v in self.variants.all()
        ])

class ProductVariant(models.Model):
    product = models.ForeignKey(Product, on_delete=models.CASCADE, related_name='variants')
    sku = models.CharField(max_length=50, unique=True)
    name = models.CharField(max_length=100)
    price = models.DecimalField(max_digits=10, decimal_places=2)
    compare_price = models.DecimalField(max_digits=10, decimal_places=2, null=True, blank=True)
    stock = models.PositiveIntegerField(default=0)
    color_hex = models.CharField(max_length=7, null=True, blank=True)
    image = models.ImageField(upload_to='variants/', null=True, blank=True)
    is_default = models.BooleanField(default=False)

    @property
    def stock_status(self):
        if self.stock == 0:
            return 'out'
        elif self.stock < 5:
            return 'low'
        return 'available'</pre>
      </div>

      <h4 style="margin-top: var(--ux-space-lg); margin-bottom: var(--ux-space-sm); font-weight: 600;">Agregar al carrito con variante seleccionada</h4>
      <div class="demo-box">
        <pre class="ux-code-block" data-lang="html" style="margin: 0;">&lt;!-- Formulario completo de producto --&gt;
&lt;form hx-post="{% url 'cart_add' %}"
      hx-target="#cart-count"
      hx-swap="innerHTML"
      hx-indicator="#add-spinner"&gt;
  {% csrf_token %}
  &lt;input type="hidden" name="product_id" value="{{ product.id }}"&gt;

  &lt;!-- Selector de variante --&gt;
  &lt;div x-data="uxVariantSelector({
         label: 'Talla',
         options: {{ product.variants_json|safe }},
         selected: '{{ product.default_variant.sku }}'
       })"&gt;
    &lt;input type="hidden" name="variant_sku" :value="selected"&gt;

    &lt;div class="ux-variant-selector"&gt;
      &lt;!-- ... opciones ... --&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;!-- Cantidad --&gt;
  &lt;div class="ux-quantity-stepper" x-data="{ qty: 1 }"&gt;
    &lt;button type="button" @click="qty = Math.max(1, qty - 1)"&gt;-&lt;/button&gt;
    &lt;input type="number" name="quantity" x-model="qty" min="1"&gt;
    &lt;button type="button" @click="qty++"&gt;+&lt;/button&gt;
  &lt;/div&gt;

  &lt;!-- Boton agregar --&gt;
  &lt;button type="submit" class="ux-button ux-color-primary" style="width: 100%;"&gt;
    &lt;span class="ux-spinner ux-spinner--sm" id="add-spinner" style="display: none;"&gt;&lt;/span&gt;
    Agregar al carrito
  &lt;/button&gt;
&lt;/form&gt;</pre>
      </div>

      <h4 style="margin-top: var(--ux-space-lg); margin-bottom: var(--ux-space-sm); font-weight: 600;">Selectores encadenados (Color + Talla)</h4>
      <p>Ejemplo donde la seleccion de color filtra las tallas disponibles.</p>
      <div class="demo-box">
        <pre class="ux-code-block" data-lang="html" style="margin: 0;">&lt;div x-data="{
       colors: {{ product.colors_json|safe }},
       allSizes: {{ product.sizes_by_color_json|safe }},
       selectedColor: '{{ product.default_color }}',
       selectedSize: null,

       get availableSizes() {
         return this.allSizes[this.selectedColor] || [];
       },

       selectColor(color) {
         this.selectedColor = color;
         // Reset size si no esta disponible en el nuevo color
         const sizeAvailable = this.availableSizes.find(s =&gt; s.value === this.selectedSize);
         if (!sizeAvailable || sizeAvailable.available === false) {
           const firstAvailable = this.availableSizes.find(s =&gt; s.available !== false);
           this.selectedSize = firstAvailable?.value || null;
         }
         // Actualizar precio
         htmx.trigger(this.$refs.priceContainer, 'refresh');
       }
     }"&gt;

  &lt;!-- Selector de Color --&gt;
  &lt;div class="ux-variant-selector ux-variant-selector--color"&gt;
    &lt;div class="ux-variant-selector__label"&gt;Color&lt;/div&gt;
    &lt;div class="ux-variant-selector__options"&gt;
      &lt;template x-for="color in colors" :key="color.value"&gt;
        &lt;button class="ux-variant-selector__option"
                :class="{ 'ux-variant-selector__option--selected': selectedColor === color.value }"
                :style="'background-color: ' + color.hex"
                @click="selectColor(color.value)"
                :title="color.label"&gt;
        &lt;/button&gt;
      &lt;/template&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;!-- Selector de Talla (dinamico segun color) --&gt;
  &lt;div class="ux-variant-selector"&gt;
    &lt;div class="ux-variant-selector__label"&gt;Talla&lt;/div&gt;
    &lt;div class="ux-variant-selector__options"&gt;
      &lt;template x-for="size in availableSizes" :key="size.value"&gt;
        &lt;button class="ux-variant-selector__option"
                :class="{
                  'ux-variant-selector__option--selected': selectedSize === size.value,
                  'ux-variant-selector__option--unavailable': size.available === false
                }"
                @click="selectedSize = size.value; htmx.trigger($refs.priceContainer, 'refresh')"
                x-text="size.label"&gt;
        &lt;/button&gt;
      &lt;/template&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;input type="hidden" name="color" :value="selectedColor"&gt;
  &lt;input type="hidden" name="size" :value="selectedSize"&gt;

  &lt;div x-ref="priceContainer"
       hx-get="{% url 'product_price' product.id %}"
       hx-trigger="refresh"
       hx-vals="js:{color: document.querySelector('[name=color]').value, size: document.querySelector('[name=size]').value}"&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
      </div>
    </section>