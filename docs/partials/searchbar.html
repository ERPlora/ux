<style>
    .demo-section { margin-bottom: var(--ux-space-xl); padding: var(--ux-space-lg); }
    .demo-section h3 { font-size: var(--ux-font-size-lg); font-weight: 600; margin-bottom: var(--ux-space-md); }
    .demo-section p { font-size: var(--ux-font-size-md); color: var(--ux-text-secondary); margin-bottom: var(--ux-space-md); }
    .demo-box { background: var(--ux-surface); border-radius: var(--ux-border-radius-lg); padding: var(--ux-space-lg); margin-bottom: var(--ux-space-md); }
  </style>

<!-- Basic Searchbar -->
  <div class="demo-section">
    <h3>Searchbar Basico</h3>
    <p>Barra de busqueda estilo iOS con icono de lupa y boton de limpiar.</p>
    <div class="demo-box" x-data="{ query: '' }">
      <div class="ux-searchbar" :class="{ 'ux-searchbar--has-value': query.length > 0 }">
        <div class="ux-searchbar__container">
          <span class="ux-searchbar__icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
          </span>
          <input type="search" class="ux-searchbar__input" placeholder="Buscar..." x-model="query">
          <button class="ux-searchbar__clear" @click="query = ''" type="button">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">&lt;div class="ux-searchbar" :class="{ 'ux-searchbar--has-value': query.length &gt; 0 }"&gt;
  &lt;div class="ux-searchbar__container"&gt;
    &lt;span class="ux-searchbar__icon"&gt;
      &lt;svg&gt;...&lt;/svg&gt;
    &lt;/span&gt;
    &lt;input type="search" class="ux-searchbar__input" placeholder="Buscar..."&gt;
    &lt;button class="ux-searchbar__clear"&gt;
      &lt;svg&gt;...&lt;/svg&gt;
    &lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
  </div>

  <!-- With Cancel Button -->
  <div class="demo-section">
    <h3>Con Boton Cancelar</h3>
    <p>Boton cancelar que aparece al enfocar (estilo iOS).</p>
    <div class="demo-box" x-data="{ query: '', focused: false }">
      <div class="ux-searchbar"
           :class="{
             'ux-searchbar--has-value': query.length > 0,
             'ux-searchbar--focused': focused
           }">
        <div class="ux-searchbar__container">
          <span class="ux-searchbar__icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
          </span>
          <input type="search" class="ux-searchbar__input" placeholder="Buscar productos..."
                 x-model="query"
                 @focus="focused = true"
                 @blur="setTimeout(() => focused = false, 200)">
          <button class="ux-searchbar__clear" @click="query = ''" type="button">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
        <button class="ux-searchbar__cancel" @click="query = ''; focused = false" type="button">Cancelar</button>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">&lt;div class="ux-searchbar ux-searchbar--focused"&gt;
  &lt;div class="ux-searchbar__container"&gt;...&lt;/div&gt;
  &lt;button class="ux-searchbar__cancel"&gt;Cancelar&lt;/button&gt;
&lt;/div&gt;</pre>
  </div>

  <!-- Variants -->
  <div class="demo-section">
    <h3>Variantes</h3>
    <p>Diferentes estilos: default, rounded, outline y filled.</p>
    <div class="demo-box" style="display: flex; flex-direction: column; gap: var(--ux-space-lg);">
      <!-- Default -->
      <div x-data="{ query: '' }">
        <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-xs);">Default</p>
        <div class="ux-searchbar" :class="{ 'ux-searchbar--has-value': query.length > 0 }">
          <div class="ux-searchbar__container">
            <span class="ux-searchbar__icon">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
            </span>
            <input type="search" class="ux-searchbar__input" placeholder="Default..." x-model="query">
            <button class="ux-searchbar__clear" @click="query = ''" type="button">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Rounded -->
      <div x-data="{ query: '' }">
        <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-xs);">Rounded</p>
        <div class="ux-searchbar ux-searchbar--rounded" :class="{ 'ux-searchbar--has-value': query.length > 0 }">
          <div class="ux-searchbar__container">
            <span class="ux-searchbar__icon">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
            </span>
            <input type="search" class="ux-searchbar__input" placeholder="Rounded..." x-model="query">
            <button class="ux-searchbar__clear" @click="query = ''" type="button">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Outline -->
      <div x-data="{ query: '' }">
        <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-xs);">Outline</p>
        <div class="ux-searchbar ux-searchbar--outline" :class="{ 'ux-searchbar--has-value': query.length > 0 }">
          <div class="ux-searchbar__container">
            <span class="ux-searchbar__icon">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
            </span>
            <input type="search" class="ux-searchbar__input" placeholder="Outline..." x-model="query">
            <button class="ux-searchbar__clear" @click="query = ''" type="button">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Filled -->
      <div x-data="{ query: '' }">
        <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-xs);">Filled</p>
        <div class="ux-searchbar ux-searchbar--filled" :class="{ 'ux-searchbar--has-value': query.length > 0 }">
          <div class="ux-searchbar__container">
            <span class="ux-searchbar__icon">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
            </span>
            <input type="search" class="ux-searchbar__input" placeholder="Filled..." x-model="query">
            <button class="ux-searchbar__clear" @click="query = ''" type="button">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">&lt;div class="ux-searchbar ux-searchbar--rounded"&gt;...&lt;/div&gt;
&lt;div class="ux-searchbar ux-searchbar--outline"&gt;...&lt;/div&gt;
&lt;div class="ux-searchbar ux-searchbar--filled"&gt;...&lt;/div&gt;</pre>
  </div>

  <!-- Sizes -->
  <div class="demo-section">
    <h3>Tamanos</h3>
    <p>Tamanos pequeno, default y grande.</p>
    <div class="demo-box" style="display: flex; flex-direction: column; gap: var(--ux-space-lg);">
      <!-- Small -->
      <div x-data="{ query: '' }">
        <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-xs);">Small</p>
        <div class="ux-searchbar ux-searchbar--sm" :class="{ 'ux-searchbar--has-value': query.length > 0 }">
          <div class="ux-searchbar__container">
            <span class="ux-searchbar__icon">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
            </span>
            <input type="search" class="ux-searchbar__input" placeholder="Small..." x-model="query">
            <button class="ux-searchbar__clear" @click="query = ''" type="button">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Default -->
      <div x-data="{ query: '' }">
        <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-xs);">Default</p>
        <div class="ux-searchbar" :class="{ 'ux-searchbar--has-value': query.length > 0 }">
          <div class="ux-searchbar__container">
            <span class="ux-searchbar__icon">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
            </span>
            <input type="search" class="ux-searchbar__input" placeholder="Default..." x-model="query">
            <button class="ux-searchbar__clear" @click="query = ''" type="button">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>
      </div>

      <!-- Large -->
      <div x-data="{ query: '' }">
        <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-xs);">Large</p>
        <div class="ux-searchbar ux-searchbar--lg" :class="{ 'ux-searchbar--has-value': query.length > 0 }">
          <div class="ux-searchbar__container">
            <span class="ux-searchbar__icon">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
              </svg>
            </span>
            <input type="search" class="ux-searchbar__input" placeholder="Large..." x-model="query">
            <button class="ux-searchbar__clear" @click="query = ''" type="button">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">&lt;div class="ux-searchbar ux-searchbar--sm"&gt;...&lt;/div&gt;
&lt;div class="ux-searchbar"&gt;...&lt;/div&gt;
&lt;div class="ux-searchbar ux-searchbar--lg"&gt;...&lt;/div&gt;</pre>
  </div>

  <!-- With Results Dropdown -->
  <div class="demo-section">
    <h3>Con Resultados</h3>
    <p>Dropdown de resultados de busqueda. Escribe para ver sugerencias.</p>
    <div class="demo-box" x-data="{
      query: '',
      focused: false,
      results: [
        { title: 'iPhone 15 Pro', subtitle: 'Smartphones' },
        { title: 'iPad Air', subtitle: 'Tablets' },
        { title: 'MacBook Pro', subtitle: 'Laptops' },
        { title: 'AirPods Pro', subtitle: 'Audio' }
      ],
      get filteredResults() {
        if (!this.query) return [];
        return this.results.filter(r =>
          r.title.toLowerCase().includes(this.query.toLowerCase())
        );
      }
    }">
      <div class="ux-searchbar"
           :class="{
             'ux-searchbar--has-value': query.length > 0,
             'ux-searchbar--focused': focused
           }"
           style="position: relative;">
        <div class="ux-searchbar__container">
          <span class="ux-searchbar__icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
          </span>
          <input type="search" class="ux-searchbar__input" placeholder="Buscar productos..."
                 x-model="query"
                 @focus="focused = true"
                 @blur="setTimeout(() => focused = false, 200)">
          <button class="ux-searchbar__clear" @click="query = ''" type="button">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>

        <!-- Results dropdown -->
        <div class="ux-searchbar__results" x-show="focused && query.length > 0" x-cloak>
          <template x-if="filteredResults.length > 0">
            <div>
              <template x-for="result in filteredResults" :key="result.title">
                <div class="ux-searchbar__result" @click="query = result.title">
                  <span class="ux-searchbar__result-icon">
                    <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                    </svg>
                  </span>
                  <div class="ux-searchbar__result-content">
                    <div class="ux-searchbar__result-title" x-text="result.title"></div>
                    <div class="ux-searchbar__result-subtitle" x-text="result.subtitle"></div>
                  </div>
                </div>
              </template>
            </div>
          </template>
          <template x-if="filteredResults.length === 0">
            <div class="ux-searchbar__no-results">No se encontraron resultados</div>
          </template>
        </div>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">&lt;div class="ux-searchbar__results"&gt;
  &lt;div class="ux-searchbar__result"&gt;
    &lt;span class="ux-searchbar__result-icon"&gt;...&lt;/span&gt;
    &lt;div class="ux-searchbar__result-content"&gt;
      &lt;div class="ux-searchbar__result-title"&gt;Titulo&lt;/div&gt;
      &lt;div class="ux-searchbar__result-subtitle"&gt;Subtitulo&lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
  </div>

  <!-- Recent Searches -->
  <div class="demo-section">
    <h3>Busquedas Recientes</h3>
    <p>Historial de busquedas recientes con opcion de eliminar.</p>
    <div class="demo-box" x-data="{
      query: '',
      focused: false,
      recentSearches: ['iPhone', 'MacBook', 'AirPods', 'Apple Watch']
    }">
      <div class="ux-searchbar"
           :class="{
             'ux-searchbar--has-value': query.length > 0,
             'ux-searchbar--focused': focused
           }"
           style="position: relative;">
        <div class="ux-searchbar__container">
          <span class="ux-searchbar__icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
          </span>
          <input type="search" class="ux-searchbar__input" placeholder="Buscar..."
                 x-model="query"
                 @focus="focused = true"
                 @blur="setTimeout(() => focused = false, 200)">
          <button class="ux-searchbar__clear" @click="query = ''" type="button">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>

        <!-- Recent searches dropdown -->
        <div class="ux-searchbar__results" x-show="focused && query.length === 0 && recentSearches.length > 0" x-cloak>
          <div class="ux-searchbar__recent">
            <div class="ux-searchbar__recent-header">
              <span class="ux-searchbar__recent-title">Busquedas recientes</span>
              <button class="ux-searchbar__recent-clear" @click="recentSearches = []">Limpiar</button>
            </div>
            <template x-for="(term, index) in recentSearches" :key="index">
              <div class="ux-searchbar__recent-item" @click="query = term">
                <span class="ux-searchbar__recent-item-icon">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                  </svg>
                </span>
                <span class="ux-searchbar__recent-item-text" x-text="term"></span>
                <button class="ux-searchbar__recent-item-remove" @click.stop="recentSearches.splice(index, 1)">
                  <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                  </svg>
                </button>
              </div>
            </template>
          </div>
        </div>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">&lt;div class="ux-searchbar__recent"&gt;
  &lt;div class="ux-searchbar__recent-header"&gt;
    &lt;span class="ux-searchbar__recent-title"&gt;Busquedas recientes&lt;/span&gt;
    &lt;button class="ux-searchbar__recent-clear"&gt;Limpiar&lt;/button&gt;
  &lt;/div&gt;
  &lt;div class="ux-searchbar__recent-item"&gt;
    &lt;span class="ux-searchbar__recent-item-icon"&gt;...&lt;/span&gt;
    &lt;span class="ux-searchbar__recent-item-text"&gt;Termino&lt;/span&gt;
    &lt;button class="ux-searchbar__recent-item-remove"&gt;...&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
  </div>

  <!-- Disabled -->
  <div class="demo-section">
    <h3>Deshabilitado</h3>
    <div class="demo-box">
      <div class="ux-searchbar ux-searchbar--disabled">
        <div class="ux-searchbar__container">
          <span class="ux-searchbar__icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
          </span>
          <input type="search" class="ux-searchbar__input" placeholder="No disponible..." disabled>
        </div>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">&lt;div class="ux-searchbar ux-searchbar--disabled"&gt;
  &lt;input type="search" disabled&gt;
&lt;/div&gt;</pre>
  </div>

  <!-- Alpine Component -->
  <div class="demo-section">
    <h3>Componente Alpine.js</h3>
    <p>Uso del componente <code>uxSearchbar</code> con funcionalidad completa.</p>
    <div class="demo-box" x-data="uxSearchbar({
      recentSearches: ['React', 'Vue', 'Angular'],
      debounceTime: 300
    })">
      <div class="ux-searchbar"
           :class="{
             'ux-searchbar--has-value': hasValue,
             'ux-searchbar--focused': isFocused
           }"
           style="position: relative;">
        <div class="ux-searchbar__container">
          <span class="ux-searchbar__icon">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
            </svg>
          </span>
          <input type="search" class="ux-searchbar__input" placeholder="Buscar frameworks..."
                 x-model="query"
                 @focus="focus()"
                 @blur="blur()"
                 @input="onInput()"
                 @keydown="handleKeydown($event)">
          <button class="ux-searchbar__clear" @click="clear()" type="button">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
        <button class="ux-searchbar__cancel" @click="cancel()" type="button">Cancelar</button>
      </div>

      <div style="margin-top: var(--ux-space-md); padding: var(--ux-space-md); background: var(--ux-surface-secondary); border-radius: var(--ux-border-radius);">
        <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-secondary);">
          Query: <strong x-text="query || '(vacio)'"></strong><br>
          Focused: <strong x-text="isFocused"></strong><br>
          Recientes: <strong x-text="recentSearches.join(', ') || 'ninguno'"></strong>
        </p>
        <div style="display: flex; gap: var(--ux-space-sm); margin-top: var(--ux-space-sm); flex-wrap: wrap;">
          <button class="ux-button ux-button--sm" @click="addToRecent('Svelte')">Agregar reciente</button>
          <button class="ux-button ux-button--sm ux-button ux-color-secondary" @click="clearRecent()">Limpiar recientes</button>
        </div>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">// Configuracion del componente uxSearchbar
uxSearchbar({
  query: '',              // Valor inicial
  recentSearches: [],     // Busquedas recientes
  maxRecent: 5,           // Maximo de recientes
  debounceTime: 300,      // Debounce en ms
  minChars: 1             // Caracteres minimos para buscar
})

// Propiedades:
hasValue           // true si hay texto
isFocused          // true si esta enfocado
isLoading          // true durante busqueda
shouldShowDropdown // true si debe mostrar dropdown

// Metodos:
focus()            // Enfocar
blur()             // Desenfocar
clear()            // Limpiar query
cancel()           // Cancelar busqueda
onInput()          // Handler de input (con debounce)
search()           // Ejecutar busqueda (sobreescribir)
selectResult(r)    // Seleccionar resultado
addToRecent(term)  // Agregar a recientes
selectRecent(term) // Seleccionar reciente
removeRecent(term) // Eliminar de recientes
clearRecent()      // Limpiar todos los recientes
submit()           // Enviar busqueda
handleKeydown(e)   // Handler de teclado</pre>
  </div>

  <!-- Highlight Helper -->
  <div class="demo-section">
    <h3>Helper de Resaltado</h3>
    <p>Funcion para resaltar coincidencias en los resultados.</p>
    <div class="demo-box">
      <pre class="ux-code-block" data-lang="html">// Resaltar texto que coincide con la busqueda
UX.highlightMatch('iPhone 15 Pro Max', 'pro')
// Retorna: 'iPhone 15 &lt;span class="ux-searchbar__highlight"&gt;Pro&lt;/span&gt; Max'

// Uso en template:
&lt;span x-html="UX.highlightMatch(result.title, query)"&gt;&lt;/span&gt;</pre>
    </div>
  </div>

  <!-- HTMX Integration -->
  <div class="demo-section">
    <h3>Integracion con HTMX</h3>
    <p>Busqueda en servidor con resultados dinamicos usando HTMX.</p>
    <div class="demo-box">
      <pre class="ux-code-block" data-lang="html">&lt;!-- Busqueda basica con HTMX --&gt;
&lt;div class="ux-searchbar"&gt;
  &lt;div class="ux-searchbar__container"&gt;
    &lt;span class="ux-searchbar__icon"&gt;...&lt;/span&gt;
    &lt;input type="search"
           class="ux-searchbar__input"
           name="q"
           placeholder="Buscar..."
           hx-get="/api/search"
           hx-trigger="input changed delay:300ms, search"
           hx-target="#search-results"
           hx-indicator="#search-loading"&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Indicador de carga --&gt;
&lt;div id="search-loading" class="htmx-indicator ux-searchbar__loading"&gt;
  &lt;span class="ux-spinner"&gt;&lt;/span&gt;
&lt;/div&gt;

&lt;!-- Contenedor de resultados --&gt;
&lt;div id="search-results" class="ux-searchbar__results"&gt;&lt;/div&gt;</pre>
    </div>

    <div class="demo-box">
      <pre class="ux-code-block" data-lang="html">&lt;!-- Respuesta del servidor (HTML parcial) --&gt;
&lt;!-- GET /api/search?q=iphone --&gt;

&lt;div class="ux-searchbar__result" hx-get="/producto/123" hx-push-url="true"&gt;
  &lt;span class="ux-searchbar__result-icon"&gt;...&lt;/span&gt;
  &lt;div class="ux-searchbar__result-content"&gt;
    &lt;div class="ux-searchbar__result-title"&gt;
      &lt;span class="ux-searchbar__highlight"&gt;iPhone&lt;/span&gt; 15 Pro
    &lt;/div&gt;
    &lt;div class="ux-searchbar__result-subtitle"&gt;Smartphones&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;div class="ux-searchbar__result" hx-get="/producto/456" hx-push-url="true"&gt;
  &lt;div class="ux-searchbar__result-content"&gt;
    &lt;div class="ux-searchbar__result-title"&gt;
      &lt;span class="ux-searchbar__highlight"&gt;iPhone&lt;/span&gt; 14
    &lt;/div&gt;
    &lt;div class="ux-searchbar__result-subtitle"&gt;Smartphones&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Sin resultados --&gt;
&lt;div class="ux-searchbar__no-results"&gt;
  No se encontraron resultados para "xyz"
&lt;/div&gt;</pre>
    </div>

    <div class="demo-box">
      <pre class="ux-code-block" data-lang="html">&lt;!-- Busqueda con formulario completo --&gt;
&lt;form hx-get="/api/search"
      hx-target="#search-results"
      hx-trigger="submit"&gt;
  &lt;div class="ux-searchbar"&gt;
    &lt;div class="ux-searchbar__container"&gt;
      &lt;span class="ux-searchbar__icon"&gt;...&lt;/span&gt;
      &lt;input type="search"
             class="ux-searchbar__input"
             name="q"
             placeholder="Buscar..."
             hx-get="/api/search"
             hx-trigger="input changed delay:500ms"
             hx-target="#search-results"&gt;
      &lt;button type="submit" class="ux-searchbar__clear" style="opacity: 1;"&gt;
        &lt;svg&gt;...&lt;/svg&gt; &lt;!-- icono buscar --&gt;
      &lt;/button&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/form&gt;

&lt;div id="search-results"&gt;&lt;/div&gt;</pre>
    </div>

    <div class="demo-box">
      <pre class="ux-code-block" data-lang="html">&lt;!-- Con historial de busquedas recientes (servidor) --&gt;
&lt;div class="ux-searchbar" style="position: relative;"&gt;
  &lt;div class="ux-searchbar__container"&gt;
    &lt;span class="ux-searchbar__icon"&gt;...&lt;/span&gt;
    &lt;input type="search"
           class="ux-searchbar__input"
           name="q"
           placeholder="Buscar..."
           hx-get="/api/search"
           hx-trigger="input changed delay:300ms"
           hx-target="#search-dropdown"
           onfocus="document.getElementById('search-dropdown').style.display='block'"
           onblur="setTimeout(() =&gt; document.getElementById('search-dropdown').style.display='none', 200)"&gt;
  &lt;/div&gt;

  &lt;!-- Dropdown con recientes (cargado al focus) --&gt;
  &lt;div id="search-dropdown"
       class="ux-searchbar__results"
       style="display: none;"
       hx-get="/api/search/recent"
       hx-trigger="load"&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
    </div>

    <div class="demo-box">
      <pre class="ux-code-block" data-lang="html">&lt;!-- Ejemplo Python/Flask del endpoint --&gt;
@app.route('/api/search')
def search():
    q = request.args.get('q', '')
    if not q:
        return render_template('search/recent.html')

    results = Product.search(q)
    return render_template('search/results.html',
                           results=results,
                           query=q)

&lt;!-- Ejemplo Node/Express --&gt;
app.get('/api/search', async (req, res) =&gt; {
  const { q } = req.query;
  if (!q) {
    return res.render('search/recent');
  }

  const results = await Product.search(q);
  res.render('search/results', { results, query: q });
});</pre>
    </div>
  </div>

  <!-- HTMX + Django -->
  <div class="demo-section">
    <h3>HTMX + Django</h3>
    <p>Busqueda en tiempo real con debounce, resultados dinamicos y vista Django.</p>

    <div class="demo-box">
      <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-sm);">Template Django con HTMX</p>
      <pre class="ux-code-block" data-lang="html">&lt;!-- templates/components/searchbar.html --&gt;
&lt;div class="ux-searchbar" style="position: relative;"&gt;
  &lt;div class="ux-searchbar__container"&gt;
    &lt;span class="ux-searchbar__icon"&gt;
      &lt;svg fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;
        &lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/&gt;
      &lt;/svg&gt;
    &lt;/span&gt;
    &lt;input type="search"
           class="ux-searchbar__input"
           name="q"
           placeholder="Buscar productos..."
           hx-get="{% url 'product_search' %}"
           hx-trigger="input changed delay:300ms, search"
           hx-target="#search-results"
           hx-indicator="#search-loading"
           autocomplete="off"&gt;
    &lt;span id="search-loading" class="htmx-indicator ux-spinner ux-spinner--sm"&gt;&lt;/span&gt;
  &lt;/div&gt;

  &lt;!-- Resultados dinamicos --&gt;
  &lt;div id="search-results" class="ux-searchbar__results"&gt;&lt;/div&gt;
&lt;/div&gt;</pre>
    </div>

    <div class="demo-box">
      <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-sm);">Vista Django</p>
      <pre class="ux-code-block" data-lang="python"># views.py
from django.shortcuts import render
from django.db.models import Q
from .models import Product

def product_search(request):
    """Vista de busqueda con debounce (manejado por HTMX)"""
    query = request.GET.get('q', '').strip()

    if not query:
        # Sin query: mostrar busquedas recientes del usuario
        recent = request.session.get('recent_searches', [])[:5]
        return render(request, 'partials/search_recent.html', {
            'recent_searches': recent
        })

    # Buscar productos
    products = Product.objects.filter(
        Q(name__icontains=query) |
        Q(sku__icontains=query) |
        Q(category__name__icontains=query)
    ).select_related('category')[:10]

    # Guardar en busquedas recientes
    recent = request.session.get('recent_searches', [])
    if query not in recent:
        recent.insert(0, query)
        request.session['recent_searches'] = recent[:10]

    return render(request, 'partials/search_results.html', {
        'products': products,
        'query': query
    })</pre>
    </div>

    <div class="demo-box">
      <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-sm);">Template de resultados</p>
      <pre class="ux-code-block" data-lang="html">&lt;!-- templates/partials/search_results.html --&gt;
{% if products %}
  {% for product in products %}
  &lt;div class="ux-searchbar__result"
       hx-get="{% url 'product_detail' product.pk %}"
       hx-target="#main-content"
       hx-push-url="true"&gt;
    &lt;span class="ux-searchbar__result-icon"&gt;
      {% if product.image %}
        &lt;img src="{{ product.image.url }}" alt="" class="ux-avatar ux-avatar--sm"&gt;
      {% else %}
        &lt;svg fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;
          &lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/&gt;
        &lt;/svg&gt;
      {% endif %}
    &lt;/span&gt;
    &lt;div class="ux-searchbar__result-content"&gt;
      &lt;div class="ux-searchbar__result-title"&gt;{{ product.name|highlight:query }}&lt;/div&gt;
      &lt;div class="ux-searchbar__result-subtitle"&gt;
        {{ product.category.name }} &amp;middot; ${{ product.price }}
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
  {% endfor %}
{% else %}
  &lt;div class="ux-searchbar__no-results"&gt;
    No se encontraron resultados para "{{ query }}"
  &lt;/div&gt;
{% endif %}</pre>
    </div>

    <div class="demo-box">
      <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-sm);">Template de busquedas recientes</p>
      <pre class="ux-code-block" data-lang="html">&lt;!-- templates/partials/search_recent.html --&gt;
{% if recent_searches %}
&lt;div class="ux-searchbar__recent"&gt;
  &lt;div class="ux-searchbar__recent-header"&gt;
    &lt;span class="ux-searchbar__recent-title"&gt;Busquedas recientes&lt;/span&gt;
    &lt;button class="ux-searchbar__recent-clear"
            hx-delete="{% url 'clear_recent_searches' %}"
            hx-target="#search-results"
            hx-swap="innerHTML"&gt;
      Limpiar
    &lt;/button&gt;
  &lt;/div&gt;
  {% for term in recent_searches %}
  &lt;div class="ux-searchbar__recent-item"
       hx-get="{% url 'product_search' %}?q={{ term|urlencode }}"
       hx-target="#search-results"&gt;
    &lt;span class="ux-searchbar__recent-item-icon"&gt;
      &lt;svg fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;
        &lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/&gt;
      &lt;/svg&gt;
    &lt;/span&gt;
    &lt;span class="ux-searchbar__recent-item-text"&gt;{{ term }}&lt;/span&gt;
  &lt;/div&gt;
  {% endfor %}
&lt;/div&gt;
{% endif %}</pre>
    </div>

    <div class="demo-box">
      <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-sm);">Template filter para resaltado</p>
      <pre class="ux-code-block" data-lang="python"># templatetags/search_tags.py
from django import template
from django.utils.safestring import mark_safe
import re

register = template.Library()

@register.filter
def highlight(text, query):
    """Resalta las coincidencias de busqueda en el texto"""
    if not query:
        return text
    pattern = re.compile(f'({re.escape(query)})', re.IGNORECASE)
    highlighted = pattern.sub(
        r'&lt;span class="ux-searchbar__highlight"&gt;\1&lt;/span&gt;',
        str(text)
    )
    return mark_safe(highlighted)</pre>
    </div>

    <div class="demo-box">
      <p style="font-size: var(--ux-font-size-md); color: var(--ux-text-tertiary); margin-bottom: var(--ux-space-sm);">URLs</p>
      <pre class="ux-code-block" data-lang="python"># urls.py
from django.urls import path
from . import views

urlpatterns = [
    path('search/', views.product_search, name='product_search'),
    path('search/clear/', views.clear_recent_searches, name='clear_recent_searches'),
    path('product/&lt;int:pk&gt;/', views.product_detail, name='product_detail'),
]</pre>
    </div>
  </div>