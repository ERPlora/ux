<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Calendar - UX Library</title>
  <link rel="stylesheet" href="../bootstrap-grid.min.css">
  <script src="../dist/ux.min.js"></script>
  <script src="../components/ux-code-block.js"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
      background: var(--ux-surface-secondary);
      padding: 2rem;
      padding-bottom: 4rem;
    }
    .demo-section {
      margin-bottom: 3rem;
    }
    .demo-section h2 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--ux-text);
    }
    .demo-box {
      background: var(--ux-surface);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1rem;
    }
    .demo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: 1.5rem;
    }
    .result-display {
      margin-top: 1rem;
      padding: 0.75rem;
      background: var(--ux-surface-secondary);
      border-radius: 8px;
      font-size: 0.875rem;
    }
    .demo-glass-bg {
      background: linear-gradient(135deg, var(--ux-blue-400), var(--ux-cyan-500));
      padding: 2rem;
      border-radius: 16px;
      display: flex;
      justify-content: center;
    }
  </style>
</head>
<body class="ux-app">

  <h1 style="margin-bottom: 0.5rem;">Calendar</h1>
  <p style="color: var(--ux-text-secondary); margin-bottom: 2rem;">
    Calendario mensual con selección de fecha, rango de fechas e indicadores de eventos.
  </p>

  <!-- Basic Calendar -->
  <section class="demo-section">
    <h2>Calendario Básico</h2>

    <div class="demo-grid">
      <div>
        <div x-data="uxCalendar()" @calendar:select="selectedDisplay = $event.detail.formatted">
          <div class="ux-calendar">
            <!-- Header -->
            <div class="ux-calendar__header">
              <button class="ux-calendar__nav-btn" @click="prevMonth()" x-html="icons.prev"></button>
              <span class="ux-calendar__title" x-text="currentMonthYear"></span>
              <button class="ux-calendar__nav-btn" @click="nextMonth()" x-html="icons.next"></button>
            </div>

            <!-- Weekdays -->
            <div class="ux-calendar__weekdays">
              <template x-for="day in weekdays" :key="day">
                <div class="ux-calendar__weekday" x-text="day"></div>
              </template>
            </div>

            <!-- Days -->
            <div class="ux-calendar__days">
              <template x-for="dayObj in calendarDays" :key="dayObj.date.toISOString()">
                <button class="ux-calendar__day"
                        :class="{
                          'ux-calendar__day--other-month': dayObj.isOtherMonth && showOtherMonths,
                          'ux-calendar__day--today': dayObj.isToday,
                          'ux-calendar__day--selected': dayObj.isSelected,
                          'ux-calendar__day--disabled': dayObj.isDisabled
                        }"
                        :style="dayObj.isOtherMonth && !showOtherMonths ? 'visibility: hidden' : ''"
                        @click="selectDate(dayObj)"
                        x-text="dayObj.day">
                </button>
              </template>
            </div>

            <!-- Footer -->
            <div class="ux-calendar__footer" x-show="showFooter">
              <button class="ux-calendar__today-btn" @click="goToToday()">Hoy</button>
              <button class="ux-calendar__clear-btn" @click="clearSelection()" x-show="selectedDate">Limpiar</button>
            </div>
          </div>

          <div class="result-display" x-data="{ selectedDisplay: null }" x-show="selectedDate">
            Fecha seleccionada: <strong x-text="formatDate(selectedDate)"></strong>
          </div>
        </div>
      </div>

      <div>
        <pre class="ux-code-block" data-lang="html">&lt;div x-data="uxCalendar()"&gt;
  &lt;div class="ux-calendar"&gt;
    &lt;!-- Header --&gt;
    &lt;div class="ux-calendar__header"&gt;
      &lt;button @click="prevMonth()"&gt;←&lt;/button&gt;
      &lt;span x-text="currentMonthYear"&gt;&lt;/span&gt;
      &lt;button @click="nextMonth()"&gt;→&lt;/button&gt;
    &lt;/div&gt;

    &lt;!-- Weekdays --&gt;
    &lt;div class="ux-calendar__weekdays"&gt;...&lt;/div&gt;

    &lt;!-- Days --&gt;
    &lt;div class="ux-calendar__days"&gt;
      &lt;template x-for="dayObj in calendarDays"&gt;
        &lt;button class="ux-calendar__day"
                @click="selectDate(dayObj)"&gt;
        &lt;/button&gt;
      &lt;/template&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
      </div>
    </div>
  </section>

  <!-- Range Selection -->
  <section class="demo-section">
    <h2>Selección de Rango</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Selecciona una fecha de inicio y una de fin.
    </p>

    <div class="demo-grid">
      <div x-data="{
        ...uxCalendar({ range: true }),
        rangeDisplay: ''
      }" @calendar:range-select="rangeDisplay = $event.detail.startFormatted + ' → ' + $event.detail.endFormatted">
        <div class="ux-calendar">
          <div class="ux-calendar__header">
            <button class="ux-calendar__nav-btn" @click="prevMonth()" x-html="icons.prev"></button>
            <span class="ux-calendar__title" x-text="currentMonthYear"></span>
            <button class="ux-calendar__nav-btn" @click="nextMonth()" x-html="icons.next"></button>
          </div>

          <div class="ux-calendar__weekdays">
            <template x-for="day in weekdays" :key="day">
              <div class="ux-calendar__weekday" x-text="day"></div>
            </template>
          </div>

          <div class="ux-calendar__days">
            <template x-for="dayObj in calendarDays" :key="dayObj.date.toISOString()">
              <button class="ux-calendar__day"
                      :class="{
                        'ux-calendar__day--other-month': dayObj.isOtherMonth,
                        'ux-calendar__day--today': dayObj.isToday,
                        'ux-calendar__day--range-start': dayObj.isRangeStart,
                        'ux-calendar__day--range-end': dayObj.isRangeEnd,
                        'ux-calendar__day--in-range': dayObj.isInRange,
                        'ux-calendar__day--range-hover': dayObj.isRangeHover,
                        'ux-calendar__day--disabled': dayObj.isDisabled
                      }"
                      @click="selectDate(dayObj)"
                      @mouseenter="onDayHover(dayObj)"
                      @mouseleave="onDayLeave()"
                      x-text="dayObj.day">
              </button>
            </template>
          </div>

          <div class="ux-calendar__footer">
            <button class="ux-calendar__today-btn" @click="goToToday()">Hoy</button>
            <button class="ux-calendar__clear-btn" @click="clearSelection()" x-show="rangeStart">Limpiar</button>
          </div>
        </div>

        <div class="result-display" x-show="rangeStart && rangeEnd">
          Rango: <strong x-text="rangeDisplay"></strong>
        </div>
      </div>
    </div>
  </section>

  <!-- With Events -->
  <section class="demo-section">
    <h2>Con Eventos</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Muestra indicadores de eventos en días específicos.
    </p>

    <div class="demo-grid">
      <div x-data="uxCalendar({
        events: [
          { date: new Date().toISOString().split('T')[0], color: 'primary', title: 'Hoy' },
          { date: new Date(Date.now() + 86400000 * 2).toISOString().split('T')[0], color: 'success', title: 'Reunión' },
          { date: new Date(Date.now() + 86400000 * 5).toISOString().split('T')[0], color: 'warning', title: 'Deadline' },
          { date: new Date(Date.now() + 86400000 * 5).toISOString().split('T')[0], color: 'danger', title: 'Urgente' },
          { date: new Date(Date.now() + 86400000 * 10).toISOString().split('T')[0], color: 'primary', title: 'Evento' }
        ]
      })">
        <div class="ux-calendar">
          <div class="ux-calendar__header">
            <button class="ux-calendar__nav-btn" @click="prevMonth()" x-html="icons.prev"></button>
            <span class="ux-calendar__title" x-text="currentMonthYear"></span>
            <button class="ux-calendar__nav-btn" @click="nextMonth()" x-html="icons.next"></button>
          </div>

          <div class="ux-calendar__weekdays">
            <template x-for="day in weekdays" :key="day">
              <div class="ux-calendar__weekday" x-text="day"></div>
            </template>
          </div>

          <div class="ux-calendar__days">
            <template x-for="dayObj in calendarDays" :key="dayObj.date.toISOString()">
              <button class="ux-calendar__day"
                      :class="{
                        'ux-calendar__day--other-month': dayObj.isOtherMonth,
                        'ux-calendar__day--today': dayObj.isToday,
                        'ux-calendar__day--selected': dayObj.isSelected
                      }"
                      @click="selectDate(dayObj)">
                <span x-text="dayObj.day"></span>
                <div class="ux-calendar__day-events" x-show="dayObj.events.length > 0">
                  <template x-for="event in dayObj.events.slice(0, 3)" :key="event.title">
                    <span class="ux-calendar__day-event"
                          :class="'ux-calendar__day-event--' + (event.color || 'primary')"></span>
                  </template>
                </div>
              </button>
            </template>
          </div>

          <div class="ux-calendar__footer">
            <button class="ux-calendar__today-btn" @click="goToToday()">Hoy</button>
          </div>
        </div>
      </div>

      <div>
        <h3 style="font-size: 1rem; margin-bottom: 0.5rem;">Leyenda</h3>
        <div style="display: flex; flex-direction: column; gap: 0.5rem; font-size: 0.875rem;">
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <span style="width: 8px; height: 8px; border-radius: 50%; background: var(--ux-primary);"></span>
            Evento normal
          </div>
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <span style="width: 8px; height: 8px; border-radius: 50%; background: var(--ux-success);"></span>
            Completado
          </div>
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <span style="width: 8px; height: 8px; border-radius: 50%; background: var(--ux-warning);"></span>
            Pendiente
          </div>
          <div style="display: flex; align-items: center; gap: 0.5rem;">
            <span style="width: 8px; height: 8px; border-radius: 50%; background: var(--ux-danger);"></span>
            Urgente
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Min/Max Dates -->
  <section class="demo-section">
    <h2>Fechas Mínima y Máxima</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Restringe la selección a un rango de fechas.
    </p>

    <div class="demo-grid">
      <div x-data="uxCalendar({
        minDate: new Date(),
        maxDate: new Date(Date.now() + 86400000 * 30)
      })">
        <div class="ux-calendar">
          <div class="ux-calendar__header">
            <button class="ux-calendar__nav-btn" @click="prevMonth()" x-html="icons.prev"></button>
            <span class="ux-calendar__title" x-text="currentMonthYear"></span>
            <button class="ux-calendar__nav-btn" @click="nextMonth()" x-html="icons.next"></button>
          </div>

          <div class="ux-calendar__weekdays">
            <template x-for="day in weekdays" :key="day">
              <div class="ux-calendar__weekday" x-text="day"></div>
            </template>
          </div>

          <div class="ux-calendar__days">
            <template x-for="dayObj in calendarDays" :key="dayObj.date.toISOString()">
              <button class="ux-calendar__day"
                      :class="{
                        'ux-calendar__day--other-month': dayObj.isOtherMonth,
                        'ux-calendar__day--today': dayObj.isToday,
                        'ux-calendar__day--selected': dayObj.isSelected,
                        'ux-calendar__day--disabled': dayObj.isDisabled
                      }"
                      :disabled="dayObj.isDisabled"
                      @click="selectDate(dayObj)"
                      x-text="dayObj.day">
              </button>
            </template>
          </div>
        </div>
        <p style="margin-top: 0.5rem; font-size: 0.8125rem; color: var(--ux-text-tertiary);">
          Solo se pueden seleccionar los próximos 30 días.
        </p>
      </div>
    </div>
  </section>

  <!-- Disabled Days -->
  <section class="demo-section">
    <h2>Días Deshabilitados</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Deshabilita días específicos de la semana (ej: fines de semana).
    </p>

    <div class="demo-grid">
      <div x-data="uxCalendar({
        disabledDays: [0, 6],
        highlightWeekends: true
      })">
        <div class="ux-calendar">
          <div class="ux-calendar__header">
            <button class="ux-calendar__nav-btn" @click="prevMonth()" x-html="icons.prev"></button>
            <span class="ux-calendar__title" x-text="currentMonthYear"></span>
            <button class="ux-calendar__nav-btn" @click="nextMonth()" x-html="icons.next"></button>
          </div>

          <div class="ux-calendar__weekdays">
            <template x-for="day in weekdays" :key="day">
              <div class="ux-calendar__weekday" x-text="day"></div>
            </template>
          </div>

          <div class="ux-calendar__days">
            <template x-for="dayObj in calendarDays" :key="dayObj.date.toISOString()">
              <button class="ux-calendar__day"
                      :class="{
                        'ux-calendar__day--other-month': dayObj.isOtherMonth,
                        'ux-calendar__day--today': dayObj.isToday,
                        'ux-calendar__day--selected': dayObj.isSelected,
                        'ux-calendar__day--disabled': dayObj.isDisabled,
                        'ux-calendar__day--weekend': dayObj.isWeekend && highlightWeekends
                      }"
                      :disabled="dayObj.isDisabled"
                      @click="selectDate(dayObj)"
                      x-text="dayObj.day">
              </button>
            </template>
          </div>
        </div>
        <p style="margin-top: 0.5rem; font-size: 0.8125rem; color: var(--ux-text-tertiary);">
          Sábados y domingos deshabilitados.
        </p>
      </div>
    </div>
  </section>

  <!-- Glass Variant -->
  <section class="demo-section">
    <h2>Glass Variant</h2>

    <div class="demo-glass-bg">
      <div x-data="uxCalendar({ showFooter: false })">
        <div class="ux-calendar ux-calendar--glass">
          <div class="ux-calendar__header">
            <button class="ux-calendar__nav-btn" @click="prevMonth()" x-html="icons.prev"></button>
            <span class="ux-calendar__title" x-text="currentMonthYear" style="color: var(--ux-primary-contrast);"></span>
            <button class="ux-calendar__nav-btn" @click="nextMonth()" x-html="icons.next"></button>
          </div>

          <div class="ux-calendar__weekdays">
            <template x-for="day in weekdays" :key="day">
              <div class="ux-calendar__weekday" x-text="day" style="color: rgba(var(--ux-surface-rgb), 0.6);"></div>
            </template>
          </div>

          <div class="ux-calendar__days">
            <template x-for="dayObj in calendarDays" :key="dayObj.date.toISOString()">
              <button class="ux-calendar__day"
                      :class="{
                        'ux-calendar__day--other-month': dayObj.isOtherMonth,
                        'ux-calendar__day--today': dayObj.isToday,
                        'ux-calendar__day--selected': dayObj.isSelected
                      }"
                      :style="dayObj.isOtherMonth ? 'color: rgba(var(--ux-surface-rgb), 0.3)' : 'color: var(--ux-primary-contrast)'"
                      @click="selectDate(dayObj)"
                      x-text="dayObj.day">
              </button>
            </template>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Sizes -->
  <section class="demo-section">
    <h2>Tamaños</h2>

    <div style="display: flex; flex-wrap: wrap; gap: 1.5rem; align-items: flex-start;">
      <div x-data="uxCalendar({ showFooter: false })">
        <p style="font-size: 0.875rem; margin-bottom: 0.5rem; color: var(--ux-text-secondary);">Small</p>
        <div class="ux-calendar ux-calendar--sm">
          <div class="ux-calendar__header">
            <button class="ux-calendar__nav-btn" @click="prevMonth()" x-html="icons.prev"></button>
            <span class="ux-calendar__title" x-text="currentMonthYear"></span>
            <button class="ux-calendar__nav-btn" @click="nextMonth()" x-html="icons.next"></button>
          </div>
          <div class="ux-calendar__weekdays">
            <template x-for="day in weekdays" :key="day">
              <div class="ux-calendar__weekday" x-text="day"></div>
            </template>
          </div>
          <div class="ux-calendar__days">
            <template x-for="dayObj in calendarDays" :key="dayObj.date.toISOString()">
              <button class="ux-calendar__day"
                      :class="{ 'ux-calendar__day--other-month': dayObj.isOtherMonth, 'ux-calendar__day--today': dayObj.isToday, 'ux-calendar__day--selected': dayObj.isSelected }"
                      @click="selectDate(dayObj)" x-text="dayObj.day"></button>
            </template>
          </div>
        </div>
      </div>

      <div x-data="uxCalendar({ showFooter: false })">
        <p style="font-size: 0.875rem; margin-bottom: 0.5rem; color: var(--ux-text-secondary);">Large</p>
        <div class="ux-calendar ux-calendar--lg">
          <div class="ux-calendar__header">
            <button class="ux-calendar__nav-btn" @click="prevMonth()" x-html="icons.prev"></button>
            <span class="ux-calendar__title" x-text="currentMonthYear"></span>
            <button class="ux-calendar__nav-btn" @click="nextMonth()" x-html="icons.next"></button>
          </div>
          <div class="ux-calendar__weekdays">
            <template x-for="day in weekdays" :key="day">
              <div class="ux-calendar__weekday" x-text="day"></div>
            </template>
          </div>
          <div class="ux-calendar__days">
            <template x-for="dayObj in calendarDays" :key="dayObj.date.toISOString()">
              <button class="ux-calendar__day"
                      :class="{ 'ux-calendar__day--other-month': dayObj.isOtherMonth, 'ux-calendar__day--today': dayObj.isToday, 'ux-calendar__day--selected': dayObj.isSelected }"
                      @click="selectDate(dayObj)" x-text="dayObj.day"></button>
            </template>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- API Reference -->
  <section class="demo-section">
    <h2>API Reference</h2>

    <h3>Opciones</h3>
    <pre class="ux-code-block" data-lang="javascript">uxCalendar({
  locale: 'es',              // Idioma
  firstDayOfWeek: 1,         // 0=Domingo, 1=Lunes
  minDate: null,             // Fecha mínima seleccionable
  maxDate: null,             // Fecha máxima seleccionable
  disabledDates: [],         // Fechas específicas deshabilitadas
  disabledDays: [],          // Días de semana deshabilitados [0-6]
  events: [],                // Eventos { date, color, title }
  range: false,              // Modo selección de rango
  showFooter: true,          // Mostrar footer
  showOtherMonths: true,     // Mostrar días de otros meses
  highlightWeekends: false,  // Resaltar fines de semana
  value: null                // Fecha inicial seleccionada
})</pre>

    <h3>Propiedades</h3>
    <pre class="ux-code-block" data-lang="javascript">currentDate      // Fecha actual del calendario
selectedDate     // Fecha seleccionada (modo normal)
rangeStart       // Fecha inicio (modo rango)
rangeEnd         // Fecha fin (modo rango)
calendarDays     // Array de días del mes actual
currentMonthYear // String "Mes Año"
weekdays         // Array de nombres de días</pre>

    <h3>Métodos</h3>
    <pre class="ux-code-block" data-lang="javascript">prevMonth()          // Ir al mes anterior
nextMonth()          // Ir al mes siguiente
goToToday()          // Ir a hoy
goToDate(date)       // Ir a fecha específica
selectDate(dayObj)   // Seleccionar un día
clearSelection()     // Limpiar selección
formatDate(date)     // Formatear fecha (YYYY-MM-DD)</pre>

    <h3>Eventos</h3>
    <pre class="ux-code-block" data-lang="javascript">@calendar:select       // Fecha seleccionada (modo normal)
@calendar:range-start  // Inicio de rango seleccionado
@calendar:range-select // Rango completo seleccionado
@calendar:navigate     // Navegación mes anterior/siguiente
@calendar:today        // Click en "Hoy"
@calendar:clear        // Selección limpiada</pre>

    <h3>Clases CSS</h3>
    <pre class="ux-code-block" data-lang="css">.ux-calendar              // Contenedor
.ux-calendar--sm          // Pequeño
.ux-calendar--lg          // Grande
.ux-calendar--full        // Ancho 100%
.ux-calendar--glass       // Glass morphism
.ux-calendar--inline      // Sin borde/sombra</pre>
  </section>

  <!-- HTMX + Django -->
  <section class="demo-section">
    <h2>HTMX + Django</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Integración con Django para cargar eventos dinámicamente desde el servidor.
    </p>

    <h3>Template Django con Eventos</h3>
    <pre class="ux-code-block" data-lang="html">&lt;!-- templates/calendar.html --&gt;
&lt;div id="calendar-container"
     x-data="uxCalendar({
       events: {{ events_json|safe }}
     })"
     @calendar:select="loadDayEvents($event.detail.date)"
     @calendar:navigate="$refs.container.dispatchEvent(
       new CustomEvent('load-month', { detail: { month: currentDate.getMonth() + 1, year: currentDate.getFullYear() } })
     )"&gt;

  &lt;div class="ux-calendar"
       hx-get="{% url 'calendar_events' %}"
       hx-trigger="load-month from:body"
       hx-vals="js:{month: event.detail.month, year: event.detail.year}"
       hx-target="#events-data"
       hx-swap="innerHTML"&gt;

    &lt;div class="ux-calendar__header"&gt;
      &lt;button class="ux-calendar__nav-btn" @click="prevMonth()" x-html="icons.prev"&gt;&lt;/button&gt;
      &lt;span class="ux-calendar__title" x-text="currentMonthYear"&gt;&lt;/span&gt;
      &lt;button class="ux-calendar__nav-btn" @click="nextMonth()" x-html="icons.next"&gt;&lt;/button&gt;
    &lt;/div&gt;

    &lt;div class="ux-calendar__weekdays"&gt;
      &lt;template x-for="day in weekdays" :key="day"&gt;
        &lt;div class="ux-calendar__weekday" x-text="day"&gt;&lt;/div&gt;
      &lt;/template&gt;
    &lt;/div&gt;

    &lt;div class="ux-calendar__days"&gt;
      &lt;template x-for="dayObj in calendarDays" :key="dayObj.date.toISOString()"&gt;
        &lt;button class="ux-calendar__day"
                :class="{
                  'ux-calendar__day--today': dayObj.isToday,
                  'ux-calendar__day--selected': dayObj.isSelected
                }"
                @click="selectDate(dayObj)"&gt;
          &lt;span x-text="dayObj.day"&gt;&lt;/span&gt;
          &lt;div class="ux-calendar__day-events" x-show="dayObj.events.length &gt; 0"&gt;
            &lt;template x-for="event in dayObj.events.slice(0, 3)"&gt;
              &lt;span class="ux-calendar__day-event"
                    :class="'ux-calendar__day-event--' + event.color"&gt;&lt;/span&gt;
            &lt;/template&gt;
          &lt;/div&gt;
        &lt;/button&gt;
      &lt;/template&gt;
    &lt;/div&gt;
  &lt;/div&gt;

  &lt;!-- Panel de eventos del dia seleccionado --&gt;
  &lt;div id="day-events-panel"
       hx-get="{% url 'day_events' %}"
       hx-trigger="day-selected from:body"
       hx-vals="js:{date: event.detail.date}"
       hx-target="this"
       hx-swap="innerHTML"&gt;
    &lt;p class="ux-text-secondary"&gt;Selecciona un dia para ver sus eventos&lt;/p&gt;
  &lt;/div&gt;

  &lt;!-- Container oculto para actualizar eventos via HTMX --&gt;
  &lt;div id="events-data" style="display: none;"&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;script&gt;
function loadDayEvents(date) {
  document.body.dispatchEvent(
    new CustomEvent('day-selected', { detail: { date: date } })
  );
}
&lt;/script&gt;</pre>

    <h3>Vista Django</h3>
    <pre class="ux-code-block" data-lang="python"># views.py
from django.http import JsonResponse
from django.shortcuts import render
from django.views.decorators.http import require_GET
from .models import Event
import json

def calendar_view(request):
    """Vista principal del calendario"""
    events = Event.objects.filter(
        date__month=timezone.now().month,
        date__year=timezone.now().year
    )

    events_json = json.dumps([
        {
            'date': e.date.isoformat(),
            'color': e.color,
            'title': e.title
        }
        for e in events
    ])

    return render(request, 'calendar.html', {
        'events_json': events_json
    })


@require_GET
def calendar_events(request):
    """Retorna eventos para un mes especifico (HTMX)"""
    month = int(request.GET.get('month', timezone.now().month))
    year = int(request.GET.get('year', timezone.now().year))

    events = Event.objects.filter(date__month=month, date__year=year)

    # Retorna script que actualiza Alpine.js
    events_data = [
        {'date': e.date.isoformat(), 'color': e.color, 'title': e.title}
        for e in events
    ]

    return HttpResponse(f'''
        &lt;script&gt;
            document.querySelector('[x-data]').__x.$data.events = {json.dumps(events_data)};
        &lt;/script&gt;
    ''')


@require_GET
def day_events(request):
    """Retorna eventos de un dia especifico (HTMX)"""
    date_str = request.GET.get('date')
    date = datetime.strptime(date_str, '%Y-%m-%d').date()

    events = Event.objects.filter(date=date).order_by('time')

    if not events:
        return HttpResponse('&lt;p class="ux-text-tertiary"&gt;No hay eventos para este dia&lt;/p&gt;')

    html = '&lt;ul class="ux-list ux-list--inset"&gt;'
    for event in events:
        html += f'''
            &lt;li class="ux-list__item"&gt;
                &lt;span class="ux-calendar__day-event ux-calendar__day-event--{event.color}"
                      style="width: 10px; height: 10px; margin-right: 8px;"&gt;&lt;/span&gt;
                &lt;div class="ux-list__content"&gt;
                    &lt;div class="ux-list__title"&gt;{event.title}&lt;/div&gt;
                    &lt;div class="ux-list__note"&gt;{event.time.strftime('%H:%M') if event.time else 'Todo el dia'}&lt;/div&gt;
                &lt;/div&gt;
            &lt;/li&gt;
        '''
    html += '&lt;/ul&gt;'

    return HttpResponse(html)</pre>

    <h3>Modelo Django</h3>
    <pre class="ux-code-block" data-lang="python"># models.py
from django.db import models

class Event(models.Model):
    COLOR_CHOICES = [
        ('primary', 'Primary'),
        ('success', 'Success'),
        ('warning', 'Warning'),
        ('danger', 'Danger'),
    ]

    title = models.CharField(max_length=200)
    date = models.DateField()
    time = models.TimeField(null=True, blank=True)
    color = models.CharField(max_length=20, choices=COLOR_CHOICES, default='primary')
    description = models.TextField(blank=True)
    user = models.ForeignKey('auth.User', on_delete=models.CASCADE)

    class Meta:
        ordering = ['date', 'time']

    def __str__(self):
        return f"{self.title} - {self.date}"</pre>

    <h3>URLs Django</h3>
    <pre class="ux-code-block" data-lang="python"># urls.py
from django.urls import path
from . import views

urlpatterns = [
    path('calendar/', views.calendar_view, name='calendar'),
    path('calendar/events/', views.calendar_events, name='calendar_events'),
    path('calendar/day/', views.day_events, name='day_events'),
]</pre>

    <h3>Crear Evento con Modal</h3>
    <pre class="ux-code-block" data-lang="html">&lt;!-- Modal para crear evento --&gt;
&lt;div x-data="uxModal()" @calendar:select.window="selectedDate = $event.detail.date; open()"&gt;
  &lt;template x-teleport="body"&gt;
    &lt;div class="ux-modal-backdrop" x-show="isOpen" @click="close()"&gt;&lt;/div&gt;
    &lt;div class="ux-modal" x-show="isOpen"&gt;
      &lt;div class="ux-modal__header"&gt;
        &lt;h2&gt;Nuevo Evento&lt;/h2&gt;
        &lt;button class="ux-modal__close" @click="close()"&gt;&times;&lt;/button&gt;
      &lt;/div&gt;

      &lt;form hx-post="{% url 'create_event' %}"
            hx-target="#calendar-container"
            hx-swap="outerHTML"
            @htmx:after-request="close()"&gt;

        {% csrf_token %}
        &lt;input type="hidden" name="date" :value="selectedDate"&gt;

        &lt;div class="ux-modal__content"&gt;
          &lt;div class="ux-input"&gt;
            &lt;input type="text" name="title" required&gt;
            &lt;label&gt;Titulo del evento&lt;/label&gt;
          &lt;/div&gt;

          &lt;div class="ux-input"&gt;
            &lt;input type="time" name="time"&gt;
            &lt;label&gt;Hora (opcional)&lt;/label&gt;
          &lt;/div&gt;

          &lt;div class="ux-input"&gt;
            &lt;select name="color"&gt;
              &lt;option value="primary"&gt;Normal&lt;/option&gt;
              &lt;option value="success"&gt;Completado&lt;/option&gt;
              &lt;option value="warning"&gt;Pendiente&lt;/option&gt;
              &lt;option value="danger"&gt;Urgente&lt;/option&gt;
            &lt;/select&gt;
            &lt;label&gt;Tipo&lt;/label&gt;
          &lt;/div&gt;

          &lt;div class="ux-input"&gt;
            &lt;textarea name="description" rows="3"&gt;&lt;/textarea&gt;
            &lt;label&gt;Descripcion&lt;/label&gt;
          &lt;/div&gt;
        &lt;/div&gt;

        &lt;div class="ux-modal__footer"&gt;
          &lt;button type="button" class="ux-button" @click="close()"&gt;Cancelar&lt;/button&gt;
          &lt;button type="submit" class="ux-button ux-color-primary"&gt;Guardar&lt;/button&gt;
        &lt;/div&gt;
      &lt;/form&gt;
    &lt;/div&gt;
  &lt;/template&gt;
&lt;/div&gt;</pre>

    <h3>Vista para Crear Evento</h3>
    <pre class="ux-code-block" data-lang="python"># views.py
from django.views.decorators.http import require_POST

@require_POST
def create_event(request):
    """Crea un evento y retorna el calendario actualizado"""
    Event.objects.create(
        title=request.POST['title'],
        date=request.POST['date'],
        time=request.POST.get('time') or None,
        color=request.POST.get('color', 'primary'),
        description=request.POST.get('description', ''),
        user=request.user
    )

    # Retorna el calendario completo actualizado
    return calendar_view(request)</pre>
  </section>

</body>
</html>
