<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Virtual Keyboard - UX Library</title>
  <link rel="stylesheet" href="../bootstrap-grid.min.css">
  <script src="../dist/ux.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', Roboto, sans-serif;
      background: var(--ux-surface-secondary);
      padding: 2rem;
      padding-bottom: 4rem;
    }
    .demo-section {
      margin-bottom: 3rem;
    }
    .demo-section h2 {
      font-size: 1.25rem;
      font-weight: 600;
      margin-bottom: 1rem;
      color: var(--ux-text);
    }
    .demo-section h3 {
      font-size: 1rem;
      font-weight: 500;
      margin-bottom: 0.75rem;
      color: var(--ux-text-secondary);
    }
    .demo-box {
      background: var(--ux-surface);
      border-radius: 16px;
      padding: 1.5rem;
      margin-bottom: 1rem;
    }
    .demo-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
    }
    code {
      background: var(--ux-surface-tertiary);
      padding: 0.125rem 0.375rem;
      border-radius: 4px;
      font-size: 0.875rem;
    }
    pre {
      background: var(--ux-gray-900);
      color: var(--ux-gray-100);
      padding: 1rem;
      border-radius: 8px;
      overflow-x: auto;
      font-size: 0.8125rem;
      line-height: 1.5;
    }
    .warning-box {
      background: var(--ux-warning-tint);
      border: 1px solid var(--ux-warning);
      border-radius: 12px;
      padding: 1rem 1.25rem;
      margin-bottom: 1.5rem;
    }
    .warning-box h4 {
      color: var(--ux-warning-shade);
      margin: 0 0 0.5rem;
      font-size: 0.9375rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .warning-box p, .warning-box ul {
      color: var(--ux-text);
      margin: 0;
      font-size: 0.875rem;
      line-height: 1.6;
    }
    .warning-box ul {
      margin-top: 0.5rem;
      padding-left: 1.25rem;
    }
    .warning-box li {
      margin-bottom: 0.25rem;
    }
    .support-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.875rem;
    }
    .support-table th,
    .support-table td {
      padding: 0.75rem 1rem;
      text-align: left;
      border-bottom: 1px solid var(--ux-border-color);
    }
    .support-table th {
      background: var(--ux-surface-secondary);
      font-weight: 600;
    }
    .support-yes {
      color: var(--ux-success);
      font-weight: 600;
    }
    .support-no {
      color: var(--ux-danger);
      font-weight: 600;
    }
    .support-partial {
      color: var(--ux-warning);
      font-weight: 600;
    }
    .status-card {
      background: var(--ux-surface-secondary);
      border-radius: 12px;
      padding: 1rem;
      margin-bottom: 1rem;
    }
    .status-card__row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.5rem 0;
      border-bottom: 1px solid var(--ux-border-color);
    }
    .status-card__row:last-child {
      border-bottom: none;
    }
    .status-card__label {
      font-size: 0.875rem;
      color: var(--ux-text-secondary);
    }
    .status-card__value {
      font-size: 0.875rem;
      font-weight: 500;
    }
    .input-with-btn {
      display: flex;
      gap: 0;
    }
    .input-with-btn .ux-input {
      flex: 1;
      border-top-right-radius: 0;
      border-bottom-right-radius: 0;
    }
    .input-with-btn .ux-virtual-keyboard-btn {
      border-top-left-radius: 0;
      border-bottom-left-radius: 0;
      margin-left: -1px;
    }
  </style>
</head>
<body class="ux-app">

  <h1 style="margin-bottom: 0.5rem;">Virtual Keyboard</h1>
  <p style="color: var(--ux-text-secondary); margin-bottom: 2rem;">
    Botón para activar el teclado táctil del sistema operativo usando la VirtualKeyboard API.
  </p>

  <!-- Important Warning -->
  <div class="warning-box">
    <h4>
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 8v4M12 16h.01"/>
      </svg>
      Limitaciones Importantes
    </h4>
    <p>Este componente usa la <strong>VirtualKeyboard API</strong> que tiene soporte limitado:</p>
    <ul>
      <li><strong>Navegadores:</strong> Solo Chromium (Chrome 94+, Edge 94+, Opera 80+)</li>
      <li><strong>Dispositivos:</strong> Requiere pantalla táctil o modo tableta activo</li>
      <li><strong>Windows:</strong> El teclado táctil debe estar habilitado en Configuración</li>
      <li><strong>Seguridad:</strong> Requiere HTTPS en producción</li>
      <li><strong>Interacción:</strong> Solo funciona tras clic/toque del usuario</li>
      <li><strong>No soportado:</strong> Firefox, Safari, iOS (usan teclado nativo)</li>
    </ul>
  </div>

  <!-- Browser Support -->
  <section class="demo-section">
    <h2>Compatibilidad de Navegadores</h2>

    <div class="demo-box">
      <table class="support-table">
        <thead>
          <tr>
            <th>Navegador</th>
            <th>Soporte</th>
            <th>Versión Mínima</th>
            <th>Notas</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Chrome</td>
            <td class="support-yes">Sí</td>
            <td>94+</td>
            <td>Requiere dispositivo táctil</td>
          </tr>
          <tr>
            <td>Edge</td>
            <td class="support-yes">Sí</td>
            <td>94+</td>
            <td>Requiere dispositivo táctil</td>
          </tr>
          <tr>
            <td>Opera</td>
            <td class="support-yes">Sí</td>
            <td>80+</td>
            <td>Basado en Chromium</td>
          </tr>
          <tr>
            <td>Firefox</td>
            <td class="support-no">No</td>
            <td>-</td>
            <td>API no implementada</td>
          </tr>
          <tr>
            <td>Safari</td>
            <td class="support-no">No</td>
            <td>-</td>
            <td>API no implementada</td>
          </tr>
          <tr>
            <td>iOS Safari</td>
            <td class="support-no">No</td>
            <td>-</td>
            <td>Usa teclado nativo al hacer focus</td>
          </tr>
          <tr>
            <td>Android Chrome</td>
            <td class="support-partial">Parcial</td>
            <td>94+</td>
            <td>Comportamiento variable por dispositivo</td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- Live Status Check -->
  <section class="demo-section">
    <h2>Estado de tu Dispositivo</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Verificación en tiempo real del soporte en tu navegador actual.
    </p>

    <div class="demo-box" x-data="uxVirtualKeyboard()">
      <div class="status-card">
        <div class="status-card__row">
          <span class="status-card__label">VirtualKeyboard API</span>
          <span class="status-card__value" :class="getSupportInfo().apiAvailable ? 'support-yes' : 'support-no'"
                x-text="getSupportInfo().apiAvailable ? 'Disponible' : 'No disponible'"></span>
        </div>
        <div class="status-card__row">
          <span class="status-card__label">Contexto seguro (HTTPS)</span>
          <span class="status-card__value" :class="getSupportInfo().isSecureContext ? 'support-yes' : 'support-no'"
                x-text="getSupportInfo().isSecureContext ? 'Sí' : 'No'"></span>
        </div>
        <div class="status-card__row">
          <span class="status-card__label">Dispositivo táctil</span>
          <span class="status-card__value" :class="getSupportInfo().isTouchDevice ? 'support-yes' : 'support-partial'"
                x-text="getSupportInfo().isTouchDevice ? 'Detectado' : 'No detectado'"></span>
        </div>
        <div class="status-card__row">
          <span class="status-card__label">Navegador</span>
          <span class="status-card__value" x-text="getSupportInfo().browser"></span>
        </div>
        <div class="status-card__row">
          <span class="status-card__label">Recomendación</span>
          <span class="status-card__value" style="font-size: 0.8125rem; color: var(--ux-text-secondary);"
                x-text="getSupportInfo().recommendation"></span>
        </div>
      </div>

      <div class="ux-virtual-keyboard-status" :class="isSupported ? 'ux-virtual-keyboard-status--supported' : 'ux-virtual-keyboard-status--unsupported'">
        <span class="ux-virtual-keyboard-status__dot"></span>
        <span x-text="isSupported ? 'Teclado virtual disponible' : 'Teclado virtual no disponible'"></span>
      </div>
    </div>
  </section>

  <!-- Basic Usage -->
  <section class="demo-section">
    <h2>Uso Básico</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Botón que abre el teclado virtual del sistema al hacer clic.
    </p>

    <div class="demo-box" x-data="uxVirtualKeyboard()">
      <div style="display: flex; flex-direction: column; gap: 1rem; max-width: 400px;">
        <input type="text"
               id="demo-input-1"
               class="ux-input"
               placeholder="Escribe aquí...">

        <button class="ux-virtual-keyboard-btn"
                @click="show(document.getElementById('demo-input-1'))">
          <span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"></span>
          <span>Abrir Teclado</span>
        </button>
      </div>
    </div>

    <pre>&lt;div x-data="uxVirtualKeyboard()"&gt;
  &lt;input type="text" id="my-input" class="ux-input"&gt;

  &lt;button class="ux-virtual-keyboard-btn"
          @click="show(document.getElementById('my-input'))"&gt;
    &lt;span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"&gt;&lt;/span&gt;
    &lt;span&gt;Abrir Teclado&lt;/span&gt;
  &lt;/button&gt;
&lt;/div&gt;</pre>
  </section>

  <!-- Input Group -->
  <section class="demo-section">
    <h2>Integrado con Input</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Botón integrado al lado del campo de entrada.
    </p>

    <div class="demo-box" x-data="uxVirtualKeyboard()">
      <div class="input-with-btn" style="max-width: 400px;">
        <input type="text"
               x-ref="inputField"
               class="ux-input"
               placeholder="Toca el botón para abrir el teclado">
        <button class="ux-virtual-keyboard-btn ux-virtual-keyboard-btn--icon-only"
                @click="show($refs.inputField)"
                :title="isSupported ? 'Abrir teclado virtual' : 'Teclado no disponible'">
          <span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"></span>
        </button>
      </div>
    </div>

    <pre>&lt;div x-data="uxVirtualKeyboard()" class="input-with-btn"&gt;
  &lt;input type="text" x-ref="inputField" class="ux-input"&gt;
  &lt;button class="ux-virtual-keyboard-btn ux-virtual-keyboard-btn--icon-only"
          @click="show($refs.inputField)"&gt;
    &lt;span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"&gt;&lt;/span&gt;
  &lt;/button&gt;
&lt;/div&gt;</pre>
  </section>

  <!-- Size Variants -->
  <section class="demo-section">
    <h2>Tamaños</h2>

    <div class="demo-box" x-data="uxVirtualKeyboard()">
      <div style="display: flex; flex-wrap: wrap; gap: 1rem; align-items: center;">
        <button class="ux-virtual-keyboard-btn ux-virtual-keyboard-btn--sm" @click="show()">
          <span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"></span>
          <span>Small</span>
        </button>

        <button class="ux-virtual-keyboard-btn" @click="show()">
          <span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"></span>
          <span>Default</span>
        </button>

        <button class="ux-virtual-keyboard-btn ux-virtual-keyboard-btn--lg" @click="show()">
          <span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"></span>
          <span>Large</span>
        </button>
      </div>
    </div>
  </section>

  <!-- Icon Only -->
  <section class="demo-section">
    <h2>Solo Icono</h2>

    <div class="demo-box" x-data="uxVirtualKeyboard()">
      <div style="display: flex; flex-wrap: wrap; gap: 1rem; align-items: center;">
        <button class="ux-virtual-keyboard-btn ux-virtual-keyboard-btn--icon-only ux-virtual-keyboard-btn--sm" @click="show()">
          <span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"></span>
        </button>

        <button class="ux-virtual-keyboard-btn ux-virtual-keyboard-btn--icon-only" @click="show()">
          <span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"></span>
        </button>

        <button class="ux-virtual-keyboard-btn ux-virtual-keyboard-btn--icon-only ux-virtual-keyboard-btn--lg" @click="show()">
          <span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"></span>
        </button>

        <button class="ux-virtual-keyboard-btn ux-virtual-keyboard-btn--icon-only ux-virtual-keyboard-btn--primary" @click="show()">
          <span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"></span>
        </button>
      </div>
    </div>
  </section>

  <!-- With Custom Alert -->
  <section class="demo-section">
    <h2>Con Mensaje Personalizado</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Personaliza el mensaje que se muestra cuando el teclado no está disponible.
    </p>

    <div class="demo-box" x-data="uxVirtualKeyboard({
      alertTitle: 'Función No Disponible',
      alertMessage: 'Para usar el teclado en pantalla, necesitas Chrome o Edge en un dispositivo Windows con pantalla táctil.'
    })">
      <input type="text" x-ref="customInput" class="ux-input" placeholder="Input de prueba" style="max-width: 300px; margin-bottom: 1rem;">

      <button class="ux-virtual-keyboard-btn ux-virtual-keyboard-btn--primary"
              @click="show($refs.customInput)">
        <span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"></span>
        <span>Probar Teclado</span>
      </button>

      <p style="margin-top: 1rem; font-size: 0.8125rem; color: var(--ux-text-tertiary);">
        * Si el teclado no está disponible, se mostrará un mensaje de alerta personalizado.
      </p>
    </div>

    <pre>&lt;div x-data="uxVirtualKeyboard({
  alertTitle: 'Función No Disponible',
  alertMessage: 'Para usar el teclado...'
})"&gt;
  ...
&lt;/div&gt;</pre>
  </section>

  <!-- Events -->
  <section class="demo-section">
    <h2>Eventos</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      El componente emite eventos para integración con tu aplicación.
    </p>

    <div class="demo-box" x-data="{
      ...uxVirtualKeyboard({ showAlert: false }),
      events: []
    }"
    @virtualkeyboard:show="events.unshift('show: ' + new Date().toLocaleTimeString())"
    @virtualkeyboard:hide="events.unshift('hide: ' + new Date().toLocaleTimeString())"
    @virtualkeyboard:unsupported="events.unshift('unsupported: ' + $event.detail.browser)"
    @virtualkeyboard:change="events.unshift('change: visible=' + $event.detail.isVisible)">
      <div class="row g-3">
        <div class="col-md-6">
          <input type="text" x-ref="eventInput" class="ux-input" placeholder="Input de prueba" style="margin-bottom: 1rem;">

          <div style="display: flex; gap: 0.5rem;">
            <button class="ux-virtual-keyboard-btn" @click="show($refs.eventInput)">
              <span class="ux-virtual-keyboard-btn__icon" x-html="keyboardIcon"></span>
              Mostrar
            </button>
            <button class="ux-virtual-keyboard-btn" @click="hide()">
              Ocultar
            </button>
          </div>
        </div>
        <div class="col-md-6">
          <div style="background: var(--ux-gray-900); color: var(--ux-green-400); padding: 0.75rem; border-radius: 8px; font-family: monospace; font-size: 0.75rem; max-height: 150px; overflow-y: auto;">
            <template x-for="(event, i) in events.slice(0, 10)" :key="i">
              <div x-text="event"></div>
            </template>
            <div x-show="events.length === 0" style="color: var(--ux-gray-500);">
              Interactúa con los botones...
            </div>
          </div>
        </div>
      </div>
    </div>

    <h3>Eventos disponibles</h3>
    <pre>@virtualkeyboard:show        // Teclado mostrado
@virtualkeyboard:hide        // Teclado ocultado
@virtualkeyboard:change      // Cambio de geometría (altura)
@virtualkeyboard:unsupported // API no soportada
@virtualkeyboard:error       // Error al mostrar/ocultar
@virtualkeyboard:alert       // Para integrar con ux-alert externo</pre>
  </section>

  <!-- Without Alpine -->
  <section class="demo-section">
    <h2>Uso sin Alpine.js</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      También puedes usar la función global sin Alpine.js.
    </p>

    <div class="demo-box">
      <input type="text" id="vanilla-input" class="ux-input" placeholder="Input vanilla" style="max-width: 300px; margin-bottom: 1rem;">

      <button class="ux-virtual-keyboard-btn" onclick="openKeyboard()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <rect x="2" y="4" width="20" height="16" rx="2"/>
          <path d="M6 8h.01M10 8h.01M14 8h.01M18 8h.01M6 12h.01M10 12h.01M14 12h.01M18 12h.01M8 16h8"/>
        </svg>
        <span>Abrir Teclado (Vanilla)</span>
      </button>

      <script>
        function openKeyboard() {
          const input = document.getElementById('vanilla-input');

          if ('virtualKeyboard' in navigator) {
            input.focus();
            navigator.virtualKeyboard.show();
          } else {
            // Usar la función helper de UX
            if (!window.UX.showVirtualKeyboard('#vanilla-input')) {
              alert('El teclado virtual no está disponible en este navegador.');
            }
          }
        }
      </script>
    </div>

    <pre>&lt;script&gt;
function openKeyboard() {
  const input = document.getElementById('my-input');

  if ('virtualKeyboard' in navigator) {
    input.focus();
    navigator.virtualKeyboard.show();
  } else {
    alert('Teclado no disponible');
  }
}
&lt;/script&gt;

// O usar el helper de UX:
window.UX.showVirtualKeyboard('#my-input');</pre>
  </section>

  <!-- Windows Setup -->
  <section class="demo-section">
    <h2>Configuración en Windows</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Para que el teclado virtual funcione en Windows, asegúrate de:
    </p>

    <div class="demo-box">
      <ol style="margin: 0; padding-left: 1.5rem; line-height: 1.8;">
        <li>Abrir <strong>Configuración</strong> (Win + I)</li>
        <li>Ir a <strong>Hora e idioma</strong> → <strong>Escritura</strong></li>
        <li>En "Teclado en pantalla", activar <strong>"Mostrar el teclado en pantalla..."</strong></li>
        <li>Opcionalmente, activar el <strong>Modo tableta</strong> en dispositivos 2-en-1</li>
        <li>Usar <strong>Chrome</strong> o <strong>Edge</strong> como navegador</li>
      </ol>

      <div style="margin-top: 1rem; padding: 1rem; background: var(--ux-surface-secondary); border-radius: 8px;">
        <p style="margin: 0; font-size: 0.875rem; color: var(--ux-text-secondary);">
          <strong>Tip:</strong> En dispositivos sin pantalla táctil, puedes probar activando el
          "Modo tableta" en el Centro de actividades (Win + A) si tu versión de Windows lo soporta.
        </p>
      </div>
    </div>
  </section>

  <!-- API Reference -->
  <section class="demo-section">
    <h2>API Reference</h2>

    <h3>Opciones</h3>
    <pre>uxVirtualKeyboard({
  targetSelector: null,      // Selector CSS del input objetivo
  showAlert: true,           // Mostrar alerta si no está soportado
  alertTitle: '...',         // Título del mensaje de error
  alertMessage: '...'        // Mensaje de error personalizado
})</pre>

    <h3>Propiedades</h3>
    <pre>isSupported   // Boolean: si la API está disponible
isVisible     // Boolean: si el teclado está visible
keyboardIcon  // String: SVG del icono de teclado</pre>

    <h3>Métodos</h3>
    <pre>show(targetEl)      // Mostrar teclado (opcional: elemento objetivo)
hide()              // Ocultar teclado
toggle(targetEl)    // Alternar visibilidad
checkSupport()      // Verificar soporte
getSupportInfo()    // Obtener info detallada de soporte</pre>

    <h3>Clases CSS</h3>
    <pre>.ux-virtual-keyboard-btn              // Botón base
.ux-virtual-keyboard-btn--icon-only   // Solo icono
.ux-virtual-keyboard-btn--sm          // Pequeño
.ux-virtual-keyboard-btn--lg          // Grande
.ux-virtual-keyboard-btn--primary     // Color primario
.ux-virtual-keyboard-btn--glass       // Estilo glass
.ux-virtual-keyboard-btn__icon        // Contenedor del icono</pre>
  </section>

  <!-- Fallback Strategies -->
  <section class="demo-section">
    <h2>Estrategias de Fallback</h2>
    <p style="color: var(--ux-text-secondary); margin-bottom: 1rem;">
      Qué hacer cuando la API no está disponible.
    </p>

    <div class="demo-box">
      <h3>1. Ocultar el botón si no está soportado</h3>
      <pre>&lt;button x-show="isSupported" ...&gt;Abrir Teclado&lt;/button&gt;</pre>

      <h3 style="margin-top: 1.5rem;">2. Deshabilitar el botón</h3>
      <pre>&lt;button :disabled="!isSupported" ...&gt;Abrir Teclado&lt;/button&gt;</pre>

      <h3 style="margin-top: 1.5rem;">3. Mostrar mensaje alternativo</h3>
      <pre>&lt;template x-if="!isSupported"&gt;
  &lt;p&gt;Toca el campo de texto para abrir el teclado.&lt;/p&gt;
&lt;/template&gt;</pre>

      <h3 style="margin-top: 1.5rem;">4. Usar inputmode para teclados móviles</h3>
      <pre>&lt;!-- El teclado se abre automáticamente en móviles al hacer focus --&gt;
&lt;input type="text" inputmode="numeric"&gt;  &lt;!-- Teclado numérico --&gt;
&lt;input type="text" inputmode="email"&gt;    &lt;!-- Teclado con @ --&gt;
&lt;input type="text" inputmode="tel"&gt;      &lt;!-- Teclado teléfono --&gt;</pre>
    </div>
  </section>

</body>
</html>
