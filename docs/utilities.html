<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Utilities - UX Library</title>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="../components/ux-core.js"></script>
  <script src="../components/ux-button.js"></script>
  <script src="../components/ux-utilities.js"></script>
  <style>
    .demo-section { margin-bottom: var(--ux-space-xl); }
    .demo-section h3 {
      font-size: var(--ux-font-size-lg);
      font-weight: 600;
      margin-bottom: var(--ux-space-md);
      color: var(--ux-text);
    }
    .demo-section p {
      font-size: var(--ux-font-size-md);
      color: var(--ux-text-secondary);
      margin-bottom: var(--ux-space-md);
    }
    .demo-box {
      background: var(--ux-surface);
      border-radius: var(--ux-border-radius-lg);
      padding: var(--ux-space-lg);
      margin-bottom: var(--ux-space-md);
    }
    .code-block {
      background: #1a1a2e;
      color: #e5e5e5;
      padding: var(--ux-space-md);
      border-radius: var(--ux-border-radius);
      overflow-x: auto;
      font-family: 'SF Mono', Monaco, monospace;
      font-size: var(--ux-font-size-md);
      line-height: 1.6;
    }
    .code-block .tag { color: #ff7b72; }
    .code-block .attr { color: #79c0ff; }
    .code-block .string { color: #a5d6ff; }
    .code-block .comment { color: #8b949e; }
    .code-block .keyword { color: #ff7b72; }
    .code-block .function { color: #d2a8ff; }
    .utility-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: var(--ux-space-md);
    }
    .utility-card {
      padding: var(--ux-space-md);
      background: var(--ux-gray-50);
      border-radius: var(--ux-radius-md);
    }
    .utility-card code {
      display: block;
      font-size: var(--ux-font-size-sm);
      color: var(--ux-primary);
      margin-bottom: var(--ux-space-xs);
    }
    .utility-card small {
      color: var(--ux-text-secondary);
    }
  </style>
</head>
<body class="ux-app">

  <div class="ux-content" style="padding: var(--ux-space-lg);">

    <!-- Visibility Helpers -->
    <section class="demo-section">
      <h3>Visibility Helpers</h3>
      <p>Clases para mostrar/ocultar elementos segun contexto.</p>

      <div class="demo-box">
        <h4 style="margin-bottom: var(--ux-space-md);">Basicas</h4>
        <div class="utility-grid">
          <div class="utility-card">
            <code>.ux-hidden</code>
            <small>Oculta completamente (display: none)</small>
          </div>
          <div class="utility-card">
            <code>.ux-invisible</code>
            <small>Invisible pero ocupa espacio</small>
          </div>
          <div class="utility-card">
            <code>.ux-sr-only</code>
            <small>Solo visible para screen readers</small>
          </div>
        </div>
      </div>

      <div class="demo-box">
        <h4 style="margin-bottom: var(--ux-space-md);">Responsive</h4>
        <div class="utility-grid">
          <div class="utility-card">
            <code>.ux-hidden-xs</code>
            <small>Oculto en &lt;576px</small>
          </div>
          <div class="utility-card">
            <code>.ux-hidden-sm</code>
            <small>Oculto en 576-767px</small>
          </div>
          <div class="utility-card">
            <code>.ux-hidden-md</code>
            <small>Oculto en 768-991px</small>
          </div>
          <div class="utility-card">
            <code>.ux-hidden-lg</code>
            <small>Oculto en 992-1199px</small>
          </div>
          <div class="utility-card">
            <code>.ux-hidden-xl</code>
            <small>Oculto en &gt;1200px</small>
          </div>
          <div class="utility-card">
            <code>.ux-mobile-only</code>
            <small>Solo en movil (&lt;768px)</small>
          </div>
          <div class="utility-card">
            <code>.ux-desktop-only</code>
            <small>Solo en desktop (&gt;768px)</small>
          </div>
        </div>
      </div>

      <div class="demo-box">
        <h4 style="margin-bottom: var(--ux-space-md);">Por Capacidad</h4>
        <div class="utility-grid">
          <div class="utility-card">
            <code>.ux-touch-only</code>
            <small>Solo dispositivos tactiles</small>
          </div>
          <div class="utility-card">
            <code>.ux-no-touch</code>
            <small>Solo dispositivos con mouse</small>
          </div>
          <div class="utility-card">
            <code>.ux-dark-only</code>
            <small>Solo en modo oscuro</small>
          </div>
          <div class="utility-card">
            <code>.ux-light-only</code>
            <small>Solo en modo claro</small>
          </div>
        </div>
      </div>

      <pre class="code-block"><span class="comment">&lt;!-- Visible solo en movil --&gt;</span>
<span class="tag">&lt;button</span> <span class="attr">class</span>=<span class="string">"ux-button ux-mobile-only"</span><span class="tag">&gt;</span>Menu<span class="tag">&lt;/button&gt;</span>

<span class="comment">&lt;!-- Oculto en pantallas pequenas --&gt;</span>
<span class="tag">&lt;nav</span> <span class="attr">class</span>=<span class="string">"ux-hidden-xs ux-hidden-sm"</span><span class="tag">&gt;</span>...<span class="tag">&lt;/nav&gt;</span>

<span class="comment">&lt;!-- Solo para screen readers --&gt;</span>
<span class="tag">&lt;span</span> <span class="attr">class</span>=<span class="string">"ux-sr-only"</span><span class="tag">&gt;</span>Abrir menu<span class="tag">&lt;/span&gt;</span></pre>
    </section>

    <!-- Print Utilities -->
    <section class="demo-section">
      <h3>Print Utilities</h3>
      <p>Clases para controlar la impresion.</p>

      <div class="demo-box">
        <div class="utility-grid">
          <div class="utility-card">
            <code>.ux-no-print</code>
            <small>Ocultar al imprimir</small>
          </div>
          <div class="utility-card">
            <code>.ux-print-only</code>
            <small>Mostrar solo al imprimir</small>
          </div>
          <div class="utility-card">
            <code>.ux-print-break-before</code>
            <small>Salto de pagina antes</small>
          </div>
          <div class="utility-card">
            <code>.ux-print-break-after</code>
            <small>Salto de pagina despues</small>
          </div>
          <div class="utility-card">
            <code>.ux-print-break-avoid</code>
            <small>Evitar corte dentro</small>
          </div>
          <div class="utility-card">
            <code>.ux-print-bg</code>
            <small>Preservar colores de fondo</small>
          </div>
        </div>
      </div>

      <pre class="code-block"><span class="comment">&lt;!-- No imprimir navegacion --&gt;</span>
<span class="tag">&lt;nav</span> <span class="attr">class</span>=<span class="string">"ux-navbar ux-no-print"</span><span class="tag">&gt;</span>...<span class="tag">&lt;/nav&gt;</span>

<span class="comment">&lt;!-- Nota de pie de pagina solo en impresion --&gt;</span>
<span class="tag">&lt;footer</span> <span class="attr">class</span>=<span class="string">"ux-print-only"</span><span class="tag">&gt;</span>Impreso desde...<span class="tag">&lt;/footer&gt;</span>

<span class="comment">&lt;!-- Evitar que tabla se corte --&gt;</span>
<span class="tag">&lt;table</span> <span class="attr">class</span>=<span class="string">"ux-print-break-avoid"</span><span class="tag">&gt;</span>...<span class="tag">&lt;/table&gt;</span></pre>
    </section>

    <!-- JavaScript Utilities -->
    <section class="demo-section">
      <h3>Focus Trap</h3>
      <p>Atrapa el foco dentro de un elemento (modales, dialogs).</p>

      <div class="demo-box" x-data="{ isOpen: false }">
        <button class="ux-button ux-color-primary" @click="isOpen = true">Abrir Dialog</button>

        <div x-show="isOpen"
             x-trap-focus.escape
             style="position: fixed; inset: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; z-index: 1000;"
             @keydown.escape="isOpen = false">
          <div style="background: var(--ux-surface); padding: var(--ux-space-xl); border-radius: var(--ux-radius-lg); max-width: 400px;">
            <h4 style="margin-bottom: var(--ux-space-md);">Dialog con Focus Trap</h4>
            <p style="margin-bottom: var(--ux-space-md);">El foco esta atrapado dentro de este dialog. Presiona Tab para navegar.</p>
            <input type="text" class="ux-input" placeholder="Input 1" style="margin-bottom: var(--ux-space-sm);">
            <input type="text" class="ux-input" placeholder="Input 2" style="margin-bottom: var(--ux-space-md);">
            <div style="display: flex; gap: var(--ux-space-sm); justify-content: flex-end;">
              <button class="ux-button ux-button--outline" @click="isOpen = false">Cancelar</button>
              <button class="ux-button ux-color-primary" @click="isOpen = false">Aceptar</button>
            </div>
          </div>
        </div>
      </div>

      <pre class="code-block"><span class="comment">// Directiva Alpine.js</span>
<span class="tag">&lt;div</span> <span class="attr">x-trap-focus</span><span class="tag">&gt;</span>...<span class="tag">&lt;/div&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">x-trap-focus.escape</span><span class="tag">&gt;</span>...<span class="tag">&lt;/div&gt;</span>  <span class="comment">// Desactiva con Escape</span>

<span class="comment">// JavaScript API</span>
<span class="keyword">const</span> release = <span class="function">UX.trapFocus</span>(element, {
  initialFocus: <span class="string">'#first-input'</span>,
  returnFocus: <span class="keyword">true</span>,
  escapeDeactivates: <span class="keyword">true</span>
});

<span class="comment">// Liberar trap</span>
<span class="function">release</span>();
<span class="comment">// o</span>
<span class="function">UX.releaseFocusTrap</span>(element);</pre>
    </section>

    <!-- Click Outside -->
    <section class="demo-section">
      <h3>Click Outside</h3>
      <p>Detecta clicks fuera de un elemento.</p>

      <div class="demo-box" x-data="{ isOpen: false }">
        <div style="position: relative; display: inline-block;">
          <button class="ux-button" @click="isOpen = !isOpen">Toggle Dropdown</button>
          <div x-show="isOpen"
               x-click-outside="isOpen = false"
               style="position: absolute; top: 100%; left: 0; margin-top: 8px; padding: var(--ux-space-md); background: var(--ux-surface); border: 1px solid var(--ux-border-color); border-radius: var(--ux-radius-md); box-shadow: var(--ux-shadow-lg); min-width: 200px;">
            <p style="margin: 0;">Click fuera para cerrar</p>
          </div>
        </div>
      </div>

      <pre class="code-block"><span class="comment">// Directiva Alpine.js</span>
<span class="tag">&lt;div</span> <span class="attr">x-click-outside</span>=<span class="string">"isOpen = false"</span><span class="tag">&gt;</span>...<span class="tag">&lt;/div&gt;</span>

<span class="comment">// JavaScript API</span>
<span class="keyword">const</span> cleanup = <span class="function">UX.onClickOutside</span>(element, () => {
  <span class="function">console.log</span>(<span class="string">'Clicked outside!'</span>);
}, {
  ignore: [<span class="string">'.ignore-me'</span>, otherElement]
});

<span class="comment">// Remover listener</span>
<span class="function">cleanup</span>();</pre>
    </section>

    <!-- Scroll Lock -->
    <section class="demo-section">
      <h3>Scroll Lock</h3>
      <p>Bloquea el scroll del body (para modales).</p>

      <div class="demo-box" x-data="{ locked: false }">
        <button class="ux-button"
                :class="locked ? 'ux-color-danger' : 'ux-color-primary'"
                @click="locked = !locked; locked ? UX.lockScroll() : UX.unlockScroll()">
          <span x-text="locked ? 'Desbloquear Scroll' : 'Bloquear Scroll'"></span>
        </button>
        <p style="margin-top: var(--ux-space-sm); color: var(--ux-text-secondary);" x-show="locked">
          El scroll esta bloqueado. Intenta hacer scroll.
        </p>
      </div>

      <pre class="code-block"><span class="comment">// Bloquear scroll</span>
<span class="function">UX.lockScroll</span>();

<span class="comment">// Desbloquear scroll</span>
<span class="function">UX.unlockScroll</span>();

<span class="comment">// Forzar desbloqueo (ignora contadores)</span>
<span class="function">UX.forceUnlockScroll</span>();</pre>
    </section>

    <!-- Clipboard -->
    <section class="demo-section">
      <h3>Clipboard</h3>
      <p>Copiar texto al portapapeles.</p>

      <div class="demo-box" x-data="{ copied: false, text: 'Texto de ejemplo para copiar' }">
        <div style="display: flex; gap: var(--ux-space-sm); align-items: center;">
          <input type="text" class="ux-input" x-model="text" style="flex: 1;">
          <button class="ux-button ux-color-primary"
                  x-clipboard="text"
                  x-clipboard.feedback
                  @clipboard:copied="copied = true; setTimeout(() => copied = false, 2000)">
            <span x-text="copied ? 'Copiado!' : 'Copiar'"></span>
          </button>
        </div>
      </div>

      <pre class="code-block"><span class="comment">// Directiva Alpine.js</span>
<span class="tag">&lt;button</span> <span class="attr">x-clipboard</span>=<span class="string">"textToCopy"</span><span class="tag">&gt;</span>Copiar<span class="tag">&lt;/button&gt;</span>
<span class="tag">&lt;button</span> <span class="attr">x-clipboard.feedback</span>=<span class="string">"text"</span><span class="tag">&gt;</span>Copiar<span class="tag">&lt;/button&gt;</span>  <span class="comment">// Cambia texto a "Copied!"</span>

<span class="comment">// Magic helper</span>
<span class="tag">&lt;button</span> <span class="attr">@click</span>=<span class="string">"$clipboard.copy('Hello!')"</span><span class="tag">&gt;</span>Copiar<span class="tag">&lt;/button&gt;</span>

<span class="comment">// JavaScript API</span>
<span class="keyword">await</span> <span class="function">UX.copyToClipboard</span>(<span class="string">'Texto a copiar'</span>);
<span class="keyword">const</span> text = <span class="keyword">await</span> <span class="function">UX.readFromClipboard</span>();</pre>
    </section>

    <!-- Debounce & Throttle -->
    <section class="demo-section">
      <h3>Debounce & Throttle</h3>
      <p>Controla la frecuencia de ejecucion de funciones.</p>

      <div class="demo-box" x-data="{ searchCount: 0, scrollCount: 0 }">
        <div style="margin-bottom: var(--ux-space-md);">
          <label style="display: block; margin-bottom: var(--ux-space-xs);">Debounce (300ms) - Busqueda:</label>
          <input type="text"
                 class="ux-input"
                 placeholder="Escribe algo..."
                 @input="$debounce(() => searchCount++, 300)()">
          <small style="color: var(--ux-text-secondary);">Busquedas ejecutadas: <span x-text="searchCount"></span></small>
        </div>
      </div>

      <pre class="code-block"><span class="comment">// Magic helpers en Alpine.js</span>
<span class="attr">@input</span>=<span class="string">"$debounce(() => search(), 300)()"</span>
<span class="attr">@scroll</span>=<span class="string">"$throttle(() => onScroll(), 100)()"</span>

<span class="comment">// JavaScript API</span>
<span class="keyword">const</span> debouncedSearch = <span class="function">UX.debounce</span>((query) => {
  <span class="function">fetch</span>(<span class="string">`/search?q=\${query}`</span>);
}, 300, {
  leading: <span class="keyword">false</span>,   <span class="comment">// No ejecutar al inicio</span>
  trailing: <span class="keyword">true</span>    <span class="comment">// Ejecutar al final</span>
});

<span class="keyword">const</span> throttledScroll = <span class="function">UX.throttle</span>(() => {
  <span class="function">updatePosition</span>();
}, 100, {
  leading: <span class="keyword">true</span>,
  trailing: <span class="keyword">true</span>
});

<span class="comment">// Cancelar</span>
debouncedSearch.<span class="function">cancel</span>();
debouncedSearch.<span class="function">flush</span>(); <span class="comment">// Ejecutar inmediatamente</span></pre>
    </section>

    <!-- Print Element -->
    <section class="demo-section">
      <h3>Print Element</h3>
      <p>Imprimir un elemento especifico de la pagina.</p>

      <div class="demo-box">
        <div id="printable-content" style="padding: var(--ux-space-md); border: 1px dashed var(--ux-border-color); border-radius: var(--ux-radius-md);">
          <h4>Contenido Imprimible</h4>
          <p>Este contenido se imprimira de forma aislada.</p>
          <table style="width: 100%; border-collapse: collapse; margin-top: var(--ux-space-md);">
            <tr><th style="text-align: left; padding: 8px; border-bottom: 1px solid var(--ux-border-color);">Item</th><th style="text-align: right; padding: 8px; border-bottom: 1px solid var(--ux-border-color);">Precio</th></tr>
            <tr><td style="padding: 8px;">Producto A</td><td style="text-align: right; padding: 8px;">$100</td></tr>
            <tr><td style="padding: 8px;">Producto B</td><td style="text-align: right; padding: 8px;">$200</td></tr>
          </table>
        </div>
        <button class="ux-button ux-color-primary" style="margin-top: var(--ux-space-md);" onclick="UX.printElement('#printable-content', { title: 'Reporte' })">
          Imprimir Contenido
        </button>
      </div>

      <pre class="code-block"><span class="function">UX.printElement</span>(<span class="string">'#element-id'</span>, {
  title: <span class="string">'Titulo del documento'</span>,
  styles: <span class="keyword">true</span>,         <span class="comment">// Incluir estilos de la pagina</span>
  extraStyles: <span class="string">'...'</span>    <span class="comment">// CSS adicional</span>
});

<span class="comment">// Imprimir pagina completa</span>
<span class="function">UX.print</span>();</pre>
    </section>

    <!-- Interactive State Utilities -->
    <section class="demo-section">
      <h3>State Utilities</h3>
      <p>Clases para estados interactivos.</p>

      <div class="demo-box">
        <div class="utility-grid">
          <div class="utility-card">
            <code>.ux-disabled</code>
            <small>Deshabilitado (opacity + no pointer)</small>
          </div>
          <div class="utility-card">
            <code>.ux-loading</code>
            <small>Estado de carga (cursor wait)</small>
          </div>
          <div class="utility-card">
            <code>.ux-clickable</code>
            <small>Cursor pointer</small>
          </div>
          <div class="utility-card">
            <code>.ux-draggable</code>
            <small>Cursor grab</small>
          </div>
          <div class="utility-card">
            <code>.ux-select-none</code>
            <small>Texto no seleccionable</small>
          </div>
          <div class="utility-card">
            <code>.ux-select-all</code>
            <small>Seleccionar todo al click</small>
          </div>
          <div class="utility-card">
            <code>.ux-pointer-none</code>
            <small>Sin eventos de pointer</small>
          </div>
          <div class="utility-card">
            <code>.ux-focus-ring</code>
            <small>Anillo de foco visible</small>
          </div>
        </div>
      </div>
    </section>

    <!-- Overflow Utilities -->
    <section class="demo-section">
      <h3>Overflow Utilities</h3>
      <p>Clases para controlar el overflow.</p>

      <div class="demo-box">
        <div class="utility-grid">
          <div class="utility-card">
            <code>.ux-overflow-hidden</code>
            <small>Ocultar overflow</small>
          </div>
          <div class="utility-card">
            <code>.ux-overflow-auto</code>
            <small>Scroll automatico</small>
          </div>
          <div class="utility-card">
            <code>.ux-overflow-x-auto</code>
            <small>Scroll horizontal</small>
          </div>
          <div class="utility-card">
            <code>.ux-overflow-y-auto</code>
            <small>Scroll vertical</small>
          </div>
          <div class="utility-card">
            <code>.ux-scrollbar-thin</code>
            <small>Scrollbar delgado</small>
          </div>
          <div class="utility-card">
            <code>.ux-scrollbar-none</code>
            <small>Ocultar scrollbar</small>
          </div>
        </div>
      </div>
    </section>

  </div>

</body>
</html>
