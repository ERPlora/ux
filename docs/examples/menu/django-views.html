# views.py
from django.shortcuts import render
from django.urls import reverse

def menu_items(request):
    """Retorna items del menu basados en permisos del usuario."""
    items = [
        {
            'label': 'Nuevo archivo',
            'url': reverse('file_create'),
            'method': 'get',
            'icon': '<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>',
            'shortcut': 'Cmd+N',
        },
        {
            'label': 'Guardar',
            'url': reverse('file_save'),
            'method': 'post',
            'icon': '<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"/></svg>',
            'shortcut': 'Cmd+S',
            'divider_after': True,
        },
    ]

    # Items condicionales por permisos
    if request.user.has_perm('app.delete_file'):
        items.append({
            'label': 'Eliminar',
            'url': reverse('file_delete'),
            'method': 'delete',
            'danger': True,
            'confirm': 'Esta seguro de eliminar este archivo?',
            'icon': '<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/></svg>',
        })

    return render(request, 'partials/menu_items.html', {'menu_items': items})
