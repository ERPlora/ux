<div x-data="uxCommand({
  placeholder: 'Buscar usuarios...',
  loadResults: async (query) => {
    // Simular delay de API
    await new Promise(r => setTimeout(r, 500));

    // Datos de ejemplo
    const users = [
      { id: 'u1', title: 'Ana Garcia', description: 'ana@email.com', icon: 'user' },
      { id: 'u2', title: 'Carlos Lopez', description: 'carlos@email.com', icon: 'user' },
      { id: 'u3', title: 'Maria Rodriguez', description: 'maria@email.com', icon: 'user' },
      { id: 'u4', title: 'Pedro Martinez', description: 'pedro@email.com', icon: 'user' },
      { id: 'u5', title: 'Laura Sanchez', description: 'laura@email.com', icon: 'user' }
    ];

    // Filtrar por query
    const filtered = users.filter(u =>
      u.title.toLowerCase().includes(query.toLowerCase()) ||
      u.description.toLowerCase().includes(query.toLowerCase())
    );

    return [{ group: 'Usuarios', commands: filtered }];
  }
})">
  <button class="ux-button ux-button--outline" @click="open()">
    Buscar Usuarios
  </button>

  <div class="ux-command-backdrop" :class="{ 'ux-command-backdrop--open': isOpen }" @click="close()"></div>
  <div class="ux-command" :class="{ 'ux-command--open': isOpen }">
    <div class="ux-command__search">
      <span class="ux-command__search-icon" x-html="icons.search"></span>
      <input type="text" class="ux-command__input" :placeholder="placeholder"
             x-model="query" @input="filterCommands()" @keydown="handleKeydown($event)">
    </div>
    <div class="ux-command__results">
      <div x-show="loading" class="ux-command__loading">
        <div class="ux-command__loading-spinner"></div>
      </div>
      <div x-show="!loading && query && filteredCommands.length === 0" class="ux-command__empty">
        <div class="ux-command__empty-title">Sin resultados</div>
      </div>
      <div x-show="!loading && !query" class="ux-command__empty">
        <div class="ux-command__empty-icon" x-html="icons.search"></div>
        <div class="ux-command__empty-title">Escribe para buscar</div>
        <div class="ux-command__empty-description">Ingresa un nombre o email</div>
      </div>
      <template x-for="(group, gi) in filteredCommands" :key="group.group">
        <div class="ux-command__group">
          <div class="ux-command__group-title" x-text="group.group"></div>
          <ul class="ux-command__list">
            <template x-for="(cmd, ii) in group.commands" :key="cmd.id">
              <li class="ux-command__item" :class="{ 'ux-command__item--active': isActiveItem(gi, ii) }"
                  @click="executeCommand(cmd)">
                <div class="ux-command__item-icon" x-html="getIcon(cmd)"></div>
                <div class="ux-command__item-content">
                  <div class="ux-command__item-title" x-html="highlightMatch(cmd.title, query)"></div>
                  <div class="ux-command__item-description" x-text="cmd.description"></div>
                </div>
              </li>
            </template>
          </ul>
        </div>
      </template>
    </div>
  </div>
</div>
