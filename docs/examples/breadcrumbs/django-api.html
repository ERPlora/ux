# urls.py
urlpatterns = [
    path('api/breadcrumbs/', views.breadcrumbs_partial, name='breadcrumbs_partial'),
]

# views.py
from django.http import HttpRequest

def breadcrumbs_partial(request: HttpRequest):
    """Retorna breadcrumbs basados en la URL actual"""
    path = request.GET.get('path', request.headers.get('HX-Current-URL', '/'))
    breadcrumbs = build_breadcrumbs_from_path(path)
    return render(request, 'components/breadcrumbs.html', {'breadcrumbs': breadcrumbs})

def build_breadcrumbs_from_path(path: str) -> list:
    """Construye breadcrumbs a partir de la ruta"""
    crumbs = [{'title': 'Inicio', 'url': '/'}]
    parts = [p for p in path.split('/') if p]

    current_path = ''
    for part in parts:
        current_path += f'/{part}'
        crumbs.append({
            'title': part.replace('-', ' ').title(),
            'url': current_path + '/'
        })
    return crumbs
