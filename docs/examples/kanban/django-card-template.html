<!-- templates/kanban/partials/card.html -->
<div class="ux-kanban__card {% if card.completed %}ux-kanban__card--completed{% endif %}"
     id="card-{{ card.id }}"
     draggable="true"
     @dragstart="event.dataTransfer.setData('text/plain', '{{ card.id }}')">

  {% if card.priority == 'high' %}
    <div class="ux-kanban__card-labels">
      <span class="ux-kanban__card-label ux-kanban__card-label--danger">Urgente</span>
    </div>
  {% endif %}

  <h5 class="ux-kanban__card-title">{{ card.title }}</h5>

  {% if card.description %}
    <p class="ux-kanban__card-body">{{ card.description|truncatewords:15 }}</p>
  {% endif %}

  <div class="ux-kanban__card-footer">
    <div class="ux-kanban__card-meta">
      {% if card.due_date %}
        <span class="ux-kanban__card-meta-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="4" width="18" height="18" rx="2"/>
            <path d="M16 2v4M8 2v4M3 10h18"/>
          </svg>
          {{ card.due_date|date:"d M" }}
        </span>
      {% endif %}
    </div>

    {% if card.assignees.exists %}
      <div class="ux-kanban__card-assignees">
        {% for user in card.assignees.all|slice:":3" %}
          <div class="ux-kanban__card-assignee">
            <img src="{% if user.profile.avatar %}{{ user.profile.avatar.url }}{% else %}https://ui-avatars.com/api/?name={{ user.get_full_name|urlencode }}&size=48{% endif %}" alt="{{ user.get_full_name }}">
          </div>
        {% endfor %}
        {% if card.assignees.count > 3 %}
          <div class="ux-kanban__card-assignee ux-kanban__card-assignee--more">+{{ card.assignees.count|add:"-3" }}</div>
        {% endif %}
      </div>
    {% endif %}
  </div>

  <!-- Hidden input para HTMX -->
  <input type="hidden" name="card_id" value="{{ card.id }}">
</div>
