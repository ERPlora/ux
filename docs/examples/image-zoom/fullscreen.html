<div x-data="uxImageZoom({ enableFullscreen: true })"
     class="ux-image-zoom"
     :class="{ 'ux-image-zoom--fullscreen-active': isFullscreenOpen }"
     @click="handleImageClick()">
  <img class="ux-image-zoom__img"
       src="https://picsum.photos/400/300?random=5"
       data-zoom-src="https://picsum.photos/1600/1200?random=5"
       alt="Click for fullscreen">
  <div class="ux-image-zoom__icon" x-show="showZoomIcon">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path>
    </svg>
  </div>

  <template x-teleport="body">
    <div class="ux-image-zoom-fullscreen"
         :class="{ 'ux-image-zoom-fullscreen--open': isFullscreenOpen, 'ux-image-zoom-fullscreen--hide-ui': hideUI, 'ux-image-zoom-fullscreen--zoomed': currentZoom > 1, 'ux-image-zoom-fullscreen--panning': isPanning }"
         @click="handleBackdropClick($event)"
         @wheel.prevent="handleWheel($event)">
      <div class="ux-image-zoom-fullscreen__backdrop"></div>
      <div class="ux-image-zoom-fullscreen__container">
        <header class="ux-image-zoom-fullscreen__header">
          <h3 class="ux-image-zoom-fullscreen__title">Image Preview</h3>
          <span class="ux-image-zoom-fullscreen__zoom-level" x-text="zoomPercent + '%'"></span>
        </header>
        <button class="ux-image-zoom-fullscreen__close" @click="closeFullscreen()" aria-label="Close">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M18 6L6 18M6 6l12 12"></path>
          </svg>
        </button>
        <div class="ux-image-zoom-fullscreen__image-container"
             @click="toggleUI()"
             @dblclick="handleDoubleTap()"
             @mousedown="startPan($event)"
             @mousemove="pan($event)"
             @mouseup="endPan()"
             @mouseleave="endPan()"
             @touchstart="handleTouchStart($event)"
             @touchmove="handleTouchMove($event)"
             @touchend="handleTouchEnd($event)">
          <div class="ux-image-zoom-fullscreen__image-wrapper" :style="{ transform: imageTransform }">
            <img class="ux-image-zoom-fullscreen__image" :src="highResSrc || src" alt="Zoomed image">
          </div>
        </div>
        <div class="ux-image-zoom-fullscreen__controls">
          <button class="ux-image-zoom-fullscreen__btn" @click.stop="zoomOut()" :disabled="!canZoomOut" aria-label="Zoom out">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="M21 21l-4.35-4.35M8 11h6"></path>
            </svg>
          </button>
          <span class="ux-image-zoom-fullscreen__zoom-display" x-text="zoomPercent + '%'"></span>
          <button class="ux-image-zoom-fullscreen__btn" @click.stop="zoomIn()" :disabled="!canZoomIn" aria-label="Zoom in">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="M21 21l-4.35-4.35M11 8v6M8 11h6"></path>
            </svg>
          </button>
          <button class="ux-image-zoom-fullscreen__btn" @click.stop="resetZoom()" aria-label="Reset zoom">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
              <path d="M3 3v5h5"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </template>
</div>
