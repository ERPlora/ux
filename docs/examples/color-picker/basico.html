<div class="ux-color-picker" x-data="uxColorPicker({ value: '#3b82f6' })" @colorpicker:change="selected = $event.detail">
  <button class="ux-color-picker__trigger" @click="toggle()">
    <span class="ux-color-picker__swatch" :style="{ background: displayValue }"></span>
    <span class="ux-color-picker__value" x-text="displayValue"></span>
  </button>

  <div class="ux-color-picker__dropdown" x-show="isOpen" x-transition @click.outside="close()">
    <!-- Spectrum -->
    <div class="ux-color-picker__spectrum"
         :style="{ background: `hsl(${hue}, 100%, 50%)` }"
         @mousedown="onSpectrumMouseDown"
         @touchstart.prevent="onSpectrumTouchStart">
      <div class="ux-color-picker__spectrum-white"></div>
      <div class="ux-color-picker__spectrum-black"></div>
      <div class="ux-color-picker__spectrum-cursor"
           :style="{ left: saturation + '%', top: (100 - lightness * 2) + '%' }"></div>
    </div>

    <!-- Hue Slider -->
    <div class="ux-color-picker__slider ux-color-picker__slider--hue"
         @mousedown="onHueMouseDown"
         @touchstart.prevent="onHueTouchStart">
      <div class="ux-color-picker__slider-track"></div>
      <div class="ux-color-picker__slider-thumb" :style="{ left: (hue / 360 * 100) + '%' }"></div>
    </div>

    <!-- Input -->
    <div class="ux-color-picker__input-group">
      <input type="text" class="ux-color-picker__input" :value="displayValue" @change="setFromInput($event.target.value)">
      <button class="ux-color-picker__format-btn" @click="cycleFormat()" x-text="format.toUpperCase()"></button>
    </div>

    <!-- Presets -->
    <div class="ux-color-picker__presets" x-show="presets.length > 0">
      <template x-for="preset in presets" :key="preset">
        <button class="ux-color-picker__preset"
                :style="{ background: preset }"
                :class="{ 'ux-color-picker__preset--active': value === preset }"
                @click="setValue(preset)"></button>
      </template>
    </div>
  </div>

  <div class="color-preview" style="display: flex; align-items: center; gap: 0.75rem; margin-top: 1rem;">
    <div class="color-swatch" style="width: 48px; height: 48px; border-radius: 8px; border: 1px solid var(--ux-border-color);" :style="{ background: displayValue }"></div>
    <span x-text="displayValue"></span>
  </div>
</div>
