<div x-data="{
        ...uxProductionLine({
          name: 'Interactive Line Demo',
          status: 'running',
          target: 1000,
          actual: 500,
          efficiency: 85,
          speed: 70,
          maxSpeed: 100,
          downtime: 0,
          stations: [
            { name: 'Station 1', status: 'running', output: 550, alerts: 0 },
            { name: 'Station 2', status: 'running', output: 530, alerts: 0 },
            { name: 'Station 3', status: 'running', output: 510, alerts: 0 },
            { name: 'Station 4', status: 'running', output: 500, alerts: 0 }
          ]
        }),
        simulateProduction() {
          if (this.status === 'running') {
            this.actual = Math.min(this.target, this.actual + Math.floor(Math.random() * 5));
            this.stations.forEach((s, i) => {
              if (s.status === 'running') {
                s.output = Math.min(s.output + Math.floor(Math.random() * 3), this.actual + (this.stations.length - i) * 10);
              }
            });
          }
        },
        toggleStatus(newStatus) {
          this.status = newStatus;
          if (newStatus === 'stopped' || newStatus === 'maintenance' || newStatus === 'error') {
            this.speed = 0;
            this.stations.forEach(s => s.status = newStatus);
          } else {
            this.speed = 70;
            this.stations.forEach(s => s.status = 'running');
          }
        },
        triggerError(index) {
          this.stations[index].status = 'error';
          this.stations[index].alerts = (this.stations[index].alerts || 0) + 1;
          this.status = 'error';
        },
        resolveError(index) {
          this.stations[index].status = 'running';
          this.stations[index].alerts = 0;
          if (this.stations.every(s => s.status === 'running')) {
            this.status = 'running';
          }
        }
      }"
      x-init="setInterval(() => simulateProduction(), 1000)"
      class="ux-production-line">
        <div class="ux-production-line__header">
          <h3 class="ux-production-line__title">
            <span x-text="name"></span>
            <span class="ux-production-line__status-badge" :class="'ux-production-line__status-badge--' + status">
              <span class="ux-production-line__status-dot"></span>
              <span x-text="getStatusLabel(status)"></span>
            </span>
          </h3>
          <div class="ux-production-line__speed">
            <span class="ux-production-line__speed-label">Speed:</span>
            <span class="ux-production-line__speed-value" x-text="speed + '%'"></span>
            <div class="ux-production-line__speed-bar">
              <div class="ux-production-line__speed-fill" :style="{ width: speedPercent + '%' }"></div>
            </div>
          </div>
        </div>

        <div class="ux-production-line__metrics">
          <div class="ux-production-line__metric">
            <span class="ux-production-line__metric-label">Production</span>
            <span class="ux-production-line__metric-value">
              <span x-text="actual.toLocaleString()"></span>
              <span class="ux-production-line__metric-unit">/ <span x-text="target.toLocaleString()"></span></span>
            </span>
          </div>
          <div class="ux-production-line__metric">
            <span class="ux-production-line__metric-label">Efficiency</span>
            <span class="ux-production-line__metric-value">
              <span x-text="efficiencyDisplay"></span>
              <span class="ux-production-line__metric-unit">%</span>
            </span>
          </div>
          <div class="ux-production-line__metric">
            <span class="ux-production-line__metric-label">Errors</span>
            <span class="ux-production-line__metric-value" :style="{ color: errorStationsCount > 0 ? 'var(--ux-danger)' : 'inherit' }">
              <span x-text="errorStationsCount"></span>
            </span>
          </div>
        </div>

        <div class="ux-production-line__progress">
          <div class="ux-production-line__progress-header">
            <span class="ux-production-line__progress-label">Daily Target</span>
            <span class="ux-production-line__progress-values">
              <span class="ux-production-line__progress-actual" x-text="progressPercent.toFixed(1) + '%'"></span>
            </span>
          </div>
          <div class="ux-production-line__progress-bar">
            <div class="ux-production-line__progress-fill"
                 :class="'ux-production-line__progress-fill--' + progressStatus"
                 :style="{ width: Math.min(100, progressPercent) + '%' }"></div>
          </div>
        </div>

        <div class="ux-production-line__stations">
          <div class="ux-production-line__stations-wrapper">
            <template x-for="(station, index) in stations" :key="index">
              <template x-if="true">
                <div style="display: contents;">
                  <div class="ux-production-line__station" :class="getStationClass(station)" @click="station.status === 'error' ? resolveError(index) : triggerError(index)" style="cursor: pointer;">
                    <div class="ux-production-line__station-icon">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="3" y="8" width="18" height="8" rx="1"/>
                        <circle cx="7" cy="16" r="2"/>
                        <circle cx="17" cy="16" r="2"/>
                      </svg>
                      <span class="ux-production-line__station-alert" x-show="station.alerts > 0" x-text="station.alerts"></span>
                    </div>
                    <span class="ux-production-line__station-label" x-text="station.name"></span>
                    <span class="ux-production-line__station-sublabel" x-text="station.output + ' units'"></span>
                    <div class="ux-production-line__station-tooltip">
                      <div class="ux-production-line__tooltip-row">
                        <span class="ux-production-line__tooltip-label">Status:</span>
                        <span class="ux-production-line__tooltip-value" x-text="getStatusLabel(station.status)"></span>
                      </div>
                      <div class="ux-production-line__tooltip-row">
                        <span class="ux-production-line__tooltip-label">Click:</span>
                        <span class="ux-production-line__tooltip-value" x-text="station.status === 'error' ? 'Resolve' : 'Trigger error'"></span>
                      </div>
                    </div>
                  </div>
                  <div class="ux-production-line__connector"
                       :class="{ 'ux-production-line__connector--active': isConnectorActive(index), 'ux-production-line__connector--inactive': !isConnectorActive(index) }"
                       x-show="index < stations.length - 1">
                    <div class="ux-production-line__connector-flow" x-show="isConnectorActive(index)"></div>
                  </div>
                </div>
              </template>
            </template>
          </div>
        </div>

        <div class="ux-production-line__footer">
          <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
            <button class="ux-button ux-button--sm ux-color-success" @click="toggleStatus('running')" :class="{ 'ux-button--outline': status !== 'running' }">Running</button>
            <button class="ux-button ux-button--sm" @click="toggleStatus('stopped')" :class="{ 'ux-button--outline': status !== 'stopped' }">Stopped</button>
            <button class="ux-button ux-button--sm ux-color-warning" @click="toggleStatus('maintenance')" :class="{ 'ux-button--outline': status !== 'maintenance' }">Maintenance</button>
          </div>
          <span class="ux-production-line__last-update">Click on stations to toggle error state</span>
        </div>
      </div>
