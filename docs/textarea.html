<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Textarea - UX Library</title>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="../components/ux-core.js"></script>
  <script src="../components/ux-navbar.js"></script>
  <script src="../components/ux-button.js"></script>
  <script src="../components/ux-textarea.js"></script>
  <script src="../components/ux-code-block.js"></script>
  <style>
    .demo-section { margin-bottom: var(--ux-space-xl); }
    .demo-section h3 { font-size: var(--ux-font-size-lg); font-weight: 600; margin-bottom: var(--ux-space-md); }
    .demo-section p { font-size: var(--ux-font-size-md); color: var(--ux-text-secondary); margin-bottom: var(--ux-space-md); }
    .demo-box { background: var(--ux-surface); border-radius: var(--ux-border-radius-lg); padding: var(--ux-space-lg); margin-bottom: var(--ux-space-md); }
  </style>
</head>
<body class="ux-app">

  <div class="ux-content ux-padding">
    <!-- Textarea Basico -->
    <section class="demo-section">
      <h3>Textarea Basico</h3>
      <p>Area de texto con estilos Ionic.</p>
      <div class="demo-box">
        <div class="ux-textarea">
          <label class="ux-textarea__label">Descripcion</label>
          <textarea class="ux-textarea__field" placeholder="Escribe aqui..."></textarea>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-textarea"&gt;
  &lt;label class="ux-textarea__label"&gt;Descripcion&lt;/label&gt;
  &lt;textarea class="ux-textarea__field" placeholder="Escribe aqui..."&gt;&lt;/textarea&gt;
&lt;/div&gt;</pre>
    </section>

    <!-- Label Flotante -->
    <section class="demo-section">
      <h3>Label Flotante</h3>
      <p>El label se anima hacia arriba al enfocar o escribir.</p>
      <div class="demo-box">
        <div class="ux-textarea ux-textarea--floating">
          <textarea class="ux-textarea__field" placeholder=" "></textarea>
          <label class="ux-textarea__label">Tu mensaje</label>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-textarea ux-textarea--floating"&gt;
  &lt;textarea class="ux-textarea__field" placeholder=" "&gt;&lt;/textarea&gt;
  &lt;label class="ux-textarea__label"&gt;Tu mensaje&lt;/label&gt;
&lt;/div&gt;</pre>
    </section>

    <!-- Tamanos -->
    <section class="demo-section">
      <h3>Tamanos</h3>
      <p>Pequeno, normal y grande.</p>
      <div class="demo-box" style="display: flex; flex-direction: column; gap: var(--ux-space-md);">
        <div class="ux-textarea ux-textarea--sm">
          <label class="ux-textarea__label">Pequeno</label>
          <textarea class="ux-textarea__field" placeholder="Textarea pequeno"></textarea>
        </div>
        <div class="ux-textarea">
          <label class="ux-textarea__label">Normal</label>
          <textarea class="ux-textarea__field" placeholder="Textarea normal"></textarea>
        </div>
        <div class="ux-textarea ux-textarea--lg">
          <label class="ux-textarea__label">Grande</label>
          <textarea class="ux-textarea__field" placeholder="Textarea grande"></textarea>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-textarea ux-textarea--sm"&gt;...&lt;/div&gt;
&lt;div class="ux-textarea"&gt;...&lt;/div&gt;
&lt;div class="ux-textarea ux-textarea--lg"&gt;...&lt;/div&gt;</pre>
    </section>

    <!-- Variantes -->
    <section class="demo-section">
      <h3>Variantes</h3>
      <p>Diferentes estilos visuales.</p>
      <div class="demo-box" style="display: flex; flex-direction: column; gap: var(--ux-space-md);">
        <div class="ux-textarea">
          <label class="ux-textarea__label">Default (Outline)</label>
          <textarea class="ux-textarea__field" placeholder="Borde completo"></textarea>
        </div>
        <div class="ux-textarea ux-textarea--filled">
          <label class="ux-textarea__label">Filled</label>
          <textarea class="ux-textarea__field" placeholder="Fondo con linea inferior"></textarea>
        </div>
        <div class="ux-textarea ux-textarea--borderless">
          <label class="ux-textarea__label">Borderless</label>
          <textarea class="ux-textarea__field" placeholder="Sin bordes"></textarea>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-textarea ux-textarea--filled"&gt;...&lt;/div&gt;
&lt;div class="ux-textarea ux-textarea--borderless"&gt;...&lt;/div&gt;</pre>
    </section>

    <!-- Con Contador -->
    <section class="demo-section">
      <h3>Con Contador de Caracteres</h3>
      <p>Muestra caracteres usados y restantes usando Alpine.js.</p>
      <div class="demo-box">
        <div class="ux-textarea"
             x-data="uxTextarea({ maxLength: 200 })">
          <label class="ux-textarea__label">Comentario</label>
          <textarea class="ux-textarea__field"
                    x-model="value"
                    placeholder="Escribe tu comentario..."
                    maxlength="200"></textarea>
          <div class="ux-textarea__footer">
            <span class="ux-textarea__helper">Maximo 200 caracteres</span>
            <span class="ux-textarea__counter" :class="counterClass" x-text="charCount + '/200'"></span>
          </div>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-textarea"
     x-data="uxTextarea({ maxLength: 200 })"&gt;
  &lt;label class="ux-textarea__label"&gt;Comentario&lt;/label&gt;
  &lt;textarea class="ux-textarea__field"
            x-model="value"
            maxlength="200"&gt;&lt;/textarea&gt;
  &lt;div class="ux-textarea__footer"&gt;
    &lt;span class="ux-textarea__helper"&gt;...&lt;/span&gt;
    &lt;span class="ux-textarea__counter"
          :class="counterClass"
          x-text="charCount + '/200'"&gt;&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
    </section>

    <!-- Auto Resize -->
    <section class="demo-section">
      <h3>Auto Resize</h3>
      <p>El textarea crece automaticamente segun el contenido.</p>
      <div class="demo-box">
        <div class="ux-textarea ux-textarea--auto-resize"
             x-data="uxTextarea({ autoResize: true })">
          <label class="ux-textarea__label">Mensaje</label>
          <textarea class="ux-textarea__field"
                    x-model="value"
                    @input="resize($event.target)"
                    placeholder="Escribe y el textarea crecera..."></textarea>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-textarea ux-textarea--auto-resize"
     x-data="uxTextarea({ autoResize: true })"&gt;
  &lt;textarea class="ux-textarea__field"
            x-model="value"
            @input="resize($event.target)"&gt;&lt;/textarea&gt;
&lt;/div&gt;</pre>
    </section>

    <!-- Estados -->
    <section class="demo-section">
      <h3>Estados de Validacion</h3>
      <p>Error, exito y deshabilitado.</p>
      <div class="demo-box" style="display: flex; flex-direction: column; gap: var(--ux-space-md);">
        <div class="ux-textarea ux-textarea--error">
          <label class="ux-textarea__label">Con Error</label>
          <textarea class="ux-textarea__field" placeholder="Campo con error">Texto invalido</textarea>
          <span class="ux-textarea__error">Este campo contiene errores</span>
        </div>
        <div class="ux-textarea ux-textarea--success">
          <label class="ux-textarea__label">Exito</label>
          <textarea class="ux-textarea__field" placeholder="Campo validado">Texto valido</textarea>
        </div>
        <div class="ux-textarea ux-textarea--disabled">
          <label class="ux-textarea__label">Deshabilitado</label>
          <textarea class="ux-textarea__field" disabled>No se puede editar</textarea>
        </div>
        <div class="ux-textarea">
          <label class="ux-textarea__label">Solo Lectura</label>
          <textarea class="ux-textarea__field" readonly>Contenido de solo lectura</textarea>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-textarea ux-textarea--error"&gt;
  &lt;textarea class="ux-textarea__field"&gt;&lt;/textarea&gt;
  &lt;span class="ux-textarea__error"&gt;Mensaje de error&lt;/span&gt;
&lt;/div&gt;

&lt;div class="ux-textarea ux-textarea--success"&gt;...&lt;/div&gt;

&lt;textarea class="ux-textarea__field" disabled&gt;&lt;/textarea&gt;
&lt;textarea class="ux-textarea__field" readonly&gt;&lt;/textarea&gt;</pre>
    </section>

    <!-- Control de Resize -->
    <section class="demo-section">
      <h3>Opciones de Resize</h3>
      <p>Controla como el usuario puede redimensionar el textarea.</p>
      <div class="demo-box" style="display: flex; flex-direction: column; gap: var(--ux-space-md);">
        <div class="ux-textarea">
          <label class="ux-textarea__label">Vertical (default)</label>
          <textarea class="ux-textarea__field" placeholder="Resize vertical"></textarea>
        </div>
        <div class="ux-textarea ux-textarea--no-resize">
          <label class="ux-textarea__label">Sin resize</label>
          <textarea class="ux-textarea__field" placeholder="No se puede redimensionar"></textarea>
        </div>
        <div class="ux-textarea ux-textarea--resize-both">
          <label class="ux-textarea__label">Resize ambas direcciones</label>
          <textarea class="ux-textarea__field" placeholder="Horizontal y vertical"></textarea>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-textarea ux-textarea--no-resize"&gt;...&lt;/div&gt;
&lt;div class="ux-textarea ux-textarea--resize-both"&gt;...&lt;/div&gt;
&lt;div class="ux-textarea ux-textarea--resize-horizontal"&gt;...&lt;/div&gt;</pre>
    </section>

    <!-- Con Toolbar -->
    <section class="demo-section">
      <h3>Con Toolbar de Formato</h3>
      <p>Barra de herramientas para formateo de texto.</p>
      <div class="demo-box">
        <div class="ux-textarea ux-textarea--with-toolbar">
          <div class="ux-textarea__toolbar">
            <button type="button" class="ux-textarea__toolbar-btn" title="Negrita">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 4h8a4 4 0 014 4 4 4 0 01-4 4H6z M6 12h9a4 4 0 014 4 4 4 0 01-4 4H6z"/>
              </svg>
            </button>
            <button type="button" class="ux-textarea__toolbar-btn" title="Cursiva">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 4h4m-2 0v16m-4 0h8"/>
              </svg>
            </button>
            <button type="button" class="ux-textarea__toolbar-btn" title="Subrayado">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8v8a5 5 0 0010 0V8M5 21h14"/>
              </svg>
            </button>
            <div class="ux-textarea__toolbar-divider"></div>
            <button type="button" class="ux-textarea__toolbar-btn" title="Lista">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
              </svg>
            </button>
            <button type="button" class="ux-textarea__toolbar-btn" title="Link">
              <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"/>
              </svg>
            </button>
          </div>
          <textarea class="ux-textarea__field" placeholder="Escribe tu contenido formateado..."></textarea>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-textarea ux-textarea--with-toolbar"&gt;
  &lt;div class="ux-textarea__toolbar"&gt;
    &lt;button class="ux-textarea__toolbar-btn"&gt;B&lt;/button&gt;
    &lt;button class="ux-textarea__toolbar-btn"&gt;I&lt;/button&gt;
    &lt;div class="ux-textarea__toolbar-divider"&gt;&lt;/div&gt;
    &lt;button class="ux-textarea__toolbar-btn"&gt;...&lt;/button&gt;
  &lt;/div&gt;
  &lt;textarea class="ux-textarea__field"&gt;&lt;/textarea&gt;
&lt;/div&gt;</pre>
    </section>

    <!-- Campo Requerido -->
    <section class="demo-section">
      <h3>Campo Requerido</h3>
      <div class="demo-box">
        <div class="ux-textarea">
          <label class="ux-textarea__label ux-textarea__label--required">Mensaje obligatorio</label>
          <textarea class="ux-textarea__field" required placeholder="Este campo es requerido"></textarea>
        </div>
      </div>
      <pre class="ux-code-block" data-lang="html">&lt;label class="ux-textarea__label ux-textarea__label--required"&gt;
  Mensaje obligatorio
&lt;/label&gt;</pre>
    </section>

    <!-- HTMX Integration -->
    <section class="demo-section">
      <h3>Integracion HTMX</h3>
      <p>Textarea con envio automatico al servidor.</p>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-textarea"&gt;
  &lt;label class="ux-textarea__label"&gt;Notas&lt;/label&gt;
  &lt;textarea class="ux-textarea__field"
            name="notes"
            hx-post="/api/save-notes"
            hx-trigger="blur changed"
            hx-swap="none"&gt;&lt;/textarea&gt;
&lt;/div&gt;

&lt;!-- Con debounce para auto-guardado --&gt;
&lt;textarea class="ux-textarea__field"
          hx-post="/api/draft"
          hx-trigger="keyup changed delay:500ms"
          hx-swap="none"&gt;&lt;/textarea&gt;</pre>
    </section>

    <!-- HTMX + Django -->
    <section class="demo-section">
      <h3>HTMX + Django</h3>
      <p>Ejemplos de integracion con Django para autoguardado y contador dinamico.</p>

      <h4 style="font-weight: 600; margin: var(--ux-space-md) 0 var(--ux-space-sm);">Autoguardado de contenido</h4>
      <p>El textarea guarda automaticamente el borrador mientras el usuario escribe.</p>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-textarea"
     x-data="{ saving: false, saved: false }"&gt;
  &lt;label class="ux-textarea__label"&gt;Contenido del articulo&lt;/label&gt;
  &lt;textarea class="ux-textarea__field"
            name="content"
            hx-post="{% url 'save_draft' article.id %}"
            hx-trigger="keyup changed delay:1000ms"
            hx-swap="none"
            hx-indicator=".save-indicator"
            @htmx:before-request="saving = true; saved = false"
            @htmx:after-request="saving = false; saved = true"
            placeholder="Escribe tu articulo..."&gt;{{ article.content }}&lt;/textarea&gt;
  &lt;div class="ux-textarea__footer"&gt;
    &lt;span class="ux-textarea__helper"&gt;
      &lt;span x-show="saving" class="save-indicator"&gt;Guardando...&lt;/span&gt;
      &lt;span x-show="saved &amp;&amp; !saving"&gt;Borrador guardado&lt;/span&gt;
    &lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>

      <h4 style="font-weight: 600; margin: var(--ux-space-md) 0 var(--ux-space-sm);">Contador de caracteres dinamico</h4>
      <p>El servidor calcula y devuelve el conteo de caracteres en tiempo real.</p>
      <pre class="ux-code-block" data-lang="html">&lt;div class="ux-textarea"&gt;
  &lt;label class="ux-textarea__label"&gt;Descripcion (max 500 caracteres)&lt;/label&gt;
  &lt;textarea class="ux-textarea__field"
            name="description"
            hx-post="{% url 'char_count' %}"
            hx-trigger="keyup changed delay:300ms"
            hx-target="#char-counter"
            hx-swap="innerHTML"
            maxlength="500"
            placeholder="Describe tu producto..."&gt;&lt;/textarea&gt;
  &lt;div class="ux-textarea__footer"&gt;
    &lt;span class="ux-textarea__helper"&gt;Se conciso y descriptivo&lt;/span&gt;
    &lt;span id="char-counter" class="ux-textarea__counter"&gt;0/500&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>

      <h4 style="font-weight: 600; margin: var(--ux-space-md) 0 var(--ux-space-sm);">Vista Django para guardar borradores</h4>
      <pre class="ux-code-block" data-lang="python"># views.py
from django.http import HttpResponse
from django.views.decorators.http import require_POST
from django.contrib.auth.decorators import login_required
from .models import Article

@login_required
@require_POST
def save_draft(request, article_id):
    """Guarda el borrador del articulo automaticamente."""
    article = Article.objects.get(id=article_id, author=request.user)
    content = request.POST.get('content', '')

    article.content = content
    article.is_draft = True
    article.save(update_fields=['content', 'is_draft', 'updated_at'])

    return HttpResponse(status=204)  # No Content


@require_POST
def char_count(request):
    """Devuelve el conteo de caracteres para el textarea."""
    text = request.POST.get('description', '')
    count = len(text)
    max_length = 500

    # Clase CSS segun proximidad al limite
    css_class = ''
    if count >= max_length:
        css_class = 'ux-textarea__counter--error'
    elif count >= max_length * 0.9:
        css_class = 'ux-textarea__counter--warning'

    return HttpResponse(
        f'&lt;span class="{css_class}"&gt;{count}/{max_length}&lt;/span&gt;'
    )</pre>

      <h4 style="font-weight: 600; margin: var(--ux-space-md) 0 var(--ux-space-sm);">URLs de Django</h4>
      <pre class="ux-code-block" data-lang="python"># urls.py
from django.urls import path
from . import views

urlpatterns = [
    path('draft/&lt;int:article_id&gt;/save/', views.save_draft, name='save_draft'),
    path('utils/char-count/', views.char_count, name='char_count'),
]</pre>
    </section>

    <!-- API -->
    <section class="demo-section">
      <h3>API - Componente Alpine</h3>
      <div class="demo-box">
        <h4 style="font-weight: 600; margin-bottom: var(--ux-space-sm);">uxTextarea(config)</h4>
        <p><strong>Configuracion:</strong></p>
        <ul style="font-size: var(--ux-font-size-md); color: var(--ux-text-secondary); margin-left: var(--ux-space-lg); margin-bottom: var(--ux-space-md);">
          <li><code>value</code>: Valor inicial</li>
          <li><code>maxLength</code>: Maximo de caracteres</li>
          <li><code>minLength</code>: Minimo de caracteres</li>
          <li><code>autoResize</code>: Auto-ajustar altura (boolean)</li>
        </ul>
        <p><strong>Propiedades:</strong></p>
        <ul style="font-size: var(--ux-font-size-md); color: var(--ux-text-secondary); margin-left: var(--ux-space-lg); margin-bottom: var(--ux-space-md);">
          <li><code>charCount</code>: Cantidad de caracteres</li>
          <li><code>charRemaining</code>: Caracteres restantes</li>
          <li><code>isOverLimit</code>: Si excede el limite</li>
          <li><code>isNearLimit</code>: Si esta cerca del limite (10%)</li>
          <li><code>counterClass</code>: Clase CSS para el contador</li>
          <li><code>hasValue</code>: Si tiene contenido</li>
          <li><code>isValid</code>: Si es valido</li>
        </ul>
        <p><strong>Metodos:</strong></p>
        <ul style="font-size: var(--ux-font-size-md); color: var(--ux-text-secondary); margin-left: var(--ux-space-lg);">
          <li><code>clear()</code>: Limpiar contenido</li>
          <li><code>resize(el)</code>: Ajustar altura del elemento</li>
          <li><code>validate(rules)</code>: Validar con reglas</li>
          <li><code>required(msg)</code>: Validador requerido</li>
          <li><code>minLengthValidator(min, msg)</code>: Validador minimo</li>
          <li><code>maxLengthValidator(max, msg)</code>: Validador maximo</li>
          <li><code>pattern(regex, msg)</code>: Validador regex</li>
        </ul>
      </div>
    </section>

    <!-- Clases CSS -->
    <section class="demo-section">
      <h3>Clases CSS Disponibles</h3>
      <div class="demo-box">
        <table style="width: 100%; font-size: var(--ux-font-size-md);">
          <tr>
            <td><code>.ux-textarea</code></td>
            <td>Contenedor principal</td>
          </tr>
          <tr>
            <td><code>.ux-textarea__field</code></td>
            <td>Elemento textarea</td>
          </tr>
          <tr>
            <td><code>.ux-textarea__label</code></td>
            <td>Label del campo</td>
          </tr>
          <tr>
            <td><code>.ux-textarea__label--required</code></td>
            <td>Marca campo requerido (*)</td>
          </tr>
          <tr>
            <td><code>.ux-textarea__footer</code></td>
            <td>Contenedor para helper/counter</td>
          </tr>
          <tr>
            <td><code>.ux-textarea__helper</code></td>
            <td>Texto de ayuda</td>
          </tr>
          <tr>
            <td><code>.ux-textarea__counter</code></td>
            <td>Contador de caracteres</td>
          </tr>
          <tr>
            <td><code>.ux-textarea__error</code></td>
            <td>Mensaje de error</td>
          </tr>
          <tr>
            <td><code>.ux-textarea--sm</code></td>
            <td>Tamano pequeno</td>
          </tr>
          <tr>
            <td><code>.ux-textarea--lg</code></td>
            <td>Tamano grande</td>
          </tr>
          <tr>
            <td><code>.ux-textarea--floating</code></td>
            <td>Label flotante</td>
          </tr>
          <tr>
            <td><code>.ux-textarea--filled</code></td>
            <td>Variante filled</td>
          </tr>
          <tr>
            <td><code>.ux-textarea--borderless</code></td>
            <td>Sin bordes</td>
          </tr>
          <tr>
            <td><code>.ux-textarea--error</code></td>
            <td>Estado de error</td>
          </tr>
          <tr>
            <td><code>.ux-textarea--success</code></td>
            <td>Estado de exito</td>
          </tr>
          <tr>
            <td><code>.ux-textarea--no-resize</code></td>
            <td>Deshabilitar resize</td>
          </tr>
          <tr>
            <td><code>.ux-textarea--resize-both</code></td>
            <td>Resize en ambas direcciones</td>
          </tr>
          <tr>
            <td><code>.ux-textarea--auto-resize</code></td>
            <td>Auto-ajustar altura</td>
          </tr>
          <tr>
            <td><code>.ux-textarea--with-toolbar</code></td>
            <td>Con barra de herramientas</td>
          </tr>
        </table>
      </div>
    </section>
  </div>
</body>
</html>
