<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>BOM Tree - UX Library</title>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="../components/ux-core.js"></script>
  <script src="../components/ux-navbar.js"></script>
  <script src="../components/ux-button.js"></script>
  <script src="../components/ux-bom-tree.js"></script>
  <script src="../components/ux-code-block.js"></script>
  <style>
    .demo-section { margin-bottom: var(--ux-space-xl); padding: var(--ux-space-lg); }
    .demo-section h3 { font-size: var(--ux-font-size-lg); font-weight: 600; margin-bottom: var(--ux-space-md); color: var(--ux-text); }
    .demo-section p { font-size: var(--ux-font-size-md); color: var(--ux-text-secondary); margin-bottom: var(--ux-space-md); }
    .demo-box { background: var(--ux-surface); border-radius: var(--ux-border-radius-lg); padding: var(--ux-space-lg); margin-bottom: var(--ux-space-md); }
    .demo-controls { display: flex; gap: var(--ux-space-sm); margin-bottom: var(--ux-space-md); flex-wrap: wrap; }
  </style>
</head>
<body class="ux-app">
  <div class="demo-section">
    <h3>Basic BOM Tree</h3>
    <p>Hierarchical Bill of Materials tree with component types and quantities.</p>
    <div class="demo-box" x-data="uxBomTree({
      showStock: false,
      showCost: false,
      data: [
        {
          id: 'prod-001',
          sku: 'BIKE-MTN-001',
          name: 'Mountain Bike Pro',
          type: 'finished',
          quantity: 1,
          unit: 'pcs',
          children: [
            {
              id: 'frame-001',
              sku: 'FRAME-AL-27',
              name: 'Aluminum Frame 27.5\"',
              type: 'subassembly',
              quantity: 1,
              unit: 'pcs',
              children: [
                { id: 'tube-001', sku: 'TUBE-AL-6061', name: 'Aluminum Tube 6061-T6', type: 'raw', quantity: 3, unit: 'm' },
                { id: 'weld-001', sku: 'WELD-FILLER', name: 'Welding Filler Rod', type: 'consumable', quantity: 0.5, unit: 'kg' }
              ]
            },
            {
              id: 'wheel-001',
              sku: 'WHEEL-27-BLK',
              name: 'Wheel Assembly 27.5\" Black',
              type: 'subassembly',
              quantity: 2,
              unit: 'pcs',
              children: [
                { id: 'rim-001', sku: 'RIM-AL-27', name: 'Aluminum Rim', type: 'raw', quantity: 1, unit: 'pcs' },
                { id: 'tire-001', sku: 'TIRE-MTN-27', name: 'Mountain Tire 27.5x2.4', type: 'raw', quantity: 1, unit: 'pcs' },
                { id: 'spoke-001', sku: 'SPOKE-SS-280', name: 'Stainless Spokes 280mm', type: 'raw', quantity: 32, unit: 'pcs' }
              ]
            },
            { id: 'seat-001', sku: 'SEAT-SPORT-BLK', name: 'Sport Saddle Black', type: 'raw', quantity: 1, unit: 'pcs' },
            { id: 'hdlbar-001', sku: 'HBAR-AL-720', name: 'Handlebar 720mm', type: 'raw', quantity: 1, unit: 'pcs' }
          ]
        }
      ]
    })">
      <div class="ux-bom-tree ux-bom-tree--bordered">
        <!-- Header -->
        <div class="ux-bom-tree__header">
          <div class="ux-bom-tree__title">Bill of Materials</div>
          <div class="ux-bom-tree__actions">
            <button class="ux-bom-tree__action" @click="expandAll()" title="Expand All">
              <span x-html="icons.expandAll"></span>
            </button>
            <button class="ux-bom-tree__action" @click="collapseAll()" title="Collapse All">
              <span x-html="icons.collapseAll"></span>
            </button>
          </div>
        </div>

        <!-- Tree -->
        <ul class="ux-bom-tree__list">
          <template x-for="node in data" :key="node.id">
            <li class="ux-bom-tree__node">
              <div class="ux-bom-tree__item"
                   @click="toggle(node.id)"
                   :data-node-id="node.id">
                <span class="ux-bom-tree__toggle"
                      :class="{
                        'ux-bom-tree__toggle--expanded': expandedNodes.has(node.id),
                        'ux-bom-tree__toggle--empty': !node.children || node.children.length === 0
                      }"
                      x-html="icons.chevron"></span>
                <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (node.type || 'raw')"
                      x-html="getTypeIcon(node.type)"></span>
                <div class="ux-bom-tree__details">
                  <span class="ux-bom-tree__name" x-text="node.name"></span>
                  <span class="ux-bom-tree__sku" x-text="node.sku"></span>
                </div>
                <span class="ux-bom-tree__type" :class="'ux-bom-tree__type--' + (node.type || 'raw')" x-text="node.type || 'raw'"></span>
                <div class="ux-bom-tree__quantity">
                  <span class="ux-bom-tree__qty-value" x-text="node.quantity"></span>
                  <span class="ux-bom-tree__qty-unit" x-text="node.unit"></span>
                </div>
              </div>
              <!-- Level 2 -->
              <template x-if="node.children && node.children.length > 0 && expandedNodes.has(node.id)">
                <ul class="ux-bom-tree__list ux-bom-tree__list--nested">
                  <template x-for="child in node.children" :key="child.id">
                    <li class="ux-bom-tree__node">
                      <div class="ux-bom-tree__item" @click="toggle(child.id)">
                        <span class="ux-bom-tree__toggle"
                              :class="{
                                'ux-bom-tree__toggle--expanded': expandedNodes.has(child.id),
                                'ux-bom-tree__toggle--empty': !child.children || child.children.length === 0
                              }"
                              x-html="icons.chevron"></span>
                        <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (child.type || 'raw')"
                              x-html="getTypeIcon(child.type)"></span>
                        <div class="ux-bom-tree__details">
                          <span class="ux-bom-tree__name" x-text="child.name"></span>
                          <span class="ux-bom-tree__sku" x-text="child.sku"></span>
                        </div>
                        <span class="ux-bom-tree__type" :class="'ux-bom-tree__type--' + (child.type || 'raw')" x-text="child.type || 'raw'"></span>
                        <div class="ux-bom-tree__quantity">
                          <span class="ux-bom-tree__qty-value" x-text="child.quantity"></span>
                          <span class="ux-bom-tree__qty-unit" x-text="child.unit"></span>
                        </div>
                      </div>
                      <!-- Level 3 -->
                      <template x-if="child.children && child.children.length > 0 && expandedNodes.has(child.id)">
                        <ul class="ux-bom-tree__list ux-bom-tree__list--nested">
                          <template x-for="gc in child.children" :key="gc.id">
                            <li class="ux-bom-tree__node">
                              <div class="ux-bom-tree__item">
                                <span class="ux-bom-tree__toggle ux-bom-tree__toggle--empty" x-html="icons.chevron"></span>
                                <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (gc.type || 'raw')"
                                      x-html="getTypeIcon(gc.type)"></span>
                                <div class="ux-bom-tree__details">
                                  <span class="ux-bom-tree__name" x-text="gc.name"></span>
                                  <span class="ux-bom-tree__sku" x-text="gc.sku"></span>
                                </div>
                                <span class="ux-bom-tree__type" :class="'ux-bom-tree__type--' + (gc.type || 'raw')" x-text="gc.type || 'raw'"></span>
                                <div class="ux-bom-tree__quantity">
                                  <span class="ux-bom-tree__qty-value" x-text="gc.quantity"></span>
                                  <span class="ux-bom-tree__qty-unit" x-text="gc.unit"></span>
                                </div>
                              </div>
                            </li>
                          </template>
                        </ul>
                      </template>
                    </li>
                  </template>
                </ul>
              </template>
            </li>
          </template>
        </ul>

        <!-- Footer -->
        <div class="ux-bom-tree__footer">
          <div class="ux-bom-tree__summary">
            <div class="ux-bom-tree__summary-item">
              <span class="ux-bom-tree__summary-label">Components</span>
              <span class="ux-bom-tree__summary-value" x-text="countComponents()"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">&lt;div x-data="uxBomTree({
  data: [
    {
      id: 'prod-001',
      sku: 'BIKE-MTN-001',
      name: 'Mountain Bike Pro',
      type: 'finished',
      quantity: 1,
      unit: 'pcs',
      children: [
        { id: 'frame-001', sku: 'FRAME-AL-27', name: 'Aluminum Frame', type: 'subassembly', quantity: 1, unit: 'pcs', children: [...] },
        { id: 'wheel-001', sku: 'WHEEL-27-BLK', name: 'Wheel Assembly', type: 'subassembly', quantity: 2, unit: 'pcs', children: [...] }
      ]
    }
  ]
})"&gt;
  &lt;div class="ux-bom-tree ux-bom-tree--bordered"&gt;
    &lt;!-- BOM structure --&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
  </div>

  <div class="demo-section">
    <h3>With Stock Indicators</h3>
    <p>Display real-time stock status for each component with color-coded indicators.</p>
    <div class="demo-box" x-data="uxBomTree({
      showCost: false,
      lowStockThreshold: 15,
      data: [
        {
          id: 'chair-001',
          sku: 'CHAIR-OFC-BLK',
          name: 'Office Chair Ergonomic',
          type: 'finished',
          quantity: 1,
          unit: 'pcs',
          stock: 45,
          children: [
            { id: 'base-001', sku: 'BASE-5STAR', name: '5-Star Base Chrome', type: 'subassembly', quantity: 1, unit: 'pcs', stock: 120 },
            { id: 'caster-001', sku: 'CASTER-NYL', name: 'Nylon Casters', type: 'raw', quantity: 5, unit: 'pcs', stock: 8 },
            { id: 'gas-001', sku: 'GASLIFT-CL3', name: 'Gas Lift Class 3', type: 'raw', quantity: 1, unit: 'pcs', stock: 0 },
            { id: 'seat-001', sku: 'SEAT-FOAM', name: 'Seat Foam Cushion', type: 'raw', quantity: 1, unit: 'pcs', stock: 67 },
            { id: 'back-001', sku: 'BACK-MESH', name: 'Mesh Backrest', type: 'raw', quantity: 1, unit: 'pcs', stock: 12 },
            { id: 'arm-001', sku: 'ARM-ADJ-PR', name: 'Adjustable Armrests (Pair)', type: 'raw', quantity: 1, unit: 'pair', stock: 34 }
          ]
        }
      ]
    })">
      <div class="ux-bom-tree ux-bom-tree--bordered">
        <div class="ux-bom-tree__header">
          <div class="ux-bom-tree__title">Stock Status</div>
          <div class="ux-bom-tree__actions">
            <button class="ux-bom-tree__action" @click="expandAll()"><span x-html="icons.expandAll"></span></button>
            <button class="ux-bom-tree__action" @click="collapseAll()"><span x-html="icons.collapseAll"></span></button>
          </div>
        </div>
        <ul class="ux-bom-tree__list">
          <template x-for="node in data" :key="node.id">
            <li class="ux-bom-tree__node">
              <div class="ux-bom-tree__item" @click="toggle(node.id)">
                <span class="ux-bom-tree__toggle"
                      :class="{ 'ux-bom-tree__toggle--expanded': expandedNodes.has(node.id), 'ux-bom-tree__toggle--empty': !node.children }"
                      x-html="icons.chevron"></span>
                <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (node.type || 'raw')" x-html="getTypeIcon(node.type)"></span>
                <div class="ux-bom-tree__details">
                  <span class="ux-bom-tree__name" x-text="node.name"></span>
                  <span class="ux-bom-tree__sku" x-text="node.sku"></span>
                </div>
                <div class="ux-bom-tree__quantity">
                  <span class="ux-bom-tree__qty-value" x-text="node.quantity"></span>
                  <span class="ux-bom-tree__qty-unit" x-text="node.unit"></span>
                </div>
                <div class="ux-bom-tree__stock" :class="'ux-bom-tree__stock--' + getStockStatus(node)">
                  <span class="ux-bom-tree__stock-dot"></span>
                  <span class="ux-bom-tree__stock-text" x-text="node.stock + ' in stock'"></span>
                </div>
              </div>
              <template x-if="node.children && expandedNodes.has(node.id)">
                <ul class="ux-bom-tree__list ux-bom-tree__list--nested">
                  <template x-for="child in node.children" :key="child.id">
                    <li class="ux-bom-tree__node">
                      <div class="ux-bom-tree__item">
                        <span class="ux-bom-tree__toggle ux-bom-tree__toggle--empty" x-html="icons.chevron"></span>
                        <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (child.type || 'raw')" x-html="getTypeIcon(child.type)"></span>
                        <div class="ux-bom-tree__details">
                          <span class="ux-bom-tree__name" x-text="child.name"></span>
                          <span class="ux-bom-tree__sku" x-text="child.sku"></span>
                        </div>
                        <div class="ux-bom-tree__quantity">
                          <span class="ux-bom-tree__qty-value" x-text="child.quantity"></span>
                          <span class="ux-bom-tree__qty-unit" x-text="child.unit"></span>
                        </div>
                        <div class="ux-bom-tree__stock" :class="'ux-bom-tree__stock--' + getStockStatus(child)">
                          <span class="ux-bom-tree__stock-dot"></span>
                          <span class="ux-bom-tree__stock-text" x-text="child.stock + ' in stock'"></span>
                        </div>
                      </div>
                    </li>
                  </template>
                </ul>
              </template>
            </li>
          </template>
        </ul>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">&lt;!-- Stock status is determined by stock value and lowStockThreshold --&gt;
&lt;div x-data="uxBomTree({ lowStockThreshold: 15, data: [...] })"&gt;
  &lt;!-- Stock indicator --&gt;
  &lt;div class="ux-bom-tree__stock" :class="'ux-bom-tree__stock--' + getStockStatus(node)"&gt;
    &lt;span class="ux-bom-tree__stock-dot"&gt;&lt;/span&gt;
    &lt;span class="ux-bom-tree__stock-text" x-text="node.stock + ' in stock'"&gt;&lt;/span&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
  </div>

  <div class="demo-section">
    <h3>With Cost Display</h3>
    <p>Show unit costs and calculate cost rollups for each level of the BOM.</p>
    <div class="demo-box" x-data="uxBomTree({
      showStock: false,
      currency: '$',
      data: [
        {
          id: 'laptop-001',
          sku: 'LAPTOP-PRO-15',
          name: 'Laptop Pro 15\"',
          type: 'finished',
          quantity: 1,
          unit: 'pcs',
          unitCost: 0,
          children: [
            {
              id: 'screen-001',
              sku: 'LCD-15-4K',
              name: 'LCD Panel 15.6\" 4K',
              type: 'raw',
              quantity: 1,
              unit: 'pcs',
              unitCost: 189.99
            },
            {
              id: 'mb-001',
              sku: 'MB-INTEL-13',
              name: 'Motherboard Intel 13th Gen',
              type: 'subassembly',
              quantity: 1,
              unit: 'pcs',
              unitCost: 245.00,
              children: [
                { id: 'cpu-001', sku: 'CPU-I7-13', name: 'Intel Core i7-13700H', type: 'raw', quantity: 1, unit: 'pcs', unitCost: 420.00 },
                { id: 'ram-001', sku: 'RAM-DDR5-16', name: 'DDR5 RAM 16GB', type: 'raw', quantity: 2, unit: 'pcs', unitCost: 89.99 },
                { id: 'ssd-001', sku: 'SSD-NVME-1T', name: 'NVMe SSD 1TB', type: 'raw', quantity: 1, unit: 'pcs', unitCost: 119.99 }
              ]
            },
            {
              id: 'batt-001',
              sku: 'BATT-LI-72',
              name: 'Battery Pack 72Wh',
              type: 'raw',
              quantity: 1,
              unit: 'pcs',
              unitCost: 65.00
            },
            {
              id: 'case-001',
              sku: 'CASE-AL-15',
              name: 'Aluminum Chassis',
              type: 'raw',
              quantity: 1,
              unit: 'pcs',
              unitCost: 78.50
            },
            {
              id: 'kb-001',
              sku: 'KB-BACKLIT',
              name: 'Backlit Keyboard',
              type: 'raw',
              quantity: 1,
              unit: 'pcs',
              unitCost: 42.00
            }
          ]
        }
      ]
    })">
      <div class="ux-bom-tree ux-bom-tree--bordered">
        <div class="ux-bom-tree__header">
          <div class="ux-bom-tree__title">Cost Breakdown</div>
          <div class="ux-bom-tree__actions">
            <button class="ux-bom-tree__action" @click="expandAll()"><span x-html="icons.expandAll"></span></button>
            <button class="ux-bom-tree__action" @click="collapseAll()"><span x-html="icons.collapseAll"></span></button>
            <button class="ux-bom-tree__action" @click="exportBOM('csv')" title="Export CSV"><span x-html="icons.export"></span></button>
          </div>
        </div>
        <ul class="ux-bom-tree__list">
          <template x-for="node in data" :key="node.id">
            <li class="ux-bom-tree__node">
              <div class="ux-bom-tree__item" @click="toggle(node.id)">
                <span class="ux-bom-tree__toggle"
                      :class="{ 'ux-bom-tree__toggle--expanded': expandedNodes.has(node.id), 'ux-bom-tree__toggle--empty': !node.children }"
                      x-html="icons.chevron"></span>
                <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (node.type || 'raw')" x-html="getTypeIcon(node.type)"></span>
                <div class="ux-bom-tree__details">
                  <span class="ux-bom-tree__name" x-text="node.name"></span>
                  <span class="ux-bom-tree__sku" x-text="node.sku"></span>
                </div>
                <div class="ux-bom-tree__quantity">
                  <span class="ux-bom-tree__qty-value" x-text="node.quantity"></span>
                  <span class="ux-bom-tree__qty-unit" x-text="node.unit"></span>
                </div>
                <div class="ux-bom-tree__cost ux-bom-tree__cost--total">
                  <span class="ux-bom-tree__cost-value" x-text="formatCurrency(calculateRollupCost(node))"></span>
                  <span class="ux-bom-tree__cost-label">Total</span>
                </div>
              </div>
              <template x-if="node.children && expandedNodes.has(node.id)">
                <ul class="ux-bom-tree__list ux-bom-tree__list--nested">
                  <template x-for="child in node.children" :key="child.id">
                    <li class="ux-bom-tree__node">
                      <div class="ux-bom-tree__item" @click="toggle(child.id)">
                        <span class="ux-bom-tree__toggle"
                              :class="{ 'ux-bom-tree__toggle--expanded': expandedNodes.has(child.id), 'ux-bom-tree__toggle--empty': !child.children }"
                              x-html="icons.chevron"></span>
                        <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (child.type || 'raw')" x-html="getTypeIcon(child.type)"></span>
                        <div class="ux-bom-tree__details">
                          <span class="ux-bom-tree__name" x-text="child.name"></span>
                          <span class="ux-bom-tree__sku" x-text="child.sku"></span>
                        </div>
                        <div class="ux-bom-tree__quantity">
                          <span class="ux-bom-tree__qty-value" x-text="child.quantity"></span>
                          <span class="ux-bom-tree__qty-unit" x-text="child.unit"></span>
                        </div>
                        <div class="ux-bom-tree__cost">
                          <span class="ux-bom-tree__cost-value" x-text="formatCurrency(child.unitCost * child.quantity)"></span>
                          <span class="ux-bom-tree__cost-label" x-text="formatCurrency(child.unitCost) + '/ea'"></span>
                        </div>
                      </div>
                      <template x-if="child.children && expandedNodes.has(child.id)">
                        <ul class="ux-bom-tree__list ux-bom-tree__list--nested">
                          <template x-for="gc in child.children" :key="gc.id">
                            <li class="ux-bom-tree__node">
                              <div class="ux-bom-tree__item">
                                <span class="ux-bom-tree__toggle ux-bom-tree__toggle--empty" x-html="icons.chevron"></span>
                                <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (gc.type || 'raw')" x-html="getTypeIcon(gc.type)"></span>
                                <div class="ux-bom-tree__details">
                                  <span class="ux-bom-tree__name" x-text="gc.name"></span>
                                  <span class="ux-bom-tree__sku" x-text="gc.sku"></span>
                                </div>
                                <div class="ux-bom-tree__quantity">
                                  <span class="ux-bom-tree__qty-value" x-text="gc.quantity"></span>
                                  <span class="ux-bom-tree__qty-unit" x-text="gc.unit"></span>
                                </div>
                                <div class="ux-bom-tree__cost">
                                  <span class="ux-bom-tree__cost-value" x-text="formatCurrency(gc.unitCost * gc.quantity)"></span>
                                  <span class="ux-bom-tree__cost-label" x-text="formatCurrency(gc.unitCost) + '/ea'"></span>
                                </div>
                              </div>
                            </li>
                          </template>
                        </ul>
                      </template>
                    </li>
                  </template>
                </ul>
              </template>
            </li>
          </template>
        </ul>
        <div class="ux-bom-tree__footer">
          <div class="ux-bom-tree__summary">
            <div class="ux-bom-tree__summary-item">
              <span class="ux-bom-tree__summary-label">Components</span>
              <span class="ux-bom-tree__summary-value" x-text="countComponents()"></span>
            </div>
            <div class="ux-bom-tree__summary-item">
              <span class="ux-bom-tree__summary-label">Total Cost</span>
              <span class="ux-bom-tree__summary-value" style="color: var(--ux-primary);" x-text="formatCurrency(calculateTotalCost())"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="javascript">// Node structure with cost
{
  id: 'component-001',
  sku: 'PART-XYZ',
  name: 'Component Name',
  type: 'raw',           // raw, subassembly, finished, consumable, packaging
  quantity: 2,
  unit: 'pcs',
  unitCost: 49.99,       // Cost per unit
  stock: 100,            // Optional stock quantity
  children: []           // Optional child components
}

// Calculate costs
calculateTotalCost()     // Sum of all component costs
calculateRollupCost(node) // Cost including all children
formatCurrency(value)    // Format with currency symbol</pre>
  </div>

  <div class="demo-section">
    <h3>With Search</h3>
    <p>Filter components by name or SKU with real-time search.</p>
    <div class="demo-box" x-data="uxBomTree({
      showCost: false,
      showStock: false,
      data: [
        {
          id: 'desk-001',
          sku: 'DESK-STD-180',
          name: 'Standing Desk 180cm',
          type: 'finished',
          quantity: 1,
          unit: 'pcs',
          children: [
            { id: 'top-001', sku: 'TOP-BAMBOO-180', name: 'Bamboo Desktop 180x80cm', type: 'raw', quantity: 1, unit: 'pcs' },
            { id: 'leg-001', sku: 'LEG-ELEC-DUAL', name: 'Electric Dual Motor Legs', type: 'subassembly', quantity: 1, unit: 'set' },
            { id: 'ctrl-001', sku: 'CTRL-MEMORY-4', name: 'Memory Controller 4-Position', type: 'raw', quantity: 1, unit: 'pcs' },
            { id: 'cable-001', sku: 'CABLE-MGMT-KIT', name: 'Cable Management Kit', type: 'raw', quantity: 1, unit: 'set' },
            { id: 'screw-001', sku: 'SCREW-M6-PACK', name: 'M6 Screws Pack', type: 'consumable', quantity: 1, unit: 'pack' },
            { id: 'foot-001', sku: 'FOOT-ADJ-4', name: 'Adjustable Feet Set', type: 'raw', quantity: 4, unit: 'pcs' },
            { id: 'power-001', sku: 'POWER-CORD-2M', name: 'Power Cord 2m', type: 'raw', quantity: 1, unit: 'pcs' },
            { id: 'box-001', sku: 'BOX-DESK-LG', name: 'Packaging Box Large', type: 'packaging', quantity: 1, unit: 'pcs' }
          ]
        }
      ]
    })">
      <div class="ux-bom-tree ux-bom-tree--bordered">
        <div class="ux-bom-tree__header">
          <div class="ux-bom-tree__title">Component Search</div>
        </div>
        <div class="ux-bom-tree__search">
          <input type="text"
                 class="ux-bom-tree__search-input"
                 placeholder="Search by name or SKU..."
                 x-model="searchQuery">
        </div>
        <ul class="ux-bom-tree__list">
          <template x-for="node in filteredData" :key="node.id">
            <li class="ux-bom-tree__node">
              <div class="ux-bom-tree__item"
                   :class="{ 'ux-bom-tree__item--highlight': node._highlight }"
                   @click="toggle(node.id)">
                <span class="ux-bom-tree__toggle"
                      :class="{ 'ux-bom-tree__toggle--expanded': expandedNodes.has(node.id), 'ux-bom-tree__toggle--empty': !node.children }"
                      x-html="icons.chevron"></span>
                <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (node.type || 'raw')" x-html="getTypeIcon(node.type)"></span>
                <div class="ux-bom-tree__details">
                  <span class="ux-bom-tree__name" x-text="node.name"></span>
                  <span class="ux-bom-tree__sku" x-text="node.sku"></span>
                </div>
                <span class="ux-bom-tree__type" :class="'ux-bom-tree__type--' + (node.type || 'raw')" x-text="node.type || 'raw'"></span>
              </div>
              <template x-if="node.children && expandedNodes.has(node.id)">
                <ul class="ux-bom-tree__list ux-bom-tree__list--nested">
                  <template x-for="child in node.children" :key="child.id">
                    <li class="ux-bom-tree__node">
                      <div class="ux-bom-tree__item" :class="{ 'ux-bom-tree__item--highlight': child._highlight }">
                        <span class="ux-bom-tree__toggle ux-bom-tree__toggle--empty" x-html="icons.chevron"></span>
                        <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (child.type || 'raw')" x-html="getTypeIcon(child.type)"></span>
                        <div class="ux-bom-tree__details">
                          <span class="ux-bom-tree__name" x-text="child.name"></span>
                          <span class="ux-bom-tree__sku" x-text="child.sku"></span>
                        </div>
                        <span class="ux-bom-tree__type" :class="'ux-bom-tree__type--' + (child.type || 'raw')" x-text="child.type || 'raw'"></span>
                      </div>
                    </li>
                  </template>
                </ul>
              </template>
            </li>
          </template>
        </ul>
        <template x-if="filteredData.length === 0">
          <div class="ux-bom-tree__empty">
            <div class="ux-bom-tree__empty-icon" x-html="icons.empty"></div>
            <div class="ux-bom-tree__empty-title">No components found</div>
            <p>Try adjusting your search terms</p>
          </div>
        </template>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">&lt;!-- Search input --&gt;
&lt;div class="ux-bom-tree__search"&gt;
  &lt;input type="text" class="ux-bom-tree__search-input"
         placeholder="Search..." x-model="searchQuery"&gt;
&lt;/div&gt;

&lt;!-- Use filteredData instead of data --&gt;
&lt;template x-for="node in filteredData" :key="node.id"&gt;
  &lt;!-- Highlight matching items --&gt;
  &lt;div class="ux-bom-tree__item" :class="{ 'ux-bom-tree__item--highlight': node._highlight }"&gt;
    ...
  &lt;/div&gt;
&lt;/template&gt;</pre>
  </div>

  <div class="demo-section">
    <h3>Complete Example</h3>
    <p>Full-featured BOM tree with stock, cost, search, and level indicators.</p>
    <div class="demo-box" x-data="uxBomTree({
      currency: '$',
      lowStockThreshold: 20,
      selectable: true,
      data: [
        {
          id: 'tv-001',
          sku: 'TV-LED-55',
          name: 'LED TV 55\" 4K Smart',
          type: 'finished',
          quantity: 1,
          unit: 'pcs',
          unitCost: 0,
          stock: 28,
          children: [
            {
              id: 'panel-001',
              sku: 'PANEL-LED-55',
              name: 'LED Panel Assembly',
              type: 'subassembly',
              quantity: 1,
              unit: 'pcs',
              unitCost: 280.00,
              stock: 45,
              children: [
                { id: 'lcd-001', sku: 'LCD-55-4K', name: 'LCD Glass 55\" 4K', type: 'raw', quantity: 1, unit: 'pcs', unitCost: 195.00, stock: 62 },
                { id: 'led-001', sku: 'LED-STRIP-55', name: 'LED Backlight Strip', type: 'raw', quantity: 6, unit: 'pcs', unitCost: 12.50, stock: 340 },
                { id: 'diff-001', sku: 'DIFF-SHEET-55', name: 'Diffuser Sheet', type: 'raw', quantity: 1, unit: 'pcs', unitCost: 8.00, stock: 18 }
              ]
            },
            {
              id: 'main-001',
              sku: 'MAINBD-SMART',
              name: 'Smart TV Main Board',
              type: 'subassembly',
              quantity: 1,
              unit: 'pcs',
              unitCost: 95.00,
              stock: 67,
              children: [
                { id: 'proc-001', sku: 'PROC-QUAD', name: 'Quad-Core Processor', type: 'raw', quantity: 1, unit: 'pcs', unitCost: 45.00, stock: 89 },
                { id: 'mem-001', sku: 'MEM-2GB', name: 'Memory 2GB DDR4', type: 'raw', quantity: 1, unit: 'pcs', unitCost: 18.00, stock: 156 },
                { id: 'wifi-001', sku: 'WIFI-MODULE', name: 'WiFi/BT Module', type: 'raw', quantity: 1, unit: 'pcs', unitCost: 8.50, stock: 0 }
              ]
            },
            { id: 'psu-001', sku: 'PSU-TV-200W', name: 'Power Supply 200W', type: 'raw', quantity: 1, unit: 'pcs', unitCost: 32.00, stock: 78 },
            { id: 'spk-001', sku: 'SPK-STEREO-PR', name: 'Stereo Speakers (Pair)', type: 'raw', quantity: 1, unit: 'pair', unitCost: 15.00, stock: 92 },
            { id: 'case-001', sku: 'CASE-TV-55', name: 'Plastic Housing', type: 'raw', quantity: 1, unit: 'set', unitCost: 28.00, stock: 5 },
            { id: 'remote-001', sku: 'REMOTE-SMART', name: 'Smart Remote Control', type: 'raw', quantity: 1, unit: 'pcs', unitCost: 6.50, stock: 234 },
            { id: 'stand-001', sku: 'STAND-TV-55', name: 'TV Stand Base', type: 'raw', quantity: 1, unit: 'pcs', unitCost: 12.00, stock: 47 },
            { id: 'pack-001', sku: 'PACK-TV-55', name: 'Packaging Kit', type: 'packaging', quantity: 1, unit: 'set', unitCost: 18.00, stock: 52 }
          ]
        }
      ]
    })" @bom:select="console.log('Selected:', $event.detail)">
      <div class="ux-bom-tree ux-bom-tree--bordered">
        <div class="ux-bom-tree__header">
          <div class="ux-bom-tree__title">Manufacturing BOM</div>
          <div class="ux-bom-tree__actions">
            <button class="ux-bom-tree__action" @click="expandAll()" title="Expand All"><span x-html="icons.expandAll"></span></button>
            <button class="ux-bom-tree__action" @click="collapseAll()" title="Collapse All"><span x-html="icons.collapseAll"></span></button>
            <button class="ux-bom-tree__action" @click="exportBOM('json')" title="Export"><span x-html="icons.export"></span></button>
          </div>
        </div>
        <div class="ux-bom-tree__search">
          <input type="text" class="ux-bom-tree__search-input" placeholder="Search components..." x-model="searchQuery">
        </div>
        <ul class="ux-bom-tree__list">
          <template x-for="node in filteredData" :key="node.id">
            <li class="ux-bom-tree__node">
              <div class="ux-bom-tree__item"
                   :class="{
                     'ux-bom-tree__item--selected': selectedNode === node.id,
                     'ux-bom-tree__item--highlight': node._highlight
                   }"
                   @click="toggle(node.id); select(node.id, node)">
                <span class="ux-bom-tree__toggle"
                      :class="{ 'ux-bom-tree__toggle--expanded': expandedNodes.has(node.id), 'ux-bom-tree__toggle--empty': !node.children }"
                      x-html="icons.chevron"></span>
                <div class="ux-bom-tree__level">
                  <span class="ux-bom-tree__level-bar ux-bom-tree__level-bar--l1"></span>
                </div>
                <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (node.type || 'raw')" x-html="getTypeIcon(node.type)"></span>
                <div class="ux-bom-tree__details">
                  <span class="ux-bom-tree__name" x-text="node.name"></span>
                  <span class="ux-bom-tree__sku" x-text="node.sku"></span>
                </div>
                <div class="ux-bom-tree__quantity">
                  <span class="ux-bom-tree__qty-value" x-text="node.quantity"></span>
                  <span class="ux-bom-tree__qty-unit" x-text="node.unit"></span>
                </div>
                <div class="ux-bom-tree__stock" :class="'ux-bom-tree__stock--' + getStockStatus(node)">
                  <span class="ux-bom-tree__stock-dot"></span>
                  <span class="ux-bom-tree__stock-text" x-text="node.stock"></span>
                </div>
                <div class="ux-bom-tree__cost ux-bom-tree__cost--total">
                  <span class="ux-bom-tree__cost-value" x-text="formatCurrency(calculateRollupCost(node))"></span>
                </div>
              </div>
              <template x-if="node.children && expandedNodes.has(node.id)">
                <ul class="ux-bom-tree__list ux-bom-tree__list--nested">
                  <template x-for="child in node.children" :key="child.id">
                    <li class="ux-bom-tree__node">
                      <div class="ux-bom-tree__item"
                           :class="{ 'ux-bom-tree__item--selected': selectedNode === child.id }"
                           @click="toggle(child.id); select(child.id, child)">
                        <span class="ux-bom-tree__toggle"
                              :class="{ 'ux-bom-tree__toggle--expanded': expandedNodes.has(child.id), 'ux-bom-tree__toggle--empty': !child.children }"
                              x-html="icons.chevron"></span>
                        <div class="ux-bom-tree__level">
                          <span class="ux-bom-tree__level-bar ux-bom-tree__level-bar--l1"></span>
                          <span class="ux-bom-tree__level-bar ux-bom-tree__level-bar--l2"></span>
                        </div>
                        <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (child.type || 'raw')" x-html="getTypeIcon(child.type)"></span>
                        <div class="ux-bom-tree__details">
                          <span class="ux-bom-tree__name" x-text="child.name"></span>
                          <span class="ux-bom-tree__sku" x-text="child.sku"></span>
                        </div>
                        <div class="ux-bom-tree__quantity">
                          <span class="ux-bom-tree__qty-value" x-text="child.quantity"></span>
                          <span class="ux-bom-tree__qty-unit" x-text="child.unit"></span>
                        </div>
                        <div class="ux-bom-tree__stock" :class="'ux-bom-tree__stock--' + getStockStatus(child)">
                          <span class="ux-bom-tree__stock-dot"></span>
                          <span class="ux-bom-tree__stock-text" x-text="child.stock"></span>
                        </div>
                        <div class="ux-bom-tree__cost">
                          <span class="ux-bom-tree__cost-value" x-text="formatCurrency(child.unitCost * child.quantity)"></span>
                        </div>
                      </div>
                      <template x-if="child.children && expandedNodes.has(child.id)">
                        <ul class="ux-bom-tree__list ux-bom-tree__list--nested">
                          <template x-for="gc in child.children" :key="gc.id">
                            <li class="ux-bom-tree__node">
                              <div class="ux-bom-tree__item"
                                   :class="{ 'ux-bom-tree__item--selected': selectedNode === gc.id }"
                                   @click="select(gc.id, gc)">
                                <span class="ux-bom-tree__toggle ux-bom-tree__toggle--empty" x-html="icons.chevron"></span>
                                <div class="ux-bom-tree__level">
                                  <span class="ux-bom-tree__level-bar ux-bom-tree__level-bar--l1"></span>
                                  <span class="ux-bom-tree__level-bar ux-bom-tree__level-bar--l2"></span>
                                  <span class="ux-bom-tree__level-bar ux-bom-tree__level-bar--l3"></span>
                                </div>
                                <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (gc.type || 'raw')" x-html="getTypeIcon(gc.type)"></span>
                                <div class="ux-bom-tree__details">
                                  <span class="ux-bom-tree__name" x-text="gc.name"></span>
                                  <span class="ux-bom-tree__sku" x-text="gc.sku"></span>
                                </div>
                                <div class="ux-bom-tree__quantity">
                                  <span class="ux-bom-tree__qty-value" x-text="gc.quantity"></span>
                                  <span class="ux-bom-tree__qty-unit" x-text="gc.unit"></span>
                                </div>
                                <div class="ux-bom-tree__stock" :class="'ux-bom-tree__stock--' + getStockStatus(gc)">
                                  <span class="ux-bom-tree__stock-dot"></span>
                                  <span class="ux-bom-tree__stock-text" x-text="gc.stock"></span>
                                </div>
                                <div class="ux-bom-tree__cost">
                                  <span class="ux-bom-tree__cost-value" x-text="formatCurrency(gc.unitCost * gc.quantity)"></span>
                                </div>
                              </div>
                            </li>
                          </template>
                        </ul>
                      </template>
                    </li>
                  </template>
                </ul>
              </template>
            </li>
          </template>
        </ul>
        <div class="ux-bom-tree__footer">
          <div class="ux-bom-tree__summary">
            <div class="ux-bom-tree__summary-item">
              <span class="ux-bom-tree__summary-label">Components</span>
              <span class="ux-bom-tree__summary-value" x-text="countComponents()"></span>
            </div>
            <div class="ux-bom-tree__summary-item">
              <span class="ux-bom-tree__summary-label">Total Cost</span>
              <span class="ux-bom-tree__summary-value" style="color: var(--ux-primary);" x-text="formatCurrency(calculateTotalCost())"></span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="demo-section">
    <h3>Glass Variant</h3>
    <p>Glass morphism style for modern interfaces.</p>
    <div class="demo-box" style="background: linear-gradient(135deg, var(--ux-primary-tint) 0%, var(--ux-tertiary-tint) 100%); padding: var(--ux-space-xl);">
      <div x-data="uxBomTree({
        showStock: false,
        showCost: false,
        data: [
          {
            id: 'phone-001',
            sku: 'PHONE-PRO-256',
            name: 'Smartphone Pro 256GB',
            type: 'finished',
            quantity: 1,
            unit: 'pcs',
            children: [
              { id: 'screen-001', sku: 'OLED-6.7', name: 'OLED Display 6.7\"', type: 'raw', quantity: 1, unit: 'pcs' },
              { id: 'chip-001', sku: 'SOC-A17', name: 'A17 Bionic Chip', type: 'raw', quantity: 1, unit: 'pcs' },
              { id: 'batt-001', sku: 'BATT-4500', name: 'Battery 4500mAh', type: 'raw', quantity: 1, unit: 'pcs' },
              { id: 'cam-001', sku: 'CAM-TRIPLE', name: 'Triple Camera Module', type: 'subassembly', quantity: 1, unit: 'pcs' }
            ]
          }
        ]
      })">
        <div class="ux-bom-tree ux-bom-tree--glass">
          <div class="ux-bom-tree__header">
            <div class="ux-bom-tree__title">Glass Style BOM</div>
            <div class="ux-bom-tree__actions">
              <button class="ux-bom-tree__action" @click="expandAll()"><span x-html="icons.expandAll"></span></button>
              <button class="ux-bom-tree__action" @click="collapseAll()"><span x-html="icons.collapseAll"></span></button>
            </div>
          </div>
          <ul class="ux-bom-tree__list">
            <template x-for="node in data" :key="node.id">
              <li class="ux-bom-tree__node">
                <div class="ux-bom-tree__item" @click="toggle(node.id)">
                  <span class="ux-bom-tree__toggle"
                        :class="{ 'ux-bom-tree__toggle--expanded': expandedNodes.has(node.id), 'ux-bom-tree__toggle--empty': !node.children }"
                        x-html="icons.chevron"></span>
                  <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (node.type || 'raw')" x-html="getTypeIcon(node.type)"></span>
                  <div class="ux-bom-tree__details">
                    <span class="ux-bom-tree__name" x-text="node.name"></span>
                    <span class="ux-bom-tree__sku" x-text="node.sku"></span>
                  </div>
                  <span class="ux-bom-tree__type" :class="'ux-bom-tree__type--' + (node.type || 'raw')" x-text="node.type"></span>
                </div>
                <template x-if="node.children && expandedNodes.has(node.id)">
                  <ul class="ux-bom-tree__list ux-bom-tree__list--nested">
                    <template x-for="child in node.children" :key="child.id">
                      <li class="ux-bom-tree__node">
                        <div class="ux-bom-tree__item">
                          <span class="ux-bom-tree__toggle ux-bom-tree__toggle--empty" x-html="icons.chevron"></span>
                          <span class="ux-bom-tree__icon" :class="'ux-bom-tree__icon--' + (child.type || 'raw')" x-html="getTypeIcon(child.type)"></span>
                          <div class="ux-bom-tree__details">
                            <span class="ux-bom-tree__name" x-text="child.name"></span>
                            <span class="ux-bom-tree__sku" x-text="child.sku"></span>
                          </div>
                          <span class="ux-bom-tree__type" :class="'ux-bom-tree__type--' + (child.type || 'raw')" x-text="child.type"></span>
                        </div>
                      </li>
                    </template>
                  </ul>
                </template>
              </li>
            </template>
          </ul>
        </div>
      </div>
    </div>
    <pre class="ux-code-block" data-lang="html">&lt;div class="ux-bom-tree ux-bom-tree--glass"&gt;
  &lt;!-- Glass morphism style --&gt;
&lt;/div&gt;</pre>
  </div>

  <div class="demo-section">
    <h3>Component Types</h3>
    <p>Available component type icons and their intended usage.</p>
    <div class="demo-box">
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--ux-space-md);">
        <div style="display: flex; align-items: center; gap: var(--ux-space-sm); padding: var(--ux-space-sm); background: var(--ux-surface-secondary); border-radius: var(--ux-radius-md);">
          <span class="ux-bom-tree__icon ux-bom-tree__icon--raw" x-data x-html="window.UX.bomTreeIcons.raw"></span>
          <div>
            <div style="font-weight: 600;">Raw Material</div>
            <div style="font-size: var(--ux-font-size-xs); color: var(--ux-text-secondary);">Basic materials, metals, plastics</div>
          </div>
        </div>
        <div style="display: flex; align-items: center; gap: var(--ux-space-sm); padding: var(--ux-space-sm); background: var(--ux-surface-secondary); border-radius: var(--ux-radius-md);">
          <span class="ux-bom-tree__icon ux-bom-tree__icon--subassembly" x-data x-html="window.UX.bomTreeIcons.subassembly"></span>
          <div>
            <div style="font-weight: 600;">Sub-Assembly</div>
            <div style="font-size: var(--ux-font-size-xs); color: var(--ux-text-secondary);">Pre-assembled components</div>
          </div>
        </div>
        <div style="display: flex; align-items: center; gap: var(--ux-space-sm); padding: var(--ux-space-sm); background: var(--ux-surface-secondary); border-radius: var(--ux-radius-md);">
          <span class="ux-bom-tree__icon ux-bom-tree__icon--finished" x-data x-html="window.UX.bomTreeIcons.finished"></span>
          <div>
            <div style="font-weight: 600;">Finished Product</div>
            <div style="font-size: var(--ux-font-size-xs); color: var(--ux-text-secondary);">Complete sellable items</div>
          </div>
        </div>
        <div style="display: flex; align-items: center; gap: var(--ux-space-sm); padding: var(--ux-space-sm); background: var(--ux-surface-secondary); border-radius: var(--ux-radius-md);">
          <span class="ux-bom-tree__icon ux-bom-tree__icon--consumable" x-data x-html="window.UX.bomTreeIcons.consumable"></span>
          <div>
            <div style="font-weight: 600;">Consumable</div>
            <div style="font-size: var(--ux-font-size-xs); color: var(--ux-text-secondary);">Welding, adhesives, fluids</div>
          </div>
        </div>
        <div style="display: flex; align-items: center; gap: var(--ux-space-sm); padding: var(--ux-space-sm); background: var(--ux-surface-secondary); border-radius: var(--ux-radius-md);">
          <span class="ux-bom-tree__icon ux-bom-tree__icon--packaging" x-data x-html="window.UX.bomTreeIcons.packaging"></span>
          <div>
            <div style="font-weight: 600;">Packaging</div>
            <div style="font-size: var(--ux-font-size-xs); color: var(--ux-text-secondary);">Boxes, wrapping, labels</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="demo-section">
    <h3>API Reference</h3>
    <div class="demo-box">
      <pre class="ux-code-block" data-lang="javascript">// Configuration Options
uxBomTree({
  data: [],                    // Array of BOM nodes
  showSearch: true,            // Show search input
  showCost: true,              // Show cost columns
  showStock: true,             // Show stock status
  showLevels: true,            // Show level indicators
  showTypes: true,             // Show type badges
  currency: '$',               // Currency symbol
  currencyPosition: 'before',  // 'before' or 'after'
  lowStockThreshold: 10,       // Threshold for low stock warning
  draggable: false,            // Enable drag to reorder
  selectable: false,           // Enable node selection
  expanded: []                 // Array of initially expanded node IDs
})

// Node Structure
{
  id: 'unique-id',             // Required: Unique identifier
  sku: 'PART-123',             // Optional: SKU/part number
  name: 'Component Name',      // Required: Display name
  type: 'raw',                 // 'raw', 'subassembly', 'finished', 'consumable', 'packaging'
  quantity: 1,                 // Required: Quantity needed
  unit: 'pcs',                 // Unit of measure
  unitCost: 49.99,             // Optional: Cost per unit
  stock: 100,                  // Optional: Current stock level
  lowThreshold: 20,            // Optional: Custom low stock threshold
  children: []                 // Optional: Child components
}

// Methods
toggle(nodeId)                 // Expand/collapse node
expandAll()                    // Expand all nodes
collapseAll()                  // Collapse all nodes
select(nodeId, node)           // Select a node (if selectable)
getStockStatus(node)           // Get stock status string
formatCurrency(value)          // Format number as currency
calculateTotalCost()           // Sum all component costs
calculateRollupCost(node)      // Cost including children
countComponents()              // Count total components
exportBOM(format)              // Export as 'json' or 'csv'
findNode(nodeId)               // Find node by ID

// Events
@bom:toggle                    // Node expanded/collapsed
@bom:expand-all                // All nodes expanded
@bom:collapse-all              // All nodes collapsed
@bom:select                    // Node selected
@bom:reorder                   // Drag reorder completed
@bom:export                    // BOM exported</pre>
    </div>
  </div>

  <div class="demo-section">
    <h3>HTMX + Django</h3>
    <p>Load BOM tree data from Django and enable lazy loading of child nodes.</p>
    <pre class="ux-code-block" data-lang="html">&lt;!-- Load BOM tree from Django --&gt;
&lt;div id="bom-container"
     hx-get="{% url 'bom:tree' product_id=product.id %}"
     hx-trigger="load"
     hx-swap="innerHTML"&gt;
  &lt;div class="ux-spinner"&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;!-- BOM tree with lazy loading of children --&gt;
&lt;div x-data="uxBomTree({ data: [] })"
     x-init="data = JSON.parse($el.dataset.bom)"
     data-bom="{{ bom_data|escapejs }}"&gt;
  &lt;div class="ux-bom-tree ux-bom-tree--bordered"&gt;
    &lt;ul class="ux-bom-tree__list"&gt;
      &lt;template x-for="node in data" :key="node.id"&gt;
        &lt;li class="ux-bom-tree__node"&gt;
          &lt;div class="ux-bom-tree__item"
               @click="toggle(node.id)"
               hx-get="{% url 'bom:children' %}?node_id=${node.id}"
               hx-trigger="click once"
               hx-target="next .ux-bom-tree__list--nested"
               hx-swap="innerHTML"&gt;
            &lt;span class="ux-bom-tree__name" x-text="node.name"&gt;&lt;/span&gt;
          &lt;/div&gt;
          &lt;ul class="ux-bom-tree__list ux-bom-tree__list--nested"&gt;&lt;/ul&gt;
        &lt;/li&gt;
      &lt;/template&gt;
    &lt;/ul&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Update stock via HTMX --&gt;
&lt;button hx-patch="{% url 'bom:update-stock' node.id %}"
        hx-vals='{"stock": 50}'
        hx-target="#node-{{ node.id }}"
        hx-swap="outerHTML"
        class="ux-button ux-button--sm"&gt;
  Update Stock
&lt;/button&gt;</pre>
    <pre class="ux-code-block" data-lang="python"># views.py
from django.http import JsonResponse
from django.shortcuts import render
from django.views.decorators.http import require_http_methods
import json

def bom_tree_view(request, product_id):
    """Render BOM tree page with initial data."""
    product = Product.objects.get(id=product_id)
    bom_data = get_bom_tree(product)
    return render(request, 'bom/tree.html', {
        'product': product,
        'bom_data': json.dumps(bom_data)
    })

def bom_tree_data(request, product_id):
    """Return BOM tree as HTML partial for HTMX."""
    product = Product.objects.get(id=product_id)
    bom_data = get_bom_tree(product)
    return render(request, 'bom/partials/tree.html', {
        'bom_data': json.dumps(bom_data)
    })

def bom_children(request):
    """Lazy load children for a BOM node."""
    node_id = request.GET.get('node_id')
    node = BomNode.objects.get(id=node_id)
    children = node.children.select_related('component').all()
    return render(request, 'bom/partials/children.html', {
        'children': children
    })

@require_http_methods(["PATCH"])
def update_stock(request, node_id):
    """Update stock quantity for a component."""
    node = BomNode.objects.get(id=node_id)
    data = json.loads(request.body)
    node.component.stock = data.get('stock', 0)
    node.component.save()
    return render(request, 'bom/partials/node.html', {'node': node})

def get_bom_tree(product, max_depth=3):
    """Build hierarchical BOM tree structure."""
    def build_node(bom_item, depth=0):
        node = {
            'id': str(bom_item.id),
            'sku': bom_item.component.sku,
            'name': bom_item.component.name,
            'type': bom_item.component.component_type,
            'quantity': float(bom_item.quantity),
            'unit': bom_item.unit,
            'unitCost': float(bom_item.component.unit_cost or 0),
            'stock': bom_item.component.stock or 0,
        }
        if depth &lt; max_depth:
            children = bom_item.component.bom_children.all()
            if children.exists():
                node['children'] = [build_node(c, depth + 1) for c in children]
        return node

    root_items = product.bom_items.filter(parent__isnull=True)
    return [build_node(item) for item in root_items]

# urls.py
from django.urls import path
from . import views

app_name = 'bom'
urlpatterns = [
    path('&lt;int:product_id&gt;/', views.bom_tree_view, name='tree'),
    path('&lt;int:product_id&gt;/data/', views.bom_tree_data, name='tree-data'),
    path('children/', views.bom_children, name='children'),
    path('node/&lt;int:node_id&gt;/stock/', views.update_stock, name='update-stock'),
]</pre>
  </div>

  <div class="demo-section">
    <h3>CSS Classes</h3>
    <div class="demo-box">
      <pre class="ux-code-block" data-lang="css">/* Base */
.ux-bom-tree                   /* Container */
.ux-bom-tree--bordered         /* With border */
.ux-bom-tree--glass            /* Glass morphism */
.ux-bom-tree--sm               /* Small size */
.ux-bom-tree--lg               /* Large size */
.ux-bom-tree--compact          /* Compact spacing */

/* Structure */
.ux-bom-tree__header           /* Header with title and actions */
.ux-bom-tree__search           /* Search input container */
.ux-bom-tree__list             /* List container */
.ux-bom-tree__list--nested     /* Nested list (indented) */
.ux-bom-tree__node             /* Node container */
.ux-bom-tree__item             /* Item row */
.ux-bom-tree__footer           /* Footer with summary */

/* Item States */
.ux-bom-tree__item--selected   /* Selected state */
.ux-bom-tree__item--highlight  /* Search match highlight */
.ux-bom-tree__item--dragging   /* Being dragged */
.ux-bom-tree__item--drag-over  /* Drop target */

/* Elements */
.ux-bom-tree__toggle           /* Expand/collapse arrow */
.ux-bom-tree__icon             /* Component type icon */
.ux-bom-tree__details          /* Name and SKU container */
.ux-bom-tree__name             /* Component name */
.ux-bom-tree__sku              /* SKU/part number */
.ux-bom-tree__quantity         /* Quantity display */
.ux-bom-tree__stock            /* Stock status indicator */
.ux-bom-tree__cost             /* Cost display */
.ux-bom-tree__type             /* Type badge */
.ux-bom-tree__level            /* Level indicator bars */

/* Type Modifiers */
.ux-bom-tree__icon--raw
.ux-bom-tree__icon--subassembly
.ux-bom-tree__icon--finished
.ux-bom-tree__icon--consumable
.ux-bom-tree__icon--packaging

/* Stock Status */
.ux-bom-tree__stock--in-stock
.ux-bom-tree__stock--low-stock
.ux-bom-tree__stock--out-of-stock</pre>
    </div>
  </div>
</body>
</html>
