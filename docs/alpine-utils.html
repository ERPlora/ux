<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Alpine Utils - UX Library</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap-grid.min.css">
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="../components/ux-core.js"></script>
  <script src="../components/ux-button.js"></script>
  <script src="../components/ux-navbar.js"></script>
  <script src="../components/ux-content.js"></script>
  <script src="../components/ux-input.js"></script>
  <script src="../components/ux-modal.js"></script>
  <script src="../components/ux-sheet.js"></script>
  <script src="../components/ux-list.js"></script>
  <script src="../components/ux-card.js"></script>
  <script src="../components/ux-alpine-utils.js"></script>
  <script src="../components/ux-code-block.js"></script>
  <style>
    .demo-section { margin-bottom: var(--ux-space-xl); }
    .demo-section h3 {
      font-size: var(--ux-font-size-lg);
      font-weight: 600;
      margin-bottom: var(--ux-space-md);
      color: var(--ux-text);
    }
    .demo-section p {
      font-size: var(--ux-font-size-md);
      color: var(--ux-text-secondary);
      margin-bottom: var(--ux-space-md);
    }
    .demo-box {
      background: var(--ux-surface);
      border-radius: var(--ux-border-radius-lg);
      padding: var(--ux-space-lg);
      margin-bottom: var(--ux-space-md);
    }
    .demo-box--flex {
      display: flex;
      flex-wrap: wrap;
      gap: var(--ux-space-md);
    }
    .demo-result {
      margin-top: var(--ux-space-md);
      padding: var(--ux-space-md);
      background: var(--ux-surface-secondary);
      border-radius: var(--ux-border-radius);
      font-family: monospace;
      font-size: var(--ux-font-size-sm);
      min-height: 44px;
      display: flex;
      align-items: center;
    }
    .focus-trap-demo {
      border: 2px dashed var(--ux-border-color);
      border-radius: var(--ux-border-radius-lg);
      padding: var(--ux-space-lg);
    }
    .focus-trap-demo[data-focus-trapped] {
      border-color: var(--ux-primary);
      border-style: solid;
    }
    .click-outside-box {
      padding: var(--ux-space-xl);
      background: var(--ux-primary-tint);
      border-radius: var(--ux-border-radius-lg);
      text-align: center;
      color: var(--ux-primary);
      font-weight: 500;
    }
    .copy-target {
      padding: var(--ux-space-md);
      background: var(--ux-surface-secondary);
      border-radius: var(--ux-border-radius);
      font-family: monospace;
      margin-bottom: var(--ux-space-md);
    }
    .scroll-content {
      height: 300px;
      overflow-y: auto;
      border: 1px solid var(--ux-border-color);
      border-radius: var(--ux-border-radius);
    }
    .scroll-content__inner {
      height: 800px;
      padding: var(--ux-space-lg);
      background: linear-gradient(180deg, var(--ux-primary-tint), var(--ux-surface));
    }
  </style>
</head>
<body class="ux-app">

  <div class="ux-content" style="padding: var(--ux-space-lg);">
    <h1 style="margin-bottom: var(--ux-space-lg);">Alpine Utils</h1>
    <p style="color: var(--ux-text-secondary); margin-bottom: var(--ux-space-xl);">
      Utility directives and magic helpers for Alpine.js. Focus trap, click outside detection, scroll lock, clipboard, debounce and throttle.
    </p>

    <!-- Installation -->
    <section class="demo-section">
      <h3>Installation</h3>
      <p>Load after ux-core.js and Alpine.js:</p>
      <pre class="ux-code-block" data-lang="html">&lt;script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"&gt;&lt;/script&gt;
&lt;script src="components/ux-core.js"&gt;&lt;/script&gt;
&lt;script src="components/ux-alpine-utils.js"&gt;&lt;/script&gt;</pre>
    </section>

    <!-- Focus Trap -->
    <section class="demo-section">
      <h3>x-focus-trap</h3>
      <p>Traps keyboard focus within an element. Press Tab to cycle through focusable elements. Useful for modals and dialogs.</p>

      <div class="demo-box" x-data="{ isTrapActive: false }">
        <button class="ux-button ux-color-primary" @click="isTrapActive = !isTrapActive" x-text="isTrapActive ? 'Disable Focus Trap' : 'Enable Focus Trap'"></button>

        <div class="focus-trap-demo" x-focus-trap="isTrapActive" style="margin-top: var(--ux-space-lg);">
          <p style="margin-bottom: var(--ux-space-md); color: var(--ux-text-secondary);">Focus is trapped inside this box when active. Try pressing Tab.</p>
          <div style="display: flex; gap: var(--ux-space-sm); flex-wrap: wrap;">
            <input type="text" class="ux-input" placeholder="First input" style="flex: 1; min-width: 150px;">
            <input type="text" class="ux-input" placeholder="Second input" style="flex: 1; min-width: 150px;">
          </div>
          <div style="display: flex; gap: var(--ux-space-sm); margin-top: var(--ux-space-md);">
            <button class="ux-button">Button 1</button>
            <button class="ux-button">Button 2</button>
            <button class="ux-button ux-color-danger" @click="isTrapActive = false">Close Trap</button>
          </div>
        </div>
      </div>

      <pre class="ux-code-block" data-lang="html">&lt;!-- Conditional focus trap --&gt;
&lt;div x-data="{ isOpen: false }"&gt;
  &lt;button @click="isOpen = true"&gt;Open&lt;/button&gt;

  &lt;div class="modal" x-show="isOpen" x-focus-trap="isOpen"&gt;
    &lt;input type="text"&gt;
    &lt;button @click="isOpen = false"&gt;Close&lt;/button&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Always active trap --&gt;
&lt;div x-focus-trap&gt;
  &lt;!-- Focus always trapped here --&gt;
&lt;/div&gt;</pre>
    </section>

    <!-- Focus Trap with Modal -->
    <section class="demo-section">
      <h3>Focus Trap with Modal</h3>
      <p>Example of using focus trap with a modal component.</p>

      <div class="demo-box" x-data="uxModal()">
        <button class="ux-button ux-color-primary" @click="open()">Open Modal with Focus Trap</button>

        <template x-teleport="body">
          <div class="ux-modal-backdrop" :class="isOpen && 'ux-modal-backdrop--open'" @click="handleBackdropClick($event)" x-scroll-lock="isOpen">
            <div class="container-fluid">
              <div class="row justify-content-center align-items-center" style="min-height: 100vh;">
                <div class="col-12 col-md-6 col-lg-4">
                  <div class="ux-modal" @click.stop x-show="isOpen" x-focus-trap="isOpen" @keydown.escape="close()">
                    <div class="ux-modal__handle"></div>
                    <div class="ux-modal__header">
                      <h2 class="ux-modal__title">Focus Trapped Modal</h2>
                      <button class="ux-modal__close" @click="close()">
                        <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                        </svg>
                      </button>
                    </div>
                    <div class="ux-modal__content">
                      <p style="margin-bottom: var(--ux-space-md);">Press Tab to cycle through inputs. Focus cannot leave this modal.</p>
                      <div class="ux-input" style="margin-bottom: var(--ux-space-md);">
                        <input type="text" placeholder=" ">
                        <label>Name</label>
                      </div>
                      <div class="ux-input">
                        <input type="email" placeholder=" ">
                        <label>Email</label>
                      </div>
                    </div>
                    <div class="ux-modal__footer">
                      <button class="ux-button" @click="close()">Cancel</button>
                      <button class="ux-button ux-color-primary" @click="close()">Save</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </template>
      </div>

      <pre class="ux-code-block" data-lang="html">&lt;div x-data="uxModal()" x-scroll-lock="isOpen"&gt;
  &lt;div class="ux-modal"
       x-show="isOpen"
       x-focus-trap="isOpen"
       @keydown.escape="close()"&gt;
    &lt;!-- Modal content --&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
    </section>

    <!-- Click Outside -->
    <section class="demo-section">
      <h3>x-click-outside</h3>
      <p>Detects clicks outside an element. Perfect for closing dropdowns, popovers, and menus.</p>

      <div class="demo-box" x-data="{ isOpen: false, clickCount: 0 }">
        <button class="ux-button ux-color-primary" @click="isOpen = true">Open Box</button>
        <span style="margin-left: var(--ux-space-md); color: var(--ux-text-secondary);">
          Outside clicks: <strong x-text="clickCount"></strong>
        </span>

        <div x-show="isOpen"
             x-click-outside="isOpen = false; clickCount++"
             x-transition
             class="click-outside-box"
             style="margin-top: var(--ux-space-lg);">
          Click outside this box to close it
        </div>
      </div>

      <pre class="ux-code-block" data-lang="html">&lt;!-- Basic usage --&gt;
&lt;div x-data="{ isOpen: false }"&gt;
  &lt;button @click="isOpen = true"&gt;Open&lt;/button&gt;

  &lt;div x-show="isOpen" x-click-outside="isOpen = false"&gt;
    Click outside to close
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- With ignore selector (clicks on trigger don't close) --&gt;
&lt;div x-click-outside.ignore.#trigger="close()"&gt;
  ...
&lt;/div&gt;</pre>
    </section>

    <!-- Click Outside with Dropdown -->
    <section class="demo-section">
      <h3>Click Outside Dropdown</h3>
      <p>Common pattern for dropdown menus.</p>

      <div class="demo-box" x-data="{ isOpen: false }">
        <div style="position: relative; display: inline-block;">
          <button id="dropdown-trigger" class="ux-button" @click="isOpen = !isOpen">
            Dropdown Menu
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-left: var(--ux-space-xs);">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
            </svg>
          </button>

          <div x-show="isOpen"
               x-click-outside="isOpen = false"
               x-transition:enter="transition ease-out duration-200"
               x-transition:enter-start="opacity-0 transform scale-95"
               x-transition:enter-end="opacity-100 transform scale-100"
               x-transition:leave="transition ease-in duration-150"
               x-transition:leave-start="opacity-100 transform scale-100"
               x-transition:leave-end="opacity-0 transform scale-95"
               style="position: absolute; top: 100%; left: 0; min-width: 200px; margin-top: var(--ux-space-xs); z-index: 100;">
            <ul class="ux-list ux-list--inset" style="box-shadow: var(--ux-shadow-lg);">
              <li class="ux-list__item" @click="isOpen = false">Profile</li>
              <li class="ux-list__item" @click="isOpen = false">Settings</li>
              <li class="ux-list__item" @click="isOpen = false">Help</li>
              <li class="ux-list__divider"></li>
              <li class="ux-list__item" style="color: var(--ux-danger);" @click="isOpen = false">Logout</li>
            </ul>
          </div>
        </div>
      </div>
    </section>

    <!-- Scroll Lock -->
    <section class="demo-section">
      <h3>x-scroll-lock</h3>
      <p>Prevents body scroll when active. Handles iOS scroll quirks automatically. Useful for modals and overlays.</p>

      <div class="demo-box" x-data="{ isLocked: false }">
        <button class="ux-button ux-color-primary"
                @click="isLocked = !isLocked"
                x-text="isLocked ? 'Unlock Scroll' : 'Lock Scroll'"></button>
        <span style="margin-left: var(--ux-space-md); color: var(--ux-text-secondary);">
          Try scrolling the page when locked
        </span>

        <div x-scroll-lock="isLocked"></div>
      </div>

      <pre class="ux-code-block" data-lang="html">&lt;!-- Conditional scroll lock --&gt;
&lt;div x-data="{ isOpen: false }"&gt;
  &lt;div x-scroll-lock="isOpen"&gt;&lt;/div&gt;
  &lt;div class="modal" x-show="isOpen"&gt;...&lt;/div&gt;
&lt;/div&gt;

&lt;!-- Or use magic helper --&gt;
&lt;button @click="$scrollLock.lock()"&gt;Lock&lt;/button&gt;
&lt;button @click="$scrollLock.unlock()"&gt;Unlock&lt;/button&gt;</pre>
    </section>

    <!-- Clipboard -->
    <section class="demo-section">
      <h3>x-clipboard</h3>
      <p>Copy text to clipboard with optional visual feedback.</p>

      <div class="demo-box">
        <div class="copy-target" id="copy-source">npm install @ux/components</div>

        <div style="display: flex; gap: var(--ux-space-md); flex-wrap: wrap;">
          <!-- Copy static text -->
          <button class="ux-button" x-clipboard="'Hello World!'">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: var(--ux-space-xs);">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
            </svg>
            Copy "Hello World!"
          </button>

          <!-- Copy from target element -->
          <button class="ux-button" x-clipboard:target="'#copy-source'">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: var(--ux-space-xs);">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
            </svg>
            Copy Install Command
          </button>
        </div>
      </div>

      <pre class="ux-code-block" data-lang="html">&lt;!-- Copy static text --&gt;
&lt;button x-clipboard="'Hello World!'"&gt;Copy&lt;/button&gt;

&lt;!-- Copy dynamic value --&gt;
&lt;button x-clipboard="someVariable"&gt;Copy&lt;/button&gt;

&lt;!-- Copy from target element --&gt;
&lt;div id="source"&gt;Text to copy&lt;/div&gt;
&lt;button x-clipboard:target="'#source'"&gt;Copy&lt;/button&gt;

&lt;!-- Without feedback toast --&gt;
&lt;button x-clipboard.no-feedback="text"&gt;Copy&lt;/button&gt;

&lt;!-- Listen to events --&gt;
&lt;button x-clipboard="text"
        @clipboard:success="console.log('Copied:', $event.detail.text)"
        @clipboard:error="console.error($event.detail.error)"&gt;
  Copy
&lt;/button&gt;</pre>
    </section>

    <!-- Clipboard with Dynamic Content -->
    <section class="demo-section">
      <h3>Clipboard with Dynamic Content</h3>
      <p>Copy dynamically generated content using the magic helper.</p>

      <div class="demo-box" x-data="{
        items: ['Item 1', 'Item 2', 'Item 3'],
        shareUrl: 'https://example.com/shared/abc123',
        async copyShare() {
          const success = await $clipboard(this.shareUrl, { message: 'Link copied!' });
          if (success) {
            // Optional: show additional feedback
          }
        }
      }">
        <div style="display: flex; gap: var(--ux-space-md); flex-wrap: wrap; margin-bottom: var(--ux-space-lg);">
          <button class="ux-button ux-color-primary" @click="copyShare()">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: var(--ux-space-xs);">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"/>
            </svg>
            Share Link
          </button>

          <button class="ux-button" @click="$clipboard(items.join('\n'), { message: 'List copied!' })">
            <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24" style="margin-right: var(--ux-space-xs);">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
            </svg>
            Copy List
          </button>
        </div>

        <ul class="ux-list ux-list--inset">
          <template x-for="item in items" :key="item">
            <li class="ux-list__item" style="display: flex; justify-content: space-between; align-items: center;">
              <span x-text="item"></span>
              <button class="ux-button ux-button--sm" x-clipboard="item">Copy</button>
            </li>
          </template>
        </ul>
      </div>

      <pre class="ux-code-block" data-lang="html">&lt;!-- Using $clipboard magic --&gt;
&lt;button @click="$clipboard('text', { message: 'Done!' })"&gt;
  Copy
&lt;/button&gt;

&lt;!-- With async/await --&gt;
&lt;button @click="
  const success = await $clipboard(dynamicText);
  if (success) showNotification();
"&gt;
  Copy
&lt;/button&gt;</pre>
    </section>

    <!-- Debounce -->
    <section class="demo-section">
      <h3>$debounce</h3>
      <p>Delays function execution until after a period of inactivity. Perfect for search inputs.</p>

      <div class="demo-box" x-data="{
        searchQuery: '',
        searchResult: 'Type to search...',
        searchCount: 0,
        search(query) {
          this.searchCount++;
          this.searchResult = `Searching for '${query}' (search #${this.searchCount})`;
        },
        get debouncedSearch() {
          return $debounce((query) => this.search(query), 500);
        }
      }">
        <div class="ux-input" style="margin-bottom: var(--ux-space-md);">
          <input type="text"
                 placeholder=" "
                 x-model="searchQuery"
                 @input="debouncedSearch(searchQuery)">
          <label>Search (debounced 500ms)</label>
        </div>
        <div class="demo-result" x-text="searchResult"></div>
      </div>

      <pre class="ux-code-block" data-lang="html">&lt;div x-data="{
  search(query) { /* API call */ },
  get debouncedSearch() {
    return $debounce((q) =&gt; this.search(q), 500);
  }
}"&gt;
  &lt;input @input="debouncedSearch($el.value)"&gt;
&lt;/div&gt;

&lt;!-- Debounce methods --&gt;
&lt;script&gt;
const fn = $debounce(myFunc, 300);
fn();         // Schedules execution
fn.cancel();  // Cancels pending execution
fn.flush();   // Executes immediately
&lt;/script&gt;</pre>
    </section>

    <!-- Throttle -->
    <section class="demo-section">
      <h3>$throttle</h3>
      <p>Limits function execution to once per time period. Perfect for scroll and resize handlers.</p>

      <div class="demo-box" x-data="{
        scrollY: 0,
        updateCount: 0,
        get throttledScroll() {
          return $throttle(() => {
            this.updateCount++;
          }, 200);
        }
      }">
        <p style="margin-bottom: var(--ux-space-md); color: var(--ux-text-secondary);">
          Scroll the box below. Updates are throttled to max 5 per second.
        </p>

        <div class="scroll-content" @scroll="throttledScroll()">
          <div class="scroll-content__inner">
            <p style="position: sticky; top: var(--ux-space-md);">
              Throttled updates: <strong x-text="updateCount"></strong>
            </p>
          </div>
        </div>
      </div>

      <pre class="ux-code-block" data-lang="html">&lt;div x-data="{
  handleScroll() { /* expensive operation */ },
  get throttledScroll() {
    return $throttle(() =&gt; this.handleScroll(), 200);
  }
}"&gt;
  &lt;div @scroll="throttledScroll()"&gt;
    Scrollable content
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Window scroll example --&gt;
&lt;div x-data @scroll.window="$throttle(() =&gt; handleScroll(), 100)()"&gt;
  ...
&lt;/div&gt;</pre>
    </section>

    <!-- Debounce vs Throttle -->
    <section class="demo-section">
      <h3>Debounce vs Throttle</h3>
      <p>Interactive comparison of debounce and throttle behavior.</p>

      <div class="demo-box" x-data="{
        rawCount: 0,
        debounceCount: 0,
        throttleCount: 0,
        get debounced() {
          return $debounce(() => this.debounceCount++, 300);
        },
        get throttled() {
          return $throttle(() => this.throttleCount++, 300);
        },
        handleClick() {
          this.rawCount++;
          this.debounced();
          this.throttled();
        },
        reset() {
          this.rawCount = 0;
          this.debounceCount = 0;
          this.throttleCount = 0;
        }
      }">
        <div style="display: flex; gap: var(--ux-space-md); margin-bottom: var(--ux-space-lg);">
          <button class="ux-button ux-color-primary" @click="handleClick()">Click rapidly!</button>
          <button class="ux-button" @click="reset()">Reset</button>
        </div>

        <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: var(--ux-space-md);">
          <div class="ux-card">
            <div class="ux-card__content" style="text-align: center;">
              <div style="font-size: var(--ux-font-size-2xl); font-weight: 700; color: var(--ux-text);" x-text="rawCount"></div>
              <div style="color: var(--ux-text-secondary); font-size: var(--ux-font-size-sm);">Raw clicks</div>
            </div>
          </div>
          <div class="ux-card">
            <div class="ux-card__content" style="text-align: center;">
              <div style="font-size: var(--ux-font-size-2xl); font-weight: 700; color: var(--ux-primary);" x-text="debounceCount"></div>
              <div style="color: var(--ux-text-secondary); font-size: var(--ux-font-size-sm);">Debounced (300ms)</div>
            </div>
          </div>
          <div class="ux-card">
            <div class="ux-card__content" style="text-align: center;">
              <div style="font-size: var(--ux-font-size-2xl); font-weight: 700; color: var(--ux-success);" x-text="throttleCount"></div>
              <div style="color: var(--ux-text-secondary); font-size: var(--ux-font-size-sm);">Throttled (300ms)</div>
            </div>
          </div>
        </div>

        <p style="margin-top: var(--ux-space-lg); color: var(--ux-text-secondary); font-size: var(--ux-font-size-sm);">
          <strong>Debounce:</strong> Waits for pause in activity before executing (fires once at end).<br>
          <strong>Throttle:</strong> Executes at regular intervals during activity (fires multiple times).
        </p>
      </div>
    </section>

    <!-- All Magic Helpers -->
    <section class="demo-section">
      <h3>Magic Helpers Reference</h3>
      <p>All available magic helpers at a glance.</p>

      <pre class="ux-code-block" data-lang="javascript">// Debounce - delays execution until pause
const search = $debounce(fn, 300);
search();         // Schedule
search.cancel();  // Cancel pending
search.flush();   // Execute now

// Throttle - limits execution rate
const scroll = $throttle(fn, 200);
scroll();         // Execute (if not throttled)
scroll.cancel();  // Cancel pending trailing call

// Clipboard - copy to clipboard
await $clipboard('text');
await $clipboard('text', { feedback: true, message: 'Copied!' });

// Scroll Lock - prevent body scroll
$scrollLock.lock();
$scrollLock.unlock();
$scrollLock.isLocked; // boolean

// Focus Trap - trap focus in container
const cleanup = $focusTrap(element);
cleanup(); // Remove trap and restore focus</pre>
    </section>

    <!-- All Directives -->
    <section class="demo-section">
      <h3>Directives Reference</h3>
      <p>All available directives at a glance.</p>

      <pre class="ux-code-block" data-lang="html">&lt;!-- Focus Trap --&gt;
&lt;div x-focus-trap="isOpen"&gt;...&lt;/div&gt;
&lt;div x-focus-trap&gt;...&lt;/div&gt;

&lt;!-- Click Outside --&gt;
&lt;div x-click-outside="close()"&gt;...&lt;/div&gt;
&lt;div x-click-outside.ignore.#trigger="close()"&gt;...&lt;/div&gt;

&lt;!-- Scroll Lock --&gt;
&lt;div x-scroll-lock="isOpen"&gt;&lt;/div&gt;
&lt;div x-scroll-lock&gt;&lt;/div&gt;

&lt;!-- Clipboard --&gt;
&lt;button x-clipboard="'text'"&gt;Copy&lt;/button&gt;
&lt;button x-clipboard="variable"&gt;Copy&lt;/button&gt;
&lt;button x-clipboard:target="'#element'"&gt;Copy from element&lt;/button&gt;</pre>
    </section>

    <!-- HTMX + Django Integration -->
    <section class="demo-section">
      <h3>HTMX + Django Integration</h3>
      <p>Use Alpine Utils directives with HTMX for server-rendered components. Common patterns for Django backends.</p>

      <div class="demo-box">
        <p style="margin-bottom: var(--ux-space-md); color: var(--ux-text-secondary);">
          Combine HTMX requests with Alpine.js directives for interactive server-rendered UIs.
        </p>
      </div>

      <h4 style="font-size: var(--ux-font-size-md); font-weight: 600; margin-bottom: var(--ux-space-md); color: var(--ux-text);">HTML Template with Django + HTMX</h4>
      <pre class="ux-code-block" data-lang="html">&lt;!-- Django template: modal-form.html --&gt;
&lt;div x-data="{ isOpen: false, isLoading: false }"
     @htmx:configRequest="isLoading = true"
     @htmx:afterRequest="isLoading = false"&gt;

  &lt;button class="ux-button ux-color-primary"
          @click="isOpen = true"&gt;
    Add User
  &lt;/button&gt;

  &lt;template x-teleport="body"&gt;
    &lt;div class="ux-modal-backdrop"
         :class="isOpen && 'ux-modal-backdrop--open'"
         @click="isOpen = false"&gt;
      &lt;div class="ux-modal"
           @click.stop
           x-show="isOpen"
           x-focus-trap="isOpen"
           x-scroll-lock="isOpen"&gt;

        &lt;div class="ux-modal__header"&gt;
          &lt;h2 class="ux-modal__title"&gt;Create User&lt;/h2&gt;
          &lt;button class="ux-modal__close" @click="isOpen = false"&gt;
            &lt;svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24"&gt;
              &lt;path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/&gt;
            &lt;/svg&gt;
          &lt;/button&gt;
        &lt;/div&gt;

        &lt;!-- Form loaded via HTMX --&gt;
        &lt;div class="ux-modal__content"
             hx-get="{% url 'user_form' %}"
             hx-trigger="revealed"&gt;
          &lt;div class="ux-spinner"&gt;&lt;/div&gt;
        &lt;/div&gt;

        &lt;div class="ux-modal__footer"&gt;
          &lt;button class="ux-button" @click="isOpen = false"&gt;
            Cancel
          &lt;/button&gt;
          &lt;button class="ux-button ux-color-primary"
                  form="user-form"
                  type="submit"
                  :class="isLoading && 'ux-button--loading'"
                  :disabled="isLoading"&gt;
            &lt;span class="ux-spinner" x-show="isLoading"&gt;&lt;/span&gt;
            Save
          &lt;/button&gt;
        &lt;/div&gt;

      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/template&gt;

&lt;/div&gt;</pre>

      <h4 style="font-size: var(--ux-font-size-md); font-weight: 600; margin-bottom: var(--ux-space-md); margin-top: var(--ux-space-lg); color: var(--ux-text);">Django Form Template</h4>
      <pre class="ux-code-block" data-lang="html">&lt;!-- Django template: user_form.html (rendered by view) --&gt;
&lt;form id="user-form"
      hx-post="{% url 'create_user' %}"
      hx-target="closest .ux-modal"
      hx-swap="outerHTML"&gt;

  {% csrf_token %}

  &lt;div class="ux-input" style="margin-bottom: var(--ux-space-md);"&gt;
    &lt;input type="text"
           name="username"
           id="id_username"
           placeholder=" "
           required&gt;
    &lt;label for="id_username"&gt;Username&lt;/label&gt;
    {% if form.username.errors %}
      &lt;div style="color: var(--ux-danger); font-size: var(--ux-font-size-sm); margin-top: 4px;"&gt;
        {{ form.username.errors }}
      &lt;/div&gt;
    {% endif %}
  &lt;/div&gt;

  &lt;div class="ux-input" style="margin-bottom: var(--ux-space-md);"&gt;
    &lt;input type="email"
           name="email"
           id="id_email"
           placeholder=" "
           required&gt;
    &lt;label for="id_email"&gt;Email&lt;/label&gt;
    {% if form.email.errors %}
      &lt;div style="color: var(--ux-danger); font-size: var(--ux-font-size-sm); margin-top: 4px;"&gt;
        {{ form.email.errors }}
      &lt;/div&gt;
    {% endif %}
  &lt;/div&gt;

  &lt;!-- Search with autocomplete --&gt;
  &lt;div class="ux-input" style="margin-bottom: var(--ux-space-md); position: relative;"
       x-data="{ open: false }"&gt;
    &lt;input type="text"
           name="department"
           id="id_department"
           placeholder=" "
           hx-get="{% url 'search_departments' %}"
           hx-trigger="input changed delay:300ms"
           hx-target="next .dropdown-menu"
           @focus="open = true"
           @keydown.escape="open = false"&gt;
    &lt;label for="id_department"&gt;Department&lt;/label&gt;

    &lt;div class="dropdown-menu"
         style="position: absolute; top: 100%; left: 0; right: 0; margin-top: 4px; z-index: 10;"
         x-show="open"
         x-click-outside="open = false"&gt;
      &lt;ul class="ux-list ux-list--inset"&gt;
        &lt;!-- Results loaded via HTMX --&gt;
      &lt;/ul&gt;
    &lt;/div&gt;
  &lt;/div&gt;

&lt;/form&gt;</pre>

      <h4 style="font-size: var(--ux-font-size-md); font-weight: 600; margin-bottom: var(--ux-space-md); margin-top: var(--ux-space-lg); color: var(--ux-text);">Django Views</h4>
      <pre class="ux-code-block" data-lang="python"># views.py
from django.shortcuts import render
from django.http import HttpResponse
from django.views.decorators.http import require_http_methods
from .forms import UserForm
from .models import User, Department

@require_http_methods(["GET"])
def user_form(request):
    """Return empty form for creating user"""
    form = UserForm()
    return render(request, 'user_form.html', {'form': form})

@require_http_methods(["POST"])
def create_user(request):
    """Create user and return updated modal or errors"""
    form = UserForm(request.POST)
    if form.is_valid():
        user = form.save()
        # Return success message or redirect
        return HttpResponse(
            f'&lt;div class="ux-modal-backdrop ux-modal-backdrop--open"&gt;'
            f'&lt;div class="ux-modal"&gt;'
            f'&lt;div class="ux-modal__header"&gt;&lt;h2&gt;Success&lt;/h2&gt;&lt;/div&gt;'
            f'&lt;div class="ux-modal__content"&gt;User created successfully!&lt;/div&gt;'
            f'&lt;/div&gt;&lt;/div&gt;',
            headers={'HX-Trigger': 'closeModal'}
        )
    else:
        # Return form with errors
        return render(request, 'user_form.html', {'form': form}, status=400)

@require_http_methods(["GET"])
def search_departments(request):
    """Search departments for autocomplete"""
    query = request.GET.get('department', '')
    departments = Department.objects.filter(name__icontains=query)[:10]

    html = ''
    for dept in departments:
        html += f'&lt;li class="ux-list__item" hx-get="#" hx-vals={{"department": "{dept.name}"}}&gt;{dept.name}&lt;/li&gt;'

    return HttpResponse(html)</pre>

      <h4 style="font-size: var(--ux-font-size-md); font-weight: 600; margin-bottom: var(--ux-space-md); margin-top: var(--ux-space-lg); color: var(--ux-text);">Common HTMX + Alpine Patterns</h4>
      <pre class="ux-code-block" data-lang="html">&lt;!-- Toast notification on success --&gt;
&lt;form hx-post="/api/submit"
      hx-on="htmx:responseError: showError($event)"
      hx-on="htmx:xhr:loadend:
        if(event.detail.xhr.status === 200) {
          $dispatch('toast', {message: 'Saved!', type: 'success'});
        }"&gt;
  ...
&lt;/form&gt;

&lt;!-- Debounced search --&gt;
&lt;input type="text"
       hx-get="/api/search"
       hx-trigger="input changed delay:500ms"
       hx-target="#results"&gt;

&lt;!-- Click outside to close dropdown --&gt;
&lt;div x-data="{ open: false }"&gt;
  &lt;button @click="open = !open"&gt;Menu&lt;/button&gt;

  &lt;div x-show="open"
       x-click-outside="open = false"
       hx-get="/api/menu"
       hx-trigger="revealed"&gt;
    &lt;!-- Menu items --&gt;
  &lt;/div&gt;
&lt;/div&gt;

&lt;!-- Focus trap in modal loaded via HTMX --&gt;
&lt;div class="ux-modal"
     x-focus-trap
     hx-get="/api/modal-content"
     hx-trigger="revealed"&gt;
  &lt;div class="ux-spinner"&gt;&lt;/div&gt;
&lt;/div&gt;</pre>

    </section>

  </div>

</body>
</html>
