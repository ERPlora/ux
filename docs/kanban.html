<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Kanban Board - UX Library</title>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="../components/ux-core.js"></script>
  <script src="../components/ux-navbar.js"></script>
  <script src="../components/ux-button.js"></script>
  <script src="../components/ux-badge.js"></script>
  <script src="../components/ux-avatar.js"></script>
  <script src="../components/ux-kanban.js"></script>
  <style>
    .demo-section { margin-bottom: var(--ux-space-xl); padding: var(--ux-space-lg); }
    .demo-section h3 { font-size: var(--ux-font-size-lg); font-weight: 600; margin-bottom: var(--ux-space-md); }
    .demo-section p { font-size: var(--ux-font-size-md); color: var(--ux-text-secondary); margin-bottom: var(--ux-space-md); }
    .demo-box { background: var(--ux-surface-secondary); border-radius: var(--ux-border-radius-lg); margin-bottom: var(--ux-space-md); overflow: hidden; }
    .code-block { background: #1a1a2e; color: #e5e5e5; padding: var(--ux-space-md); border-radius: var(--ux-border-radius); font-family: monospace; font-size: var(--ux-font-size-sm); overflow-x: auto; white-space: pre; }
  </style>
</head>
<body class="ux-app">

  <!-- Basic Kanban -->
  <div class="demo-section">
    <h3>Kanban Basico</h3>
    <p>Tablero kanban con columnas y tarjetas arrastrables. Drag and drop entre columnas.</p>

    <div class="demo-box" x-data="uxKanban({
      columns: [
        { id: 'todo', title: 'Por hacer', color: '#6b7280', cards: [] },
        { id: 'progress', title: 'En progreso', color: '#3b82f6', cards: [] },
        { id: 'review', title: 'En revision', color: '#f59e0b', cards: [] },
        { id: 'done', title: 'Completado', color: '#10b981', cards: [] }
      ],
      cards: [
        { id: 1, columnId: 'todo', title: 'Disenar mockups de la nueva feature' },
        { id: 2, columnId: 'todo', title: 'Revisar documentacion del API' },
        { id: 3, columnId: 'progress', title: 'Implementar login con OAuth' },
        { id: 4, columnId: 'progress', title: 'Crear tests unitarios' },
        { id: 5, columnId: 'review', title: 'Refactorizar modulo de pagos' },
        { id: 6, columnId: 'done', title: 'Configurar CI/CD pipeline' },
        { id: 7, columnId: 'done', title: 'Actualizar dependencias' }
      ]
    })" class="ux-kanban"
       @kanban:move.window="console.log('Card moved:', $event.detail)">

      <template x-for="column in columns" :key="column.id">
        <div class="ux-kanban__column"
             :class="{ 'ux-kanban__column--drag-over': isColumnDragOver(column.id) }"
             @dragover="onDragOver(column.id, $event)"
             @dragleave="onDragLeave(column.id, $event)"
             @drop="onDrop(column.id, null, $event)">

          <!-- Column Header -->
          <div class="ux-kanban__column-header">
            <div class="ux-kanban__column-header-start">
              <div class="ux-kanban__column-color" :style="{ background: column.color }"></div>
              <h4 class="ux-kanban__column-title" x-text="column.title"></h4>
              <span class="ux-kanban__column-count" x-text="getColumnCount(column.id)"></span>
            </div>
            <div class="ux-kanban__column-actions">
              <button class="ux-kanban__column-btn" title="Mas opciones">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <circle cx="12" cy="12" r="1"/>
                  <circle cx="12" cy="5" r="1"/>
                  <circle cx="12" cy="19" r="1"/>
                </svg>
              </button>
            </div>
          </div>

          <!-- Column Body -->
          <div class="ux-kanban__column-body" :data-empty-text="emptyText">
            <template x-for="card in column.cards" :key="card.id">
              <div class="ux-kanban__card"
                   draggable="true"
                   @dragstart="onDragStart(card, column.id, $event)"
                   @dragend="onDragEnd($event)"
                   @click="onCardClick(card, column.id, $event)">
                <h5 class="ux-kanban__card-title" x-text="card.title"></h5>
              </div>
            </template>
          </div>

          <!-- Column Footer -->
          <div class="ux-kanban__column-footer" x-show="allowAddCards">
            <button class="ux-kanban__add-btn" @click="addCard(column.id, { title: 'Nueva tarea' })">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 5v14M5 12h14"/>
              </svg>
              Agregar tarjeta
            </button>
          </div>
        </div>
      </template>
    </div>

    <pre class="code-block">&lt;div x-data="uxKanban({
  columns: [
    { id: 'todo', title: 'Por hacer', cards: [] },
    { id: 'progress', title: 'En progreso', cards: [] },
    { id: 'done', title: 'Completado', cards: [] }
  ],
  cards: [
    { id: 1, columnId: 'todo', title: 'Tarea 1' },
    { id: 2, columnId: 'progress', title: 'Tarea 2' }
  ]
})" class="ux-kanban"&gt;
  &lt;template x-for="column in columns"&gt;
    &lt;div class="ux-kanban__column"&gt;
      &lt;!-- Column content --&gt;
    &lt;/div&gt;
  &lt;/template&gt;
&lt;/div&gt;</pre>
  </div>

  <!-- Rich Cards -->
  <div class="demo-section">
    <h3>Tarjetas con Detalles</h3>
    <p>Tarjetas con etiquetas, asignados, fechas y prioridad.</p>

    <div class="demo-box">
      <div class="ux-kanban" x-data="{
        columns: [
          { id: 'backlog', title: 'Backlog', color: '#6b7280' },
          { id: 'sprint', title: 'Sprint Actual', color: '#3b82f6' },
          { id: 'testing', title: 'Testing', color: '#8b5cf6' }
        ]
      }">
        <!-- Backlog Column -->
        <div class="ux-kanban__column ux-kanban__column--todo">
          <div class="ux-kanban__column-header">
            <div class="ux-kanban__column-header-start">
              <div class="ux-kanban__column-color"></div>
              <h4 class="ux-kanban__column-title">Backlog</h4>
              <span class="ux-kanban__column-count">3</span>
            </div>
          </div>
          <div class="ux-kanban__column-body">
            <!-- Card with labels -->
            <div class="ux-kanban__card ux-kanban__card--color ux-kanban__card--color-danger">
              <div class="ux-kanban__card-labels">
                <span class="ux-kanban__card-label ux-kanban__card-label--danger">Bug</span>
                <span class="ux-kanban__card-label ux-kanban__card-label--primary">Frontend</span>
              </div>
              <h5 class="ux-kanban__card-title">Error en formulario de registro</h5>
              <p class="ux-kanban__card-body">El boton de submit no funciona en Safari</p>
              <div class="ux-kanban__card-footer">
                <div class="ux-kanban__card-meta">
                  <span class="ux-kanban__card-meta-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <rect x="3" y="4" width="18" height="18" rx="2"/>
                      <path d="M16 2v4M8 2v4M3 10h18"/>
                    </svg>
                    15 Ene
                  </span>
                  <span class="ux-kanban__card-meta-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z"/>
                    </svg>
                    3
                  </span>
                </div>
                <div class="ux-kanban__card-priority ux-kanban__card-priority--high" title="Prioridad alta">
                  <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                </div>
              </div>
            </div>

            <!-- Card with assignees -->
            <div class="ux-kanban__card">
              <div class="ux-kanban__card-header">
                <span class="ux-kanban__card-id">#PROJ-142</span>
              </div>
              <h5 class="ux-kanban__card-title">Implementar dark mode</h5>
              <div class="ux-kanban__card-footer">
                <div class="ux-kanban__card-meta">
                  <span class="ux-kanban__card-meta-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <rect x="3" y="4" width="18" height="18" rx="2"/>
                      <path d="M16 2v4M8 2v4M3 10h18"/>
                    </svg>
                    20 Ene
                  </span>
                </div>
                <div class="ux-kanban__card-assignees">
                  <div class="ux-kanban__card-assignee">
                    <img src="https://i.pravatar.cc/48?img=1" alt="Avatar">
                  </div>
                  <div class="ux-kanban__card-assignee">
                    <img src="https://i.pravatar.cc/48?img=2" alt="Avatar">
                  </div>
                </div>
              </div>
            </div>

            <!-- Simple card -->
            <div class="ux-kanban__card">
              <h5 class="ux-kanban__card-title">Actualizar documentacion del API</h5>
            </div>
          </div>
        </div>

        <!-- Sprint Column -->
        <div class="ux-kanban__column ux-kanban__column--progress">
          <div class="ux-kanban__column-header">
            <div class="ux-kanban__column-header-start">
              <div class="ux-kanban__column-color"></div>
              <h4 class="ux-kanban__column-title">Sprint Actual</h4>
              <span class="ux-kanban__column-count">2</span>
            </div>
          </div>
          <div class="ux-kanban__column-body">
            <div class="ux-kanban__card ux-kanban__card--color ux-kanban__card--color-primary">
              <div class="ux-kanban__card-labels">
                <span class="ux-kanban__card-label ux-kanban__card-label--success">Feature</span>
              </div>
              <h5 class="ux-kanban__card-title">Sistema de notificaciones push</h5>
              <p class="ux-kanban__card-body">Integrar Firebase Cloud Messaging para notificaciones en tiempo real</p>
              <div class="ux-kanban__card-footer">
                <div class="ux-kanban__card-meta">
                  <span class="ux-kanban__card-meta-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M22 11.08V12a10 10 0 11-5.93-9.14"/>
                      <path d="M22 4L12 14.01l-3-3"/>
                    </svg>
                    60%
                  </span>
                </div>
                <div class="ux-kanban__card-assignees">
                  <div class="ux-kanban__card-assignee">
                    <img src="https://i.pravatar.cc/48?img=3" alt="Avatar">
                  </div>
                </div>
              </div>
            </div>

            <div class="ux-kanban__card">
              <div class="ux-kanban__card-labels">
                <span class="ux-kanban__card-label ux-kanban__card-label--warning">UX</span>
              </div>
              <h5 class="ux-kanban__card-title">Redisenar pagina de perfil</h5>
              <div class="ux-kanban__card-footer">
                <div class="ux-kanban__card-priority ux-kanban__card-priority--medium" title="Prioridad media">
                  <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                  <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Testing Column -->
        <div class="ux-kanban__column ux-kanban__column--review">
          <div class="ux-kanban__column-header">
            <div class="ux-kanban__column-header-start">
              <div class="ux-kanban__column-color"></div>
              <h4 class="ux-kanban__column-title">Testing</h4>
              <span class="ux-kanban__column-count">1</span>
            </div>
          </div>
          <div class="ux-kanban__column-body">
            <div class="ux-kanban__card ux-kanban__card--color ux-kanban__card--color-success">
              <h5 class="ux-kanban__card-title">Optimizar queries de base de datos</h5>
              <p class="ux-kanban__card-body">Reducir tiempo de carga del dashboard de 3s a 500ms</p>
              <div class="ux-kanban__card-footer">
                <div class="ux-kanban__card-meta">
                  <span class="ux-kanban__card-meta-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M9 11l3 3L22 4"/>
                      <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11"/>
                    </svg>
                    8/10
                  </span>
                </div>
                <div class="ux-kanban__card-assignees">
                  <div class="ux-kanban__card-assignee">
                    <img src="https://i.pravatar.cc/48?img=4" alt="Avatar">
                  </div>
                  <div class="ux-kanban__card-assignee">
                    <img src="https://i.pravatar.cc/48?img=5" alt="Avatar">
                  </div>
                  <div class="ux-kanban__card-assignee ux-kanban__card-assignee--more">+2</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- CSS-Only Static Board -->
  <div class="demo-section">
    <h3>Kanban Estatico (CSS-only)</h3>
    <p>Tablero kanban sin interactividad, solo con CSS.</p>

    <div class="demo-box">
      <div class="ux-kanban">
        <div class="ux-kanban__column">
          <div class="ux-kanban__column-header">
            <div class="ux-kanban__column-header-start">
              <div class="ux-kanban__column-color" style="background: #ef4444;"></div>
              <h4 class="ux-kanban__column-title">Urgente</h4>
              <span class="ux-kanban__column-count">2</span>
            </div>
          </div>
          <div class="ux-kanban__column-body">
            <div class="ux-kanban__card ux-kanban__card--color ux-kanban__card--color-danger">
              <h5 class="ux-kanban__card-title">Servidor caido en produccion</h5>
              <p class="ux-kanban__card-body">El servicio principal no responde</p>
            </div>
            <div class="ux-kanban__card">
              <h5 class="ux-kanban__card-title">Corregir error critico de seguridad</h5>
            </div>
          </div>
        </div>

        <div class="ux-kanban__column">
          <div class="ux-kanban__column-header">
            <div class="ux-kanban__column-header-start">
              <div class="ux-kanban__column-color" style="background: #f59e0b;"></div>
              <h4 class="ux-kanban__column-title">En revision</h4>
              <span class="ux-kanban__column-count">1</span>
            </div>
          </div>
          <div class="ux-kanban__column-body">
            <div class="ux-kanban__card">
              <h5 class="ux-kanban__card-title">Pull request #234</h5>
              <p class="ux-kanban__card-body">Esperando aprobacion del equipo</p>
            </div>
          </div>
        </div>

        <div class="ux-kanban__column">
          <div class="ux-kanban__column-header">
            <div class="ux-kanban__column-header-start">
              <div class="ux-kanban__column-color" style="background: #10b981;"></div>
              <h4 class="ux-kanban__column-title">Resuelto</h4>
              <span class="ux-kanban__column-count">3</span>
            </div>
          </div>
          <div class="ux-kanban__column-body">
            <div class="ux-kanban__card ux-kanban__card--completed">
              <h5 class="ux-kanban__card-title">Actualizar certificado SSL</h5>
            </div>
            <div class="ux-kanban__card ux-kanban__card--completed">
              <h5 class="ux-kanban__card-title">Backup de base de datos</h5>
            </div>
            <div class="ux-kanban__card ux-kanban__card--completed">
              <h5 class="ux-kanban__card-title">Monitoreo de rendimiento</h5>
            </div>
          </div>
        </div>
      </div>
    </div>

    <pre class="code-block">&lt;div class="ux-kanban"&gt;
  &lt;div class="ux-kanban__column"&gt;
    &lt;div class="ux-kanban__column-header"&gt;
      &lt;div class="ux-kanban__column-header-start"&gt;
        &lt;div class="ux-kanban__column-color" style="background: #ef4444;"&gt;&lt;/div&gt;
        &lt;h4 class="ux-kanban__column-title"&gt;Urgente&lt;/h4&gt;
        &lt;span class="ux-kanban__column-count"&gt;2&lt;/span&gt;
      &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="ux-kanban__column-body"&gt;
      &lt;div class="ux-kanban__card"&gt;
        &lt;h5 class="ux-kanban__card-title"&gt;Tarea 1&lt;/h5&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;</pre>
  </div>

  <!-- CSS Classes -->
  <div class="demo-section">
    <h3>Clases CSS</h3>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">/* Board */
.ux-kanban                        // Container principal
.ux-kanban--compact               // Espaciado reducido
.ux-kanban--glass                 // Glass morphism

/* Columns */
.ux-kanban__column                // Columna
.ux-kanban__column--collapsed     // Columna colapsada
.ux-kanban__column--drag-over     // Arrastrando sobre columna
.ux-kanban__column--todo          // Color: por hacer
.ux-kanban__column--progress      // Color: en progreso
.ux-kanban__column--review        // Color: en revision
.ux-kanban__column--done          // Color: completado

/* Column Parts */
.ux-kanban__column-header         // Header de columna
.ux-kanban__column-title          // Titulo
.ux-kanban__column-count          // Contador de tarjetas
.ux-kanban__column-color          // Indicador de color
.ux-kanban__column-body           // Contenedor de tarjetas
.ux-kanban__column-footer         // Footer con boton agregar

/* Cards */
.ux-kanban__card                  // Tarjeta
.ux-kanban__card--dragging        // Mientras se arrastra
.ux-kanban__card--ghost           // Placeholder
.ux-kanban__card--completed       // Tarea completada
.ux-kanban__card--color           // Con borde de color
.ux-kanban__card--color-primary   // Color primario
.ux-kanban__card--color-success   // Color exito
.ux-kanban__card--color-warning   // Color advertencia
.ux-kanban__card--color-danger    // Color peligro

/* Card Parts */
.ux-kanban__card-header           // Header de tarjeta
.ux-kanban__card-title            // Titulo
.ux-kanban__card-id               // ID o referencia
.ux-kanban__card-body             // Descripcion
.ux-kanban__card-labels           // Contenedor etiquetas
.ux-kanban__card-label            // Etiqueta individual
.ux-kanban__card-footer           // Footer con meta
.ux-kanban__card-meta             // Metadatos (fecha, comentarios)
.ux-kanban__card-assignees        // Avatares asignados
.ux-kanban__card-priority         // Indicador prioridad</pre>
    </div>
  </div>

  <!-- Alpine Component -->
  <div class="demo-section">
    <h3>Componente Alpine.js</h3>
    <div class="demo-box" style="padding: var(--ux-space-lg);">
      <pre class="code-block">// Configuracion
uxKanban({
  columns: [
    { id: 'todo', title: 'Por hacer', color: '#6b7280', cards: [] }
  ],
  cards: [
    { id: 1, columnId: 'todo', title: 'Tarea' }
  ],
  allowAddCards: true,       // Permitir agregar tarjetas
  allowAddColumns: false,    // Permitir agregar columnas
  emptyText: 'No hay tarjetas'
})

// Estructura de tarjeta
{
  id: 'card-1',
  columnId: 'todo',
  title: 'Titulo de la tarea',
  description: 'Descripcion opcional',
  labels: ['Bug', 'Frontend'],
  assignees: ['user1', 'user2'],
  dueDate: '2024-01-15',
  priority: 'high',       // high, medium, low
  completed: false
}

// Metodos
getColumnCards(columnId)              // Obtener tarjetas de columna
getColumnCount(columnId)              // Contar tarjetas
addCard(columnId, cardData)           // Agregar tarjeta
removeCard(cardId, columnId)          // Eliminar tarjeta
updateCard(cardId, columnId, updates) // Actualizar tarjeta
addColumn(columnData)                 // Agregar columna
removeColumn(columnId)                // Eliminar columna
moveCard(cardId, from, to, index)     // Mover tarjeta
getAllCards()                         // Todas las tarjetas
isColumnDragOver(columnId)            // Check drag over

// Eventos de drag
onDragStart(card, columnId, event)
onDragEnd(event)
onDragOver(columnId, event)
onDragLeave(columnId, event)
onDrop(columnId, index, event)
onCardClick(card, columnId, event)

// Eventos emitidos
@kanban:move          // { card, fromColumn, toColumn, toIndex }
@kanban:add           // { card, columnId }
@kanban:remove        // { card, columnId }
@kanban:update        // { card, columnId, updates }
@kanban:addcolumn     // { column }
@kanban:removecolumn  // { column }
@kanban:click         // { card, columnId, event }
@kanban:dragstart     // { card, columnId }
@kanban:dragend       // {}</pre>
    </div>
  </div>

</body>
</html>
