<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Diff Viewer - UX Library</title>
  <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
  <script src="../components/ux-core.js"></script>
  <script src="../components/ux-diff-viewer.js"></script>
  <script src="../components/ux-content.js"></script>
  <style>
    .demo-section { margin-bottom: var(--ux-space-xl); }
    .demo-section h3 {
      font-size: var(--ux-font-size-lg);
      font-weight: 600;
      margin-bottom: var(--ux-space-md);
      color: var(--ux-text);
    }
    .demo-section p {
      font-size: var(--ux-font-size-md);
      color: var(--ux-text-secondary);
      margin-bottom: var(--ux-space-md);
    }
    .demo-box {
      background: var(--ux-surface);
      border-radius: var(--ux-border-radius-lg);
      padding: var(--ux-space-lg);
      margin-bottom: var(--ux-space-md);
    }
    .code-block {
      background: #1a1a2e;
      color: #e5e5e5;
      padding: var(--ux-space-md);
      border-radius: var(--ux-border-radius);
      overflow-x: auto;
      font-family: 'SF Mono', Monaco, monospace;
      font-size: var(--ux-font-size-sm);
      line-height: 1.6;
    }
    .code-block .tag { color: #ff7b72; }
    .code-block .attr { color: #79c0ff; }
    .code-block .string { color: #a5d6ff; }
    .code-block .comment { color: #8b949e; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: var(--ux-space-md);
    }
    th, td {
      padding: var(--ux-space-sm) var(--ux-space-md);
      text-align: left;
      border-bottom: 1px solid var(--ux-border-color);
    }
    th { font-weight: 600; color: var(--ux-text); }
    td { color: var(--ux-text-secondary); }
    td code {
      background: var(--ux-gray-100);
      padding: 2px 6px;
      border-radius: var(--ux-border-radius-sm);
      font-size: var(--ux-font-size-sm);
    }
    .demo-stack { display: flex; flex-direction: column; gap: var(--ux-space-md); }
  </style>
</head>
<body class="ux-app">

  <div class="ux-content" style="padding: var(--ux-space-lg); max-width: 1200px; margin: 0 auto;">
    <h1 style="margin-bottom: var(--ux-space-sm);">Diff Viewer</h1>
    <p style="color: var(--ux-text-secondary); margin-bottom: var(--ux-space-xl);">Visualizacion de cambios en codigo y texto con vistas unificada y dividida.</p>

    <!-- Unified View -->
    <section class="demo-section">
      <h3>Vista Unificada</h3>
      <p>Usa <code>.ux-diff--unified</code> para mostrar los cambios en una sola columna.</p>
      <div class="demo-box">
        <div class="ux-diff ux-diff--unified"
             x-data="uxDiffViewer({
               oldText: `function greet(name) {
  console.log('Hello, ' + name);
  return true;
}

// Call the function
greet('World');`,
               newText: `function greet(name, greeting = 'Hello') {
  console.log(greeting + ', ' + name + '!');
  return { success: true, name };
}

// Call the function with custom greeting
greet('World', 'Hi');`,
               fileName: 'greeting.js',
               view: 'unified'
             })">
          <div class="ux-diff__header">
            <div class="ux-diff__title" x-text="fileName || 'Diff'"></div>
            <div class="ux-diff__stats">
              <span class="ux-diff__stat--added">+<span x-text="stats.added"></span></span>
              <span class="ux-diff__stat--removed">-<span x-text="stats.removed"></span></span>
            </div>
          </div>

          <div class="ux-diff__content">
            <template x-for="(line, idx) in displayLines" :key="idx">
              <div>
                <template x-if="line.type === 'expand'">
                  <div class="ux-diff__expand" @click="expandSection(line.startIndex, line.endIndex)">
                    <span x-html="icons.expand" class="ux-diff__expand-icon"></span>
                    <span class="ux-diff__expand-text" x-text="'Expand ' + line.count + ' lines'"></span>
                  </div>
                </template>

                <template x-if="line.type !== 'expand'">
                  <div class="ux-diff__line"
                       :class="{
                         'ux-diff__line--added': line.type === 'added',
                         'ux-diff__line--removed': line.type === 'removed',
                         'ux-diff__line--context': line.type === 'context'
                       }">
                    <span class="ux-diff__gutter ux-diff__gutter--old" x-text="line.oldLine || ''"></span>
                    <span class="ux-diff__gutter ux-diff__gutter--new" x-text="line.newLine || ''"></span>
                    <span class="ux-diff__marker" x-text="line.type === 'added' ? '+' : line.type === 'removed' ? '-' : ' '"></span>
                    <span class="ux-diff__code" x-text="line.content"></span>
                  </div>
                </template>
              </div>
            </template>
          </div>
        </div>
      </div>
    </section>

    <!-- Split View -->
    <section class="demo-section">
      <h3>Vista Dividida (Split)</h3>
      <p>Usa <code>.ux-diff--split</code> para mostrar el original y modificado lado a lado.</p>
      <div class="demo-box">
        <div class="ux-diff ux-diff--split"
             x-data="uxDiffViewer({
               oldText: `const user = {
  name: 'John',
  age: 30
};

function getUser() {
  return user;
}`,
               newText: `const user = {
  name: 'John',
  age: 30,
  email: 'john@example.com'
};

function getUser(includeEmail = true) {
  if (!includeEmail) {
    const { email, ...rest } = user;
    return rest;
  }
  return user;
}`,
               fileName: 'user.js',
               view: 'split'
             })">
          <div class="ux-diff__header">
            <div class="ux-diff__title" x-text="fileName || 'Diff'"></div>
            <div class="ux-diff__stats">
              <span class="ux-diff__stat--added">+<span x-text="stats.added"></span></span>
              <span class="ux-diff__stat--removed">-<span x-text="stats.removed"></span></span>
            </div>
          </div>

          <div class="ux-diff__content">
            <div class="ux-diff__pane ux-diff__pane--old">
              <div class="ux-diff__pane-header ux-diff__pane-header--old" x-text="oldTitle"></div>
              <template x-for="(pair, idx) in splitLines" :key="'old-' + idx">
                <div class="ux-diff__line"
                     :class="{
                       'ux-diff__line--removed': pair.old.type === 'removed',
                       'ux-diff__line--context': pair.old.type === 'context',
                       'ux-diff__line--empty': pair.old.type === 'empty'
                     }">
                  <span class="ux-diff__gutter" x-text="pair.old.oldLine || ''"></span>
                  <span class="ux-diff__code" x-text="pair.old.content"></span>
                </div>
              </template>
            </div>

            <div class="ux-diff__pane ux-diff__pane--new">
              <div class="ux-diff__pane-header ux-diff__pane-header--new" x-text="newTitle"></div>
              <template x-for="(pair, idx) in splitLines" :key="'new-' + idx">
                <div class="ux-diff__line"
                     :class="{
                       'ux-diff__line--added': pair.new.type === 'added',
                       'ux-diff__line--context': pair.new.type === 'context',
                       'ux-diff__line--empty': pair.new.type === 'empty'
                     }">
                  <span class="ux-diff__gutter" x-text="pair.new.newLine || ''"></span>
                  <span class="ux-diff__code" x-text="pair.new.content"></span>
                </div>
              </template>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- With File Status -->
    <section class="demo-section">
      <h3>Con Estado de Archivo</h3>
      <p>Muestra el estado del archivo con <code>fileStatus</code>: modified, added, deleted.</p>
      <div class="demo-stack">
        <div class="ux-diff ux-diff--unified"
             x-data="uxDiffViewer({
               oldText: 'version: 1.0.0',
               newText: 'version: 1.1.0',
               fileName: 'package.json',
               fileStatus: 'modified'
             })">
          <div class="ux-diff__file">
            <span x-html="icons.file" class="ux-diff__file-icon"></span>
            <span class="ux-diff__file-name" x-text="fileName"></span>
            <span class="ux-diff__file-status ux-diff__file-status--modified">Modified</span>
          </div>
          <div class="ux-diff__content">
            <template x-for="(line, idx) in diff" :key="idx">
              <div class="ux-diff__line"
                   :class="{
                     'ux-diff__line--added': line.type === 'added',
                     'ux-diff__line--removed': line.type === 'removed',
                     'ux-diff__line--context': line.type === 'context'
                   }">
                <span class="ux-diff__gutter ux-diff__gutter--old" x-text="line.oldLine || ''"></span>
                <span class="ux-diff__gutter ux-diff__gutter--new" x-text="line.newLine || ''"></span>
                <span class="ux-diff__marker" x-text="line.type === 'added' ? '+' : line.type === 'removed' ? '-' : ' '"></span>
                <span class="ux-diff__code" x-text="line.content"></span>
              </div>
            </template>
          </div>
        </div>

        <div class="ux-diff ux-diff--unified"
             x-data="uxDiffViewer({
               oldText: '',
               newText: `# README

This is a new file.`,
               fileName: 'README.md',
               fileStatus: 'added'
             })">
          <div class="ux-diff__file">
            <span x-html="icons.file" class="ux-diff__file-icon"></span>
            <span class="ux-diff__file-name" x-text="fileName"></span>
            <span class="ux-diff__file-status ux-diff__file-status--added">Added</span>
          </div>
          <div class="ux-diff__content">
            <template x-for="(line, idx) in diff" :key="idx">
              <div class="ux-diff__line ux-diff__line--added">
                <span class="ux-diff__gutter ux-diff__gutter--new" x-text="line.newLine"></span>
                <span class="ux-diff__marker">+</span>
                <span class="ux-diff__code" x-text="line.content"></span>
              </div>
            </template>
          </div>
        </div>

        <div class="ux-diff ux-diff--unified"
             x-data="uxDiffViewer({
               oldText: `// Deprecated file
module.exports = {};`,
               newText: '',
               fileName: 'old-module.js',
               fileStatus: 'deleted'
             })">
          <div class="ux-diff__file">
            <span x-html="icons.file" class="ux-diff__file-icon"></span>
            <span class="ux-diff__file-name" x-text="fileName"></span>
            <span class="ux-diff__file-status ux-diff__file-status--deleted">Deleted</span>
          </div>
          <div class="ux-diff__content">
            <template x-for="(line, idx) in diff" :key="idx">
              <div class="ux-diff__line ux-diff__line--removed">
                <span class="ux-diff__gutter ux-diff__gutter--old" x-text="line.oldLine"></span>
                <span class="ux-diff__marker">-</span>
                <span class="ux-diff__code" x-text="line.content"></span>
              </div>
            </template>
          </div>
        </div>
      </div>
    </section>

    <!-- Size Variants -->
    <section class="demo-section">
      <h3>Tamanos</h3>
      <p>Usa <code>.ux-diff--sm</code> o <code>.ux-diff--lg</code> para diferentes tamanos.</p>
      <div class="demo-stack">
        <div>
          <p style="margin-bottom: var(--ux-space-xs);"><small>Small</small></p>
          <div class="ux-diff ux-diff--unified ux-diff--sm"
               x-data="uxDiffViewer({
                 oldText: 'const x = 1;',
                 newText: 'const x = 2;'
               })">
            <div class="ux-diff__content">
              <template x-for="(line, idx) in diff" :key="idx">
                <div class="ux-diff__line"
                     :class="{
                       'ux-diff__line--added': line.type === 'added',
                       'ux-diff__line--removed': line.type === 'removed'
                     }">
                  <span class="ux-diff__gutter" x-text="line.oldLine || line.newLine"></span>
                  <span class="ux-diff__marker" x-text="line.type === 'added' ? '+' : '-'"></span>
                  <span class="ux-diff__code" x-text="line.content"></span>
                </div>
              </template>
            </div>
          </div>
        </div>

        <div>
          <p style="margin-bottom: var(--ux-space-xs);"><small>Large</small></p>
          <div class="ux-diff ux-diff--unified ux-diff--lg"
               x-data="uxDiffViewer({
                 oldText: 'const x = 1;',
                 newText: 'const x = 2;'
               })">
            <div class="ux-diff__content">
              <template x-for="(line, idx) in diff" :key="idx">
                <div class="ux-diff__line"
                     :class="{
                       'ux-diff__line--added': line.type === 'added',
                       'ux-diff__line--removed': line.type === 'removed'
                     }">
                  <span class="ux-diff__gutter" x-text="line.oldLine || line.newLine"></span>
                  <span class="ux-diff__marker" x-text="line.type === 'added' ? '+' : '-'"></span>
                  <span class="ux-diff__code" x-text="line.content"></span>
                </div>
              </template>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Usage -->
    <section class="demo-section">
      <h3>Uso</h3>
      <pre class="code-block"><span class="comment">&lt;!-- Vista unificada basica --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"ux-diff ux-diff--unified"</span>
     <span class="attr">x-data</span>=<span class="string">"uxDiffViewer({
       oldText: 'const x = 1;',
       newText: 'const x = 2;',
       fileName: 'app.js'
     })"</span><span class="tag">&gt;</span>
  <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"ux-diff__header"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"ux-diff__title"</span> <span class="attr">x-text</span>=<span class="string">"fileName"</span><span class="tag">&gt;&lt;/div&gt;</span>
    <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"ux-diff__stats"</span><span class="tag">&gt;</span>
      <span class="tag">&lt;span</span> <span class="attr">class</span>=<span class="string">"ux-diff__stat--added"</span><span class="tag">&gt;</span>+<span class="tag">&lt;span</span> <span class="attr">x-text</span>=<span class="string">"stats.added"</span><span class="tag">&gt;&lt;/span&gt;&lt;/span&gt;</span>
      <span class="tag">&lt;span</span> <span class="attr">class</span>=<span class="string">"ux-diff__stat--removed"</span><span class="tag">&gt;</span>-<span class="tag">&lt;span</span> <span class="attr">x-text</span>=<span class="string">"stats.removed"</span><span class="tag">&gt;&lt;/span&gt;&lt;/span&gt;</span>
    <span class="tag">&lt;/div&gt;</span>
  <span class="tag">&lt;/div&gt;</span>
  <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"ux-diff__content"</span><span class="tag">&gt;</span>
    <span class="tag">&lt;template</span> <span class="attr">x-for</span>=<span class="string">"(line, idx) in diff"</span><span class="tag">&gt;</span>
      <span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"ux-diff__line"</span> <span class="attr">:class</span>=<span class="string">"..."</span><span class="tag">&gt;</span>
        <span class="tag">&lt;span</span> <span class="attr">class</span>=<span class="string">"ux-diff__gutter"</span><span class="tag">&gt;&lt;/span&gt;</span>
        <span class="tag">&lt;span</span> <span class="attr">class</span>=<span class="string">"ux-diff__marker"</span><span class="tag">&gt;&lt;/span&gt;</span>
        <span class="tag">&lt;span</span> <span class="attr">class</span>=<span class="string">"ux-diff__code"</span> <span class="attr">x-text</span>=<span class="string">"line.content"</span><span class="tag">&gt;&lt;/span&gt;</span>
      <span class="tag">&lt;/div&gt;</span>
    <span class="tag">&lt;/template&gt;</span>
  <span class="tag">&lt;/div&gt;</span>
<span class="tag">&lt;/div&gt;</span>

<span class="comment">&lt;!-- Vista dividida --&gt;</span>
<span class="tag">&lt;div</span> <span class="attr">class</span>=<span class="string">"ux-diff ux-diff--split"</span>
     <span class="attr">x-data</span>=<span class="string">"uxDiffViewer({ oldText: '...', newText: '...', view: 'split' })"</span><span class="tag">&gt;</span>
  ...
<span class="tag">&lt;/div&gt;</span></pre>
    </section>

    <!-- Options -->
    <section class="demo-section">
      <h3>Opciones</h3>
      <div style="background: var(--ux-surface); border-radius: var(--ux-border-radius-lg); overflow: hidden;">
        <table>
          <thead>
            <tr><th>Opcion</th><th>Tipo</th><th>Default</th><th>Descripcion</th></tr>
          </thead>
          <tbody>
            <tr><td><code>oldText</code></td><td>String</td><td>''</td><td>Texto original</td></tr>
            <tr><td><code>newText</code></td><td>String</td><td>''</td><td>Texto modificado</td></tr>
            <tr><td><code>oldTitle</code></td><td>String</td><td>'Original'</td><td>Titulo del panel izquierdo</td></tr>
            <tr><td><code>newTitle</code></td><td>String</td><td>'Modified'</td><td>Titulo del panel derecho</td></tr>
            <tr><td><code>fileName</code></td><td>String</td><td>null</td><td>Nombre del archivo</td></tr>
            <tr><td><code>fileStatus</code></td><td>String</td><td>'modified'</td><td>'modified', 'added', 'deleted', 'renamed'</td></tr>
            <tr><td><code>view</code></td><td>String</td><td>'unified'</td><td>'unified' o 'split'</td></tr>
            <tr><td><code>showLineNumbers</code></td><td>Boolean</td><td>true</td><td>Mostrar numeros de linea</td></tr>
            <tr><td><code>contextLines</code></td><td>Number</td><td>3</td><td>Lineas de contexto (-1 = todas)</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Methods -->
    <section class="demo-section">
      <h3>Metodos</h3>
      <div style="background: var(--ux-surface); border-radius: var(--ux-border-radius-lg); overflow: hidden;">
        <table>
          <thead>
            <tr><th>Metodo</th><th>Descripcion</th></tr>
          </thead>
          <tbody>
            <tr><td><code>setTexts(oldText, newText)</code></td><td>Establece nuevos textos y recalcula diff</td></tr>
            <tr><td><code>setView(view)</code></td><td>Cambia la vista ('unified' o 'split')</td></tr>
            <tr><td><code>toggleView()</code></td><td>Alterna entre vistas</td></tr>
            <tr><td><code>expandSection(start, end)</code></td><td>Expande una seccion colapsada</td></tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- CSS Classes -->
    <section class="demo-section">
      <h3>Clases CSS</h3>
      <div style="background: var(--ux-surface); border-radius: var(--ux-border-radius-lg); overflow: hidden;">
        <table>
          <thead>
            <tr><th>Clase</th><th>Descripcion</th></tr>
          </thead>
          <tbody>
            <tr><td><code>.ux-diff</code></td><td>Contenedor principal</td></tr>
            <tr><td><code>.ux-diff--unified</code></td><td>Vista unificada</td></tr>
            <tr><td><code>.ux-diff--split</code></td><td>Vista dividida</td></tr>
            <tr><td><code>.ux-diff--sm</code></td><td>Tamano pequeno</td></tr>
            <tr><td><code>.ux-diff--lg</code></td><td>Tamano grande</td></tr>
            <tr><td><code>.ux-diff__line--added</code></td><td>Linea anadida (verde)</td></tr>
            <tr><td><code>.ux-diff__line--removed</code></td><td>Linea eliminada (rojo)</td></tr>
            <tr><td><code>.ux-diff__line--context</code></td><td>Linea de contexto</td></tr>
            <tr><td><code>.ux-diff__file-status--*</code></td><td>Estado del archivo</td></tr>
          </tbody>
        </table>
      </div>
    </section>

  </div>
</body>
</html>
